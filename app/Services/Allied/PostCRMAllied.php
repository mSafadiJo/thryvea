<?php

namespace App\Services\Allied;

use App\Services\CrmApi;
use Illuminate\Support\Facades\Log;
use Illuminate\Support\Facades\Mail;

class PostCRMAllied {
    public function callTools($data_msg, $crm_details){
        if(empty($crm_details['callTollsDetails'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "callTollsDetails"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $Lead_data_array = array(
            'auth_token' => $crm_details['callTollsDetails']['api_key'],
            'title' => ucfirst($crm_details['service_campaign_name']),
            'company_name' => ucfirst($crm_details['service_campaign_name']),
            'first_name'=> $data_msg['first_name'],
            'last_name'=> $data_msg['last_name'],
            'email_address' => $data_msg['LeadEmail'],
            'zip_code' => $data_msg['Zipcode'],
            'address' => $data_msg['street'],
            'city' => $data_msg['City'],
            'state' => $data_msg['State'],
            'phone_number' => $data_msg['LeadPhone'],
            'mobile_number' => $data_msg['LeadPhone'],
            'dial_duplicate' => 1,
            'note' => "Lead From " . config('app.name', '')
        );

        if( !empty($crm_details['callTollsDetails']['file_id']) ){
            $Lead_data_array['file'] = $crm_details['callTollsDetails']['file_id'];
            $Lead_data_array['hot_lead'] = 1;
        }

        $url_api = "https://app.calltools.com/api/contacts/";

        $leadsCustomerCampaign_id = $data_msg['leadCustomer_id'];

        $url_api = str_replace(" ","%20",$url_api);

        $httpheader = array(
            "cache-control: no-cache",
            "Accept: application/json",
            "content-type: application/json"
        );

        $from_job = (!empty($crm_details['from_job']) ? 1 : 0 );

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id'], $from_job);
        return 1;
    }

    public function five9Crm($data_msg, $crm_details){
        //Five9 CRM
        if(empty($crm_details['Five9Details'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "Five9Details"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = $data_msg['first_name'];
        $last_name = $data_msg['last_name'];
        $number1 = $data_msg['LeadPhone'];
        $zip = $data_msg['Zipcode'];
        $street = $data_msg['street'];
        $city = $data_msg['City'];
        $email = $data_msg['LeadEmail'];
        $state = $data_msg['State'];
        $Product = strtoupper($crm_details['service_campaign_name']);
        $leadsCustomerCampaign_id = strtoupper($crm_details['leadsCustomerCampaign_id']);
        $five9_domian = $crm_details['Five9Details']['five9_domian'];
        $five9_list = $crm_details['Five9Details']['five9_list'];

        $url_api = "https://api.five9.com/web2campaign/AddToList?F9domain=$five9_domian&F9list=$five9_list&number1=$number1&first_name=$first_name&last_name=$last_name&email=$email&street=$street&city=$city&zip=$zip&Leadkey=$leadsCustomerCampaign_id&Product=$Product&F9CallASAP=True%20Response%20String%20:";
        $url_api = str_replace(" ","+",$url_api);

        $httpheader = array();

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "GET", 1, $crm_details['campaign_id']);
        return 1;
    }

    public function leadsPedia($data_msg, $crm_details){
        if(empty($crm_details['Leads_PediaDetails'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "Leads_PediaDetails"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = $data_msg['first_name'];
        $last_name = $data_msg['last_name'];
        $number1 = $data_msg['LeadPhone'];
        $zip = $data_msg['Zipcode'];
        $street = $data_msg['street'];
        $city = $data_msg['City'];
        $county = $data_msg['county'];
        $email = $data_msg['LeadEmail'];
        $state = $data_msg['State'];
        $trusted_form = $data_msg['trusted_form'];
        $lead_source_text = $data_msg['lead_source'];
        $google_ts = $data_msg['google_ts'];
        $lp_campaign_id = $crm_details['Leads_PediaDetails']['IP_Campaign_ID'];
        $lp_campaign_key = $crm_details['Leads_PediaDetails']['campine_key'];
        $lp_url = $crm_details['Leads_PediaDetails']['leads_pedia_url'];

        $LeadId = $data_msg['LeadId'];
        $IPAddress = $data_msg['IPAddress'];
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $UserAgent = $data_msg['UserAgent'];
        $OriginalURL = $data_msg['OriginalURL'];
        $OriginalURL2 = $data_msg['OriginalURL2'];
        $SessionLength = $data_msg['SessionLength'];
        $lead_browser_name = $data_msg['browser_name'];
        $tcpa_compliant = $data_msg['tcpa_compliant'];
        $TCPAText = $data_msg['TCPAText'];
        $lead_source_text = $data_msg['lead_source'];

        switch ($crm_details['service_id']){
            case 2:
                //Solar Service
                switch ($crm_details['buyer_id']) {
                    case 20:
                        //Smart Home Solution
                        $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_home=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&trusted_form_cert_id=$trusted_form";

                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        $utility_provider = $crm_details['data']['utility_provider'];

                        switch ($crm_details['data']['roof_shade']){
                            case "Full Sun":
                                $roof_shade = "No Shade";
                                break;
                            case "Mostly Shaded":
                                $roof_shade = "Full Shade";
                                break;
                            case "Partial Shade":
                                $roof_shade = "Partial Shade";
                                break;
                            default:
                                $roof_shade = "Not Sure";
                        }

                        $url_api .= "&monthly_electric_bill=$monthly_electric_bill&utility_provider=$utility_provider&roof_type=$roof_shade";
                        break;
                    case 22:
                        //Lead Cactus
                        $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&email_address=$email&xxTrustedFormCertUrl=$trusted_form&jornaya_lead_id=$LeadId&ip_address=$IPAddress&lp_s1=$lead_source_text&lp_s2=$lead_source_text&lp_s3=$lead_source_text";

                        switch ($crm_details['data']['monthly_electric_bill']){
                            case '$0 - $50':
                                $average_bill = '$0-50';
                                break;
                            case '$51 - $100':
                                $average_bill = '$51-100';
                                break;
                            case '$101 - $150':
                                $average_bill = '$101-150';
                                break;
                            case '$151 - $200':
                                $average_bill = '$151-200';
                                break;
                            case '$201 - $300':
                                $average_bill = '$201-300';
                                break;
                            case '$301 - $400':
                                $average_bill = '$301-400';
                                break;
                            case '$401 - $500':
                                $average_bill = '$401-500';
                                break;
                            default:
                                $average_bill = '$501-600';
                        }

                        switch ($crm_details['data']['roof_shade']){
                            case "Full Sun":
                                $roof_shade = "No Shade";
                                break;
                            case "Mostly Shaded":
                                $roof_shade = "A Lot Of Shade";
                                break;
                            case "Partial Shade":
                                $roof_shade = "A Little Shade";
                                break;
                            default:
                                $roof_shade = "Uncertain";
                        }

                        $utility_provider = $crm_details['data']['utility_provider'];
                        $property_type = $crm_details['data']['property_type'];
                        $homeowner = ($property_type == 'Rented' ? 'No' : 'Yes');

                        $url_api .= "&average_bill=$average_bill&electricUtilityProviderText=$utility_provider&roof_shade=$roof_shade&homeowner=$homeowner";
                        break;
                    case 56:
                        //Trinity Solar 56
                        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
                        if ($listOFCampainDB_type == "Exclusive") {
                            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
                            $Lead_Cost_type = "Exclusive";
                        } else {
                            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
                            $Lead_Cost_type = "Shared";
                        }

                        if ($crm_details['campaign_Type'] == 4) {
                            $appointment_date = "";
                            $appointment_time = "";
                            if ($data_msg['appointment_date'] != "") {
                                $appointment_date = date('Y-m-d', strtotime($data_msg['appointment_date']));
                                $appointment_time = date('H:i:s', strtotime($data_msg['appointment_date']));
                            }

                            $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_home=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&lp_caller_id=$number1&appointment_date=$appointment_date&appointment_time=$appointment_time";
                        } else {
                            $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_home=$number1&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&trusted_form=$trusted_form&ip_address=$IPAddress&lp_cost=$Lead_Cost";
                        }

                        if (!empty($crm_details['data'])) {
                            $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];

                            switch ($monthly_electric_bill){
                                case '$201 - $300':
                                    $average_bill = '$201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-400';
                                    break;
                                case '$401 - $500' || '$500+':
                                    $average_bill = '$400+';
                                    break;
                                default:
                                    $average_bill = '$100-200';
                            }

                            switch ($crm_details['data']['roof_shade']){
                                case "Full Sun":
                                    $roof_shade = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade = "Full Shade";
                                    break;
                                case "Partial Shade":
                                    $roof_shade = "Partial Shade";
                                    break;
                                default:
                                    $roof_shade = "Not Sure of Roof Shade";
                            }

                            $property_type = $crm_details['data']['property_type'];
                            $homeowner = ($property_type == 'Rented' ? 'No' : 'Yes');

                            $url_api .= "&average_monthly_utility_bill=$average_bill&roof_shade=$roof_shade&homeowner=$homeowner";

                            //Check if it is warm transfer
                            if ($crm_details['campaign_Type'] == 6) {
                                $url_api .= "&phone_home=$number1&lp_caller_id=$number1";
                            }
                        }
                        break;
                    case 185:
                        //snk media group
                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        switch ($monthly_electric_bill){
                            case '$101 - $150' || '$151 - $200':
                                $average_bill = '$101-200';
                                break;
                            case '$201 - $300':
                                $average_bill = '$201-300';
                                break;
                            case '$301 - $400':
                                $average_bill = '$301-400';
                                break;
                            case '$401 - $500' || '$500+':
                                $average_bill = '+$401';
                                break;
                            default:
                                $average_bill = 'Less than $100';
                        }

                        switch ($crm_details['data']['roof_shade']){
                            case "Full Sun":
                                $roof_shade_data = "No Shade";
                                break;
                            case "Mostly Shaded":
                                $roof_shade_data = "Full Shade";
                                break;
                            case "Partial Shade":
                                $roof_shade_data = "Partial Shade";
                                break;
                            default:
                                $roof_shade_data = "Not Sure";
                        }

                        $property_type = $crm_details['data']['property_type'];
                        $homeowner = ($property_type == 'Rented' ? 'No' : 'Yes');

                        $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&lp_s2=$google_ts&first_name=$first_name&last_name=$last_name&phone_home=$number1&email_address=$email&address=$street&city=$city&state=$state&zip_code=$zip&ip_address=$IPAddress&roof_shade=$roof_shade_data&homeownership=$homeowner&electricity_bill=$average_bill&utility_provider=Other&jornaya_id=$LeadId&trusted_form_url=$trusted_form&landing_page_url=$OriginalURL&TCPA_Language=$TCPAText&TrustedForm_Yes_No=Yes&JornayaID_Yes_No=Yes&TF_Yes_No=Yes&Jornaya_Yes_No=Yes";
                        break;
                    default:
                        $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_home=$number1&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&trusted_form=$trusted_form";
                }
                break;
            case 5:
                //Walk In tubs Service
                $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&xxTrustedFormCertUrl=$trusted_form";

                if (!empty($crm_details['data'])) {
                    $reason = $crm_details['data']['reason'];
                    $start_date = $crm_details['data']['start_date'];
                    $homeOwn = $crm_details['data']['homeOwn'];

                    $url_api .= "&homeowner=$homeOwn&start_date=$start_date&reason=$reason";
                }
                break;
            default:
                $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=JSON&first_name=$first_name&last_name=$last_name&phone_home=$number1&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&county=$county&email_address=$email&trusted_form=$trusted_form";
        }

        if ($crm_details['is_ping_account'] == 1) {
            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                $url_api .= "&lp_ping_id=$TransactionId";
            } else {
                return 0;
            }
        }

        if( config('app.env', 'local') == "local" ) {
            //Test Mode
            $url_api .= "&lp_test=1";
        }

        $leadsCustomerCampaign_id = '';
        if( !empty($crm_details['leadsCustomerCampaign_id']) ){
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        }

        $url_api = str_replace(" ","%20",$url_api);

        $httpheader = array(
            "cache-control: no-cache",
            "Accept: application/json",
            "content-type: application/json"
        );

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, '', "GET",  1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        $status = 0;
        if( !empty($result2['result']) ){
            if( $result2['result'] == 'success' || $result2['msg'] == 'Lead Accepted' ){
                $status = 1;
            }
        }
        return $status;
    }

    public function hubspot($data_msg, $crm_details){
        if(empty($crm_details['hubspotDetails'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "hubspotDetails"));
            return 0;
        }

        $crm_api_file = new CrmApi();
        $first_name = $data_msg['first_name'];
        $last_name = $data_msg['last_name'];
        $email_address = $data_msg['LeadEmail'] ;
        $address = $data_msg['street'];
        $zip_code = $data_msg['Zipcode'];
        $city = $data_msg['City'];
        $state = $data_msg['State'];
        $phone_number = $data_msg['LeadPhone'];
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        $app_name =  config('app.name', '');
        $sourceAndBidType = ($listOFCampainDB_type == "Exclusive" ? "Allied Digital Media Exclusive" : "Allied Digital Media");

        $Lead_data_array = "{\r\n  \"properties\": [\r\n
{\r\n      \"property\": \"email\",\r\n          \"value\": \"$email_address\"\r\n},
\r\n
{\r\n      \"property\": \"firstname\",\r\n      \"value\": \"$first_name\"\r\n},
\r\n
{\r\n      \"property\": \"lastname\",\r\n       \"value\": \"$last_name\"\r\n},
\r\n
{\r\n      \"property\": \"website\",\r\n        \"value\": \"$app_name\"\r\n},
\r\n
{\r\n      \"property\": \"company\",\r\n        \"value\": \"\"\r\n},
\r\n
{\r\n      \"property\": \"lead_source\",\r\n    \"value\": \"$sourceAndBidType\"\r\n},
\r\n
{\r\n      \"property\": \"phone\",\r\n          \"value\": \"$phone_number\"\r\n},
\r\n
{\r\n      \"property\": \"address\",\r\n        \"value\": \"$address\"\r\n},
\r\n
{\r\n      \"property\": \"city\",\r\n           \"value\": \"$city\"\r\n},
\r\n
{\r\n      \"property\": \"state\",\r\n          \"value\": \"$state\"\r\n},
\r\n
{\r\n      \"property\": \"zip\",\r\n            \"value\": \"$zip_code\"\r\n}
\r\n  ]\r\n}";

        $url_api = "https://api.hubapi.com/contacts/v1/contact";
        if($crm_details['hubspotDetails']['key_type'] == 0){
            $url_api .= "?hapikey=" . $crm_details['hubspotDetails']['Api_Key'];
        }

        $httpheader = array(
            "cache-control: no-cache",
            "Accept: application/json",
            "content-type: application/json"
        );

        if($crm_details['hubspotDetails']['key_type'] == 1){
            $httpheader[] = "Authorization: Bearer " . $crm_details['hubspotDetails']['Api_Key'];
        }

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        if(!empty($result2['status'])){
            if($result2['status'] == "error"){
                return 0;
            }
        }
        return 1;
    }

    public function Pipdrive($data_msg, $crm_details){
        if(empty($crm_details['pipedriveDetails'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "pipedriveDetails"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $Lead_data_array = array(
            'api_token' => $crm_details['pipedriveDetails']['api_token'],
            'persons_domain' => $crm_details['pipedriveDetails']['persons_domain'],
            'persons' => $crm_details['pipedriveDetails']['persons'],
            'deals_leads' => $crm_details['pipedriveDetails']['deals_leads'],
            'title' => ucfirst($crm_details['service_campaign_name']),
            'first_name'=> $data_msg['first_name'],
            'last_name'=> $data_msg['last_name'],
            'email_address' => $data_msg['LeadEmail'],
            'phone_number' => $data_msg['LeadPhone'],
        );

        $first_name = ucwords($data_msg['first_name']);
        $last_name = ucwords($data_msg['last_name']);
        $mail = $data_msg['LeadEmail'] ;
        $phone = $data_msg['LeadPhone'];

        $street = ucwords(trim($data_msg['street']));
        $city = ucwords(trim($data_msg['City']));
        $state = ucwords(trim($data_msg['State']));
        $state_code = trim($data_msg['state_code']);
        $Zipcode = trim($data_msg['Zipcode']);

        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        if ($listOFCampainDB_type == "Exclusive") {
            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Exclusive";
        } else {
            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Shared";
        }

        // ================================== //
        // FORM INPUT CAPTURE
        // ================================== //
        $name = $first_name . ' ' . $last_name;

        // ================================== //
        // API token
        // ================================== //
        $api_token = $Lead_data_array['api_token'];
        $person_domain = $Lead_data_array['persons_domain'];
        $is_person = $Lead_data_array['persons'];
        $is_deals = $Lead_data_array['deals_leads'];

        // ================================== //
        // PERSON'S API Key fields' Array values
        // ================================== //
        if( $is_person == 1 ){
            $Lead_data_array = array(
                'name'  => $name,
                'email' => $mail,
                'phone' => $phone,
            );

            switch ($crm_details['buyer_id']){
                case 194:
                    //	Kilowatt Solar 194
                    $Lead_data_array['f5538955510ae7048610f4225eb19bf5b7b6deaf'] = "State: $state, City: $city, Street: $street";
                    break;
                case 420:
                    //Sun Badger Solar 420
                    $Lead_data_array['27f0b6de8997d6b27bd1ac692905fab8f62f7173'] = "$street, $city, $state_code $Zipcode, US";//address
                    $Lead_data_array['postal_address'] = $street;//address
                    break;
                case 800:
                    //PEP Solar	800
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    switch ($roof_shade){
                        case "Mostly Shaded":
                            $roof_shade_data = "Shady";
                            break;
                        case "Partial Sun":
                            $roof_shade_data = "Some Shade";
                            break;
                        default:
                            $roof_shade_data = "Full Sun";
                    }

                    $Lead_data_array['Utility'] = $utility_provider;
                    $Lead_data_array['Energy-Type'] = "All Electric";
                    $Lead_data_array['Roof-Radiance'] = $roof_shade_data;
                    $Lead_data_array['Monthly-Electric-Bill'] = $monthly_electric_bill;
                    //$Lead_data_array['Address'] = "State: $state, City: $city, Street: $street";
                    break;
                case 907:
                    //Allied Veterans Roofing, Solar & HVAC Company	907
                    $Lead_data_array['4741984edeabbcb415812caff055538c87d9da5e'] = $street;//street address
                    $Lead_data_array['354a1c2b7b6ab4398a1f436827172af003a6462b'] = "ADM";//Source
                    break;
            }

            // ================================== //
            // API PERSONS domain
            // ================================== //
            $url_api = 'https://'.$person_domain.'.pipedrive.com/v1/persons?api_token=' . $api_token;

            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];

            $httpheader = array(
                "cache-control: no-cache",
                "Accept: application/json",
                "content-type: application/json"
            );

            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
            $result_data = json_decode($result, true);
            if (!empty($result_data['success'])) {
                if ($result_data['success'] == true) {
                    if ($is_deals == 1) {
                        $person_id = $result_data['data']['id'];

                        $Lead_data_array2 = array(
                            'title' => $name,
                            'person_id' => $person_id,
			    'value' => ucfirst($crm_details['service_campaign_name'])
                        );

                        switch ($crm_details['buyer_id']){
                            case 194:
                                //Kilowatt Solar 194
                                $Lead_data_array2['27f936309c7f3685b070f2eba7d0915eb852dea6'] = 'Allied';
                                break;
                            case 420:
                                //Sun Badger Solar 420
                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);

                                $roof_shade_data = ($roof_shade == "Mostly Shaded" ? "Too Shaded" : "Viable Roof");
                                $property_type_data = ($property_type == "Rented" ? "No" : "Yes");

                                $Lead_data_array2['e6bea47ff543ee018be42d422f23b033b3b08288'] = $Lead_Cost;//Lead Cost
                                $Lead_data_array2['ba318b22118ccd30ad68686b48dbee75888d281f'] = $Lead_Cost_type;//Lead Cost Type
                                $Lead_data_array2['4b9fab40353950422a2cd9c0366b1c0ec8e9b20c'] = "Allied";//Lead Source
                                $Lead_data_array2['3cb8f2ea27526c0022f6bc80ebb5edec3215db5e'] = "Allied";//Lead Source (invisible)
                                $Lead_data_array2['a0ba88a0d8c8056099ffc57675c739c3eecd3be5'] = $mail;//email
                                $Lead_data_array2['ee655e39bda3ec744236818a14651e75c0bd39f7'] = $phone;//phone number
                                $Lead_data_array2['697dd2574bc090e7aa644d055c0d362d09f63a35'] = $utility_provider;//utility company
                                $Lead_data_array2['7d113de82a481399ff9ee847e5ded557572cc7be'] = "$street, $city, $state_code $Zipcode, US";//address
                                $Lead_data_array2['0a04a9c455bbfdeb6779d8dd6a890c9a31947889'] = $monthly_electric_bill;//Average Monthly Cost
                                $Lead_data_array2['5322713769c00dfbca7c5a532ffaf66a45755751'] = $property_type_data;//Homeowner
                                $Lead_data_array2['4d7f1ee1b2de6f36893ab9c90f98207da05b0b74'] = $roof_shade_data;//Roof Shaded
                                break;
                            case 800:
                                //PEP Solar	800
                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);

                                switch ($roof_shade){
                                    case "Mostly Shaded":
                                        $roof_shade_data = "Shady";
                                        break;
                                    case "Partial Sun":
                                        $roof_shade_data = "Some Shade";
                                        break;
                                    default:
                                        $roof_shade_data = "Full Sun";
                                }

                                $Lead_data_array2['Utility'] = $utility_provider;
                                $Lead_data_array2['Energy-Type'] = "All Electric";
                                $Lead_data_array2['Roof-Radiance'] = $roof_shade_data;
                                $Lead_data_array2['Monthly-Electric-Bill'] = $monthly_electric_bill;
                                //$Lead_data_array2['Address'] = "State: $state, City: $city, Street: $street";
                                break;
                        }

                        $url_api2 = 'https://' . $person_domain . '.pipedrive.com/api/v1/deals?api_token=' . $api_token;

                        $result2 = $crm_api_file->api_send_data($url_api2, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array2), "POST", 1, $crm_details['campaign_id']);
                        $result_data2 = json_decode($result2, true);
                        if (!empty($result_data2['success'])) {
                            if ($result_data2['success'] == true) {
                                return 1;
                            }
                        }
                    } else {
                        return 1;
                    }
                }
            }
        }
        return 0;
    }

    public function Jangle($data_msg, $crm_details){
        if(empty($crm_details['JangleDetails'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "JangleDetails"));
            return 0;
        }
        try {
            $crm_api_file = new CrmApi();

            $Lead_data_array = array(
                'Authorization' => $crm_details['JangleDetails']['Authorization'],
                'PostUrl' => $crm_details['JangleDetails']['PostUrl'],
                'title' => ucfirst($crm_details['service_campaign_name']),
                'first_name' => $data_msg['first_name'],
                'last_name' => $data_msg['last_name'],
                'email_address' => $data_msg['LeadEmail'],
                'phone_number' => $data_msg['LeadPhone'],
            );

            $Authorization = $Lead_data_array['Authorization'];




            switch ($crm_details['buyer_id']) {
                case 375:
                    //Blue ink digital	375
                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $url_api = "https://test-api.gateway.blueinkanalytics.com/v2/home_improvement/post";
                    } else {
                        $url_api = $Lead_data_array['PostUrl'];
                    }
                    break;
                default:
                    $url_api = $Lead_data_array['PostUrl'];
            }

            $first_name = trim($data_msg['first_name']);
            $last_name = trim($data_msg['last_name']);
            $number1 = trim($data_msg['LeadPhone']);
            $zip = trim($data_msg['Zipcode']);
            $street = trim($data_msg['street']);
            $city = trim($data_msg['City']);
            $email = trim($data_msg['LeadEmail']);
            $state = trim($data_msg['State']);
            $trusted_form = trim($data_msg['trusted_form']);
            $statename_code = trim($data_msg['state_code']);
            $request_date = trim(date('Y-m-d H:i:s'));
            //Lead Details Browser
            $UserAgent = $data_msg['UserAgent'];
            $OriginalURL = $data_msg['OriginalURL'];
            $OriginalURL2 = $data_msg['OriginalURL2'];
            $SessionLength = $data_msg['SessionLength'];
            $IPAddress = $data_msg['IPAddress'];
            $LeadId = $data_msg['LeadId'];
            $lead_browser_name = $data_msg['browser_name'];
            $TCPAText = $data_msg['TCPAText'];
            $lead_source_text = $data_msg['lead_source'];
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
            $tcpa_compliant = $data_msg['tcpa_compliant'];
            if( $tcpa_compliant == 1 ){
                $tcpa_compliant2 = "Yes";
                $tcpa_compliant3 = "yes";
                $tcpa_compliant4 = "true";
                $tcpa_compliant5 = 1;
            } else {
                $tcpa_compliant2 = "No";
                $tcpa_compliant3 = "no";
                $tcpa_compliant4 = "false";
                $tcpa_compliant5 = 2;
            }

            $httpheader = array(
                "Authorization: Token $Authorization",
                "content-type: application/json"
            );

            $subid = $lead_source_text;

            $Lead_data_array = array(
                "meta" => array(
                    "originally_created" => $request_date,
                    "source_id" => $subid,
                    "offer_id" => $leadsCustomerCampaign_id,
                    "lead_id_code" => $LeadId,
                    "trusted_form_cert_url" => $trusted_form,
                    "user_agent" => $UserAgent,
                    "landing_page_url" => $OriginalURL2,
                    "tcpa_compliant" => $tcpa_compliant4,
                    "tcpa_consent_text" => $TCPAText
                ),
                "contact" => array(
                    "first_name" => $first_name,
                    "last_name" => $last_name,
                    "email" => $email,
                    "phone" => $number1,
                    "address" => $street,
                    "city" => $city,
                    "state" => $statename_code,
                    "zip_code" => $zip,
                    "ip_address" => $IPAddress,
                    "phone_last_four" => "",
                )
            );

            if ($crm_details['is_ping_account'] == 1) {
                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                    $Lead_data_array['auth_code'] = $TransactionId;
                } else {
                    return 0;
                }
            }

            $best_call_time = "Any time";
            if ($crm_details['campaign_Type'] == 4 && $data_msg['appointment_date'] != "") {
                $best_call_time = date('m/d/Y h:i A', strtotime($data_msg['appointment_date'])) . " EST";
            }

            switch ($crm_details['service_id']){
                case 1:
                    //windows
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $number_of_windows = trim($crm_details['data']['number_of_window']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair" ? "Need repair services at this time" : "Interested in replacement windows");

                    switch ($number_of_windows){
                        case '1':
                            $number_windows = "1";
                            break;
                        case '2':
                            $number_windows = "2";
                            break;
                        case "3-5":
                            $number_windows = "5";
                            break;
                        case "6-9":
                            $number_windows = "7";
                            break;
                        default:
                            $number_windows = "10";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "windows" => array(
                            "project_type" => $project_nature_data,
                            "num_windows" => $number_windows
                        ),
                    );
                    break;
                case 2:
                    //solar
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $SecurityUsage = ($property_type == "Owned" ? "true" : "false");

                    switch ($monthly_electric_bill){
                        case '$0 - $50':
                            $monthly_bill = 50;
                            break;
                        case "$51 - $100":
                            $monthly_bill = 100;
                            break;
                        case "$101 - $150":
                            $monthly_bill = 150;
                            break;
                        case "$151 - $200":
                            $monthly_bill = 200;
                            break;
                        case "$201 - $300":
                            $monthly_bill = 300;
                            break;
                        case "$301 - $400":
                            $monthly_bill = 400;
                            break;
                        case "$401 - $500":
                            $monthly_bill = 500;
                            break;
                        default:
                            $monthly_bill = 600;
                    }

                    switch ($roof_shade){
                        case "Full Sun":
                            $roof_shade_data = "No Shade";
                            break;
                        case "Mostly Shaded":
                            $roof_shade_data = "Full Shade";
                            break;
                        case "Partial Sun":
                            $roof_shade_data = "Some Shade";
                            break;
                        default:
                            $roof_shade_data = "Not Sure";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => "1-3 months",
                        "monthly_electric_bill" => $monthly_bill,
                        "utility_provider" => $utility_provider,
                        "roof_shade" => $roof_shade_data,
                        "property_type" => "Single Family",
                        "credit_rating" => "Excellent"
                    );
                    break;
                case 3:
                    //Home Security
                    $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                    $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    switch ($property_type){
                        case "Business":
                            $Usage = "Commercial";
                            $SecurityUsage = "false";
                            break;
                        case "Rented":
                            $Usage = "residential";
                            $SecurityUsage = "false";
                            break;
                        default:
                            $Usage = "residential";
                            $SecurityUsage = "true";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "home_security" => array(
                            "building_type" => "Other",
                            "usage" => $Usage
                        )
                    );
                    break;
                case 4:
                    //Flooring
                    $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair Existing Flooring" ? "Repair" : "Installation");

                    switch ($Type_OfFlooring){
                        case "Vinyl Linoleum Flooring":
                            $Type_OfFlooring_data = "Vinyl";
                            break;
                        case "Tile Flooring":
                            $Type_OfFlooring_data = "Tile";
                            break;
                        case "Hardwood Flooring":
                            $Type_OfFlooring_data = "Hardwood";
                            break;
                        case "Laminate Flooring":
                            $Type_OfFlooring_data = "Laminate";
                            break;
                        default:
                            $Type_OfFlooring_data = "Carpet";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "flooring" => array(
                            "flooring_type" => $Type_OfFlooring_data,
                            "inquiry_type" => $project_nature_data
                        )
                    );
                    break;
                case 6:
                    //roofing
                    $roof_type = trim($crm_details['data']['roof_type']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    switch ($roof_type){
                        case "Asphalt Roofing":
                            $roof_type_data = "Asphalt shingle";
                            break;
                        case "Wood Shake/Composite Roofing":
                            $roof_type_data = "Cedar shake";
                            break;
                        case "Metal Roofing":
                            $roof_type_data = "Metal";
                            break;
                        case "Natural Slate Roofing":
                            $roof_type_data = "Natural state";
                            break;
                        default:
                            $roof_type_data = "Tile";
                    }

                    switch ($project_nature){
                        case "Install roof on new construction":
                            $project_nature_data = "New roof for new home";
                            break;
                        case "Completely replace roof":
                            $project_nature_data = "New roof for an existing home";
                            break;
                        default:
                            $project_nature_data = "Repair";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => "true",
                        "purchase_time_frame" => $start_time_data,
                        "roof" => array(
                            "project_type" => $project_nature_data,
                            "roofing_type" => $roof_type_data
                        )
                    );
                    break;
                case 7:
                    //Home Siding
                    $type_of_siding = trim($crm_details['data']['type_of_siding']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair section(s) of siding" ? "Siding repair" : "Replace siding");

                    switch($type_of_siding){
                        case "Vinyl Siding":
                            $type_of_siding_data = "Vinyl";
                            break;
                        case "Brickface Siding" || "Stoneface Siding":
                            $type_of_siding_data = "Brick or stone";
                            break;
                        case "Composite wood Siding":
                            $type_of_siding_data = "Wood";
                            break;
                        default:
                            $type_of_siding_data = "Other";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "siding" => array(
                            "siding_type" => $type_of_siding_data,
                            "project_type" => $project_nature_data
                        )
                    );
                    break;
                case 8:
                    //Kitchen
                    $service_kitchen = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $service_kitchen_data = ($service_kitchen == "Full Kitchen Remodeling" ? "Floor plan" : "Cabinets");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "kitchen" => array(
                            "project_type" => $service_kitchen_data
                        )
                    );
                    break;
                case 9:
                    //Bathroom
                    $bathroom_type_name = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    switch ($bathroom_type_name){
                        case "Shower / Bath" || "Sinks" || "Toilet":
                            $bathroom_type_name_data = "Bath, sinks";
                            break;
                        default:
                            $bathroom_type_name_data = "Full bathroom";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "bathroom" => array(
                            "project_type" => $bathroom_type_name_data
                        )
                    );
                    break;
                case 10:
                    //Stairs
                    $stairs_type = trim($crm_details['data']['stairs_type']);
                    $reason = trim($crm_details['data']['reason']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $stairs_type_data = ($stairs_type == "Straight" ? "Straight staircase" : "Curved staircase");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "stair_lift" => array(
                            "stair_type" => $stairs_type_data,
                            "project_type" => "Private",
                            "carry_weight" => 200,
                            "num_stairs" => 25,
                            "num_floors" => 2,
                            "outdoor_stairs" => false,
                            "stair_material" => "Concrete"
                        )
                    );
                    break;
                case 11:
                    //Furnace
                    $type_of_heating = trim($crm_details['data']['type_of_heating']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair" ? "Repair" : "New unit installed");

                    switch($type_of_heating){
                        case "Natural Gas":
                            $type_of_heating_data = "Gas furnace";
                            break;
                        case "Oil":
                            $type_of_heating_data = "Oil furnace";
                            break;
                        case "Propane Gas":
                            $type_of_heating_data = "Propane furnace";
                            break;
                        default:
                            $type_of_heating_data = "Electric furnace";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "hvac" => array(
                            "project_type" => $project_nature_data,
                            "air_type" => "Heating and cooling",
                            "system_type" => $type_of_heating_data
                        )
                    );
                    break;
                case 12:
                    //Boiler
                    $type_of_heating = trim($crm_details['data']['type_of_heating']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair" ? "Repair" : "New unit installed");

                    switch($type_of_heating){
                        case "Natural Gas":
                            $type_of_heating_data = "Gas boiler";
                            break;
                        case "Oil":
                            $type_of_heating_data = "Oil boiler";
                            break;
                        case "Propane Gas":
                            $type_of_heating_data = "Propane boiler";
                            break;
                        default:
                            $type_of_heating_data = "Electric boiler";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "hvac" => array(
                            "project_type" => $project_nature_data,
                            "air_type" => "Heating and cooling",
                            "system_type" => $type_of_heating_data
                        )
                    );
                    break;
                case 13:
                    //Central A/C
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair" ? "Repair" : "New unit installed");
                    $type_of_heating_data = "Central AC";

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "hvac" => array(
                            "project_type" => $project_nature_data,
                            "air_type" => "Heating and cooling",
                            "system_type" => $type_of_heating_data
                        )
                    );
                    break;
                case 14:
                    //Cabinet
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Cabinet Refacing" ? "Reface existing cabinets" : "Install new custom cabinets");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "cabinets" => array(
                            "project_type" => $project_nature_data,
                            "location_in_house" => "Other",
                            "current_materials" => "Wood",
                            "reface" => "Veneer"
                        )
                    );
                    break;
                case 15:
                    //Plumbing
                    $services = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    switch ($services){
                        case "Storm Drain Cleaning";
                            $services_data = "Drain cleaning";
                            break;
                        case "Water Heater Services":
                            $services_data = "Install or repair water heater";
                            break;
                        case "Septic Systems":
                            $services_data = "Septic install or replace";
                            break;
                        case "Drain/ Sewer Services":
                            $services_data = "Sewer main";
                            break;
                        case "Well Pump Services":
                            $services_data = "Well pumps";
                            break;
                        default:
                            $services_data = "Water main";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "plumbing" => array(
                            "project_type" => "Install",
                            "service_type" =>  $services_data
                        )
                    );
                    break;
                case 17:
                    //sunrooms
                    $services = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $SecurityUsage = "true";
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "sunrooms" => array(
                            "num_rooms" => 3,
                            "length" => 10,
                            "width" => 13
                        )
                    );
                    break;
                case 18:
                    //Handyman
                    $handyman_ammount_name = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "handy_man" => array(
                            "service_type" => $handyman_ammount_name
                        )
                    );
                    break;
                case 20:
                    //Doors
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $door_type = trim($crm_details['data']['door_type']);
                    $number_of_door = trim($crm_details['data']['number_of_door']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                    $project_nature_data = ($project_nature == "Repair" ? "Repair" : "New installation");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "doors" => array(
                            "project_type" => $project_nature_data,
                            "material" => "Other",
                            "pre_hung" => true
                        )
                    );
                    break;
                case 21:
                    //Gutter
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $service = trim($crm_details['data']['service']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "gutters" => array(
                            "protection" => false
                        )
                    );
                    break;
                case 23:
                    //Painting
                    $service_type = trim($crm_details['data']['service']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $SecurityUsage = ($ownership == "Yes" ? "true" : "false");
                    $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");

                    switch ($service_type){
                        case "Exterior Home or Structure - Paint or Stain":
                            $service_type_data = "Exterior Painting";
                            break;
                        case "Interior Home or Surfaces - Paint or Stain":
                            $service_type_data = "Interior Painting";
                            break;
                        case "Specialty Painting - Textures":
                            $service_type_data = "Specialty Painting - Textures";
                            break;
                        default:
                            $service_type_data = "Other";
                    }

                    $Lead_data_array['data'] = array(
                        "best_call_time" => $best_call_time,
                        "own_property" => $SecurityUsage,
                        "purchase_time_frame" => $start_time_data,
                        "painting" => array(
                            "project_type" => $service_type_data
                        )
                    );
                    break;
            }

            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);

            $result2 = json_decode($result, true);

            if (!empty($result2)) {
                if (!empty($result2['status'])) {
                    if ($result2['status'] == "success") {
                        return 1;
                    }
                }
            }

        } catch (Exception $e) {

        }
    }

    public function leadPerfectionCrm($data_msg, $crm_details){
        //leadperfection
        if(empty($crm_details['leadPerfectionCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "leadPerfectionCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $statename_code = trim($data_msg['state_code']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];

        $phone1type = 1;
        $phone2type = 0;
        $phone3type = 0;
        $LogNumber = 1;
        $sentto = "Leadperfection";
        $srs_id = $crm_details['leadPerfectionCrm']['lead_perfection_srs_id'];
        $pro_id = $crm_details['leadPerfectionCrm']['lead_perfection_pro_id'];
        $pro_desc = $crm_details['leadPerfectionCrm']['lead_perfection_pro_desc'];
        $sender_data = $crm_details['leadPerfectionCrm']['lead_perfection_sender'];
        $url_link = $crm_details['leadPerfectionCrm']['lead_perfection_url'];

        $sender = config('app.name', '');
        if( !empty($sender_data) ){
            $sender = $sender_data;
        }

        $url_api = "$url_link?firstname=$first_name&lastname=$last_name&address1=$street&city=$city&state=$statename_code&zip=$zip&phone1type=$phone1type&phone1=$number1&phone2type=$phone2type&phone3type=$phone3type&email=$email&LogNumber=$LogNumber&sender=$sender&sentto=$sentto&srs_id=$srs_id";
        if( !empty($pro_id) ){
            $url_api .= "&pro_id=$pro_id&productid=$pro_id";
        }
        if( !empty($pro_desc) ){
            $url_api .= "&proddescr=$pro_desc";
        }

        $httpheader = array(
            "content-type: application/json"
        );
        $url_api = str_replace(" ","%20",$url_api);
        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
        if (strpos("-" . strtolower($result), 'ok') == true) {
            return 1;
        }
        return 0;
    }

    public function Improveit360Crm($data_msg, $crm_details){
        //Improveit360Crm
        if(empty($crm_details['Improveit360Crm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "Improveit360Crm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $statename_code = trim($data_msg['state_code']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $phone1type = "Home";
        $date = date('Y-m-d');
        $trusted_form = $data_msg['trusted_form'];
        $campaignID = $crm_details['campaign_id'];

        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        if ($listOFCampainDB_type == "Exclusive") {
            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Exclusive";
        } else {
            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Shared";
        }

        $source = $crm_details['Improveit360Crm']['improveit360_source'];
        $url_link = $crm_details['Improveit360Crm']['improveit360_url'];
        $market_segment = $crm_details['Improveit360Crm']['market_segment'];
        $source_type_imp = $crm_details['Improveit360Crm']['source_type'];
        $project_imp = $crm_details['Improveit360Crm']['project'];

        $source_type = "Websites";
        if( !empty($source_type_imp) ){
            $source_type = $source_type_imp;
        }

        $project = $crm_details['service_campaign_name'];
        if( !empty($project_imp) ){
            $project = $project_imp;
        }

        $url_api = "$url_link?FirstName=$first_name&LastName=$last_name&StreetAddress=$street&City=$city&State=$statename_code&Zip=$zip&Email=$email&Phone1=$number1&Phone1Type=$phone1type&Product=$project&Date=$date&Source=$source&SourceType=$source_type";

        if( !empty($market_segment) ){
            $url_api .= "&i360__Market_Segment_Editable__c=$market_segment&MarketSegment=$market_segment";
        }

        switch ($crm_details['buyer_id']) {
            case 918:
            case 919:
            case 920:
            case 926:
                // LEI Home Enhancements – Columbus 918
                // LEI Home Enhancements – Fort Worth 919
                // LEI Home Enhancements – Chicago, Indianapolis, Cincinnati 920
                // LEI Home Enhancements – Richmond, Raleigh, Virginia Beach, Washington DC, Philadelphia 926

                $appointment_date = "";
                $appointment_time = "";
                if ($crm_details['campaign_Type'] == 4 && $data_msg['appointment_date'] != "") {
                    $appointment_date = date('m/d/Y', strtotime($data_msg['appointment_date']));
                    $appointment_time = date('h:i A', strtotime($data_msg['appointment_date']));
                }
                $url_api .= "&RequestAppontmentTime=$appointment_time&RequestAppontmentDate=$appointment_date";
                break;
            case 667:
                // 667 Wintek USA
                $Lead_Cost = '$'.$Lead_Cost;
                $createdDate = date('m/d/Y');

                $url_api.="&i360__Vendor__c=0018Z00002XgWLhQAN&Provider__c=Allied Digital Media&Provider_Database__c=Allied Digital Media - New Internet Leads - Exclusive&Order_ID__c=112135&Order_Cost__c=$Lead_Cost&Order_Purchase_Date__c=$createdDate&Lead_Manager__c=a0j1U000000AlRN&i360__External_Campaign_ID__c=$campaignID&Provider_UID__c=$trusted_form";

                switch ($crm_details['service_id']){
                    case 1:
                        // Windows
                        $number_of_windows = trim($crm_details['data']['number_of_window']);
                        $start_time = trim($crm_details['data']['start_time']);
                        $project_nature = trim($crm_details['data']['project_nature']);

                        $serviceDescription = ($project_nature == 'Install' ? 'Install' : 'Replacement');

                        switch ($number_of_windows) {
                            case '3-5':
                                $number_windows = "3_5";
                                break;
                            case '6-9':
                                $number_windows = "6_9";
                                break;
                            default:
                                $number_windows = "10_and_more";
                        }

                        switch ($start_time){
                            case 'Immediately':
                                $start_time_data = "Immediately";
                                break;
                            case "Within 6 months":
                                $start_time_data = "Within 6 months";
                                break;
                            default:
                                $start_time_data = "Not sure";
                        }

                        $url_api.="&Quantity__c=$number_windows&Project_Time_Frame__c=$start_time_data&Service_Requested__c=$serviceDescription";

                        break;
                }
                break;
            case 1067:
                //Clear Choice Home Improvements 1067
                $url_api .= "&i360__External_Campaign_ID__c=$leadsCustomerCampaign_id";
                switch ($crm_details['service_id']) {
                    case 6:
                        //Roofing
                        $roof_type = trim($crm_details['data']['roof_type']);
                        $url_api .= "&Product=$roof_type";
                        break;
                }
                break;
        }

        $httpheader = array(
            "content-type: application/json"
        );

        $url_api = str_replace(" ","%20",$url_api);
        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
        if (strpos("-" . strtolower($result), 'success') == true) {
            return 1;
        }
        return 0;
    }

    public function LeadConduitCrm($data_msg, $crm_details){
        //LeadConduitCrm
        if(empty($crm_details['LeadConduitCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "LeadConduitCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $trusted_form = $data_msg['trusted_form'];
        $statename_code = trim($data_msg['state_code']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $UserAgent = $data_msg['UserAgent'];
        $OriginalURL = $data_msg['OriginalURL'];
        $OriginalURL2 = $data_msg['OriginalURL2'];
        $SessionLength = $data_msg['SessionLength'];
        $IPAddress = $data_msg['IPAddress'];
        $LeadId = $data_msg['LeadId'];
        $lead_browser_name = $data_msg['browser_name'];
        $tcpa_compliant = $data_msg['tcpa_compliant'];
        $TCPAText = $data_msg['TCPAText'];
        $lead_source_text = $data_msg['lead_source'];
        $google_ts = $data_msg['google_ts'];
        $lead_source_name = $data_msg['lead_source_name'];
        $campaign_name = $crm_details['campaign_name'];

        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        if ($listOFCampainDB_type == "Exclusive") {
            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Exclusive";
        } else {
            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Shared";
        }

        $url_api = $crm_details['LeadConduitCrm']['post_url'];

        switch ($crm_details['service_campaign_name']){
            case "Window":
                $service_name = "windows";
                break;
            case "Home Siding":
                $service_name = "siding";
                break;
            case "Bathroom":
                $service_name = "bath";
                break;
            default:
                $service_name = strtolower($crm_details['service_campaign_name']);
        }

        $Lead_data_array = array(
            "first_name" => $first_name,
            "last_name" => $last_name,
            "email" => $email,
            "address_1" => $street,
            "city" => $city,
            "state" => $statename_code,
            "postal_code"=> $zip,
            "trustedform_cert_url" => $trusted_form,
            "phone_1" => $number1,
            "universal_leadid" => $LeadId,
            "product_id_dabel" => $service_name,
            "log_number_dabel" => $service_name,
            "ip_address" => $IPAddress,
            "user_agent" => $UserAgent,
        );

        $httpheader = array(
            "content-type: application/json"
        );

        switch ($crm_details['buyer_id']){
            case 444:
                //SUNPOWER 444
                //To check if the leads from lead review.
                if( $crm_details['is_lead_review'] == 1 ){
                    return 0;
                }

                //To check if valid IP Address.
                $url_check_ip = "https://api11.scamalytics.com/allieddigitalmedia/?key=3b3177e70a54adf5ae85248a72b53997&ip=$IPAddress";
                $result_check_ip = $crm_api_file->api_send_data($url_check_ip, $httpheader, $leadsCustomerCampaign_id, "", "GET", 1, $crm_details['campaign_id']);
                $result2_check_ip = json_decode($result_check_ip, true);
                if (!empty($result2_check_ip)) {
                    if ($result2_check_ip['score'] > 20 || $result2_check_ip['status'] != "ok") {
                        return 0;
                    }
                } else {
                    return 0;
                }

                $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                $property_type = $crm_details['data']['property_type'];
                $utility_provider = $crm_details['data']['utility_provider'];

                switch ($monthly_electric_bill){
                    case '$0 - $50':
                        $average_bill = '$50';
                        break;
                    case '$51 - $100':
                        $average_bill = '$100';
                        break;
                    case '$101 - $150':
                        $average_bill = '$150';
                        break;
                    case '$151 - $200':
                        $average_bill = '$200';
                        break;
                    case '$201 - $300':
                        $average_bill = '$300';
                        break;
                    case '$301 - $400':
                        $average_bill = '$400';
                        break;
                    case '$401 - $500':
                        $average_bill = '$500';
                        break;
                    default:
                        $average_bill = '$600';
                }

                $homeowner = ($property_type == 'Rented' ? "rent" : 'own');
                $campaignTypeName = ($crm_details['campaign_Type'] == '6' ? "Live Transfer" : 'Verified Lead');

                $Lead_data_array['currently_rent_or_own'] = $homeowner;
                $Lead_data_array['elq_monthlybill_spwr'] = $average_bill;
                $Lead_data_array['utility.electric.company.name'] = $utility_provider;
                $Lead_data_array['comments'] = $leadsCustomerCampaign_id;
                $Lead_data_array['lead_web_form_details_spwr'] = $campaignTypeName;
                break;
            case 145:
                //Long Roofing 145
                $Lead_data_array['comments'] = $leadsCustomerCampaign_id;
                $Lead_data_array['referrer_id_prod'] = $leadsCustomerCampaign_id;
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['product'] = $service_name;
                break;
            case 529:
                //PowerHome Solar LLC 529
                $Lead_data_array['lead_vendor_phs'] = "AlliedDigitalMedia";
                $Lead_data_array['lead_source'] = $lead_source_text;
                break;
            case 549:
                //Paradise Home Improvement	 549
                $Lead_data_array['lead_cost_type_para'] = "CPL";
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['115'] = "SubSource";
                $Lead_data_array['SubSource'] = "155";
                $Lead_data_array['srs_id'] = "155";
                break;
            case 383:
                //Statewide Remodeling 383
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['original_source'] = $lead_source_text;
                $Lead_data_array['2727'] = "SubSource";
                $Lead_data_array['SubSource'] = "2727";
                $Lead_data_array['srs_id'] = "2727";
                break;
            case 550:
                // Empire Today 550
                $Lead_Cost_float = number_format($Lead_Cost, 1);
                $owns_home_emp = "yes";
                if(!empty($crm_details['data']['homeOwn'])){
                    $owns_home_emp = ($crm_details['data']['homeOwn'] == "Yes" ? "yes" : "no");
                }

                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['comments'] = "AlliedDigitalMedia";
                $Lead_data_array['price'] = "$$Lead_Cost_float";
                $Lead_data_array['exclusivity_emp'] = $Lead_Cost_type;
                $Lead_data_array['country'] = 'US';
                $Lead_data_array['owns_home_emp'] = $owns_home_emp;
                $Lead_data_array['original_source'] = $google_ts;
                break;
            case 128:
                //Harley Exteriors 128
                switch ($crm_details['service_campaign_name']){
                    case "Window":
                        $service_name = "window";
                        break;
                    case "Roofing":
                        $service_name = "Roof";
                        break;
                    default:
                        $service_name = strtolower($crm_details['service_campaign_name']);
                }
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['producttype_harly'] = $service_name;
                break;
            case 347:
                //C Michael Exteriors 347
                switch ($crm_details['service_id']){
                    case 1:
                        $srs_id = "614";
                        $product = "Win";
                        break;
                    case 7:
                        $srs_id = "614";
                        $product = "Sid";
                        break;
                    case 9:
                        $srs_id = "646";
                        $product = "Bath";
                        break;
                    default:
                        $srs_id = "";
                        $product = "";
                }

                $Lead_data_array['product'] = $product;
                $Lead_data_array['srs_id'] = $srs_id;
                $Lead_data_array['notes'] = $leadsCustomerCampaign_id;
                $Lead_data_array['comments'] = $leadsCustomerCampaign_id;
                break;
            case 111:
                //Florida Window and Door 111
                switch ($crm_details['campaign_id']){
                    case 1186:
                        $marketSegm = "Florida Window and Door - Tampa";
                        break;
                    case 684:
                        $marketSegm = "Florida Window and Door - Daytona-NewSmyrna";
                        break;
                    case 683:
                        $marketSegm = "Florida Window and Door - PalmBeach-Melbourne";
                        break;
                    case 682:
                        $marketSegm = "Florida Window and Door - Miami-FtLauderdale";
                        break;
                    case 681:
                        $marketSegm = "Florida Window and Door - FM";
                        break;
                }

                $Lead_data_array['marketsegment_flwd'] = $marketSegm;
                $Lead_data_array['sourcetype_flwd'] = "Internet";
                //$Lead_data_array['trustedform_cert_url'] = "www.google.com";
                break;
            case 758:
                //Zintex Remodeling 758
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = "RLCC-BS-D";
                $Lead_data_array['reference'] = $leadsCustomerCampaign_id;
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 756:
                //Yankee Home Improvements 756
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['original_source'] = $lead_source_text;
                break;
            case 796:
            case 795:
            case 794:
            case 835:
                // Joyce Factory Direct - AVL 796
                // Joyce Factory Direct - CLE 795
                // Joyce Factory Direct - PIT 794
                // Joyce Factory Direct - CHAR 835
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['original_source'] = $google_ts;
                break;
            case 823:
                //Vision Solar LLC 823
                $Lead_data_array['lead_cost_vis'] = $Lead_Cost;
                $Lead_data_array['website'] = $OriginalURL2;
                $Lead_data_array['company.name'] = "Allied Digital Media";
                break;
            case 949:
                //Five Strata 949
                $owns_home_fstrata = "Yes";
                if(!empty($crm_details['data']['homeOwn'])){
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $owns_home_fstrata = ($ownership == "Yes" ? "Yes" : "No");
                }

                switch ($crm_details['service_campaign_name']){
                    case "Window":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:WIAD|";
                        break;
                    case "Solar":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:SLAD|";
                        break;
                    case "Bathroom":
                    case "WALK-IN TUBS":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:BRAD|";
                        break;
                    case "Flooring":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:FLAD|";
                        break;
                    case "Home Siding":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:SDAD|";
                        break;
                    case "Roofing":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:RFAD|";
                        break;
                    case "Home Security":
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:HSAD|";
                        break;
                    default:
                        $FSCode1 = "|VT:SL|PD:1|CH:HS|SC:ALI|CP:OTRAD|";
                }

                $Lead_data_array['leadid_token_fives'] = $LeadId;
                $Lead_data_array['homeowner_fives'] = $owns_home_fstrata;
                $Lead_data_array['timestamp_affiliate'] = date('Y-m-d H:i:s');
                $Lead_data_array['sourcepage'] = $OriginalURL2;
                $Lead_data_array['fscode1'] = $FSCode1;
                $Lead_data_array['fscode2'] = "|SS:$google_ts|SA:|";
                break;
            case 979:
                //American Standard Home Services 979
                $seo_source = array("Search", "Verified", "SEO", "SEM", "SEM-A", "Youtube");
                $social_source = array("Social Media", "SMS Marketing", "Email Marketing");
                $aff_source = array("Affiliate", "HQA", "RBAF");

                switch ($crm_details['service_id']){
                    case 5:
                        if(in_array($lead_source_name, $seo_source)){
                            $subId_stc = "7842";
                            $pubid_stc = "Hosted-AlliedDigital";
                        } else if(in_array($lead_source_name, $social_source)){
                            $subId_stc = "7843";
                            $pubid_stc = "Hosted-AlliedDigital-Tier1";
                        } else if(in_array($lead_source_name, $aff_source)){
                            $subId_stc = "7845";
                            $pubid_stc = "Hosted-AlliedDigital-Tier3";
                        } else {
                            $subId_stc = "7844";
                            $pubid_stc = "Hosted-AlliedDigital-Tier2";
                        }
                        break;
                    case 9:
                        if(in_array($lead_source_name, $seo_source)){
                            $subId_stc = "7846";
                            $pubid_stc = "BR-Host-AlliedDigital";
                        } else if(in_array($lead_source_name, $social_source)){
                            $subId_stc = "7847";
                            $pubid_stc = "BR-Host-AlliedDigital-Tier1";
                        } else if(in_array($lead_source_name, $aff_source)){
                            $subId_stc = "7849";
                            $pubid_stc = "BR-Host-AlliedDigital-Tier3";
                        } else {
                            $subId_stc = "7848";
                            $pubid_stc = "BR-Host-AlliedDigital-Tier2";
                        }
                        break;
                    default:
                        $subId_stc = "";
                        $pubid_stc = "";
                }

                $Lead_data_array['subid_stc'] = $subId_stc;
                $Lead_data_array['pubid_stc'] = $pubid_stc;
                $Lead_data_array['leadid_stc'] = $LeadId;
                $Lead_data_array['program_type_stc'] = "CPL";
                $Lead_data_array['cpl_stc'] = $Lead_Cost;
                $Lead_data_array['terms_stc'] = $TCPAText;
                break;
            case 977:
                //977 Homefix Custom Remodeling
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['generated_date_hfix'] = date('Y-d-m H:i:s');
                $Lead_data_array['lead_source_hfix'] = $lead_source_text;
                $Lead_data_array['campaign_name'] = $crm_details['campaign_name'];
                $Lead_data_array['company.name'] = "Allied Digital Media";
                $Lead_data_array['country'] = "United States";

                if ($crm_details['campaign_Type'] == 4){
                    if(!empty($data_msg['appointment_date'])){
                        $appointment_date = date('Y-m-d', strtotime($data_msg['appointment_date']));
                        $appointment_time = date('h:i A', strtotime($data_msg['appointment_date']));
                        $appointment_datetime = date('m/d/Y h:i:s A', strtotime($data_msg['appointment_date']));

                        $Lead_data_array['appointment_time_hfix'] = $appointment_time;
                        $Lead_data_array['appointment_date_hfix'] = $appointment_date;
                        $Lead_data_array['appointment'] = $appointment_datetime;
                    }
                }
                break;
            case 1020:
                //Freedom Solar 1020
                $Lead_data_array['product'] = "RLCC-BS-D";
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['website'] = $OriginalURL2;

                switch ($crm_details['service_id']){
                    case 2:
                        //Solar
                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        $property_type = $crm_details['data']['property_type'];
                        $utility_provider = $crm_details['data']['utility_provider'];
                        $roof_shade = trim($crm_details['data']['roof_shade']);

                        $Lead_data_array['utility.electric.company.name'] = $utility_provider;
                        $Lead_data_array['roof_shade'] = $roof_shade;
                        $Lead_data_array['average_monthly_utility_bill_free'] = $monthly_electric_bill;
                        break;
                }
                break;
            case 1029:
                //PosiGen Inc 1029
                $Lead_data_array['country'] = "US";
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['price'] = $Lead_Cost;
                switch ($crm_details['service_id']){
                    case 2:
                        //Solar
                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        $property_type = $crm_details['data']['property_type'];
                        $utility_provider = $crm_details['data']['utility_provider'];
                        $roof_shade = trim($crm_details['data']['roof_shade']);

                        $Lead_data_array['utility.electric.company.name'] = $utility_provider;
                        $Lead_data_array['utility.electric.monthly_amount'] = $monthly_electric_bill;
                        $Lead_data_array['property.sun_exposure'] = $roof_shade;
                        break;
                }
                break;
            case 1072:
                //Superior Bath System 1072
                $Lead_data_array['product'] = "Bath";
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 183:
                //Improveit USA	183
                switch ($crm_details['service_campaign_name']){
                    case "Window":
                        $service_name = "windows";
                        break;
                    case "Bathroom":
                        $service_name = "baths";
                        break;
                    default:
                        $service_name = strtolower($crm_details['service_campaign_name']);
                }

                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['phone1type_impro'] = "Home";
                $Lead_data_array['publisher_id_impro'] = $leadsCustomerCampaign_id;
                $Lead_data_array['channel_impro'] = $lead_source_text;
                $Lead_data_array['best_time_to_call_impro'] = "Anytime";
                $Lead_data_array['product_impro'] = $service_name;
                $Lead_data_array['vendor_lead_id_impro'] = $leadsCustomerCampaign_id;
                $Lead_data_array['interest_impro'] = $service_name;
                $Lead_data_array['country'] = "United States";
                $Lead_data_array['campaign_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;

                if ($crm_details['campaign_Type'] == 4){
                    if(!empty($data_msg['appointment_date'])){
                        $appointment_datetime = date('m/d/Y h:i:s A', strtotime($data_msg['appointment_date']));

                        $Lead_data_array['appointment'] = $appointment_datetime;
                    }
                }
                break;
            case 1095:
                //Expo Home Improvement 1095
                $serviceName = "";
                $serviceDescription = "";
                switch ($crm_details['service_id']){
                    case 1:
                        $serviceName = "Windows";
                        $project_nature = trim($crm_details['data']['project_nature']);
                        $serviceDescription = ($project_nature == 'Install' ? 'Install' : 'Replace');
                        break;
                    case 5:
                        $serviceName = "Walk-In Tubs";
                        break;
                    case 9:
                        $serviceName = "Bathroom - Remodel";
                        $bathroom_type_name = trim($crm_details['data']['services']);
                        switch ($bathroom_type_name){
                            case "Cabinets / Vanity":
                                $serviceDescription = "cabinets_vanity";
                                break;
                            case "Countertops":
                                $serviceDescription = "countertops";
                                break;
                            case "Flooring":
                                $serviceDescription = "flooring";
                                break;
                            case "Shower / Bath":
                                $serviceDescription = "shower_bath";
                                break;
                            case "Full Remodel":
                            default:
                                $serviceDescription = "full_remodel";
                        }
                        break;
                }

                $Lead_data_array['product_name_dve'] = $serviceName;
                $Lead_data_array['url_dve'] = $OriginalURL2;
                $Lead_data_array['ext_campaign_id_dve'] = $leadsCustomerCampaign_id;
                $Lead_data_array['vendor_lead_campaign_dve'] = $campaign_name;
                $Lead_data_array['cost_dve'] = $Lead_Cost;
                $Lead_data_array['taskname_dve'] = $serviceName;
                $Lead_data_array['leaddescription_dve'] = $serviceDescription;
                $Lead_data_array['spcompanyname_dve'] = "Allied Digital Media";
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 1108:
                //Powered by Elevation 1108
                $Lead_data_array['country'] = "United States";
                $Lead_data_array['price'] = $Lead_Cost;
                switch ($crm_details['service_id']){
                    case 2:
                        //Solar
                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        $property_type = $crm_details['data']['property_type'];
                        $utility_provider = $crm_details['data']['utility_provider'];
                        $roof_shade = trim($crm_details['data']['roof_shade']);

                        switch ($monthly_electric_bill){
                            case '$0 - $50':
                            case "$51 - $100":
                            case "$101 - $150":
                                $monthly_bill = "$150";
                                break;
                            case "$151 - $200":
                                $monthly_bill = "150-200";
                                break;
                            default:
                                $monthly_bill = "$200+";
                        }

                        $Lead_data_array['utility.electric.company.name'] = $utility_provider;
                        $Lead_data_array['utility.electric.monthly_amount'] = $monthly_bill;
                        break;
                }
                break;
            case 431:
                //Dabella 431
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 807:
                // 807 East Coast Roofing, Siding & Windows
                switch ($crm_details['service_id']){
                    case 1:
                        // Windows
                        $service_name = "Windows";
                        break;
                    case 6:
                        // Roofing
                        $service_name = "Roofing";
                        break;
                    case 7:
                        // Siding
                        $service_name = "Siding";
                        break;
                }

                $Lead_data_array['service_type_ecrsw'] = $service_name;
                $Lead_data_array['cost_ecrsw'] = $Lead_Cost;
                $Lead_data_array['reference'] = $google_ts;
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['price_ecrsw'] = $Lead_Cost;
                break;
            case 1153:
                //Bath Planet of Chicago 1153
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['srs_id'] = "5212";
                break;
            case 1154:
                //Bath Planet of Springfield 1154
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['srs_id'] = "5216";
                break;
            case 1155:
                //Bath Planet of Quad Cities 1155
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['srs_id'] = "5215";
                break;
            case 1156:
                //Bath Planet of Peoria 1156
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['srs_id'] = "5214";
                break;
            case 1157:
                //Bath Planet of Cedar Rapids 1157
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['srs_id'] = "5213";
                break;
            case 1168:
            case 1329:
                //Coastal Windows & Exteriors 1168
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 1207:
                //Luxury Bath Tampa Bay 1207
                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = "RLCC-BS-D";
                $Lead_data_array['reference'] = $leadsCustomerCampaign_id;
                break;
            case 1165:
                //Tailored Roofing and Remodeling Inc	1165

                if (str_contains(strtolower($campaign_name), "okc")){
                    $Lead_data_array['srs_id'] = "975";
                }
                if (str_contains(strtolower($campaign_name), "missouri")){
                    $Lead_data_array['srs_id'] = "973";
                }
                if (str_contains(strtolower($campaign_name), "arkansas")){
                    $Lead_data_array['srs_id'] = "976";
                }
                if (str_contains(strtolower($campaign_name), "kansas")){
                    $Lead_data_array['srs_id'] = "974";
                }

                $Lead_data_array['original_source'] = $google_ts;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['reference'] = $leadsCustomerCampaign_id;
                break;
            case 1307:
                // 1307	Windows Plus of KY
                $Lead_data_array['Product'] = $service_name;
                $Lead_data_array['reference'] = $leadsCustomerCampaign_id;
                $Lead_data_array['original_source'] = $lead_source_text;
                $Lead_data_array['price'] = $Lead_Cost;
                break;
            case 1310:
                // Next Home Improvement
                $Lead_data_array['reference'] = $leadsCustomerCampaign_id;
                $Lead_data_array['comments'] = $leadsCustomerCampaign_id;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['original_source'] = $lead_source_text;
                break;
            case 1317:
               // Homefix Custom Remodeling 1317
                $Lead_data_array['country'] = "US";
                $Lead_data_array['leadid_id'] = $LeadId;
                $Lead_data_array['price'] = $Lead_Cost;
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['landing_page'] = $OriginalURL2;
                $Lead_data_array['company.name'] = "Allied Digital Media";
                break;
            case 1319:
                $srs_id = "146";
                switch ($crm_details['service_id']){
                    case 1:
                        //Windows
                        $product = "Win";
                        $product_id = "Win";
                        break;
                    case 20:
                        //Doors
                        $product = "Doors";
                        $product_id = "Doors";
                        break;
                    case 9:
                        //Bathroom
                        $product = "Bath";
                        $product_id = "Bath";
                        break;
                    case 6:
                        //Roofing
                        $product = "Roof";
                        $product_id = "Roof";
                        break;
                    default:
                        $product = "";
                        $product_id = "";
                }
                $Lead_data_array['product'] = $product;
                $Lead_data_array['pro_id'] = $product_id;
                $Lead_data_array['srs_id'] = $srs_id;
                $Lead_data_array['sender'] = "Allied Digital Media";
                break ;
            case 667:
                //WinTek USA
                $trusted_form_link = substr($data_msg['trusted_form'], strrpos($data_msg['trusted_form'], '/') + 1);

                switch ($crm_details['service_id']){
                    case 1:
                        // Windows
                        $ownership = trim($crm_details['data']['homeOwn']);
                        $project_nature = trim($crm_details['data']['project_nature']);
                        $number_of_windows = trim($crm_details['data']['number_of_window']);
                        $start_time = trim($crm_details['data']['start_time']);

                        $Lead_data_array['project_time_frame_wntk'] = $start_time;
                        $Lead_data_array['interested_in_wntk'] = $service_name;
                        $Lead_data_array['service'] = $project_nature;
                        $Lead_data_array['quantity_wntk'] = $number_of_windows;
                        $Lead_data_array['homeowner_wntk'] = $ownership;
                        break;
                }

                $Lead_data_array['phonetype_wntk'] = "Home";
                $Lead_data_array['product'] = $service_name;
                $Lead_data_array['order_cost_wntk'] = $Lead_Cost;
                $Lead_data_array['Opt-In'] = $trusted_form;
                $Lead_data_array['Optin_ID'] = $trusted_form_link;
                $Lead_data_array['submission_date_wntk'] = date('Y-m-d H:i:s');
                $Lead_data_array['submission_agent_wntk'] = $UserAgent;
                $Lead_data_array['originating_page_url_wntk'] = $OriginalURL2;
                $Lead_data_array['order_cost_wntk'] = $Lead_Cost;
                break;
        }

        if( config('app.env', 'local') == "local" || !empty($data_msg['is_test']) ) {
            //Test Mode
            $Lead_data_array['is_test'] = true;
            //$Lead_data_array['first_name'] = "SPWRTest";
        }

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
        if (strpos("-" . $result, 'success') == true) {
            return 1;
        }
        return 0;
    }

    public function MarketsharpmCrm($data_msg, $crm_details){
        if(empty($crm_details['MarketsharpmCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "MarketsharpmCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $MSM_source = $crm_details['MarketsharpmCrm']['MSM_source'];
        $MSM_coy = $crm_details['MarketsharpmCrm']['MSM_coy'];
        $MSM_formId = $crm_details['MarketsharpmCrm']['MSM_formId'];
        $MSM_leadCaptureName = 'MarketSharp';
        $MSM_firstname = $data_msg['first_name'];
        $MSM_lastname = $data_msg['last_name'];
        $MSM_homephone = $data_msg['LeadPhone'];
        $MSM_zip = $data_msg['Zipcode'];
        $MSM_address1 = $data_msg['street'];
        $MSM_city = $data_msg['City'];
        $MSM_email = $data_msg['LeadEmail'];
        $MSM_state = $data_msg['State'];
        $service_name = $crm_details['service_campaign_name'];
        $MSM_custom_Interests = $service_name;

        $url_api = "https://haaws.marketsharpm.com/LeadCapture/MarketSharp/LeadCapture.ashx?MSM_source=$MSM_source&MSM_coy=$MSM_coy&MSM_formId=$MSM_formId&MSM_leadCaptureName=$MSM_leadCaptureName&MSM_firstname=$MSM_firstname&MSM_lastname=$MSM_lastname&MSM_homephone=$MSM_homephone&MSM_cellphone=$MSM_homephone&MSM_zip=$MSM_zip&MSM_address1=$MSM_address1&MSM_city=$MSM_city&MSM_email=$MSM_email&MSM_state=$MSM_state&MSM_custom_Interests=$MSM_custom_Interests";

        if (config('app.env', 'local') == "local" || strtolower($MSM_firstname) == "test"
            || strtolower($MSM_lastname) == "test" ) {
            //Test
            $url_api .= "&MSM_testform=true";
        }

        $url_api = str_replace(" ", "%20", $url_api);
        $Lead_data_array = array();

        $leadsCustomerCampaign_id = '';
        if (!empty($crm_details['leadsCustomerCampaign_id'])) {
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        }

        $httpheader = array(
            "cache-control: no-cache",
            "Accept: application/json",
            "content-type: application/json"
        );

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
        return 1;
    }

    public function leadPortalCrm($data_msg, $crm_details){
        if(empty($crm_details['leadPortalCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "leadPortalCrm"));
            return 0;
        }
        try {
            $crm_api_file = new CrmApi();

            $Lead_data_array = array(
                'PostUrl' => $crm_details['leadPortalCrm']['api_url'],
                'SRC'=> $crm_details['leadPortalCrm']['SRC'],
                'Key' => $crm_details['leadPortalCrm']['key'],
                'type' => $crm_details['leadPortalCrm']['type']
            );

            $url_api = $Lead_data_array['PostUrl'];

            $first_name = trim($data_msg['first_name']);
            $last_name = trim($data_msg['last_name']);
            $number1 = trim($data_msg['LeadPhone']);
            $zip = trim($data_msg['Zipcode']);
            $street = trim($data_msg['street']);
            $city = trim($data_msg['City']);
            $email = trim($data_msg['LeadEmail']);
            $state = trim($data_msg['State']);
            $trusted_form = trim($data_msg['trusted_form']);
            $statename_code = trim($data_msg['state_code']);
            $UserAgent = $data_msg['UserAgent'];
            $OriginalURL = $data_msg['OriginalURL'];
            $OriginalURL2 = $data_msg['OriginalURL2'];
            $SessionLength = $data_msg['SessionLength'];
            $IPAddress = $data_msg['IPAddress'];
            $LeadId = $data_msg['LeadId'];
            $lead_browser_name = $data_msg['browser_name'];
            $TCPAText = $data_msg['TCPAText'];
            $lead_source_text = $data_msg['lead_source'];
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
            $tcpa_compliant = $data_msg['tcpa_compliant'];
            if( $tcpa_compliant == 1 ){
                $tcpa_compliant2 = "Yes";
                $tcpa_compliant3 = "yes";
                $tcpa_compliant4 = "true";
                $tcpa_compliant5 = 1;
            } else {
                $tcpa_compliant2 = "No";
                $tcpa_compliant3 = "no";
                $tcpa_compliant4 = "false";
                $tcpa_compliant5 = 2;
            }

            $httpheader = array(
                "cache-control: no-cache",
                "Accept: application/json",
                "content-type: application/json"
            );

            $TransactionId = "";
            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                $TransactionId = $data_msg['ping_post_data']['TransactionId'];
            }

            $Repair_Project = "No";

            switch ($crm_details['service_id']){
                case 1;
                    //windows
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $number_of_windows = trim($crm_details['data']['number_of_window']);

                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair" ? "Yes" : "No");
                            $Project = (($number_of_windows == 1 || $number_of_windows == 2) ? "Windows-2 or less" : "Windows-3+");
                            break;
                        case 760:
                            //Hello Project USA 760
                            if ($project_nature == "Repair") {
                                $Project = "Windows Repair";
                            } else {
                                $Project = ($number_of_windows == 1 ? "Windows Replace - Single" : "Windows Replace - Multiple");
                            }
                            break;
                        default:
                            if ($project_nature == "Repair") {
                                $Project = "Window Repair";
                            } else {
                                $Project = ($number_of_windows == 1 ? "Window Install - Single" : "Window Install - Multiple");
                            }
                    }
                    break;
                case 2:
                    //Solar
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    switch ($monthly_electric_bill){
                        case '$0 - $50':
                            $average_bill = '$0-50';
                            break;
                        case '$51 - $100':
                            $average_bill = '$51-100';
                            break;
                        case '$101 - $150':
                            $average_bill = '$101-150';
                            break;
                        case '$151 - $200':
                            $average_bill = '$151-200';
                            break;
                        case '$201 - $300':
                            $average_bill = '$201-300';
                            break;
                        case '$301 - $400':
                            $average_bill = '$301-400';
                            break;
                        case '$401 - $500':
                            $average_bill = '$401-500';
                            break;
                        default:
                            $average_bill = '$501-600';
                    }

                    switch ($roof_shade){
                        case "Full Sun":
                            $roof_shade_data = "No Shade";
                            break;
                        case "Mostly Shaded":
                            $roof_shade_data = "A lot of Shade";
                            break;
                        case "Partial Sun":
                            $roof_shade_data = "A little shade";
                            break;
                        default:
                            $roof_shade_data = "Uncertain";
                    }

                    $property_type_data = ($property_type == "Rented" ? "Rent" : "Own");
                    $solar_electric = ($power_solution == "Solar Water Heating for my Home" ? "No" : "Yes");
                    break;
                case 3:
                    //home Security
                    $Project = "Home Security";
                    break;
                case 4:
                    //Flooring
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair Existing Flooring" ? "Yes" : "No");
                            $Project = "Epoxy Flooring";
                            break;
                        default:
                            $Project = "Flooring";
                    }
                    break;
                case 5:
                    //WALK-IN TUBS
                    $Project = "Walk-in Tub";
                    break;
                case 6:
                    //Roofing
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $Repair_Project = ($project_nature == "Repair existing roof" ? "Yes" : "No");
                    $Project = "Roofing";
                    break;
                case 7:
                    //Home Siding
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair section(s) of siding" ? "Yes" : "No");
                            $Project = "Siding";
                            break;
                        default:
                            $Project = "Siding - Install or Replace";
                    }
                    break;
                case 8:
                    //Kitchen
                    $Project = "Kitchen Remodel";
                    break;
                case 9:
                    //Bathroom
                    $Project = "Bathroom Remodel";
                    break;
                case 11:
                    //Furnace
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair" ? "Yes" : "No");
                            $Project = "HVAC";
                            break;
                        default:
                            $Project = ($project_nature == "Repair" ? "Furnace / Heating System - Repair/Service" : "Furnace / Heating System - Install/Replace");
                    }
                    break;
                case 12:
                    //Boiler
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair" ? "Yes" : "No");
                            $Project = "HVAC";
                            break;
                        default:
                            $Project = ($project_nature == "Repair" ? "Boiler or Radiator System - Service/Repair" : "Boiler Or Radiator System - Install/Replace");
                    }
                    break;
                case 13:
                    //Central A/C
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair" ? "Yes" : "No");
                            $Project = "HVAC";
                            break;
                        default:
                            $Project = ($project_nature == "Repair" ? "Central A/C - Repair/Service" : "Central A/C - Install/Replace");
                    }
                    break;
                case 15:
                    //Plumbing
                    $Project = "Plumbing";
                    break;
                case 18:
                    //Handyman
                    $Project = "Handyman";
                    break;
                case 19:
                    //Countertops
                    $Project = "Countertops";
                    break;
                case 21:
                    //Gutter
                    $project_nature = trim($crm_details['data']['project_nature']);
                    switch ($crm_details['buyer_id']){
                        case 553:
                            //conXpros 553
                            $Repair_Project = ($project_nature == "Repair" ? "Yes" : "No");
                            $Project = "Gutters";
                            break;
                        default:
                            $Project = "Gutter Install/Repair";
                    }
                    break;
                case 23:
                    //Painting
                    $Project = "Painting";
                    break;
            }

            if ($crm_details['service_id'] == 2) {
                $type = "26";
                if( !empty($Lead_data_array['type']) ){
                    $type = $Lead_data_array['type'];
                }
                $Lead_data_array_post = array(
                    "Request" => array(
                        "Key" => $Lead_data_array['Key'],
                        "API_Action" => "pingPostLead",
                        "Format" => "JSON",
                        "Mode" => (!empty($TransactionId) ? "post" : "full"),
                        "Return_Best_Price" => "1",
                        "TYPE" => $type,
                        "TCPA_Consent" => $tcpa_compliant2,
                        "TCPA" => $tcpa_compliant2,
                        "TCPA_Language" => $TCPAText,
                        "LeadiD_Token" => $LeadId,
                        "IP_Address" => $IPAddress,
                        "SRC" => $Lead_data_array['SRC'],
                        "Sub_ID" => $lead_source_text,
                        "Pub_ID" => $lead_source_text,
                        "Zip" => $zip,
                        "City" => $city,
                        "State" => $statename_code,
                        "Address" => $street,
                        "Roof_Shade" => $roof_shade_data,
                        "Shade" => $roof_shade_data,
                        "Solar_Electric" => $solar_electric,
                        "Project" => "Electrical_Supplier",
                        "Homeowner" => $property_type_data,
                        "Residence_Ownership" => $property_type_data,
                        "Credit_Rating" => "Good",
                        "Credit" => "Good",
                        "Electric_Bill" => $average_bill,
                        "Monthly_Electric_Bill" => $average_bill,
                        "Electrical_Supplier" => $utility_provider,
                        "Utility_Provider" => $utility_provider,
                        "First_Name" => $first_name,
                        "Last_Name" => $last_name,
                        "Lead_ID" => $TransactionId,
                        "Email" => $email,
                        "Home_Phone" => $number1,
                        "Primary_Phone" => $number1,
                        "Landing_Page" => $OriginalURL2,
                        "User_Agent" => $UserAgent,
                        "Trusted_Form_URL" => $trusted_form,
                        "xxTrustedFormCertUrl" => $trusted_form
                    )
                );
            }
            else if($crm_details['service_id'] == 24){
                $type = ( !empty($Lead_data_array['type']) ? $Lead_data_array['type'] : "33" );
                //Auto Insurance
                $VehicleYear = trim($crm_details['data']['VehicleYear']);
                $VehicleMake = trim($crm_details['data']['VehicleMake']);
                $car_model = trim($crm_details['data']['car_model']);
                $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                $driversNum = trim($crm_details['data']['driversNum']);
                $birthday = trim($crm_details['data']['birthday']);
                $genders = trim($crm_details['data']['genders']);
                $married = trim($crm_details['data']['married']);
                $license = trim($crm_details['data']['license']);
                $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                $driver_experience = trim($crm_details['data']['driver_experience']);
                $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                $DUI_charges = trim($crm_details['data']['DUI_charges']);
                $SR_22_need = trim($crm_details['data']['SR_22_need']);
                $ownership = trim($crm_details['data']['homeOwn']);

                $Lead_data_array_post = array(
                    "Request" => array(
                        "Key" => $Lead_data_array['Key'],
                        "API_Action" => "pingPostLead",
                        "Format" => "JSON",
                        "Mode" => (!empty($TransactionId) ? "post" : "full"),
                        "Return_Best_Price" => "1",
                        "TYPE" => $type,
                        "IP_Address" => $IPAddress,
                        "SRC" => $Lead_data_array['SRC'],
                        "Sub_ID" => $lead_source_text,
                        "Pub_ID" => $lead_source_text,
                        "Landing_Page" => $OriginalURL2,
                        "User_Agent" => $UserAgent,
                        "TCPA_Consent" => $tcpa_compliant2,
                        "TCPA_Language" => $TCPAText,
                        "LeadiD_Token" => $LeadId,
                        "Trusted_Form_URL" => $trusted_form,
                        "xxTrustedFormCertUrl" => $trusted_form,

                        "Driver_1_State" => $statename_code,
                        "Driver_1_Zip" => $zip,
                        "Vehicle_1_Year" => $VehicleYear,
                        "Vehicle_1_Make" => $VehicleMake,
                        "Vehicle_1_Model" => $car_model,
                        "Vehicle_1_Ownership" => "Owned",
                        "Vehicle_1_Primary_Use" => "Commute To/From Work",
                        "Vehicle_1_Average_One_Way_Mileage" => "8",
                        "Vehicle_1_Annual_Mileage" => "7",
                        "Vehicle_1_Parking" => "Driveway",
                        "Vehicle_1_Average_Days_Per_Week_Used" => "5",
                        "Vehicle_1_Desired_Collision_Coverage" => "No Coverage",
                        "Vehicle_1_Desired_Comprehensive_Coverage" => "No Coverage",
                        "Driver_1_Birthdate" => date("y-m-d", strtotime($birthday)),
                        "Driver_1_Gender" => $genders,
                        "Driver_1_Marital_Status" => ( $married == "Yes" ? "Married" : "Single" ),
                        "Driver_1_Credit_Rating" => "Good",
                        "Driver_1_License_Status" => ( $license == "Yes" ? "Active" : "Expired" ),
                        "Driver_1_Licensed_State" => $statename_code,
                        "Driver_1_Education" => "Unknown",
                        "Driver_1_Occupation" => "Other/Not Listed",
                        "Driver_1_Age_When_First_Licensed" => 18,
                        "Driver_1_Filing_Required" => ( $SR_22_need == "Yes" ? "SR-22" : "None" ),
                        "Driver_1_Current_Residence" => ( $ownership == "Yes" ? "Own" : "Rent" ),
                        "Driver_1_Tickets_Accidents_Claims_Past_3_Years" => ( $number_of_tickets == "0" ? "No" : "Yes" ),
                        "Driver_1_Insured_Past_30_Days" => "Yes",
                        "Driver_1_Bankruptcy_In_Past_5_Years" => "No",
                        "Driver_1_Additional_Drivers" => $driversNum,
                        "Driver_1_Additional_Vehicles" => $more_than_one_vehicle,
                        "Driver_1_Reposessions_In_The_Past_5_Years" => "Unknown",
                        "Driver_1_DUI_DWI_In_The_Past_5_Years" => ( $DUI_charges == "Yes" ? "Yes" : "No" ),

                        "Driver_1_First_Name" => $first_name,
                        "Driver_1_Last_Name" => $last_name,
                        "Lead_ID" => $TransactionId,
                        "Driver_1_Email" => $email,
                        "Driver_1_Daytime_Phone" => $number1,
                        "Driver_1_City" => $city,
                        "Driver_1_Address" => $street
                    )
                );
            }
            else {
                if( !empty($crm_details['data']['homeOwn']) ){
                    $ownership = ($crm_details['data']['homeOwn'] != "Yes" ? "No" : "Yes");
                } else {
                    if( !empty($crm_details['data']['property_type']) ){
                        $ownership = ($crm_details['data']['property_type'] == "Rented"  ? "No" : "Yes");
                    } else {
                        $ownership = "Yes";
                    }
                }

                $type = "18";
                if( !empty($Lead_data_array['type']) ){
                    $type = $Lead_data_array['type'];
                }

                $Lead_data_array_post = array(
                    "Request" => array(
                        "Key" => $Lead_data_array['Key'],
                        "API_Action" => "pingPostLead",
                        "Format" => "JSON",
                        "Mode" => (!empty($TransactionId) ? "post" : "full"),
                        "Return_Best_Price" => "1",
                        "TYPE" => $type,
                        "IP_Address" => $IPAddress,
                        "SRC" => $Lead_data_array['SRC'],
                        "Sub_ID" => $lead_source_text,
                        "Pub_ID" => $lead_source_text,
                        "Zip" => $zip,
                        "City" => $city,
                        "State" => $statename_code,
                        "Address" => $street,
                        "Project" => $Project,
                        "TCPA_Consent" => $tcpa_compliant2,
                        "TCPA_Language" => $TCPAText,
                        "LeadiD_Token" => $LeadId,
                        "Homeowner" => $ownership,
                        "First_Name" => $first_name,
                        "Last_Name" => $last_name,
                        "Lead_ID" => $TransactionId,
                        "Email" => $email,
                        "Home_Phone" => $number1,
                        "Primary_Phone" => $number1,
                        "Landing_Page" => $OriginalURL2,
                        "User_Agent" => $UserAgent,
                        "Trusted_Form_URL" => $trusted_form,
                        "xxTrustedFormCertUrl" => $trusted_form
                    )
                );

                switch($crm_details['buyer_id']){
                    case 553:
                        //conXpros 553
                        $Lead_data_array_post['Request']['Repair'] = $Repair_Project;
                        break;
                    case 760:
                        //760 hello project USA
                        unset($Lead_data_array_post['Request']['Return_Best_Price']);
                        $Lead_data_array_post['Request']['Return_Lead_Cost'] = "1";
                        break;
                }
            }

            if (config('app.env', 'local') == "local") {
                //Test Mode
//                    if ($crm_details['service_id'] != 2) {
//                        $Lead_data_array_post['Request']['Project'] = "Alarm/ security system - Install";
//                    }

                $Lead_data_array_post['Request']['State'] = "AK";
                $Lead_data_array_post['Request']['Zip'] = "99999";
                $Lead_data_array_post['Request']['Test_Lead'] = "1";
            }

            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
            $result2 = json_decode($result, true);
            if (!empty($result2['response'])) {
                if (!empty($result2['response']['status'])) {
                    if ($result2['response']['status'] == "Matched") {
                        $TransactionId = $result2['response']['lead_id'];
                        return $TransactionId;
                    }
                }
            }
            return 0;
        } catch (Exception $e) {

        }
    }

    public function leads_pedia_track($data_msg, $crm_details){
        if(empty($crm_details['leads_pedia_track'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "leads_pedia_track"));
            return 0;
        }
        try {
            $crm_api_file = new CrmApi();

            $lp_campaign_id = $crm_details['leads_pedia_track']['lp_campaign_id'];
            $lp_campaign_key = $crm_details['leads_pedia_track']['lp_campaign_key'];
            $lp_url = $crm_details['leads_pedia_track']['post_url'];

            $httpheader = array(
                "cache-control: no-cache",
                "Accept: application/json",
                "content-type: application/json"
            );

            $first_name = trim($data_msg['first_name']);
            $last_name = trim($data_msg['last_name']);
            $number1 = trim($data_msg['LeadPhone']);
            $zip = trim($data_msg['Zipcode']);
            $street = trim($data_msg['street']);
            $city = trim($data_msg['City']);
            $email = trim($data_msg['LeadEmail']);
            $state = trim($data_msg['State']);
            $statename_code = $data_msg['state_code'];
            $trusted_form = trim($data_msg['trusted_form']);
            $UserAgent = $data_msg['UserAgent'];
            $OriginalURL = $data_msg['OriginalURL'];
            $OriginalURL2 = $data_msg['OriginalURL2'];
            $SessionLength = $data_msg['SessionLength'];
            $IPAddress = $data_msg['IPAddress'];
            $LeadId = $data_msg['LeadId'];
            $lead_browser_name = $data_msg['browser_name'];
            $TCPAText = $data_msg['TCPAText'];
            $lead_source_text = $data_msg['lead_source'];
            $google_ts = $data_msg['google_ts'];
            $timestamp = date('Y-m-d H:i:s');
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
            $tcpa_compliant = $data_msg['tcpa_compliant'];
            $lead_source_name = $data_msg['lead_source_name'];
            if( $tcpa_compliant == 1 ){
                $tcpa_compliant2 = "Yes";
                $tcpa_compliant3 = "yes";
                $tcpa_compliant4 = "true";
                $tcpa_compliant5 = 1;
            } else {
                $tcpa_compliant2 = "No";
                $tcpa_compliant3 = "no";
                $tcpa_compliant4 = "false";
                $tcpa_compliant5 = 2;
            }

            $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_s1=$lead_source_text&lp_response=JSON&city=$city&state=$statename_code&zip_code=$zip&first_name=$first_name&last_name=$last_name&address=$street&phone_home=$number1&phone_cell=$number1&email_address=$email&ip_address=$IPAddress";

            switch ($crm_details['buyer_id']){
                case 303:
                    //TradeMarc Global LLC 303
                    $url_api .= "&lp_s2=$google_ts&trustedform_url=$trusted_form&universal_leadid=$LeadId&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId&tcpa=$TCPAText&landing_page=$OriginalURL2&landing_url=$OriginalURL2&landing_page_url=$OriginalURL2&tcpa_language=$TCPAText";
                    break;
                case 312:
                    //Purified Leads/ Sigora Solar 312
                    $url_api .= "&lp_s2=$lead_source_text&xx_trusted_form_cert_url=$trusted_form&leadid_token=$LeadId&tcpa_language=$TCPAText&tcpa_consent=$tcpa_compliant2&landingpage_url=$OriginalURL2";
                    break;
                case 22:
                    //Lead Cactus LLC 22
                    if($crm_details['campaign_id'] == 1503){
                        $trusted_form = "xxTrustedFormCertUrl";
                    }

                    $url_api .= "&lp_s2=$lead_source_text&lp_s3=$lead_source_text&lp_s4=$OriginalURL2&landing_page_url=$OriginalURL2&universal_leadid=$LeadId&jornaya_lead_id=$LeadId&xxTrustedFormCertUrl=$trusted_form&trusted_form_cert_id=$trusted_form&tcpa_text=$TCPAText&user_agent=$UserAgent";

                    //Check if it is warm transfer
                    if ($crm_details['campaign_Type'] == 6 ) {
                        $url_api .= "&lp_caller_id=$number1";
                    } elseif ($crm_details['campaign_Type'] == 4 ) {
                        $appointment_date = "";
                        $appointment_time = "";
                        if ($data_msg['appointment_date'] != "") {
                            $appointment_date = date('m/d/Y', strtotime($data_msg['appointment_date']));
                            $appointment_time = date('h:i A', strtotime($data_msg['appointment_date']));
                        }
                        $url_api .= "&lp_caller_id=$number1&appt_date=$appointment_date&appt_time=$appointment_time";
                    }
                    break;
                case 384:
                    //Encompass Leads LLC 384
                    $url_api .= "&lp_s2=$lead_source_text&source_url=$OriginalURL2&source_page=$OriginalURL2&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&tcpa_optin=$tcpa_compliant2&tcpa_text=$TCPAText&timestamp=$timestamp&user_agent=$UserAgent&lp_caller_id=$number1";
                    break;
                case 394:
                    //Advertising Results 394
                    $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_s1=ACS37&lp_response=JSON&city=$city&state=$state&zip_code=$zip&first_name=$first_name&last_name=$last_name&address=$street&phone_home=$number1&phone_cell=$number1&email_address=$email&ip_address=$IPAddress";
                    $UserAgent = ( !empty($UserAgent) ? $UserAgent : "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36" );
                    $url_api .= "&lp_s2=$google_ts&lp_s3=$lead_source_text&landing_page_url=$OriginalURL2&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&tcpa_consent=$tcpa_compliant3&tcpa_compliant=$tcpa_compliant3&user_agent=$UserAgent";

                    switch ($crm_details['service_id']){
                        case 6:
                        case 9:
                        case 11:
                        case 12:
                        case 13:
                        case 21:
                            $url_api .= "&tcpa_statement=$TCPAText&tcpa_opt_in=$tcpa_compliant2";
                            break;
                        case 8:
                            $url_api .= "&tcpa_text=$TCPAText";
                            break;
                        default:
                            $url_api .= "&tcpa_consent_text=$TCPAText";
                    }
                    break;
                case 400:
                    //Sunpro/ ADT Solar 400
                    $url_api .= "&landing_page=$OriginalURL2&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&lp_s2=$google_ts";
                    if ($crm_details['is_ping_account'] != 1) {
                        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
                        if ($listOFCampainDB_type == "Exclusive") {
                            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
                            $Lead_Cost_type = "Exclusive";
                        } else {
                            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
                            $Lead_Cost_type = "Shared";
                        }

                        $url_api .= "&lp_price=$Lead_Cost&lead_exclusivity=$Lead_Cost_type";
                    }

                    if (in_array($crm_details['campaign_Type'], [4, 6, 7])) {
                        $url_api .= "&lp_s3=PPA";
                    } else {
                        $url_api .= "&lp_s3=PPS";
                    }
                    break;
                case 425:
                    //Envyus Media Corp. 425
                    $url_api .= "&affid=26725&campid=38612&language=en_US&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form";
                    break;
                case 497:
                    //Airo Marketing Inc. 497
                    $source_type= "Paid Search";
                    $url_api .= "&Universal_Lead_ID=$LeadId&trusted_form_url=$trusted_form&trusted_form_cert_id=$trusted_form&tcpa_consent=$tcpa_compliant2&tcpa_language=$TCPAText&landing_page=$OriginalURL2&source_type=$source_type";
                    break;
                case 185:
                    //snk media group 185
                    $url_api .= "&jornaya_id=$LeadId&trusted_form_url=$trusted_form&user_agent=$UserAgent&lp_s2=$google_ts";
                    if ($crm_details['service_id'] == 24) {
                        $url_api .= "&landing_page_url=$OriginalURL2&tcpa_consent=$tcpa_compliant2&TCPA_Language=$TCPAText";
                    } else {
                        $url_api .= "&consentLang=$TCPAText&sumbission_url=$OriginalURL2";
                    }
                    break;
                case 540:
                    //pbtp Powered by The People LLC 540
                    $type_data = $crm_details['listOFCampainDB_type'];
                    $source_id = "400";
                    $source_key = "XP-ADM890";

                    $url_api .= "&leadtoken=$LeadId&type=$type_data&source_id=$source_id&source_key=$source_key&tcpa=$tcpa_compliant2&tcpa_text=$TCPAText&TrustedForm=$trusted_form&telephone=$number1";
                    break;
                case 605:
                    //Grow My Firm Online 605
                    $url_api .= "&user_agent=$UserAgent&tcpa_consent=$tcpa_compliant2&tcpa_language=$TCPAText&landing_page=$OriginalURL2&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form";
                    break;
                case 636:
                    //The Lead Giant 636
                    $url_api .= "&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&tcpa_text=$TCPAText&tcpa_opt_in=$tcpa_compliant2";
                    break;
                case 276:
                    //ETN AMERICA 276
                    $url_api .= "&landing_page=$OriginalURL2&tcpa_consent=$tcpa_compliant2&tcpa_language=$TCPAText&user_agent=$UserAgent&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&lp_s1=$google_ts";
                    break;
                case 723:
                    //Biz Focused 723
                    $url_api .= "&trustedform_url=$trusted_form&trusted_form_cert_id=$trusted_form&tcpa_consent=$tcpa_compliant2&tcpa_statement=$TCPAText&lp_url=$OriginalURL2&source_url=$OriginalURL2&lead_id_token=$LeadId&jornaya_lead_id=$LeadId";
                    break;
                case 56:
                    //Trinity Solar 56
                    $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
                    if ($listOFCampainDB_type == "Exclusive") {
                        $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
                        $Lead_Cost_type = "Exclusive";
                    } else {
                        $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
                        $Lead_Cost_type = "Shared";
                    }

                    $url_api .= "&lp_cost=$Lead_Cost";

                    //Check if it is warm transfer
                    if ($crm_details['campaign_Type'] == 6) {
                        $url_api .= "&lp_caller_id=$number1";
                    }
                    break;
                case 546:
                    //Remodel Well 546
                    $url_api .= "&lp_s2=$google_ts&landing_page_url=$OriginalURL2&tcpa_consent_text=$TCPAText&tcpa_consent=$tcpa_compliant2&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form";
                    break;
                case 939:
                    //939 Turtle Leads LLC
                    $url_api.="&user_agent=$UserAgent&landing_page=$OriginalURL2&landing_page_url=$OriginalURL2&tcpa_compliant=$tcpa_compliant4&tcpa_consent=$tcpa_compliant2&tcpa_consent_text=$TCPAText&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form";
                    break;
                case 959:
                    // 959 pointer leads
                    $url_api.="&trustedform_url=$trusted_form&tcpa_language=$TCPAText&landing_page=$OriginalURL2&jornaya=$LeadId";
                    break;
                case 974:
                    // 974 OnCore Leads
                    $url_api.="&tcpa=$tcpa_compliant2&tcpa_text=$TCPAText&landing_page_url=$OriginalURL2&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId";
                    break;
                case 1025:
                    //MILI Group LLC 1025
                    $type_data = $crm_details['listOFCampainDB_type'];

                    if ($trusted_form == "NA" || $trusted_form == "N/A" || $trusted_form == "https://cert.trustedform.com"){
                        $trusted_form = "";
                    }

                    $trusted_form_cert_id = "";
                    if(!empty($trusted_form)){
                        $trusted_form_cert_arr = explode("/", $trusted_form);
                        $trusted_form_cert_id = (!empty($trusted_form_cert_arr[3]) ? $trusted_form_cert_arr[3] : "");
                    }

                    $pub_id = "AL424";

                    $tcpa_compliant2 = strtoupper($tcpa_compliant2);
                    $tcpa_compliant2 = ($tcpa_compliant2 == "Yes" ? "YES" : "NO");

                    $url_api .= "&universal_leadid=$LeadId&type=$type_data&pub_id=$pub_id&tcpa_language=$TCPAText&TCPA=$tcpa_compliant2&trusted_form=$trusted_form&trusted_form_cert_url=$trusted_form&trusted_form_cert_id=$trusted_form_cert_id&landing_page=$OriginalURL2&user_agent=$UserAgent";
                    break;
                case 1045:
                    //UptownLeads LLC  1045
                    $url_api .= "&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId&tcpa_consent_language=$TCPAText&landing_page_url=$OriginalURL2";
                    if (strtolower($lead_source_name) == "affiliate") {
                        $url_api .="&lp_s2=$google_ts";
                    }
                    break;
                case 1205:
                    //Strategic Solar Solutions 1205
                    $UserAgent = (!empty($UserAgent) ? $UserAgent : "Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.103 Safari/537.36");
                    $url_api .= "&lead_source=$google_ts&user_agent=$UserAgent&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId&lp_caller_id=$number1";
                    break;
                case 1240:
                    //Rexdirect 1240
                    $url_api .= "&affkey=112890&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId";
                    break;
                case 1249:
                    // 1249	Lead2contractors
                    $url_api .= "&trusted_form_cert_id=$trusted_form&jornaya_lead_id=$LeadId&tcpa_consent=$tcpa_compliant2&tcpa_language=$TCPAText&user_agent=$UserAgent";
                    break;
                case 1303:
                    // 1303	Solar Direct Marketing
                    $url_api = "$lp_url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_s1=115&lp_response=JSON&city=$city&state=$state&zip_code=$zip&ip_address=$IPAddress&credit_score=Good&source_page_url=$OriginalURL2&landing_page=$OriginalURL2&tcpa=$tcpa_compliant2&tcpaDisclosure=$tcpa_compliant2&tcpaText=$TCPAText&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&user_agent=$UserAgent&lp_s2=$lead_source_text&traffic_source=$lead_source_name&first_name=$first_name&last_name=$last_name&address=$street&phone_home=$number1&phone_cell=$number1&email_address=$email&address_1=$street";
                    break;
            }

            switch ($crm_details['service_id']){
                case 1:
                    //Windows
                    $number_of_windows = trim($crm_details['data']['number_of_window']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 394:
                            //Advertising Results 394
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $replace_repair = ($project_nature == "Repair" ? "repair" : "install");
                            $project_timeframe = ($start_time == 'Immediately' ? "immediate" : "over_2_weeks");
                            $property_type = "residential";
                            $best_call_time = "Anytime";

                            switch ($number_of_windows){
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                case "10+":
                                    $number_of_windows_data = 10;
                                    break;
                                default:
                                    $number_of_windows_data = $number_of_windows;
                            }

                            $url_api .= "&number_of_windows=$number_of_windows_data&time_frame=$project_timeframe&owner=$homeowner&service_type=$replace_repair&property_type=$property_type&best_call_time=$best_call_time";
                            break;
                        case 22:
                            //Lead Cactus LLC Windows 22
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $replace_repair = ($project_nature == "Repair" ? "repair" : "install");

                            switch ($number_of_windows) {
                                case "3-5":
                                    $number_of_windows_data = "3_5";
                                    break;
                                case "6-9":
                                    $number_of_windows_data = "6_9";
                                    break;
                                case "10+":
                                    $number_of_windows_data = "10_and_more";
                                    break;
                                default:
                                    $number_of_windows_data = $number_of_windows;
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = "immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1_6_months";
                                    break;
                                default:
                                    $project_timeframe = "not_sure";
                            }

                            $url_api .= "&number_of_windows=$number_of_windows_data&time_frame=$project_timeframe&homeowner=$homeowner&service_type=$replace_repair&best_time_to_call=Morning";
                            break;
                        case 497:
                            //Airo Marketing Inc. 497
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            if($project_nature != "Repair") {
                                switch ($number_of_windows){
                                    case "1":
                                        $Trade = "Windows - Replace 1 Window";
                                        break;
                                    case "2":
                                        $Trade = "Windows - Replace 2 Windows";
                                        break;
                                    case "3-5":
                                        $Trade = "Windows - Replace 3-5 Windows";
                                        break;
                                    case "6-9":
                                        $Trade = "Windows - Replace 6-9 Windows";
                                        break;
                                    default:
                                        $Trade = "Windows - Replace 10%2b Windows";
                                }
                            } else {
                                $Trade = "Windows Repair - Service Call";
                            }

                            $url_api .= "&Trade=$Trade&Homeowner=$homeowner";
                            break;
                        case 185:
                            //snk media group 185
                            $ProjectType = ($project_nature != "Repair" ? "4" : "12");
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($number_of_windows){
                                case "1":
                                    $number_of_windows_data = 1;
                                    break;
                                case "2":
                                    $number_of_windows_data = 2;
                                    break;
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                default:
                                    $number_of_windows_data = 10;
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&windows=$number_of_windows_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            if($project_nature == "Repair") {
                                $type_of_work = "Window Repair";
                            } else {
                                $type_of_work = ($number_of_windows == "1" ? "Window Install - Single" : "Windows Install - Multiple");
                            }

                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Windows";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$homeowner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 636:
                            //The Lead Giant 636
                            $number_of_windows_data = ($number_of_windows == "10+" ? "6-9" : $number_of_windows);
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $replace_repair = ($project_nature == "Repair" ? "Repair" : "Install");
                            $property_type = "Single Family Home";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Unsure";
                                    break;
                                default:
                                    $project_timeframe = "1-2 Weeks";
                            }

                            $url_api .= "&property_owner=$homeowner&property_type=$property_type&project_type=$replace_repair&project_timeframe=$project_timeframe&number_of_windows=$number_of_windows_data";
                            break;
                        case 723:
                            //Biz Focused 723
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $lead_age = "Real-Time";

                            switch ($number_of_windows){
                                case "1":
                                    $number_of_windows_data = 1;
                                    break;
                                case "2":
                                    $number_of_windows_data = 2;
                                    break;
                                default:
                                    $number_of_windows_data = "3+";
                            }

                            $url_api .= "&home_owner=$homeowner&windows_replace=$number_of_windows_data&lead_age=$lead_age";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_call_time = "Anytime";

                            if($project_nature == "Repair"){
                                $category = "Windows Repair";
                            } else {
                                $category = ($number_of_windows == 1 ? "Windows Install - Single" : "Windows Install - Multiple");
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $url_api .= "&category=$category&timeframe=$project_timeframe&homeowner=$homeowner&window_number=$number_of_windows&best_time_to_call=$best_call_time";
                            break;
                        case 605:
                            //Grow My Firm Online 605
                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "Immediate";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "1-3 Months";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            switch ($ownership) {
                                case 'Yes':
                                    $homeowner = "Owner";
                                    break;
                                case "No":
                                    $homeowner = "Unauthorized Renter";
                                    break;
                                default:
                                    $homeowner = "Authorized Renter";
                            }

                            $project_details = "$number_of_windows Windows";
                            $property_type_data = "Home";
                            $service_need = "Windows";

                            $url_api .= "&project_timeframe=$start_time_data&own_rent=$homeowner&property_type=$property_type_data&service_need=$service_need&project_details=$project_details&project_nature=$project_nature&unit_count=$number_of_windows";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($number_of_windows) {
                                case "1":
                                    $number_of_windows_data = 1;
                                    break;
                                case "2":
                                    $number_of_windows_data = 2;
                                    break;
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                default:
                                    $number_of_windows_data = 10;
                            }

                            switch ($project_nature){
                                case 'Repair':
                                    $proNature = "Need repair services at this time";
                                    $category = "Window Repair";
                                    break;
                                default:
                                    $proNature = "Interested in replacement windows";
                                    switch ($number_of_windows) {
                                        case "1":
                                            $category = "Windows Install - Single";
                                            break;
                                        default:
                                            $category = "Windows Install - Multiple";
                                    }
                            }

                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $windows_material = "Wood";
                            $project_type = "Windows Project Type";
                            $property_type = "Other";

                            $url_api.="&project_time_frame=$project_timeframe&homeowner=$homeowner&windows_project_type=$proNature&num_windows=$number_of_windows_data&category=$category&best_call_time=$best_call_time&windows_material=$windows_material&project_type=$project_type&property_type=$property_type";
                            break;
                        case 959:
                            // 959 pointer leads
                            switch ($number_of_windows) {
                                case "1":
                                case "2":
                                    $number_of_windows_data = "1-2";
                                    break;
                                case "3-5":
                                    $number_of_windows_data = "3-5";
                                    break;
                                case "6-9":
                                    $number_of_windows_data = "6-9";
                                    break;
                                default:
                                    $number_of_windows_data = "10+";
                            }

                            $url_api.="&windows_service=$project_nature&windows_number=$number_of_windows_data";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $replace_repair = ($project_nature == "Repair" ? "Repair" : "Install/Replace");
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediate";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Timing is Flexible";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 Month";
                            }
                            switch ($number_of_windows) {
                                case "1":
                                    $number_of_windows_data = "1";
                                    break;
                                case "2":
                                    $number_of_windows_data = "2";
                                    break;
                                case "3-5":
                                    $number_of_windows_data = "3-5";
                                    break;
                                case "6-9":
                                    $number_of_windows_data = "6-9";
                                    break;
                                default:
                                    $number_of_windows_data = "10%2B";
                            }

                            $url_api.="&time_frame=$project_timeframe&home_owner=$homeowner&number_of_windows=$number_of_windows_data&window_project_type=$replace_repair&window_material=Not Sure";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            if ($project_nature == "Repair") {
                                $type_of_work = "Window Repair";
                            } else {
                                $type_of_work = ($number_of_windows == "1" ? "Window Install Single" : "Windows Install Multiple");
                            }
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            switch ($number_of_windows) {
                                case "1":
                                case "2":
                                    $service = ($project_nature == "Repair" ? "Windows Repair 2 Wood Windows" : "Windows Install 2 Wood windows");
                                    break;
                                case "3-5":
                                    $service = ($project_nature == "Repair" ? "Windows Repair 3-5 Wood Windows" : "Windows Install 3-5 Wood Windows");
                                    break;
                                default:
                                    $service = ($project_nature == "Repair" ? "Windows Repair 6-9 Wood Windows" : "Windows Install 6-9 Wood windows");
                            }

                            $url_api .= "&service=$service";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            if ($project_nature == "Repair") {
                                $project = "A01-Window Glass - Repair";
                            }
                            else {
                                switch ($number_of_windows) {
                                    case "1":
                                        $project ="A01-Window Install - Single";
                                        break;
                                    case "2":
                                    case "3-5":
                                        $project = "A01-Windows Install - 2 to 5";
                                        break;
                                    default:
                                        $project = "A01-Windows Install - 6 or more";
                                }
                            }
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $url_api .= "&project=$project&property_type=Residential&homeowner=$homeowner&contractor_ID=A01";
                            break;
                        case 303:
                            //TradeMarc Global LLC 303
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $replace_repair = ($project_nature == "Repair" ? "repair" : "install");
                            $project_timeframe = ($start_time == 'Immediately' ? "immediate" : "over 2 weeks");
                            $property_type = "residential";

                            switch ($number_of_windows){
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                case "10+":
                                    $number_of_windows_data = 10;
                                    break;
                                default:
                                    $number_of_windows_data = $number_of_windows;
                            }

                            $url_api .= "&no_of_windows=$number_of_windows_data&project_timeframe=$project_timeframe&homeowner=$homeowner&replace_repair=$replace_repair&property_type=$property_type";
                            break;
                        case 1240:
                            //Rexdirect 1240
                            switch ($number_of_windows) {
                                case "1":
                                case "2":
                                    $number_of_windows_data = "1-2";
                                    break;
                                case "3-5":
                                    $number_of_windows_data = "3-5";
                                    break;
                                case "6-9":
                                    $number_of_windows_data = "6-9";
                                    break;
                                default:
                                    $number_of_windows_data = "10+";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "1-6 month";
                                    break;
                                default:
                                    $start_time_data = "NA";
                            }

                            switch ($project_nature) {
                                case 'Install':
                                    $project_nature_data = "install";
                                    break;
                                case "Replace":
                                    $project_nature_data = "replace";
                                    break;
                                default:
                                    $project_nature_data = "Repair";
                            }

                            $url_api .= "&project_type=$project_nature_data&purchase_timeframe=$start_time_data&number_of_windows=$number_of_windows_data&own_home=$ownership&tcpa_consent_language=$TCPAText&pubsub=$leadsCustomerCampaign_id&timestamp=$timestamp&source_url=$OriginalURL2&phone_consent_language=$timestamp";
                            break;
                        case 1249:
                            // 1249	Lead2contractors
                            $homeType = "Single Family";

                            switch ($project_nature) {
                                case 'Install':
                                    $project_nature_data = "Install";
                                    break;
                                case "Replace":
                                    $project_nature_data = "Replace";
                                    break;
                                default:
                                    $project_nature_data = "Repair";
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "Immediately";
                                    $timeFrame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "Within 6 months";
                                    $timeFrame = "3-6 Months";
                                    break;
                                default:
                                    $start_time_data = "Not Sure";
                                    $timeFrame = "Flexible";
                            }
                            switch ($ownership) {
                                case 'Yes':
                                    $homeowner = "Yes";
                                    break;
                                case "No":
                                    $homeowner = "No";
                                    break;
                                default:
                                    $homeowner = "No, But Authorized to Make Changes";
                            }
                            switch ($number_of_windows) {
                                case "1":
                                    $number_of_windows_data = "1";
                                    break;
                                case "2":
                                    $number_of_windows_data = "2";
                                    break;
                                case "3-5":
                                    $number_of_windows_data = "3-5";
                                    break;
                                case "6-9":
                                    $number_of_windows_data = "6-9";
                                    break;
                                default:
                                    $number_of_windows_data = "10+";
                            }
                            $url_api .= "&timeframe=$timeFrame&homeowner=$homeowner&type_of_home=$homeType&project_nature=$project_nature_data&number_of_windows=$number_of_windows_data&landing_page_url=$OriginalURL&priority=$start_time_data";

                            break;
                        default:
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $replace_repair = ($project_nature == "Repair" ? "repair" : "install");
                            $project_timeframe = ($start_time == 'Immediately' ? "immediate" : "over 2 weeks");
                            $property_type = "residential";

                            switch ($number_of_windows){
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                case "10+":
                                    $number_of_windows_data = 10;
                                    break;
                                default:
                                    $number_of_windows_data = $number_of_windows;
                            }

                            $url_api .= "&no_of_windows=$number_of_windows_data&project_timeframe=$project_timeframe&homeowner=$homeowner&replace_repair=$replace_repair&property_type=$property_type";
                    }
                    break;
                case 2:
                    //Solar
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    switch ($crm_details['buyer_id']){
                        case 303:
                            //TradeMarc Global LLC 303
                            $residence_type = ($property_type == 'Own' ? "Yes" : "No");
                            $property_type = ($property_type == 'Business' ? "No" : "Yes");
                            $start_time = "Not Sure";

                            $url_api .= "&shade=$roof_shade&electric_bill_monthly=$monthly_electric_bill&electric_provider=$utility_provider&time_frame=$start_time&residential=$property_type&home_owner=$residence_type";
                            if (config('app.env', 'local') == "local") {
                                $url_api .= "&test_lead=Yes";
                            }
                            break;
                        case 312:
                            //Purified Leads 312
                            $CreditRating = "Good";
                            $homeowner = ($property_type == 'Rented' ? "Rent" : "Own");
                            $SolarElectric = ($power_solution == "Solar Water Heating for my Home" ? "No" : "Yes");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '$0-$50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '$51-$100';
                                    break;
                                case '$101 - $150' || '$151 - $200':
                                    $average_bill = '$101-$200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-$300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-$400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-$500';
                                    break;
                                default:
                                    $average_bill = '$501-$600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Uncertain";
                            }

                            $url_api .= "&electric_bill=$average_bill&credit_rating=$CreditRating&homeowner=$homeowner&electric_provider=$utility_provider&roof_shade=$roof_shade_data&solar_electric=$SolarElectric";
                            break;
                        case 22:
                            //Lead Cactus LLC 22
                            $homeowner = ($property_type == 'Rented' ? "No" : "Yes");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '$0-$50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '$51-$100';
                                    break;
                                case '$101 - $150' || '$151 - $200':
                                    $average_bill = '$151-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-$300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-$400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-$500';
                                    break;
                                default:
                                    $average_bill = '$501-$600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Uncertain";
                            }

                            $url_api .= "&average_bill=$average_bill&homeowner=$homeowner&electricUtilityProviderText=$utility_provider&roof_shade=$roof_shade_data";
                            break;
                        case 384:
                            //Encompass Leads LLC 384
                            $credit_score = "Good";
                            $homeowner = ($property_type == 'Rented' ? "No" : "Yes");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                case '$51 - $100':
                                    $average_bill = '0-99';
                                    break;
                                case '$101 - $150':
                                case '$151 - $200':
                                    $average_bill = '100-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '301-400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '401-500';
                                    break;
                                default:
                                    $average_bill = '501+';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            $url_api .= "&utility_electric_monthly_amount=$average_bill&homeowner=$homeowner&electric_provider=$utility_provider&roof_shade=$roof_shade_data&credit_score=$credit_score";
                            break;
                        case 394:
                            //Advertising Results 394
                            $credit_score = "Good";
                            $best_call_time = "Anytime";
                            $property_type = "Single Family";
                            $service_type = "Install New Panels";
                            $purchase_time_frame = "Within 1 months";
                            $homeowner = ($property_type == 'Rented' ? "No" : "Yes");
                            $SolarElectric = ($power_solution == "Solar Water Heating for my Home" ? "Solar Thermal" : "Solar Electrical");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '500';
                                    break;
                                default:
                                    $average_bill = '600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "no shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "full shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "some shade";
                                    break;
                                default:
                                    $roof_shade_data = "not sure";
                            }

                            $url_api .= "&best_call_time=$best_call_time&source_id=$lead_source_text&utility_provider=$utility_provider&own_property=$homeowner&roof_shade=$roof_shade_data&solar_service=$SolarElectric&credit_rating=$credit_score&monthly_electric_bill=$average_bill&purchase_time_frame=$purchase_time_frame&property_type=$property_type&service_type=$service_type";
                            break;
                        case 400:
                            //Sunpro 400
                            $url_api .= "&electric_bill_amount=$monthly_electric_bill&electric_company=$utility_provider&roof_shade=$roof_shade";
                            break;
                        case 425:
                            //Envyus Media Corp. 425
                            $homeowner = ($property_type == 'Rented' ? "Rent" : "Own");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '$0-$50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '$51-$100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '$101-150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '$151-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-$300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-$400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-$500';
                                    break;
                                default:
                                    $average_bill = '$501-$600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "no shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Uncertain";
                            }

                            $url_api .= "&utility_provider=$utility_provider&property_ownership=$homeowner&roof_shade=$roof_shade_data&electric_bill=$average_bill";
                            break;
                        case 497:
                            //Airo Marketing Inc. 497
                            $Trade = "Solar - Installation";

                            switch ($monthly_electric_bill){
                                case '$0 - $50' || '$51 - $100' || '$101 - $150':
                                    $energy_bill = '$0 - $150';
                                    break;
                                case '$151 - $200':
                                    $energy_bill = '$150 - $200';
                                    break;
                                case '$201 - $300':
                                    $energy_bill = '$200 - $300';
                                    break;
                                case '$301 - $400' || '$401 - $500':
                                    $energy_bill = '$300 - $500';
                                    break;
                                default:
                                    $energy_bill = '$500+';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Very Shaded";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Some Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            switch ($property_type){
                                case 'Rented':
                                    $homeowner = 'No';
                                    $residential = "Yes";
                                    break;
                                case 'Business':
                                    $homeowner = '';
                                    $residential = "No";
                                    break;
                                default:
                                    $homeowner = 'Yes';
                                    $residential = "Yes";
                            }

                            $url_api .= "&energy_bill=$energy_bill&Roof_shade=$roof_shade_data&Trade=$Trade&Residential=$residential&Homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $category = "Solar";
                            $type_of_work = "Install Solar Panels";
                            switch ($property_type){
                                case "Owned":
                                    $home_owner = "Yes";
                                    $residential_commercia = "residential";
                                    break;
                                case "Rented":
                                    $home_owner = "No";
                                    $residential_commercia = "residential";
                                    break;
                                default:
                                    $home_owner = "No";
                                    $residential_commercia = "commercial";
                            }

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 605:
                            //Grow My Firm Online 605
                            $credit = "Good";

                            switch ($property_type){
                                case "Owned":
                                    $home_owner = "Yes";
                                    $residential_commercia = "Residential";
                                    break;
                                case "Rented":
                                    $home_owner = "No";
                                    $residential_commercia = "Residential";
                                    break;
                                default:
                                    $home_owner = "No";
                                    $residential_commercia = "Commercial";
                            }

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '500';
                                    break;
                                default:
                                    $average_bill = '600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "Full Sun";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "No Sun";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial Sun";
                                    break;
                                default:
                                    $roof_shade_data = "Unknown";
                            }

                            $url_api .= "&homeowner=$home_owner&PropertyUsage=$residential_commercia&utilityProvider=$utility_provider&utilityBill=$average_bill&sunLevel=$roof_shade_data&credit=$credit";
                            break;
                        case 723:
                            //Biz Focused 723
                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");
                            $lead_age = "Live solar leads";

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                case '$51 - $100':
                                    $average_bill = 'Less than $100';
                                    break;
                                case '$101 - $150':
                                case '$151 - $200':
                                    $average_bill = '$100-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-400';
                                    break;
                                case '$401 - $500':
                                default:
                                    $average_bill = '$400+';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Full Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            $url_api .= "&home_owner=$home_owner&monthly_utility_bill=$average_bill&utility_provider=$utility_provider&roof_shade=$roof_shade_data&lead_age=$lead_age";
                            break;
                        case 546:
                            //Remodel Well 546
                            $credit = "Good";
                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '$0-50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '$51-100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '$101-150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '$151-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-500';
                                    break;
                                default:
                                    $average_bill = '+$401';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Full Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            $url_api .= "&homeowner=$home_owner&electric_provider=$utility_provider&roof_shade=$roof_shade_data&credit_score=$credit&electric_bill=$average_bill";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $powerSol = ($power_solution == "Solar Electricity for my Home") ? "Yes" : "No";

                            switch ($property_type){
                                case "Owned":
                                    $homeowner = "Yes";
                                    break;
                                case "Rented":
                                    $homeowner = "No";
                                    break;
                                default:
                                    $homeowner = "Yes";
                            }

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = '$0-50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '$51-100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '$101-150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '$151-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-500';
                                    break;
                                default:
                                    $average_bill = '$501-600';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Uncertain";
                            }

                            $url_api .= "&home_owner=$homeowner&roof_shade=$roof_shade_data&credit_rating=Good&solar_electric=$powerSol&electric_bill=$average_bill&electric_supplier=$utility_provider&property_type=Single Family";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");
                            $best_call_time = "Any Time";
                            $project_time_frame = "Immediately";
                            $property_type_data = "Other";
                            $category = "Solar Panels";
                            $estimate_timeline = "Timing Flexible";

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Full Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Some Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            $url_api .= "&credit=Good&roof_shade=$roof_shade_data&monthly_electric_bill=$average_bill&current_utility_provider=$utility_provider&estimate_timeline=$estimate_timeline&homeowner=$home_owner&project_time_frame=$project_time_frame&best_call_time=$best_call_time&property_type=$property_type_data&category=$category";
                            break;
                        case 959:
                            // 959 pointer leads
                            $credit_scorePnt = "Good";

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }
                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Full Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }
                            $url_api.="&credit_score=$credit_scorePnt&utility_provider=$utility_provider&electric_bill=$average_bill&roof_shade=$roof_shade_data";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                case '$51 - $100':
                                    $average_bill = "Less than $100";
                                    break;
                                case '$101 - $150':
                                case '$151 - $200':
                                    $average_bill = "From $100 to $200";
                                    break;
                                case '$201 - $300':
                                    $average_bill = "From $200 to $300";
                                    break;
                                default:
                                    $average_bill = "More than $300";
                            }

                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");

                            $url_api.="&house_size=2-3 Bedroom&monthly_bill=$average_bill&time_frame=Timing is Flexible&home_owner=$home_owner";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            $credit_rating = "good";
                            $electric_provider = "1";
                            $property_type = "single";
                            $service = "install";

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_electric_bill = '$0-50';
                                    break;
                                case '$101 - $150':
                                    $average_electric_bill = '$101-150';
                                    break;
                                case '$151 - $200':
                                    $average_electric_bill = '$151-200';
                                    break;
                                case '$201 - $300':
                                    $average_electric_bill = '$201-300';
                                    break;
                                case '$301 - $400':
                                    $average_electric_bill = '$301-400';
                                    break;
                                case '$401 - $500':
                                    $average_electric_bill = '$401-500';
                                    break;
                                default:
                                    $average_electric_bill = '$501-600';
                            }

                            switch ($roof_shade){
                                case "Mostly Shaded":
                                    $roof_shade_data = "full";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "partial";
                                    break;
                                default:
                                    $roof_shade_data = "none";
                            }

                            $url_api .= "&service=$service&electric_provider=$electric_provider&average_electric_bill=$average_electric_bill&shade=$roof_shade_data&property_type=$property_type&credit_rating=$credit_rating";
                            break;
                        case 1205:
                            //Strategic Solar Solutions 1205
                            $credit_score = "good";
                            $homeowner = ($property_type == 'Rented' ? "No" : "Yes");

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = 'below 50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '51-100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '101-150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '151-200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '201-300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '301-400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '401-500';
                                    break;
                                default:
                                    $average_bill = 'more than 500';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "full_sun";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "mostly_shaded";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "partial_sun";
                                    break;
                                default:
                                    $roof_shade_data = "not_sure";
                            }

                            $url_api .= "&electric_provider=$utility_provider&homeowner=$homeowner&roof_shade=$roof_shade_data&credit=$credit_score&electric_bill=$average_bill";
                            break;
                        case 1249:
                            // 1249	Lead2contractors
                            $credit = "Good";
                            $houseSize = "2-3 Bedroom";
                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");
                            $propertyTType = "Single Family";
                            $timeFrame = "Flexible";

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "Full Sun";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Mostly Shaded";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial Sun";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            switch ($power_solution){
                                case "Solar Electricity for my Home":
                                    $power_solution_data = "Residential Electricity";
                                    break;
                                case "Solar Water Heating for my Home":
                                    $power_solution_data = "Residential Water Heating";
                                    break;
                                case "Solar Electricity & Water Heating for my Home":
                                    $power_solution_data = "Residential Electricity and Water Heating";
                                    break;
                                default:
                                    $power_solution_data = "Business";
                            }

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_electric_bill = '$0 - $50';
                                    break;
                                case '$51 - $100':
                                    $average_electric_bill = '$51 - $100';
                                    break;
                                case '$101 - $150':
                                    $average_electric_bill = '$101 - $150';
                                    break;
                                case '$151 - $200':
                                    $average_electric_bill = '$151 - $200';
                                    break;
                                case '$201 - $300':
                                    $average_electric_bill = '$201 - $300';
                                    break;
                                case '$301 - $400':
                                    $average_electric_bill = '$301 - $400';
                                    break;
                                case '$401 - $500':
                                    $average_electric_bill = '$401 - $500';
                                    break;
                                default:
                                    $average_electric_bill = '$500+';
                            }

                            $url_api .= "&roof_shade=$roof_shade_data&monthly_electric_bill=$average_electric_bill&owner=$home_owner&utility_provider=$utility_provider&credit=$credit&landing_page_url=$OriginalURL&solution_type=$power_solution_data&property_type=$propertyTType&house_size=$houseSize&timeframe=$timeFrame";

                            break;
                        case 1303:
                            // 1303	Solar Direct Marketing
                            $home_owner = ($property_type == "Owned" ? "Yes" : "No");

                            switch ($monthly_electric_bill){
                                case '$51 - $100':
                                case '$101 - $150':
                                    $average_bill = '$100-$150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = "$151-$200";
                                    break;
                                case '$201 - $300':
                                    $average_bill = '$251-$300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '$301-$400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '$401-$500';
                                    break;
                                default:
                                    $average_bill = '$401-$500';
                            }

                            switch ($roof_shade){
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Not Sure";
                            }

                            switch ($power_solution){
                                case "Solar Electricity for my Home":
                                case "Solar Electricity & Water Heating for my Home":
                                    $power_solution_data = "Yes";
                                    break;
                                case "Solar Water Heating for my Home":
                                    $power_solution_data = "No";
                                    break;
                                default:
                                    $power_solution_data = "No";
                            }

                            $url_api .= "&homeowner=$home_owner&property_type=Single Family&roof_shade=$roof_shade_data&utility_electric_monthly_amount=$average_bill&utility_electric_company_name=$utility_provider&solar_electric=$power_solution_data";
                            break;
                    }
                    break;
                case 3:
                    //Home Security
                    $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                    $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $property_type = trim($crm_details['data']['property_type']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "08 - Home Security - New Install";
                            $ProjectType = "8";

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            switch ($property_type){
                                case "Owned":
                                    $homeowner = 1;
                                    $residential = 1;
                                    $home_security_use_type = "Residential";
                                    break;
                                case "Rented":
                                    $homeowner = 0;
                                    $residential = 1;
                                    $home_security_use_type = "Residential";
                                    break;
                                default:
                                    $homeowner = 0;
                                    $residential = 0;
                                    $home_security_use_type = "Commercial";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&home_security_use_type=$home_security_use_type&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $category = "Home Security";
                            $type_of_work = "Alarm/Security System-Install";

                            switch ($property_type){
                                case "Owned":
                                    $home_owner = "Yes";
                                    $residential_commercia = "residential";
                                    break;
                                case "Rented":
                                    $home_owner = "No";
                                    $residential_commercia = "residential";
                                    break;
                                default:
                                    $home_owner = "No";
                                    $residential_commercia = "commercial";
                            }

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 636:
                            //The Lead Giant 636
                            $homeowner = ($property_type == 'Owned' ? "Yes" : "No");
                            $url_api .= "&homeowner=$homeowner";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($property_type == "Owned" ? "Yes" : "No");
                            $category = ($property_type == "Business" ? "Home Security - Commercial" : "Home Security - Residential");
                            $best_call_time = "Anytime";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $url_api .= "&category=$category&timeframe=$project_timeframe&homeowner=$homeowner&best_time_to_call=$best_call_time";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = "Alarm Security System Install";
                            $homeowner = ($property_type == "Owned" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 959:
                            // 959 pointer leads
                            $homesecurity_service = "Install";
                            $url_api .= "&homesecurity_service=$homesecurity_service";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            switch ($property_type){
                                case "Owned":
                                    $homeowner = "Own";
                                    $residential_commercia = "Residential";
                                    $project = "L10-Alarm/security system Install";
                                    break;
                                case "Rented":
                                    $homeowner = "Rent";
                                    $residential_commercia = "Residential";
                                    $project = "L10-Alarm/security system Install";
                                    break;
                                default:
                                    $homeowner = "Rent";
                                    $residential_commercia = "Commercial";
                                    $project = "L10-Business Alarm or Security System - Install";
                            }

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=L10";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }
                            $security_property_type = "Residential";
                            switch ($property_type) {
                                case "Rented":
                                    $homeowner = "False";
                                    $security_property_type = "Residential";
                                    $category = "Home Security System - Install";
                                    break;
                                case "Business":
                                    $homeowner = "True";
                                    $security_property_type = "Commercial";
                                    $category = "Business Security System - Install";
                                    break;
                                default:
                                    $homeowner = "True";
                                    $security_property_type = "Commercial";
                                    $category = "Business Security System - Install";
                            }

                            $property_type = "Other";
                            $best_call_time = "Any Time";
                            $project_time_frame = "Immediately";
                            $property_type_data = "Other";
                            $estimate_timeline = "Timing Flexible";
                            $home_security_building_type = "Other";

                            $url_api .= "&home_security_building_type=$home_security_building_type&home_security_usage=$security_property_type&homeowner=$homeowner&project_time_frame=$project_time_frame&best_call_time=$best_call_time&property_type=$property_type_data&category=$category";
                            break;
                    }
                    break;
                case 4:
                    //Flooring
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "22 - Flooring";
                            $ProjectType = "22";
                            $residential = 1;
                            $homeowner = ($ownership == "Yes" ? "1" : "0");

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Flooring";

                            switch ($Type_OfFlooring){
                                case "Vinyl Linoleum Flooring":
                                    $type_of_work = ($project_nature == "Repair Existing Flooring" ? "Vinyl/Linoleum Floor - Repair" : "Vinyl/Linoleum Floor - Install");
                                    break;
                                case "Tile Flooring":
                                    $type_of_work = ($project_nature == "Repair Existing Flooring" ? "Tile Floor Repair" : "Tile Floor Install");
                                    break;
                                case "Hardwood Flooring":
                                    $type_of_work = "Hardwood Floor - Install";
                                    break;
                                case "Laminate Flooring":
                                    $type_of_work = ($project_nature == "Repair Existing Flooring" ? "Laminate Flooring - Repair" : "Laminate Flooring - Install");
                                    break;
                                default:
                                    $type_of_work = "Flooring";
                            }

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$homeowner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Morning";
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($Type_OfFlooring){
                                case "Vinyl Linoleum Flooring":
                                    $category = ($project_nature == "Repair Existing Flooring" ? "Flooring Repair - Vinyl/Linoleum" : "Flooring Install - Vinyl/Linoleum");
                                    break;
                                case "Tile Flooring":
                                    $category = ($project_nature == "Repair Existing Flooring" ? "Flooring Repair - Tile" : "Flooring Install - Tile");
                                    break;
                                case "Hardwood Flooring":
                                    $category = ($project_nature == "Repair Existing Flooring" ? "Flooring Repair - Hardwood" : "Flooring Install - Hardwood");
                                    break;
                                case "Laminate Flooring":
                                    $category = ($project_nature == "Repair Existing Flooring" ? "Flooring Repair - Laminate" : "Flooring Install - Laminate");
                                    break;
                                default:
                                    $category = ($project_nature == "Repair Existing Flooring" ? "Flooring Repair - Carpet" : "Flooring Install - Carpet");
                            }

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");
                            switch ($Type_OfFlooring){
                                case "Vinyl Linoleum Flooring":
                                    $type_of_work = ($project_nature == "Repair Existing Flooring" ? "Vinyl Linoleum Floor Repair" : "Vinyl Linoleum Floor Install");
                                    break;
                                case "Laminate Flooring":
                                    $type_of_work = ($project_nature == "Repair Existing Flooring" ? "Laminate Flooring Repair" : "Laminate Flooring Install");
                                    break;
                                default:
                                    $type_of_work = "Flooring";
                            }

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 959:
                            // 959 Pointer Leads
                            switch ($Type_OfFlooring){
                                case "Vinyl Linoleum Flooring":
                                    $type_of_work = "Vinyl/Linoleum Floor";
                                    break;
                                case "Hardwood Flooring":
                                    $type_of_work = "Hardwood Floor";
                                    break;
                                case "Laminate Flooring":
                                    $type_of_work = "Laminate Flooring";
                                    break;
                                default:
                                    $type_of_work = "Wood Floor";
                            }

                            switch ($project_nature){
                                case "Install New Flooring":
                                    $project_type = "Install";
                                    break;
                                case "Refinish Existing Flooring":
                                    $project_type = "Replace";
                                    break;
                                default:
                                    $project_type = "Repair";
                            }

                            $url_api.="&flooring_type=$type_of_work&flooring_service=$project_type";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                        case "Refinish Existing Flooring":
                                            $service = 'Flooring Vinyl Linoleum Install Home';
                                            break;
                                        default:
                                            $service = 'Flooring Vinyl Linoleum Repair Home';
                                    }
                                    break;
                                case  "Tile Flooring":
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                        case "Refinish Existing Flooring":
                                            $service = 'Flooring Tile Install';
                                            break;
                                        default:
                                            $service = 'Flooring Tile Repair';
                                    }
                                    break;
                                case "Hardwood Flooring":
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $service = 'Flooring Hardwood Install Materials Purchased Home';
                                            break;
                                        case "Refinish Existing Flooring":
                                            $service = 'Flooring Hardwood Refinishing Materials Purchased Home';
                                            break;
                                        default:
                                            $service = 'Flooring Hardwood Repair Materials Purchased Home';
                                    }
                                    break;
                                case "Laminate Flooring":
                                    $service = 'Flooring Laminate Materials Purchased Home';
                                    break;
                                case "Carpet":
                                default:
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                        case "Refinish Existing Flooring":
                                            $service = 'Flooring Carpet Install Materials Purchased';
                                            break;
                                        default:
                                            $service = 'Flooring Carpet Repair Materials Purchased';
                                    }
                            }

                            $url_api .= "&service=$service";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($Type_OfFlooring){
                                case "Vinyl Linoleum Flooring":
                                    $flooring_type = "Vinyl";
                                    break;
                                case "Hardwood Flooring":
                                    $flooring_type = "Hardwood";
                                    break;
                                case "Tile Flooring":
                                    $flooring_type = "Tile";
                                    break;
                                case "Carpet":
                                default:
                                    $flooring_type = "Carpet";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $category = ($project_nature == "Repair Existing Flooring" ? "Laminate Flooring - Repair" : "Laminate Flooring Install");
                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";

                            $url_api .= "&flooring_type=$flooring_type&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time";
                            break;
                    }
                    break;
                case 5:
                    //WALK-IN TUBS
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);

                    switch ($crm_details['buyer_id']){
                        case 497:
                            //Airo Marketing Inc. 497
                            $Trade = "Bathroom - Walk-in Tub";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .= "&Trade=$Trade&Homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = "Bathtub/Shower - Install/Replace";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Bathtub/Shower";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$homeowner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 22:
                            //Lead Cactus LLC WalkInTubs 22
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $bathType = "walk_in_tub";
                            $best_time = "Morning";

                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-6 months";
                                    break;
                                default:
                                    $project_timeframe = "Don't know";
                            }

                            $url_api .= "&homeowner=$homeowner&start_date=$project_timeframe&project_type=$bathType&best_time=$best_time";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");
                            $Project = "Walking Bath";

                            $url_api .= "&Project=$Project&home_owner=$homeowner";
                            break;
                    }
                    break;
                case 6:
                    //Roofing
                    $roof_type = trim($crm_details['data']['roof_type']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $start_time = trim($crm_details['data']['start_time']);

                    switch ($crm_details['buyer_id']){
                        case 394:
                            //Advertising Results 394
                            $owner = "yes";
                            $time_frame = ($start_time == 'Immediately' ? "immediate" : "over_2_weeks");
                            $property_typeRoofing = ($property_type == 'Residential' ? "residential" : "commercial");
                            $best_call_time = "Anytime";

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install-Wood Shake/Comp.';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Wood Shake';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Wood Shake/Comp.';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "repair";
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Tile Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "repair";
                                    }
                                    break;
                                default:
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $roofing_material = "Other";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $roofing_material = "Other";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $roofing_material = "Other";
                                            $service_type = "repair";
                                    }
                            }

                            $url_api .= "&service_type=$service_type&time_frame=$time_frame&owner=$owner&property_type=$property_typeRoofing&task_id=$task_id&best_call_time=$best_call_time&roofing_material=$roofing_material";
                            break;
                        case 497:
                            //Airo Marketing Inc. 497
                            if ($property_type == 'Residential') {
                                $residential = "Yes";
                                if($project_nature != "Repair existing roof") {
                                    switch ($roof_type) {
                                        case "Asphalt Roofing":
                                            $Trade = 'Roofing - Asphalt Install or Replace';
                                            break;
                                        case "Tile Roofing":
                                            $Trade = 'Roofing - Clay Tile Install or Replace';
                                            break;
                                        case "Metal Roofing":
                                            $Trade = 'Roofing - Metal Install or Replace';
                                            break;
                                        default:
                                            $Trade = 'Roofing - Wood Shingles Install or Replace';
                                    }
                                } else {
                                    $Trade = 'Roofing - Repair';
                                }
                            } else {
                                $residential = "No";
                                $Trade = ($project_nature != "Repair existing roof" ? 'Roofing - Commercial Install or Replace' : 'Roofing - Commercial Repair');
                            }

                            $url_api .= "&Trade=$Trade&Residential=$residential";
                            break;
                        case 22:
                            //Lead Cactus LLC 22
                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_material = "ROOFING_TAR_TORCHDOWN";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_material = "ROOFING_CEDAR_SHAKE";
                                    break;
                                case "Metal Roofing":
                                    $roof_material = "ROOFING_METAL";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_material = "ROOFING_NATURAL_SLATE";
                                    break;
                                case "Tile Roofing":
                                default:
                                    $roof_material = "ROOFING_TILE";
                            }

                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "1-6 months";
                                    break;
                                case "Not Sure":
                                default:
                                    $time_frame = "Don't know";
                            }

                            $homeowner = "Yes";
                            $best_time = "Morning";

                            $url_api .= "&homeowner=$homeowner&start_date=$time_frame&best_time=$best_time&roof_type=$roof_material&project_type=$project_nature&property_type=$property_type";
                            break;
                        case 185:
                            //snk media group 185
                            $ProjectType = ($project_nature != "Repair existing roof" ? 14 : 6);
                            $homeowner = ($property_type == "Residential" ? 1 : 0);
                            $residential = ($property_type == "Residential" ? 1 : 0);

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_type_data = '1';
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_type_data = '2';
                                    break;
                                case  "Metal Roofing":
                                    $roof_type_data = '3';
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_data = '6';
                                    break;
                                default:
                                    $roof_type_data = '5';
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner&RoofingType=$roof_type_data";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            if( $property_type == "Residential" ){
                                $home_owner = "Yes";
                                $residential_commercia = "residential";
                                switch ($roof_type){
                                    case "Wood Shake/Composite Roofing":
                                        $type_of_work = "Roofing Wood Shingle";
                                        break;
                                    case  "Metal Roofing":
                                        $type_of_work = "Roofing Metal";
                                        break;
                                    case "Natural Slate Roofing":
                                        $type_of_work = "Roofing Slate";
                                        break;
                                    case "Tile Roofing":
                                        $type_of_work = "Roofing Tile";
                                        break;
                                    default:
                                        $type_of_work = 'Roofing';
                                }
                            } else {
                                $home_owner = "No";
                                $residential_commercia = "commercial";
                                $type_of_work = "Commercial Roofing";
                            }

                            $category = "Roofing";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 636:
                            //The Lead Giant 636
                            $homeowner = ($property_type == "Residential" ? "Yes" : "No");
                            $property_type = "Single Family Home";

                            switch ($project_nature){
                                case "Install roof on new construction":
                                    $replace_repair = "New";
                                    break;
                                case "Completely replace roof":
                                    $replace_repair = "Replace";
                                    break;
                                default:
                                    $replace_repair = "Repair";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Unsure";
                                    break;
                                default:
                                    $project_timeframe = "1-2 Weeks";
                            }

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_type_text = "Asphalt Shingles";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_type_text = "Wood Shake";
                                    break;
                                case "Metal Roofing":
                                    $roof_type_text = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_text = "Slate";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_text = "Cement Tile";
                                    break;
                                default:
                                    $roof_type_text = "Other or Unknown";
                            }

                            $url_api .= "&property_owner=$homeowner&property_type=$property_type&project_type=$replace_repair&project_timeframe=$project_timeframe&roof_type=$roof_type_text";
                            break;
                        case 303:
                            //TradeMarc Global LLC 303
                            switch ($property_type){
                                case "Residential":
                                    $residence_type = "Own";
                                    $property_type = "Residential";
                                    break;
                                default:
                                    $residence_type = "Rent";
                                    $property_type = "Business";
                            }

                            switch ($project_nature){
                                case "Completely replace roof":
                                    $task_id = "Replace";
                                    break;
                                case "Repair existing roof":
                                    $task_id = "Repair";
                                    break;
                                default:
                                    $task_id = "New";
                            }

                            $url_api .= "&property_type=$property_type&time_frame=$start_time&residence_type=$residence_type&task_id=$task_id";
                            break;
                        case 723:
                            //Biz Focused 723
                            switch ($roof_type){
                                case "Metal Roofing":
                                    $roof_type_data = "Metal Roof";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_data = "Clay Tile";
                                    break;
                                case "Asphalt Roofing":
                                default:
                                    $roof_type_data = "Asphalt Shingles";
                                    break;
                            }

                            $owner = ($property_type == "Residential" ? "Yes" : "No");

                            $url_api .="&type_of_roof=$roof_type_data&home_owner=$owner";
                            break;
                        case 56:
                            //Trinity Solar 56
                            $homeowner = 'Yes';
                            $product_category = "Roof";

                            $url_api .= "&homeowner=$homeowner&product_category=$product_category";
                            break;
                        case 546:
                            //Remodel Well 546
                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $category = ($project_nature == "Repair existing roof" ? "Roof Repair - Asphalt Shingle" : "Roof Install - Asphalt Shingle");
                                    $roof_material = "Asphalt Shingle";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $category = ($project_nature == "Repair existing roof" ? "Roof Repair - Wood Shake/Comp." : "Roof Install - Wood Shake/Comp.");
                                    $roof_material = "Wood Shake/Comp.";
                                    break;
                                case "Metal Roofing":
                                    $category = ($project_nature == "Repair existing roof" ? "Roof Repair - Metal" : "Roof Install - Metal");
                                    $roof_material = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $category = ($project_nature == "Repair existing roof" ? "Roof Repair - Natural Slate" : "Roof Install - Natural Slate");
                                    $roof_material = "Natural Slate";
                                    break;
                                case "Tile Roofing":
                                default:
                                    $category = ($project_nature == "Repair existing roof" ? "Roof Repair - Tile" : "Roof Install - Tile");
                                    $roof_material = "Tile";
                            }

                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "1-3 months";
                                    break;
                                case "Not Sure":
                                default:
                                    $time_frame = "Within 1 months";
                            }

                            $best_time_to_call = "Anytime";
                            $homeowner = "Yes";
                            $roof_job = ($project_nature == "Repair existing roof" ? "Roof Repair" : "Roof Install");

                            $url_api .= "&category=$category&best_time_to_call=$best_time_to_call&timeframe=$time_frame&roof_material=$roof_material&roof_job=$roof_job&homeowner=$homeowner";
                            break;
                        case 605:
                            //Grow My Firm Online 605
                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "Immediate";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "1-3 Months";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            switch ($project_nature) {
                                case 'Install roof on new construction':
                                    $project_nature_data = "Install";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "Replace";
                                    break;
                                default:
                                    $project_nature_data = "Repair";
                            }

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_material = "Asphalt Shingle";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_material = "Cedar Shake";
                                    break;
                                case "Metal Roofing":
                                    $roof_material = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_material = "Natural State";
                                    break;
                                case "Tile Roofing":
                                default:
                                    $roof_material = "Tile";
                            }

                            $property_type_data = ($property_type == "Commercial" ? "Commercial" : "Home");
                            $homeowner = "Owner";
                            $service_need = "Roofing";

                            $url_api .= "&project_timeframe=$start_time_data&own_rent=$homeowner&property_type=$property_type_data&service_need=$service_need&project_details=$roof_material&project_nature=$project_nature_data&roof_material=$roof_material";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($project_nature) {
                                case 'Install roof on new construction':
                                    $project_nature_data = "New roof for new home";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "New roof for an existing home";
                                    break;
                                default:
                                    $project_nature_data = "Repair";
                            }

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_material = "Asphalt shingle";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_material = "Cedar shake";
                                    break;
                                case "Metal Roofing":
                                    $roof_material = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_material = "Natural state";
                                    break;
                                case "Tile Roofing":
                                    $roof_material = "Tile";
                                    break;
                                default:
                                    $roof_material = "Tar";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($property_type) {
                                case "Residential":
                                    switch ($roof_type){
                                        case "Asphalt Roofing":
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install - Asphalt Shingle";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Asphalt Shingle";
                                                    break;
                                                default:
                                                    $category = "Roof Repair - Asphalt Shingle";
                                            }
                                            break;
                                        case "Wood Shake/Composite Roofing":
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install - Wood Shake/Comp.";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Wood Shake";
                                                    break;
                                                default:
                                                    $category = "Roof Repair - Wood Shake/Comp.";
                                            }
                                            break;
                                        case "Metal Roofing":
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install - Metal";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Metal";
                                                    break;
                                                default:
                                                    $category = "Roof Repair - Metal";
                                            }
                                            break;
                                        case "Natural Slate Roofing":
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install - Natural Slate";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Natural Slate";
                                                    break;
                                                default:
                                                    $category = "Roof Repair - Natural Slate";
                                            }
                                            break;
                                        case "Tile Roofing":
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install - Tile";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Tile";
                                                    break;
                                                default:
                                                    $category = "Roof Repair - Tile";
                                            }
                                            break;
                                        default:
                                            switch ($project_nature) {
                                                case 'Install roof on new construction':
                                                    $category = "Roof Install -Flat / SinglePly";
                                                    break;
                                                case "Completely replace roof":
                                                    $category = "Roof Replace - Flat / SinglePly";
                                                    break;
                                                default:
                                                    $category = "Roof Repair-Flat / SinglePly";
                                            }
                                    }
                                    break;
                                default:
                                    $category = "Commercial Roofing";
                            }

                            $home_owner = ($property_type == 'Residential' ? "True" : "False");
                            $best_call_time = "Any Time";
                            $project_type = "Roofing Project Type";
                            $property_type = "Other";

                            $url_api .= "&roofing_project_type=$project_nature_data&roofing_type=$roof_material&category=$category&homeowner=$home_owner&project_time_frame=$project_timeframe&best_call_time=$best_call_time&project_type=$project_type&property_type=$property_type";
                            break;
                        case 959:
                            // 959 pointer leads
                            switch ($project_nature){
                                case "Install roof on new construction":
                                case "Completely replace roof":
                                    $replace_repair = "Replace";
                                    break;
                                default:
                                    $replace_repair = "Repair";
                            }
                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_material = "Asphalt";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_material = "Wood";
                                    break;
                                case "Metal Roofing":
                                    $roof_material = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_material = "Slate";
                                    break;
                                case "Tile Roofing":
                                    $roof_material = "Tile/Clay";
                                    break;
                                default:
                                    $roof_material = "Not Sure";
                            }
                            $url_api.="&roof_service=$replace_repair&roof_material=$roof_material";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $task_id = '4014';
                                            break;
                                        default:
                                            $task_id = '4003';
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $task_id = '4004';
                                            break;
                                        default:
                                            $task_id = '4008';
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $task_id = '4013';
                                            break;
                                        default:
                                            $task_id = '4005';
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $task_id = '4012';
                                            break;
                                        default:
                                            $task_id = '4006';
                                    }
                                    break;
                                case "Tile Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $task_id = '4011';
                                            break;
                                        default:
                                            $task_id = '4007';
                                    }
                                    break;
                                default:
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = '4017';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = '4009';
                                            break;
                                        default:
                                            $task_id = '4018';
                                    }
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "Immediate";
                                    break;
                                case "Within 6 months":
                                    $start_time_data = "More Than 1 Month";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }
                            $property_typeRoofing = ($property_type == 'Residential' ? "Yes" : "No");

                            $url_api.="&service_id=$task_id&time_frame=$start_time_data&home_owner=$property_typeRoofing";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $homeowner = "YES";
                            if($property_type == "Commercial"){
                                $type_of_work = "Commercial Roofing";
                            } else {
                                switch ($roof_type){
                                    case "Wood Shake/Composite Roofing":
                                        $type_of_work = ($project_nature == "Repair existing roof" ? "Roofing Composition Shingle Repair" : "Roofing Composition Shingle Install");
                                        break;
                                    case "Metal Roofing":
                                        $type_of_work = ($project_nature == "Repair existing roof" ? "Roofing Metal Repair" : "Roofing Metal Install");
                                        break;
                                    case "Natural Slate Roofing":
                                        $type_of_work = ($project_nature == "Repair existing roof" ? "Roofing Slate Repair" : "Roofing Slate Install");
                                        break;
                                    case "Tile Roofing":
                                        $type_of_work = ($project_nature == "Repair existing roof" ? "Roofing Tile Repair" : "Roofing Tile Install");
                                        break;
                                    default:
                                        $type_of_work = ($project_nature == "Repair existing roof" ? "Roof Repair" : "New Roof");
                                }
                            }

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $service = 'Roofing Install on New Construction Asphalt';
                                            break;
                                        case "Completely replace roof":
                                            $service = 'Roofing Replacement Asphalt';
                                            break;
                                        default:
                                            $service = 'Roofing Repair Asphalt';
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $service = 'Roofing Install on New Construction Metal';
                                            break;
                                        case "Completely replace roof":
                                            $service = 'Roofing Replacement Metal';
                                            break;
                                        default:
                                            $service = 'Roofing Repair Metal';
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $service = 'Roofing Install on New Construction Natural Slate';
                                            break;
                                        case "Completely replace roof":
                                            $service = 'Roofing Replacement Natural Slate';
                                            break;
                                        default:
                                            $service = 'Roofing Repair Natural Slate';
                                    }
                                    break;
                                case "Tile Roofing":
                                default:
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $service = 'Roofing Install on New Construction Tile';
                                            break;
                                        case "Completely replace roof":
                                            $service = 'Roofing Replacement Tile';
                                            break;
                                        default:
                                            $service = 'Roofing Repair Tile';
                                    }
                            }

                            $url_api .= "&service=$service";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            switch ($property_type){
                                case "Commercial":
                                    $homeowner = "Rent";
                                    $residential_commercia = "Commercial";
                                    $project = "B02-Commercial Roofing";
                                    break;
                                default:
                                    $homeowner = "Own";
                                    $residential_commercia = "Residential";
                                    $project = "B02-Roofing";
                            }

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=B02";
                            break;
                        case 1240:
                            //Rexdirect 1240
                            $own_home = "yes";
                            $Scheduling = "flexible";

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $Category = 'Roofing - Install Asphalt Shingle';
                                            $Category_id = '101';
                                            $roof_type = "asphalt";
                                            $service_type = "install_or_replace";
                                            break;
                                        default:
                                            $Category = 'Roofing - Install Asphalt Shingle';
                                            $Category_id = '108';
                                            $roof_type = "asphalt";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $Category = 'Roofing - Install Wood or Composite';
                                            $Category_id = '107';
                                            $roof_type = "wood_shake_or_composite";
                                            $service_type = "install_or_replace";
                                            break;
                                        default:
                                            $Category = 'Roofing - Repair Wood or Composite';
                                            $Category_id = '108';
                                            $roof_type = "wood_shake_or_composite";
                                            $service_type = "repair";
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $Category = 'Roofing - Install Metal';
                                            $Category_id = '104';
                                            $roof_type = "metal";
                                            $service_type = "install_or_replace";
                                            break;
                                        default:
                                            $Category = 'Roofing - Repair Metal';
                                            $Category_id = '108';
                                            $roof_type = "metal";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature){
                                        case "Completely replace roof":
                                            $Category = 'Roofing - Install Natural Slate';
                                            $Category_id = '105';
                                            $roof_type = "slate";
                                            $service_type = "install_or_replace";
                                            break;
                                        default:
                                            $Category = 'Roofing - Repair Natural Slate';
                                            $Category_id = '108';
                                            $roof_type = "slate";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Tile Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $Category = 'Roofing - Install Traditional Tile';
                                            $Category_id = '106';
                                            $roof_type = "tile";
                                            $service_type = "install_or_replace";
                                            break;
                                        default:
                                            $Category = 'Roofing - Repair Traditional Tile';
                                            $Category_id = '108';
                                            $roof_type = "tile";
                                            $service_type = "repair";
                                    }
                                    break;
                            }

                            $url_api .= "&service_type=$service_type&scheduling=$Scheduling&own_home=$own_home&roof_type=$roof_type&category=$Category&CategoryID=$Category_id&roof_type=$roof_type&tcpa_user_agent=$UserAgent&tcpa_text=$TCPAText&tcpa_opt_in=true&landing_page_url=$OriginalURL2";
                            break;
                        case 1249:
                            // 1249	Lead2contractors
                            $credit = "Good";
                            $propertyType = "Single Family";
                            $pitch = "Sloped";
                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "3-6 Months";
                                    break;
                                case "Not Sure":
                                default:
                                    $time_frame = "Flexible";
                            }
                            switch ($project_nature) {
                                case 'Install roof on new construction':
                                    $project_nature_data = "New roof for new home";
                                    $project_nature_data2 = "New roof for new home";
                                    $repairOrReplace = "Replace";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "New roof for existing home";
                                    $project_nature_data2 = "New roof for existing home";
                                    $repairOrReplace = "Replace";
                                    break;
                                default:
                                    $project_nature_data = "Roof Repair";
                                    $project_nature_data2 = "Repair";
                                    $repairOrReplace = "Repair";
                            }
                            switch ($property_type){
                                case "Commercial":
                                    $homeowner = "No";
                                    break;
                                default:
                                    $homeowner = "Yes";
                            }
                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roofyType = "Asphalt Shingle";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofyType = "Slate";
                                    break;
                                case "Tile Roofing":
                                    $roofyType = "Tile";
                                    break;
                                case "Metal Roofing":
                                case "Wood Shake/Composite Roofing":
                                default:
                                    $roofyType = "Other";
                                    break;
                            }

                            $url_api .= "&roof_project_type=$project_nature_data2&own_home=$homeowner&credit_rating=$credit&repair_or_replace=$repairOrReplace&current_roof_type=$roofyType&type_of_home=$propertyType&timeframe=$time_frame&credit=$credit&property_type=$propertyType&homeowner=$homeowner&roof_pitch=$pitch&project_type=$project_nature_data&landing_page=$OriginalURL";

                            break;
                        case 1303:
                            // 1303	Solar Direct Marketing
                            switch ($project_nature){
                                case "Install roof on new construction":
                                    $replace_or_repair = "Replace";
                                    $taskId = "New";
                                    break;
                                case "Completely replace roof":
                                    $replace_or_repair = "Replace";
                                    $taskId = "Replace";
                                    break;
                                default:
                                    $replace_or_repair = "Repair";
                                    $taskId = "Repair";
                            }

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roofType = "Asphalt";
                                    break;
                                case "Metal Roofing":
                                    $roofType = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofType = "Natural Slate";
                                    break;
                                case "Tile Roofing":
                                    $roofType = "Tile";
                                    break;
                                default:
                                    $roofType = "Other";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "Ready Now";
                                    break;
                                default:
                                    $start_time_data = "4 To 6 Months";
                            }

                            $url_api .= "&roof_type=$roofType&replace_or_repair=$replace_or_repair&taskId=$taskId&home_type=Single Family Home&timeFrame=$start_time_data";
                            break;
                        default:
                            $owner = "yes";
                            $time_frame = ($start_time == 'Immediately' ? "immediate" : "over_2_weeks");
                            $property_typeRoofing = ($property_type == 'Residential' ? "residential" : "commercial");
                            $best_call_time = "Anytime";

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Asphalt Shingle';
                                            $roofing_material = "Asphalt Shingle";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install-Wood Shake/Comp.';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Wood Shake';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Wood Shake/Comp.';
                                            $roofing_material = "Cedar Shake";
                                            $service_type = "repair";
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Metal';
                                            $roofing_material = "Metal";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Natural Slate';
                                            $roofing_material = "Natural Slate";
                                            $service_type = "repair";
                                    }
                                    break;
                                case "Tile Roofing":
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Tile';
                                            $roofing_material = "Tar";
                                            $service_type = "repair";
                                    }
                                    break;
                                default:
                                    switch ($project_nature){
                                        case "Install roof on new construction":
                                            $roofing_material = "Other";
                                            $service_type = "new";
                                            break;
                                        case "Completely replace roof":
                                            $roofing_material = "Other";
                                            $service_type = "replace";
                                            break;
                                        default:
                                            $roofing_material = "Other";
                                            $service_type = "repair";
                                    }
                            }

                            $url_api .= "&service_type=$service_type&time_frame=$time_frame&owner=$owner&property_type=$property_typeRoofing&task_id=$task_id&best_call_time=$best_call_time&roofing_material=$roofing_material";
                    }
                    break;
                case 7:
                    //Home Siding
                    $type_of_siding = trim($crm_details['data']['type_of_siding']);
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);

                    $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                    switch ($crm_details['buyer_id']){
                        case 497:
                            //Airo Marketing Inc. 497
                            if ($project_nature != "Repair section(s) of siding") {
                                switch ($type_of_siding){
                                    case "Vinyl Siding":
                                        $Trade = "Siding - Vinyl Install or Replace";
                                        break;
                                    case "Brickface Siding" || "Stoneface Siding":
                                        $Trade = "Siding - Brick or Stone Install or Replace";
                                        break;
                                    case "Composite wood Siding":
                                        $Trade = "Siding - Wood Install or Replace";
                                        break;
                                    case "Aluminium Siding":
                                        $Trade = "Siding - Stucco Install or Replace";
                                        break;
                                    default:
                                        $Trade = "Siding - Cement Install or Replace";
                                }
                            } else {
                                $Trade = "Siding - Repair";
                            }

                            $url_api .= "&Trade=$Trade&Homeowner=$homeowner";
                            break;
                        case 185:
                            //snk media group 185
                            $residential = 1;
                            $ProjectType = ($project_nature != "Repair section(s) of siding" ? 15 : 7);
                            $homeowner = ($ownership == "Yes" ? 1 : 0);

                            switch ($type_of_siding){
                                case "Vinyl Siding":
                                    $type_of_siding_data = '1';
                                    break;
                                case "Brickface Siding":
                                    $type_of_siding_data = '5';
                                    break;
                                case "Composite wood Siding":
                                    $type_of_siding_data = '2';
                                    break;
                                default:
                                    $type_of_siding_data = '6';
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner&SidingType=$type_of_siding_data";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature != "Repair section(s) of siding" ? "Siding Install/Replace" : "Siding Repair");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Home Siding";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $best_time = "Morning";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($type_of_siding){
                                case "Vinyl Siding":
                                    $category = ($project_nature == "Repair section(s) of siding" ? "Siding Repair - Vinyl" : "Siding Install - Vinyl");
                                    break;
                                case "Brickface Siding" || "Stoneface Siding":
                                    $category = ($project_nature == "Repair section(s) of siding" ? "Siding Repair - Brick or stone" : "Siding Install - Brick or stone");
                                    break;
                                case "Composite wood Siding":
                                    $category = ($project_nature == "Repair section(s) of siding" ? "Siding Repair - Wood" : "Siding Install - Wood");
                                    break;
                                case "Aluminium Siding":
                                    $category = ($project_nature == "Repair section(s) of siding" ? "Siding Repair - Metal" : "Siding Install - Metal");
                                    break;
                                default:
                                    $category = ($project_nature == "Repair section(s) of siding" ? "Siding Repair - Other" : "Siding Install - Other");
                            }

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $location = ($ownership == "Yes" ? "Residential" : "Commercial");
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediate";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "More Than 1 Month";
                                    break;
                                default:
                                    $project_timeframe = "Timing is Flexible";
                            }
                            switch ($project_nature){
                                case "Repair section(s) of siding":
                                    switch ($type_of_siding){
                                        case "Vinyl Siding":
                                            $projectType = "VINYL - Repair";
                                            break;
                                        case "Brickface Siding":
                                            $projectType = "BRICKFACE - Repair";
                                            break;
                                        case "Stoneface Siding":
                                            $projectType = "STONEFACE - Repair";
                                            break;
                                        case "Composite wood Siding":
                                            $projectType = "COMPOSITE_WOOD - Repair";
                                            break;
                                        case "Aluminium Siding":
                                            $projectType = "ALUMINIUM - Repair";
                                            break;
                                        default:
                                            $projectType = "STUCCO - Repair";
                                    }
                                    break;
                                case "Replace existing siding":
                                default:
                                    switch ($type_of_siding){
                                        case "Vinyl Siding":
                                            $projectType = "VINYL - Install/Replace";
                                            break;
                                        case "Brickface Siding":
                                            $projectType = "BRICKFACE - Install/Replace";
                                            break;
                                        case "Stoneface Siding":
                                            $projectType = "STONEFACE - Install/Replace";
                                            break;
                                        case "Composite wood Siding":
                                            $projectType = "COMPOSITE_WOOD - Install/Replace";
                                            break;
                                        case "Aluminium Siding":
                                            $projectType = "ALUMINIUM - Install/Replace";
                                            break;
                                        default:
                                            $projectType = "STUCCO - Install/Replace";
                                    }
                            }

                            $url_api.="&home_owner=$homeowner&time_frame=$project_timeframe&type_of_project=$projectType&location=$location";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = ($project_nature != "Repair section(s) of siding" ? "Siding Install Replace" : "Siding Repair");
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 959:
                            // 959 Pointer Leads
                            switch ($project_nature){
                                case "Repair section(s) of siding":
                                    $pointerProjectNature = "Repair";
                                    break;
                                case "Replace existing siding":
                                    $pointerProjectNature = "Replace";
                                    break;
                                default:
                                    $pointerProjectNature = "Install";
                            }

                            switch ($type_of_siding){
                                case "Vinyl Siding":
                                    $projectType = "Vinyl";
                                    break;
                                case "Brickface Siding":
                                case "Stoneface Siding":
                                    $projectType = "Brick or Stone";
                                    break;
                                case "Composite wood Siding":
                                    $projectType = "Wood";
                                    break;
                                case "Aluminium Siding":
                                    $projectType = "Aluminum";
                                    break;
                                case "Fiber Cement Siding":
                                    $projectType = "Cement";
                                    break;
                                default:
                                    $projectType = "Metal";
                            }

                            $url_api.="&siding_service=$pointerProjectNature&siding_material=$projectType";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $service = ($project_nature == "Repair section(s) of siding" ? "Siding Vinyl Repair Sections of Siding" : "Siding Vinyl Replace Existing");
                                    break;
                                case "Brickface Siding" || "Stoneface Siding":
                                    $service = ($project_nature == "Repair section(s) of siding" ? "Siding Brickface Repair Sections of Siding" : "Siding Brickface Replace Existing");
                                    break;
                                case "Composite wood Siding":
                                    $service = ($project_nature == "Repair section(s) of siding" ? "Siding Composite Wood Repair Sections of Siding" : "Siding Composite Wood Replace Existing");
                                    break;
                                case "Aluminium Siding":
                                default:
                                    $service = ($project_nature == "Repair section(s) of siding" ? "Siding Aluminum Repair Sections of Siding" : "Siding Aluminum Replace Existing");
                            }

                            $url_api .= "&service=$service";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($type_of_siding){
                                case "Vinyl Siding":
                                    $siding_type = "Vinyl";
                                    break;
                                case "Brickface Siding" || "Stoneface Siding":
                                    $siding_type = "Brick or stone";
                                    break;
                                case "Composite wood Siding":
                                    $siding_type = "Wood";
                                    break;
                                default:
                                    $siding_type = "Other";
                            }

                            if ($project_nature == "Repair section(s) of siding") {
                                $category = "Siding Repair";
                                $siding_project_type = "Siding repair";
                            } else {
                                $category = "Siding Install/Replace";
                                $siding_project_type = "Replace siding";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $property_type = "Siding Project Type";

                            $url_api .= "&siding_type=$siding_type&siding_project_type=$siding_project_type&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time&project_type=$property_type";
                            break;
                    }
                    break;
                case 8:
                    //Kitchen
                    $service_kitchen = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                    switch ($crm_details['buyer_id']){
                        case 394:
                            //Advertising Results 394
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $service_kitchen_data = ($service_kitchen == 'Full Kitchen Remodeling' ? "Floor plan" : "Cabinets");
                            $property_type = "residential";
                            $time_frame = "Timing is Flexible";
                            $project_status = "Ready to Hire";
                            $best_call_time = "Any Time";
                            $cabinet_job = "Install new custom cabinets";

                            $url_api .= "&property_type=$property_type&time_frame=$time_frame&owner=$homeowner&project_status=$project_status&project_type=$service_kitchen_data&best_call_time=$best_call_time&cabinet_job=$cabinet_job";
                            break;
                        case 185:
                            //snk media group 185
                            $Trade = "10 - Kitchen Remodel";
                            $ProjectType = "10";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = "Kitchen Remodel";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $home_owner = "No";
                            $residential_commercia = "residential";
                            $category = "Kitchen";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Anytime";
                            $kitchen_project_type = "Cabinets";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($service_kitchen){
                                case 'Full Kitchen Remodeling':
                                    $category = "Kitchen Remodel - Full Remodel";
                                    break;
                                default:
                                    $category = "Kitchen Remodel - Partial Remodel";
                            }

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time&kitchen_project_type=$kitchen_project_type";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = "Kitchen Remodel";
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 959:
                            // 959 pointer leads
                            $service_kitchen_data = ($service_kitchen == 'Full Kitchen Remodeling' ? "Kitchen Full Remodel" : "Kitchen Cabinet Installation");
                            $url_api.="&kitchen_service=$service_kitchen_data";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $project = "J08-Kitchen Remodel";
                            $residential_commercia = "Residential";
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=J08";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($service_kitchen){
                                case "Full Kitchen Remodeling":
                                    $kitchenType = "Floor plan";
                                    $kitchen_cabinet_job="";
                                    break;
                                case "Cabinet Refacing":
                                    $kitchenType = "Cabinets";
                                    $kitchen_cabinet_job = "Reface existing cabinets";
                                    break;
                                case "Cabinet Install":
                                    $kitchenType = "Cabinets";
                                    $kitchen_cabinet_job = "Install new custom cabinets";
                                    break;
                            }

                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $property_type = "Other";
                            $best_call_time = "Any Time";
                            $project_time_frame = "Immediately";
                            $property_type_data = "Other";
                            $category = "Kitchen Remodel";
                            $estimate_timeline = "Timing Flexible";

                            $url_api .= "&kitchen_project_type=$service_kitchen&kitchen_cabinet_job=$kitchen_cabinet_job&homeowner=$homeowner&project_time_frame=$project_time_frame&best_call_time=$best_call_time&property_type=$property_type_data&category=$category";
                            break;
                    }
                    break;
                case 9:
                    //bathroom
                    $bathroom_type_name = trim($crm_details['data']['services']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 497:
                            //Airo Marketing Inc. 497
                            $Trade = "Bathroom - Remodel";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .= "&Trade=$Trade&Homeowner=$homeowner";
                            break;
                        case 22:
                            //Lead Cactus LLC bathroom 22
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Morning";
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-6 months";
                                    break;
                                default:
                                    $project_timeframe = "Don't know";
                            }

                            switch ($bathroom_type_name){
                                case "Full Remodel":
                                    $bathType = "bathroom_remodel";
                                    break;
                                case "Shower / Bath":
                                    $bathType = "shower_conversion";
                                    break;
                                default:
                                    $bathType = "other";
                            }

                            $url_api .= "&homeowner=$homeowner&start_date=$project_timeframe&project_type=$bathType&best_time=$best_time";
                            break;
                        case 185:
                            //snk media group 185
                            $Trade = "11 - Bathroom Remodel";
                            $ProjectType = "11";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = "Bathroom Remodel";
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Bathroom";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 636:
                            //The Lead Giant 636
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $property_type = "Single Family Home";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Unsure";
                                    break;
                                default:
                                    $project_timeframe = "1-2 Weeks";
                            }

                            switch($bathroom_type_name){
                                case "Full Remodel":
                                    $bathroom_type = "Full Bathroom";
                                    break;
                                case "Shower / Bath":
                                    $bathroom_type = "Shower or Bath";
                                    break;
                                case "Sinks":
                                    $bathroom_type = "Sink";
                                    break;
                                case "Flooring":
                                    $bathroom_type = "Tile";
                                    break;
                                default:
                                    $bathroom_type = "Other";
                            }

                            $url_api .= "&homeowner=$homeowner&property_type=$property_type&project_timeframe=$project_timeframe&project_type=$bathroom_type";
                            break;
                        case 723:
                            //Biz Focused 723
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $lead_age = "Live solar leads";

                            $url_api .= "&home_owner=$homeowner&lead_age=$lead_age";
                            break;
                        case 303:
                            //TradeMarc Global LLC 303
                            switch($bathroom_type_name){
                                case "Toilet":
                                    $bathroom_type = "toilet";
                                    break;
                                case "Shower / Bath":
                                    $bathroom_type = "shower_bath";
                                    break;
                                case "Sinks":
                                    $bathroom_type = "sinks";
                                    break;
                                case "Flooring":
                                    $bathroom_type = "flooring";
                                    break;
                                case "Cabinets / Vanity":
                                    $bathroom_type = "cabinets_vanity";
                                    break;
                                case "Countertops":
                                    $bathroom_type = "countertops";
                                    break;
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = "immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1_6_months";
                                    break;
                                default:
                                    $project_timeframe = "not_sure";
                            }
                            $residence_type = "residential";

                            $url_api .= "&service_type=$bathroom_type&time_frame=$project_timeframe&property_type=$residence_type";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Anytime";
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($bathroom_type_name){
                                case "Full Remodel":
                                    $bathType = "Full bathroom";
                                    $category = "Bathroom Remodel - Complete Remodel";
                                    break;
                                case "Shower / Bath":
                                    $bathType = "Bath, sinks";
                                    $category = "Bathroom Remodel - Shower Install or Upgrade";
                                    break;
                                case "Flooring":
                                    $bathType = "Tile";
                                    $category = "Bathroom Remodel - Vanity, Fixtures, Sinks, Toilets, other";
                                    break;
                                default:
                                    $bathType = "Bath, sinks";
                                    $category = "Bathroom Remodel - Vanity, Fixtures, Sinks, Toilets, other";
                            }

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time&remove_walls=No&bathroom_type=$bathType";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($bathroom_type_name){
                                case "Shower / Bath":
                                case "Sinks":
                                    $bathroom_type_data = "Bath, sinks";
                                    break;
                                case "Flooring":
                                    $bathroom_type_data = "Tile";
                                    break;
                                case "Full Remodel":
                                default:
                                    $bathroom_type_data = "Full bathroom";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $category = "Bathroom Remodel";
                            $best_call_time = "Any Time";
                            $project_type = "Bathroom Project Type";
                            $property_type = "Other";

                            $url_api .= "&bathroom_project_type=$bathroom_type_data&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time&project_type=$project_type&property_type=$property_type";
                            break;
                        case 959:
                            // 959 pointer leads
                            switch ($bathroom_type_name){
                                case "Shower / Bath":
                                    $bathroom_servicePointer = "Bath/Shower Updates";
                                    break;
                                case "Full Remodel":
                                default:
                                    $bathroom_servicePointer = "Full Bathroom Remodel";
                            }
                            $url_api.="&bathroom_service=$bathroom_servicePointer";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            switch ($start_time){
                                case "Immediately":
                                    $start_time_data = "Immediate";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "More Than 1 Month";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $url_api.="&remodeling_project=Bathroom_Remodeling&time_frame=$start_time_data&home_owner=$homeowner";
                            break;
                        case 394:
                            //Advertising Results 394
                            switch ($bathroom_type_name){
                                case "Flooring":
                                    $product_needs = "New Flooring";
                                    break;
                                case "Shower / Bath":
                                    $product_needs = "Shower Install";
                                    break;
                                case "Sinks":
                                    $product_needs = "Sink Install";
                                    break;
                                case "Toilet":
                                    $product_needs = "Toilet Install";
                                    break;
                                case "Cabinets / Vanity":
                                    $product_needs = "Cabinets";
                                    break;
                                case "Countertops":
                                    $product_needs = "Countertops";
                                    break;
                                default:
                                    $product_needs = "Full Remodel";
                            }

                            switch ($start_time) {
                                case "Immediately":
                                    $start_time_data = "1-2 Weeks";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "5-6 Weeks";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }
                            $service_type = "Remodel";
                            $project_status = "Ready to Hire";
                            $property_type = "Other";
                            $credit_rating = "Good";
                            $best_time_to_call = "Any Time";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .= "&service_type=$service_type&product_needs=$product_needs&project_time_frame=$start_time_data&project_status=$project_status&property_type=$property_type&credit_rating=$credit_rating&best_time_to_call=$best_time_to_call&owner=$homeowner";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = "Bathroom Remodel";
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $project = "J08-Bathroom Remodel";
                            $residential_commercia = "Residential";
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=J08";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            $service = "Bath Remodel no walls added or removed";

                            $url_api .= "&service=$service";
                            break;
                        case 1240:
                            //Rexdirect 1240
                            $homeowner = ($ownership == "Yes" ? "Y" : "N");
                            $credit_rating = "Good";
                            $best_time_to_call = "Morning";

                            $remodel_scope = "N";
                            $bath = "N";
                            $toilet = "N";
                            $cabinet = "N";
                            $sinks = "N";
                            $flooring = "N";
                            $countertop = "N";
                            $business = "N";
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 month";
                            }

                            switch ($bathroom_type_name){
                                case "Full Remodel":
                                    $bath = "Y";
                                    $toilet = "Y";
                                    $cabinet = "Y";
                                    $sinks = "Y";
                                    $flooring = "Y";
                                    $countertop = "Y";
                                    $business = "Y";
                                    break;
                                case "Cabinets / Vanity":
                                    $cabinet = "Y";
                                    break;
                                case "Countertops":
                                    $countertop = "Y";
                                    break;
                                case "Flooring":
                                    $flooring = "Y";
                                    break;
                                case "Shower / Bath":
                                    $bath = "Y";
                                    break;
                                case "Sinks":
                                    $sinks = "Y";
                                    break;
                            }

                            $url_api .= "&own_home=$homeowner&when=$project_timeframe&remodel_scope=$remodel_scope&best_time_to_call=$best_time_to_call&credit_rating=$credit_rating&bath=$bath&toilet=$toilet&cabinet=$cabinet&sinks=$sinks&flooring=$flooring&countertop=$countertop&business=$business&tcpa_consent_lang=$TCPAText&tcpa_consent=$tcpa_compliant&landing_page_url=$OriginalURL2";
                            break;
                        case 1249:
                            // 1249 Lead2contractors
                            $url_api .= "&install_repair=install";
                            break;
                        case 1303:
                            // 1303	Solar Direct Marketing
                            $url_api .= "&repair_or_replace=Replace";
                            break;
                    }
                    break;
                case 11:
                    //Furnace
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $type_of_heating = trim($crm_details['data']['type_of_heating']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $ProjectType = ($project_nature == "Repair" ? "5" : "13");
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;
                            $AirType = "3";

                            switch ($type_of_heating){
                                case "Natural Gas":
                                    $system_type = "6";
                                    break;
                                case "Oil":
                                    $system_type = "8";
                                    break;
                                case "Electric":
                                    $system_type = "9";
                                    break;
                                case "Propane Gas":
                                    $system_type = "7";
                                    break;
                                default:
                                    $system_type = "5";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner&HVACSystemType=$system_type&AirType=$AirType";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Repair" ? "Furnace/Heating System - Repair/Service" : "Furnace/Heating System - Install/Replace");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Furnace";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Anytime";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $category = ($project_nature == "Repair" ? "HVAC Repair - Furnace/Heating System" : "HVAC Install - Furnace/Heating System");

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 394:
                            //Advertising Results 394
                            switch ($start_time) {
                                case "Immediately":
                                    $start_time_data = "1-2 Weeks";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "5-6 Weeks";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            $service_type = ($project_nature == "Repair" ? "furnaces_repair" : "furnaces_new_install");
                            $project_type = ($project_nature == "Repair" ? "Repair" : "New install");
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $air_type = "Heating";

                            $url_api .= "&air_type=$air_type&project_type=$project_type&service_type=$service_type&property_type=residential&time_frame=$start_time_data&project_status=Ready to Hire&best_time_to_call=Anytime&owner=$homeowner";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = ($project_nature == "Repair" ? "Furnace Heating System Repair Service" : "Furnace Heating System Install Replace");
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 303:
                            // TradeMarc Global LLC 303
                            switch ($type_of_heating){
                                case "Natural Gas":
                                    $Heat_Type = "Gas furnace";
                                    $HVAC_System_Type = "Gas furnace";
                                    break;
                                case "Oil":
                                    $Heat_Type = "Oil furnace";
                                    $HVAC_System_Type = "Oil furnace";
                                    break;
                                case "Electric":
                                    $Heat_Type = "Electric furnace";
                                    $HVAC_System_Type = "Electric furnace";
                                    break;
                                case "Propane Gas":
                                default:
                                    $Heat_Type = "Propane furnace";
                                    $HVAC_System_Type = "Propane furnace";
                            }

                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "1-6 months";
                                    break;
                                case "Not Sure":
                                    $time_frame = "don't know";
                                    break;
                            }

                            $Scope = ($project_nature == "Repair" ? "repair_boiler_furnace" : "install_boiler_furnace");
                            $HVAC_Project_Type = ($project_nature == "Repair" ? "Repair" : "Install");
                            $HVAC_Air_Type = "Heating";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .="&scope=$Scope&hvac_project_type=$HVAC_Project_Type&hvac_air_type=$HVAC_Air_Type&hvac_system_type=$HVAC_System_Type&timeframe=$time_frame&own_home=$homeowner&heat_type=$Heat_Type";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $residential_commercia = "Residential";
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            switch ($type_of_heating) {
                                case "Oil":
                                    $project = ($project_nature == "Repair" ? "F05-Oil Furnace / Forced Air Heating System - Repair" : "F05-Oil Furnace / Forced Air Heating System - Install");
                                    break;
                                case "Electric":
                                    $project = ($project_nature == "Repair" ? "F05-Electric Furnace / Forced Air Heating System - Repair" : "F05-Electric Furnace / Forced Air Heating System - Install");
                                    break;
                                case "Propane Gas":
                                case "Natural Gas":
                                default:
                                    $project = ($project_nature == "Repair" ? "F05-Gas Furnace / Forced Air Heating System - Repair" : "F05-Gas Furnace / Forced Air Heating System - Install");
                            }

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=F05";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            if ($project_nature == "Repair") {
                                $category = "Furnace/Heating System - Repair/Service";
                                $hvac_project_type = "Repair";
                            } else {
                                $category = "Furnace/Heating System - Install/Replace";
                                $hvac_project_type = "New unit installed";
                            }

                            switch ($type_of_heating){
                                case "Natural Gas":
                                    $hvac_system_type = "Gas furnace";
                                    break;
                                case "Oil":
                                    $hvac_system_type = "Oil furnace";
                                    break;
                                case "Electric":
                                    $hvac_system_type = "Electric furnace";
                                    break;
                                case "Propane Gas":
                                default:
                                    $hvac_system_type = "Propane furnace";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $hvac_air_type = "Heating";
                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $project_type = "HVAC Project Type";

                            $url_api .= "&project_type=$project_type&hvac_air_type=$hvac_air_type&hvac_system_type=$hvac_system_type&hvac_project_type=$hvac_project_type&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time";
                            break;
                    }
                    break;
                case 12:
                    //Boiler
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $type_of_heating = trim($crm_details['data']['type_of_heating']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $ProjectType = ($project_nature == "Repair" ? "5" : "13");
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;
                            $AirType = "3";

                            switch ($type_of_heating){
                                case "Natural Gas" || "Propane Gas":
                                    $system_type = "2";
                                    break;
                                case "Electric":
                                    $system_type = "3";
                                    break;
                                default:
                                    $system_type = "5";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner&HVACSystemType=$system_type&AirType=$AirType";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Repair" ? "Boiler Repair/Service" : "Boiler Install/Replace");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Boiler";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Anytime";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $category = ($project_nature == "Repair" ? "HVAC Repair - Boiler" : "HVAC Install - Boiler");

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 394:
                            //Advertising Results 394
                            switch ($start_time) {
                                case "Immediately":
                                    $start_time_data = "1-2 Weeks";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "5-6 Weeks";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            $service_type = ($project_nature == "Repair" ? "boilers_and_radiators_repair" : "boilers_and_radiators_new_install");
                            $project_type = ($project_nature == "Repair" ? "Repair" : "New install");
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $air_type = "Heating";

                            $url_api .= "&air_type=$air_type&project_type=$project_type&service_type=$service_type&property_type=residential&time_frame=$start_time_data&project_status=Ready to Hire&best_time_to_call=Anytime&owner=$homeowner";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = ($project_nature == "Repair" ? "Boiler Repair Service" : "Boiler Install Replace");
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 303:
                            // TradeMarc Global LLC 303
                            switch ($type_of_heating){
                                case "Natural Gas":
                                    $Heat_Type = "Gas boiler";
                                    $HVAC_System_Type = "Gas boiler";
                                    break;
                                case "Oil":
                                    $Heat_Type = "Oil boiler";
                                    $HVAC_System_Type = "Oil boiler";
                                    break;
                                case "Electric":
                                    $Heat_Type = "Electric boiler";
                                    $HVAC_System_Type = "Electric boiler";
                                    break;
                                case "Propane Gas":
                                default:
                                    $Heat_Type = "Propane boiler";
                                    $HVAC_System_Type = "Propane boiler";
                            }

                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "1-6 months";
                                    break;
                                case "Not Sure":
                                    $time_frame = "don't know";
                                    break;
                            }

                            $Scope = ($project_nature == "Repair" ? "repair_boiler_furnace" : "install_boiler_furnace");
                            $HVAC_Project_Type = ($project_nature == "Repair" ? "Repair" : "Install");
                            $HVAC_Air_Type = "Heating";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .="&scope=$Scope&hvac_project_type=$HVAC_Project_Type&hvac_air_type=$HVAC_Air_Type&hvac_system_type=$HVAC_System_Type&timeframe=$time_frame&own_home=$homeowner&heat_type=$Heat_Type";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $residential_commercia = "Residential";
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            switch ($type_of_heating) {
                                case "Oil":
                                    $project = ($project_nature == "Repair" ? "F05-Oil Boiler or Radiator Heating System - Repair" : "F05-Oil Boiler or Radiator Heating System - Install");
                                    break;
                                case "Electric":
                                    $project = ($project_nature == "Repair" ? "F05-Electric Boiler or Radiator Heating System - Repair" : "F05-Electric Boiler or Radiator Heating System - Install");
                                    break;
                                case "Propane Gas":
                                case "Natural Gas":
                                default:
                                    $project = ($project_nature == "Repair" ? "F05-Gas Boiler or Radiator Heating System - Repair" : "F05-Gas Boiler or Radiator Heating System - Install");
                            }

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=F05";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            if ($project_nature == "Repair") {
                                $category = "Boiler Repair";
                                $hvac_project_type = "Repair";
                            } else {
                                $category = "Boiler Install";
                                $hvac_project_type = "New unit installed";
                            }

                            switch ($type_of_heating){
                                case "Natural Gas":
                                    $hvac_system_type = "Gas boiler";
                                    break;
                                case "Oil":
                                    $hvac_system_type = "Oil boiler";
                                    break;
                                case "Electric":
                                    $hvac_system_type = "Electric boiler";
                                    break;
                                case "Propane Gas":
                                default:
                                    $hvac_system_type = "Propane boiler";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $hvac_air_type = "Heating";
                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $project_type = "HVAC Project Type";

                            $url_api .= "&project_type=$project_type&hvac_air_type=$hvac_air_type&hvac_system_type=$hvac_system_type&hvac_project_type=$hvac_project_type&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time";
                            break;
                    }
                    break;
                case 13:
                    //Central A/C
                    $project_nature = trim($crm_details['data']['project_nature']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $ProjectType = ($project_nature == "Repair" ? "5" : "13");
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;
                            $AirType = "3";
                            $system_type = "1";

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner&HVACSystemType=$system_type&AirType=$AirType";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Repair" ? "Central A/C - Repair/Service" : "Central A/C - Install/Replace");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Central A/C";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Anytime";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            $category = ($project_nature == "Repair" ? "HVAC Repair - Central A/C" : "HVAC Install - Central A/C");

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 394:
                            //Advertising Results 394
                            switch ($start_time) {
                                case "Immediately":
                                    $start_time_data = "1-2 Weeks";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "5-6 Weeks";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            $service_type = ($project_nature == "Repair" ? "central_air_repair" : "central_air_new_install");
                            $project_type = ($project_nature == "Repair" ? "Repair" : "New install");
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $air_type = "Heating and Cooling";

                            $url_api .= "&air_type=$air_type&project_type=$project_type&service_type=$service_type&property_type=residential&time_frame=$start_time_data&project_status=Ready to Hire&best_time_to_call=Anytime&owner=$homeowner";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = ($project_nature == "Repair" ? "Central A/C Repair Service" : "Central A/C Install Replace");
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 959:
                            // 959 pointer leads
                            $HVACType = "Central A/C";
                            $type_of_work = ($project_nature == "Repair" ? "Repair" : "Install");
                            $url_api.="&hvac_service=$type_of_work&hvac_system_type=$HVACType";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            $service = ($project_nature == "Repair" ? "HVAC Repair Central AC" : "HVAC Install Central AC");
                            $url_api .= "&service=$service";
                            break;
                        case 303:
                            // TradeMarc Global LLC 303
                            switch ($start_time){
                                case "Immediately":
                                    $time_frame = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $time_frame = "1-6 months";
                                    break;
                                case "Not Sure":
                                    $time_frame = "don't know";
                                    break;
                            }

                            $Heat_Type = "Central AC";
                            $HVAC_System_Type = "Central AC";
                            $Scope = ($project_nature == "Repair" ? "repair_central_ac" : "install_central_ac");
                            $HVAC_Project_Type = ($project_nature == "Repair" ? "Repair" : "Install");
                            $HVAC_Air_Type = "Heating and Cooling";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .="&scope=$Scope&hvac_project_type=$HVAC_Project_Type&hvac_air_type=$HVAC_Air_Type&hvac_system_type=$HVAC_System_Type&timeframe=$time_frame&own_home=$homeowner&heat_type=$Heat_Type";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $residential_commercia = "Residential";
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");
                            $project = ($project_nature == "Repair" ? "F05-Central A/C - Repair/Service" : "F05-Central A/C - Install/Replace");

                            $url_api .= "&project=$project&property_type=$residential_commercia&homeowner=$homeowner&contractor_ID=F05";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            if ($project_nature == "Repair") {
                                $category = "Central A/C - Repair/Service";
                                $hvac_project_type = "Repair";
                            } else {
                                $category = "Central A/C - Install/Replace";
                                $hvac_project_type = "New unit installed";
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $hvac_system_type = "Central AC";
                            $hvac_air_type = "Heating and cooling";
                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $project_type = "HVAC Project Type";

                            $url_api .= "&project_type=$project_type&hvac_air_type=$hvac_air_type&hvac_system_type=$hvac_system_type&hvac_project_type=$hvac_project_type&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time";
                            break;
                    }
                    break;
                case 14:
                    //Cabinet
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    switch ($crm_details['service_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "18 - Cabinets";
                            $ProjectType = "18";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Cabinet Refacing" ? "Cabinets/Drawers Repair" : "Cabinets/Drawers Installation");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");

                            $residential_commercia = "residential";
                            $category = "Cabinets";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                    }
                    break;
                case 16:
                    //Bathtubs
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 497:
                            //Airo Marketing Inc. 497
                            $Trade = "Bathroom - Bathtub to Shower Conversion";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $url_api .= "&Trade=$Trade&Homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = "Bathtub/Shower - Install/Replace";
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Bathtub/Shower";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = "Bathtub Shower Install Replace";
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                    }
                    break;
                case 18:
                    //Handyman
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "25 - Handyman";
                            $ProjectType = "25";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = "Handyman";
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Handyman";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = "Handyman";
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                    }
                    break;
                case 20:
                    //Doors
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "20 - Doors";
                            $ProjectType = "20";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Repair" ? "Door Repair" : "Door Install");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Doors";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                    }
                    break;
                case 21:
                    //Gutter
                    $service = trim($crm_details['data']['service']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $Trade = "24 - Gutter";
                            $ProjectType = "24";
                            $homeowner = ($ownership == "Yes" ? "1" : "0");
                            $residential = 1;

                            switch ($start_time){
                                case 'Immediately':
                                    $start_time_data = "1";
                                    break;
                                case 'Not Sure':
                                    $start_time_data = "2";
                                    break;
                                default:
                                    $start_time_data = "4";
                            }

                            $url_api .= "&projectType=$ProjectType&timeframe=$start_time_data&residential=$residential&homeowner=$homeowner";
                            break;
                        case 540:
                            //pbtp Powered by The People LLC 540
                            $type_of_work = ($project_nature == "Repair" ? "Gutter Repair" : "Gutter Install/Replace");
                            $home_owner = ($ownership == "Yes" ? "Yes" : "No");
                            $residential_commercia = "residential";
                            $category = "Gutters";

                            $url_api .= "&type_of_work=$type_of_work&home_owner=$home_owner&residential_commercia=$residential_commercia&category=$category";
                            break;
                        case 546:
                            //Remodel Well 546
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $best_time = "Morning";

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "1-3 months";
                                    break;
                                default:
                                    $project_timeframe = "Within 1 months";
                            }

                            switch ($service){
                                case "Galvanized Steel":
                                    $category = ($project_nature == "Repair" ? "Gutters Repair - Galvanized" : "Gutters Install - Galvanized");
                                    break;
                                case "PVC":
                                    $category = ($project_nature == "Repair" ? "Gutters Repair - PVC" : "Gutters Install - PVC");
                                    break;
                                case "Seamless Aluminum":
                                    $category = ($project_nature == "Repair" ? "Gutters Repair - Seamless Metal" : "Gutters Install - Seamless Metal");
                                    break;
                                case "Wood":
                                    $category = ($project_nature == "Repair" ? "Gutters Repair - Wood" : "Gutters Install - Wood");
                                    break;
                                default:
                                    $category = ($project_nature == "Repair" ? "Gutters Repair - Galvanized" : "Gutters Install - Galvanized");
                            }

                            $url_api .= "&homeowner=$homeowner&timeframe=$project_timeframe&category=$category&best_time_to_call=$best_time";
                            break;
                        case 974:
                            // 974 OnCore Leads
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $location = ($ownership == "Yes" ? "Residential" : "Commercial");
                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediate";
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = "More Than 1 Month";
                                    break;
                                default:
                                    $project_timeframe = "Timing is Flexible";
                            }
                            switch ($service){
                                case "Galvanized Steel":
                                    $category = ($project_nature == "Repair" ? "Galvanized Gutters - Repair" : "Galvanized Gutters - Install");
                                    break;
                                case "PVC":
                                    $category = ($project_nature == "Repair" ? "PVC Gutters - Repair" : "PVC Gutters - Install");
                                    break;
                                case "Seamless Aluminum":
                                    $category = ($project_nature == "Repair" ? "Seamless Metal Gutters - Repair" : "Seamless Metal Gutters - Install");
                                    break;
                                case "Wood":
                                    $category = ($project_nature == "Repair" ? "Wood Gutters - Repair" : "Wood Gutters - Install");
                                    break;
                                case "Copper":
                                    $category = ($project_nature == "Repair" ? "Copper Gutters - Repair" : "Copper Gutters - Install");
                                    break;
                                default:
                                    $category = ($project_nature == "Repair" ? "Gutter Cleaning" : "Install or Replace Gutter Covers and Protection");
                            }

                            $url_api.="&home_owner=$homeowner&time_frame=$project_timeframe&type_of_project=$category&location=$location";
                            break;
                        case 394:
                            //Advertising Results 394
                            switch ($start_time) {
                                case "Immediately":
                                    $start_time_data = "1-2 Weeks";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "5-6 Weeks";
                                    break;
                                default:
                                    $start_time_data = "Timing is Flexible";
                            }

                            $service_type = ($project_nature == "Repair" ? "repair" : "install");
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($service) {
                                case "Galvanized Steel":
                                    $product_type = "Galvanized";
                                    break;
                                case "PVC":
                                    $product_type = "PVC";
                                    break;
                                case "Seamless Aluminum":
                                    $product_type = "Seamless Metal";
                                    break;
                                default:
                                    $product_type = "other";
                            }

                            $url_api .= "&product_type=$product_type&service_type=$service_type&property_type=Residential&time_frame=$start_time_data&best_time_to_call=Anytime&owner=$homeowner";
                            break;
                        case 1025:
                            //MILI Group LLC 1025
                            $type_of_work = ($project_nature == "Repair" ? "Gutter Repair" : "Gutter Install Replace");
                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $url_api .= "&Project=$type_of_work&home_owner=$homeowner";
                            break;
                        case 1045:
                            //UptownLeads LLC  1045
                            switch ($service){
                                case "Galvanized Steel":
                                    $service = ($project_nature == "Repair" ? "Gutters Galvanized Repair Home" : "Gutters Galvanized Install Home");
                                    break;
                                case "PVC":
                                    $service = ($project_nature == "Repair" ? "Gutters PVC Repair Home" : "Gutters PVC Install Home");
                                    break;
                                case "Seamless Aluminum":
                                    $service = ($project_nature == "Repair" ? "Gutters Seamless Metal Repair Home" : "Gutters Seamless Metal Install Home");
                                    break;
                                case "Wood":
                                    $service = ($project_nature == "Repair" ? "Gutters Wood Repair Home" : "Gutters Wood Install Home");
                                    break;
                                case "Copper":
                                    $service = ($project_nature == "Repair" ? "Gutters Copper Repair Home" : "Gutters Copper Install Home");
                                    break;
                                default:
                                    $service = ($project_nature == "Repair" ? "Gutters Galvanized Repair Home" : "Gutters Galvanized Install Home");
                            }

                            $url_api .= "&service=$service";
                            break;
                        case 939:
                            //939 Turtle Leads LLC
                            switch ($service){
                                case "Galvanized Steel":
                                    $category = ($project_nature == "Repair" ? "Galvanized Gutters - Repair" : "Galvanized Gutters - Install");
                                    break;
                                case "PVC":
                                    $category = ($project_nature == "Repair" ? "PVC Gutters - Repair" : "PVC Gutters - Install");
                                    break;
                                case "Seamless Aluminum":
                                    $category = ($project_nature == "Repair" ? "Seamless Metal Gutters - Repair" : "Seamless Metal Gutters - Install");
                                    break;
                                case "Wood":
                                    $category = ($project_nature == "Repair" ? "Wood Gutters - Repair" : "Wood Gutters - Install");
                                    break;
                                default:
                                    $category = ($project_nature == "Repair" ? "Gutter Repair" : "Gutter Install/Replace");
                            }

                            switch ($start_time){
                                case 'Immediately':
                                    $project_timeframe = "Immediately";
                                    break;
                                case 'Not Sure':
                                    $project_timeframe = "Within 1 months";
                                    break;
                                default:
                                    $project_timeframe = "1-3 months";
                            }

                            $homeowner = ($ownership == "Yes" ? "True" : "False");
                            $best_call_time = "Any Time";
                            $gutter_protection = False;
                            $property_type = "Other";

                            $url_api .= "&gutter_protection=$gutter_protection&category=$category&homeowner=$homeowner&project_time_frame=$project_timeframe&best_call_time=$best_call_time&property_type=$property_type";
                            break;
                    }
                    break;
                case 23:
                    //Painting
                    $service = trim($crm_details['data']['service']);

                    switch ($crm_details['buyer_id']){
                        case 959:
                            // 959 pointer leads
                            switch ($service) {
                                case "Exterior Home or Structure - Paint or Stain":
                                    $painting_service = "Exterior Painting - Whole House";
                                    break;
                                case "Interior Home or Surfaces - Paint or Stain":
                                    $rooms_number = trim($crm_details['data']['rooms_number']);
                                    switch ($rooms_number) {
                                        case "1-2":
                                            $painting_service = "Interior Painting - 1 to 2 Rooms";
                                            break;
                                        default:
                                            $painting_service = "Interior Painting - 3+ Rooms";
                                    }
                                    break;
                                case "Painting or Staining - Small Projects":
                                default:
                                    $painting_service = "Paint/Stain - Deck/Fence/Porch";
                            }

                            $url_api.="&painting_service=$painting_service";
                            break;
                    }
                    break;
                case 24:
                    //Auto Insurance
                    $VehicleYear = trim($crm_details['data']['VehicleYear']);
                    $VehicleMake = trim($crm_details['data']['VehicleMake']);
                    $car_model = trim($crm_details['data']['car_model']);
                    $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                    $driversNum = trim($crm_details['data']['driversNum']);
                    $birthday = trim($crm_details['data']['birthday']);
                    $genders = trim($crm_details['data']['genders']);
                    $married = trim($crm_details['data']['married']);
                    $license = trim($crm_details['data']['license']);
                    $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                    $driver_experience = trim($crm_details['data']['driver_experience']);
                    $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                    $DUI_charges = trim($crm_details['data']['DUI_charges']);
                    $SR_22_need = trim($crm_details['data']['SR_22_need']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    switch ($crm_details['buyer_id']){
                        case 185:
                            //snk media group 185
                            $married_data = ( $married == "Yes" ? "Married" : "Single" );
                            $license_data = ( $license == "Yes" ? "Active" : "Expired" );
                            $filing_required = ( $SR_22_need == "Yes" ? "SR-22" : "None" );
                            $ownership_data = ( $ownership == "Yes" ? "Own" : "Rent" );
                            $tickets_accidents_claims = ( $driver_experience == "Yes" ? "No" : "Yes" );
                            $DUI_charges_data = ( $DUI_charges == "Yes" ? "Yes" : "No" );
                            $birthday = date("m/d/Y", strtotime($birthday));

                            $url_api .= "&dob=$birthday&gender=$genders&marital_status=$married_data&credit_rating=Good&license_status=$license_data&licensed_state=$state&age_when_first_licensed=19&filing_required=$filing_required&education=Unknown&Occupation=Other/Not Listed&current_residence=$ownership_data&tickets_accidents_claims=$tickets_accidents_claims&insured_past_30_days=Yes&insurance_company=$InsuranceCarrier&bankruptcy_in_past_5_years=No&additional_drivers=$driversNum&additional_vehicles=$more_than_one_vehicle&reposessions=Unknown&dui_dwi=$DUI_charges_data&vehicle_year=$VehicleYear&vehicle_make=$VehicleMake&vehicle_model=$car_model&vehicle_ownership=Owned&vehicle_primary_use=Commute To/From Work&vehicle_one_way_mileage=15&vehicle_annual_mileage=20000&vehicle_parking=Private Garage&vehicle_days_per_week_used=6&vehicle_collision_coverage=No Coverage&vehicle_comprehensive_coverage=No Coverage";
                            break;
                        case 276:
                            //ETN AMERICA 276
                            $married_data = ( $married == "Yes" ? "Married" : "Single" );
                            $filing_required = ( $SR_22_need == "Yes" ? "SR22 Required" : "SR22 NOT required" );
                            $ownership_data = ( $ownership == "Yes" ? "Own" : "Rent" );
                            $birthday = date("m/d/Y", strtotime($birthday));
                            $have_insurance = ($InsuranceCarrier == "Not Currently Insured" ? "No" : "Yes");
                            $continuously_insured_period = ($InsuranceCarrier == "Not Currently Insured" ? "Not Currently Insured" : "1 Year");
                            $current_policy_start_date = date("m/d/Y");

                            $url_api .= "&dob=$birthday&bankruptcy=No&credit_rating=Good&have_insurance=$have_insurance&continuously_insured_period=$continuously_insured_period&coverage_type=Standard&insurance_company=$InsuranceCarrier&residence_type=$ownership_data&driver1_gender=$genders&driver1_marital_status=$married_data&driver1_occupation=Unknown&driver1_education=Other&driver1_required_sr22=$filing_required&vehicle1_year=$VehicleYear&vehicle1_make=$VehicleMake&vehicle1_model=$car_model&vehicle1_vehicle_ownership=Owned&current_policy_start_date=$current_policy_start_date&current_policy_expiration_date=$current_policy_start_date&years_at_residence=3&months_at_residence=4&vehicle1_collision_deductible=$0&vehicle1_comprehensive_deductible=$0&vehicle1_annual_mileage=18,001 to 25,000 miles&vehicle1_daily_mileage=up to 19 miles&vehicle1_primary_use=Commute Work&vehicle1_sub_model=$car_model";
                            break;
                    }
                    break;
                case 25:
                    //home Insurance
                    $house_type = trim($crm_details['data']['house_type']);
                    $Year_Built = trim($crm_details['data']['Year_Built']);
                    $primary_residence = trim($crm_details['data']['primary_residence']);
                    $new_purchase = trim($crm_details['data']['new_purchase']);
                    $previous_insurance_within_last30 = trim($crm_details['data']['previous_insurance_within_last30']);
                    $previous_insurance_claims_last3yrs = trim($crm_details['data']['previous_insurance_claims_last3yrs']);
                    $married = trim($crm_details['data']['married']);
                    $credit_rating = trim($crm_details['data']['credit_rating']);
                    $birthday = trim($crm_details['data']['birthday']);

                    switch ($crm_details['buyer_id']){
                        case 276:
                            //ETN AMERICA 276
                            $birthday = date("m/d/Y", strtotime($birthday));
                            $occupancy = ( $primary_residence == "Yes" ? "Primary Residence" : "Seasonal Residence" );

                            switch($house_type){
                                case "Apartment":
                                    $property_type = "Condominium";
                                    break;
                                case "Condo/TownHouse":
                                    $property_type = "Townhome";
                                    break;
                                case "Duplex":
                                    $property_type = "Duplex";
                                    break;
                                default:
                                    $property_type = "Single Family";
                            }

                            $url_api .= "&dob=$birthday&credit=$credit_rating&currently_insured=$previous_insurance_within_last30&property_type=$property_type&occupancy=$occupancy&garage=Other&foundation=Other&year_built=$Year_Built&construction_type=Other&roof_type=Other&heating_type=Unknown&indoor_sprinklers=Yes&central_air_conditioning=Yes&claims=None&coverage_type=Full Package&liability=500000&deductible=500&current_coverage_type=Full Package&current_insurance_company=Other&stories=2&bedrooms=3&bathrooms=2&home_value=150000&smoke_alarm=Yes";
                            break;
                    }
                    break;
                case 26:
                    //Life Insurance
                    $Height = trim($crm_details['data']['Height']);
                    $weight = trim($crm_details['data']['weight']);
                    $birthday = trim($crm_details['data']['birthday']);
                    $genders = trim($crm_details['data']['genders']);
                    $amount_coverage = trim($crm_details['data']['amount_coverage']);
                    $military_personnel_status = trim($crm_details['data']['military_personnel_status']);
                    $military_status = trim($crm_details['data']['military_status']);
                    $service_branch = trim($crm_details['data']['service_branch']);

                    switch ($crm_details['buyer_id']){
                        case 276:
                            //ETN AMERICA 276
                            $birthday = date("m/d/Y", strtotime($birthday));
                            $Height_data = str_replace("'", "", $Height);
                            $Height_data = str_replace('"', "", $Height_data);
                            $Height_data = explode(" " , $Height_data);
                            $height_feet = $Height_data[0];
                            $height_inches = $Height_data[1];
                            $weight = (int) filter_var($weight, FILTER_SANITIZE_NUMBER_INT);
                            $amount_coverage = (int) filter_var($amount_coverage, FILTER_SANITIZE_NUMBER_INT);

                            $url_api .= "&dob=$birthday&gender=$genders&occupation=Unknown&education_level=Other&height_feet=$height_feet&height_inches=$height_inches&weight=$weight&insurance_amount=$amount_coverage&coverage_term=Not Sure&residence_type=Own&years_at_residence=2&months_at_residence=5&student=No&marital_status=Married&dui=No&previously_denied=No&expectant_parent=No&is_smoker=No&relative_heart=No&relative_cancer=No&requested_coverage_type=Unsure Life&have_insurance=No&treated=Other&policy_for=Other&current_coverage_type=Unsure Life&current_insurance_company=Other&hospitalized=No&ongoing_medical_treatment=No&hazard_pilot=No&hazard_felony=No";
                            break;
                    }
                    break;
                case 29:
                    //Health Insurance
                    $gender = trim($crm_details['data']['gender']);
                    $birthday = trim($crm_details['data']['birthday']);
                    $pregnancy = trim($crm_details['data']['pregnancy']);
                    $tobacco_usage = trim($crm_details['data']['tobacco_usage']);
                    $health_conditions = trim($crm_details['data']['health_conditions']);
                    $number_of_people_in_household = trim($crm_details['data']['number_of_people_in_household']);
                    $addPeople = trim($crm_details['data']['addPeople']);
                    $annual_income = trim($crm_details['data']['annual_income']);

                    switch ($crm_details['buyer_id']){
                        case 276:
                            //ETN AMERICA 276
                            $birthday = date("m/d/Y", strtotime($birthday));
                            $requested_coverage_type = str_replace('&quot;', "", $addPeople);
                            $requested_coverage_type = str_replace('[', "", $requested_coverage_type);
                            $requested_coverage_type = str_replace(']', "", $requested_coverage_type);
                            $requested_coverage_type = str_replace(']', "", $requested_coverage_type);
                            $requested_coverage_type = str_replace('\\', "", $requested_coverage_type);
                            $requested_coverage_type_bool = "Individual Plan";
                            if(str_contains($requested_coverage_type, 'With Spouse') || str_contains($requested_coverage_type, 'With Child/Children')){
                                $requested_coverage_type_bool = "Family Plan";
                            }

                            $url_api .= "&dob=$birthday&gender=$gender&occupation=Unknown&education_level=Other&medical_condition=Other&expectant_parent=$pregnancy&is_smoker=$tobacco_usage&requested_coverage_type=$requested_coverage_type_bool&residence_type=Own&years_at_residence=3&months_at_residence=6&marital_status=Married&student=No&height_feet=5&height_inches=70&weight=70&dui=No&previously_denied=No&relative_heart=No&relative_cancer=No&have_insurance=No";
                            break;
                    }
                    break;
            }

            if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                //Test Mode
                $url_api .= "&lp_test=1";
            }

            if ($crm_details['is_ping_account'] == 1) {
                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    $url_api .= "&lp_ping_id=$TransactionId";
                }
            }

            $url_api = str_replace(" ", "%20", $url_api);

            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
            $result2 = json_decode($result, true);
            $status = 0;
            if( !empty($result2['result']) ){
                if( $result2['result'] == 'success' || $result2['msg'] == 'Lead Accepted' ){
                    $status = 1;
                }
            }
            return $status;
        } catch (Exception $e) {

        }
    }

    public function AcculynxCrm($data_msg, $crm_details){
        //AcculynxCrm
        if(empty($crm_details['AcculynxCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "AcculynxCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $api_key = $crm_details['AcculynxCrm']['api_key'];

        $priority = "Normal";
        if(!empty($crm_details['data']['start_time'])){
            $start_time = trim($crm_details['data']['start_time']);
            if ($start_time == 'Immediately') {
                $priority = "Urgent";
            } else if ($start_time == 'Not Sure') {
                $priority = "Normal";
            } else {
                $priority = "High";
            }
        }

        $jobCategory = "Residential";
        $workType = "New";
        if(!empty($crm_details['data']['project_nature'])){
            $project_nature = trim($crm_details['data']['project_nature']);
            if ($project_nature == "Repair") {
                $jobCategory = "Repair";
                $workType = "Repair";
            }
        }

        $httpheader = array(
            "Authorization: Bearer $api_key",
            "content-type: application/json",
            "Accept: application/json"
        );

        $url_api = "https://api.acculynx.com/api/v1/leads";

        $Lead_data_array = array(
            "firstName" => $first_name,
            "lastName" => $last_name,
            "companyName" => config('app.name', ''),
            "phoneNumber1" => $number1,
            "phoneType1" => "Home",
            "emailAddress" => $email,
            "jobCategory" => $jobCategory,
            "workType" => $workType,
            "street" => $street,
            "city" => $city,
            "state" => $state,
            "zip" => $zip,
            "country" => "US",
            "priority" => $priority
        );

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        $status = 0;
        if( !empty($result2['success']) ){
            if( $result2['success'] == true ){
                $status = 1;
            }
        }
        return $status;
    }

    public function ZohoCrm($data_msg, $crm_details){
        //Zoho CRM
        if(empty($crm_details['ZohoCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "ZohoCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $statename_code = trim($data_msg['state_code']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $service_name = ucfirst($crm_details['service_campaign_name']);
        $user_id = $crm_details['buyer_id'];
        $OriginalURL2 = trim($data_msg['OriginalURL2']);

        switch ($service_name){
            case "Window":
                $service_name = "Windows";
                break;
        }

        $refresh_token = $crm_details['ZohoCrm']['refresh_token'];
        $client_id = $crm_details['ZohoCrm']['client_id'];
        $client_secret = $crm_details['ZohoCrm']['client_secret'];
        $redirect_url = $crm_details['ZohoCrm']['redirect_url'];
        $grant_type = "refresh_token";

        $url_token = "https://accounts.zoho.com/oauth/v2/token";
        $input_token = array(
            'refresh_token' => $refresh_token,
            'client_id' => $client_id,
            'client_secret' => $client_secret,
            'redirect_uri' => $redirect_url,
            'grant_type' => $grant_type
        );
        $httpheader_token = array();

        $result_token = $crm_api_file->api_send_data($url_token, $httpheader_token, $leadsCustomerCampaign_id, $input_token, "POST", 1, $crm_details['campaign_id']);
        $result_token2 = json_decode($result_token, true);
        $status = 0;
        if( !empty($result_token2['access_token']) ){
            $access_token = $result_token2['access_token'];

            $Company = $crm_details['ZohoCrm']['Lead_Source'];
            $Lead_Source = $crm_details['ZohoCrm']['Lead_Source'];
            $Country = "US";
            $lead_status = "New";
            $url_Leads = "https://www.zohoapis.com/crm/v2/Leads";

            switch ($user_id) {
                case 778:
                    //Green Home Makeover 778
                    $input_leads = '{
    "data": [
        {
            "Company": "' . $Company . '",
            "Last_Name": "' . $last_name . '",
            "First_Name": "' . $first_name . '",
            "Email": "' . $email . '",
            "State": "' . $state . '",
            "Mobile": "+1' . $number1 . '",
            "Street": "' . $street . '",
            "Zip_Code": "' . $zip . '",
            "Country": "' . $Country . '",
            "City": "' . $city . '",
            "Lead_Source": "' . $Lead_Source . '",
            "Interested In": "' . $service_name . '"
        }
    ]
}';
                    break;
                case 1139:
                    // 1139 IntegrateSun
                    $url_Leads = "https://www.zohoapis.com/crm/v2/Contacts";

                    $average_bill = 0;
                    switch ($crm_details['service_id']){
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);

                            switch ($monthly_electric_bill){
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }
                            break;
                    }

                    $input_leads = '{
            "data": [
                {
                    "Last_Name": "' . $last_name . '",
                    "First_Name": "' . $first_name . '",
                    "Email": "' . $email . '",
                    "Phone": "+1' . $number1 . '",
                    "Mailing_Street": "' . $street . '",
                    "Mailing_City": "' . $city . '",
                    "Mailing_State": "' . $statename_code . '",
                    "Mailing_Zip": "' . $zip . '",
                    "Mailing_Country": "' . $Country . '",
                    "Pre_Solar_Bill": "' . $average_bill . '",
                    "lead_source1": "S033",
                    "Lead_Status": "Open for Calls"
                }
            ]
        }';
                    break;
                case 1227:
                    //green conception 1227

                    switch ($crm_details['service_id']){
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $google_ts = $data_msg['google_ts'];
                            $srcTier = "AlliedDigitalMedia";
                            $input_leads = '{
                        "data": [
                            {
                                "Last_Name": "' . $last_name . '",
                                "First_Name": "' . $first_name . '",
                                "Email": "' . $email . '",
                                "State": "' . $statename_code . '",
                                "Phone": "' . $number1 . '",
                                "Street": "' . ucwords($street) . '",
                                "Zip_Code": "' . $zip . '",
                                "Country": "' . $Country . '",
                                "City": "' . ucwords(strtolower($city)) . '",
                                "Lead_Source": "' . $srcTier . '",
                                "SubId": "' . $google_ts . '",
                                "Website": "' . $OriginalURL2 . '",
                                "Created_By": "390912000000044003",
                                "Currency": "USD",
                                "Lead_Vertical": "Solar",
                                "Modified By": "390912000000044003",
                                "Project_Notes": "Solution Type: '. $power_solution.', Monthly Electric Bill: '.$monthly_electric_bill.'",
                                "Owner": "390912000000044003"
                            }
                        ]
                    }';
                            break;

                        case 6:
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $start_time = trim($crm_details['data']['start_time']);

                            switch ($roof_type){
                                case "Asphalt Roofing":
                                    $roof_type_text = "Asphalt Shingle";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_type_text = "Cedar Shake";
                                    break;
                                case "Metal Roofing":
                                    $roof_type_text = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_text = "Slate";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_text = "Clay/Concrete Tile";
                                    break;
                                default:
                                    $roof_type_text="Other";
                            }

                            $google_ts = $data_msg['google_ts'];
                            $srcTier = "AlliedDigitalMedia";
                            $input_leads = '{
                        "data": [
                            {
                                "Last_Name": "' . $last_name . '",
                                "First_Name": "' . $first_name . '",
                                "Email": "' . $email . '",
                                "State": "' . $statename_code . '",
                                "Phone": "' . $number1 . '",
                                "Street": "' . ucwords($street) . '",
                                "Zip_Code": "' . $zip . '",
                                "Country": "' . $Country . '",
                                "City": "' . ucwords(strtolower($city)) . '",
                                "Lead_Source": "' . $srcTier . '",
                                "SubId": "' . $google_ts . '",
                                "Roof_Type": "' . $roof_type_text . '",
                                "Website": "' . $OriginalURL2 . '",
                                "Created_By": "390912000000044003",
                                "Currency": "USD",
                                "Lead_Vertical": "Roofing",
                                "Modified By": "390912000000044003",
                                "Project_Notes": "Project Nature: '. $project_nature.', Property Type: '.$property_type.', Start Time: '.$start_time.'",
                                "Owner": "390912000000044003"
                            }
                        ]
                    }';
                            break;
                    }

                    break;


                default:
                    $input_leads = '{
    "data": [
        {
            "Company": "' . $Company . '",
            "Last_Name": "' . $last_name . '",
            "First_Name": "' . $first_name . '",
            "Email": "' . $email . '",
            "State": "' . $statename_code . '",
            "Phone": "' . $number1 . '",
            "Street": "' . $street . '",
            "Zip_Code": "' . $zip . '",
            "Country": "' . $Country . '",
            "City": "' . $city . '",
            "Lead_Source": "' . $Lead_Source . '",
            "Lead_Status": "' . $lead_status . '",
            "Interested In": "' . $service_name . '"
        }
    ]
}';
            }

            $httpheader_Leads = array(
                "Authorization: Bearer $access_token",
                'Content-Type: application/json'
            );

            $result_Leads = $crm_api_file->api_send_data($url_Leads, $httpheader_Leads, $leadsCustomerCampaign_id, stripslashes($input_leads), "POST", 1, $crm_details['campaign_id']);
            if (strpos("-" . $result_Leads, 'SUCCESS') == true) {
                return 1;
            }
        }
        return $status;
    }

    public function HatchCrm($data_msg, $crm_details){
        //Hatch CRM
        if(empty($crm_details['HatchCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "HatchCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $user_id = $crm_details['buyer_id'];

        $dep_id = $crm_details['HatchCrm']['dep_id'];
        $org_token = $crm_details['HatchCrm']['org_token'];
        $urlSub = $crm_details['HatchCrm']['URL_sub'];
        $serviceN = $crm_details['service_campaign_name'];

        //Hatch API ======================================================
        if (!empty($urlSub)){
            $url_api_post = "https://$urlSub.usehatchapp.com/api/webhooks/$dep_id/newlead";
        } else {
            $url_api_post = "https://prod.usehatchapp.com/api/webhooks/$dep_id/newlead";
        }

        $httpheader = array(
            "X-API-KEY: $org_token",
            "Content-Type: application/json",
            "Accept : application/xml"
        );

        $Lead_data_array = array(
            "firstName" => $first_name,
            "lastName" => $last_name,
            "email" => $email,
            "phoneNumber" => $number1,
            "source" => 'Allied Digital Media',
            "id" => $leadsCustomerCampaign_id
        );

        switch ($user_id){
            case 151:
                $Lead_data_array['service'] = $serviceN;
                break;
            case 1106:
                //Asher Lasting Exteriors  1106
                $Lead_data_array['details'] = array("address" => $street);
                $Lead_data_array['zipcode'] = $zip;
                break;
            case 667:
                // Wintek USA 667
                switch ($crm_details['service_id']){
                    case 1:
                        $Lead_data_array['Service'] = "Windows";
                        break;
                    default:
                        $Lead_data_array['Service'] = $serviceN;
                }
                break;
//            case 667:
//                //This update is not related with hatch{}
//                // Wintek USA 667
//                $data = array(
//                    'email' => $email,
//                    'first_name' => $first_name,
//                    'last_name' => $last_name,
//                    'street' => $street,
//                    'city' => $city,
//                    'state' => $state,
//                    'zip' => $zip,
//                    'number1' => $number1,
//                    'Interest' => "Window",
//                    'BestTimeToCall' => "Any Time",
//                );
//                Mail::send(['text'=>'Mail.wintekusa'], $data, function($message) {
//                    $message->to('eleadimport@blp9x754corlhis2fjj25198tcv63uknq5iirz96z8prryx7h.1u-12dgiuai.na210.apex.salesforce.com', 'WintekUSA')->subject('Provider = Allied Digital Media');
//                    $message->from(config('mail.from.address', ''),config('mail.from.name', ''));
//                });
//                break;
        }

        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
        if (strpos("-" . $result, 'true') == true) {
            return 1;
        }
        return 0;
    }

    public function SalesforceCrm($data_msg, $crm_details){
        //Salesforce CRM
        if(empty($crm_details['salesforceCRM'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "salesforceCRM"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $state = trim($data_msg['State']);
        $statename_code = $data_msg['state_code'];
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];

        $url_api = ( !empty($crm_details['salesforceCRM']['url']) ? $crm_details['salesforceCRM']['url'] : "https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8" );
        $lead_source = ( !empty($crm_details['salesforceCRM']['lead_source']) ? $crm_details['salesforceCRM']['lead_source'] : "");
        $retURL = $crm_details['salesforceCRM']['retURL'];
        $oid = $crm_details['salesforceCRM']['oid'];

        $Lead_data_array = "oid=$oid&retURL=$retURL&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&street=$street&city=$city&zip=$zip&state_code=$statename_code&state=$state&lead_source=$lead_source&country_code=US";

        switch ($crm_details['buyer_id']){
            case 586:
                //Solar Titan USA 586
                $property_type = $crm_details['data']['property_type'];
                $property_type_data = "0124x000000DlNY";
                if ($property_type == 'Business') {
                    $property_type_data = "0124x000000DlNd";
                }
                $Lead_data_array .= "&recordType=0124x000000DlNY&recordType=$property_type_data";
                break;
            case 1109:
                //Ameco Solar - Hybrid - Rev-Share 1109
                switch ($crm_details['service_id']){
                    case 2:
                        $Lead_data_array .= "&00N3r00000HFdtv=Solar PV";
                        break;
                    case 6:
                        $Lead_data_array .= "&00N3r00000HFdtv=Roofing";
                        break;
                }
                break;
            case 1128:
                //Boston Solar 1128
                $Lead_data_array .= "&Secondary_Lead_Source__c=Allied Digital Media&System_Path__c=Web&Parent_Account__c=TBSC&Type__c=Residential&Project_Type__c=Solar";
                break;
        }

        $Lead_data_array = str_replace(" ","%20",$Lead_data_array);

        $httpheader = array(
            "Content-Type: application/x-www-form-urlencoded",
            "Cookie: BrowserId=cDZghvzqEeqVPLVV8x7_Fg"
        );

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
        return 1;
    }

    public function BuilderPrimeCRM($data_msg, $crm_details){
        if(empty($crm_details['Builder_Prime_CRM'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "Builder_Prime_CRM"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = $data_msg['first_name'];
        $last_name = $data_msg['last_name'];
        $number1 = $data_msg['LeadPhone'];
        $email = $data_msg['LeadEmail'];
        $zip = $data_msg['Zipcode'];
        $street = $data_msg['street'];
        $city = $data_msg['City'];
        $statename_code = $data_msg['state_code'];
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];

        $postURL = $crm_details['Builder_Prime_CRM']['post_url'];
        $secretKey = $crm_details['Builder_Prime_CRM']['secret_key'];
        $httpheader = array(
            "Content-Type: application/json",
        );

        $Lead_data_array = array(
            "firstName" => $first_name,
            "lastName" => $last_name,
            "email" => $email,
            "mobilePhone" => $number1,
            "addressLine1" => $street,
            "city" => $city,
            "state" => $statename_code,
            "zip" => $zip,
            "companyName" => config('app.name', ''),
            "leadStatusName" => "Lead received",
            "leadSourceName" => "ADM - Form",
            "secretKey" => $secretKey,
        );

        switch ($crm_details['buyer_id']){
            case 1041:
                //Punch List Bath & Home Remodeling 1041
                $Lead_data_array['className'] = "Punch List Remodeling";
                $Lead_data_array['projectTypeName'] = "Bathroom Remodel";
                break;
            case 1244:
                //Window Depot USA 1244
                $number_of_windows = trim($crm_details['data']['number_of_window']);
                $project_nature = trim($crm_details['data']['project_nature']);
                $start_time = trim($crm_details['data']['start_time']);
                $ownership = trim($crm_details['data']['homeOwn']);
                $serviceName= $crm_details['service_campaign_name'];
                $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
                $Lead_data_array['notes'] = "Lead Service:$serviceName, Lead ID:$leadsCustomerCampaign_id, Owner of the Property:$ownership,The project is starting:$start_time,How many windows are involved:$number_of_windows,Type of the project:$project_nature";
                break;
        }

        $result = $crm_api_file->api_send_data($postURL, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
        if(str_contains(strtolower($result) , 'success')){
            return 1;
        }
        return 0;
    }

    public function ZapierCRM($data_msg, $crm_details){
        //ZapierCrm
        if(empty($crm_details['ZapierCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "ZapierCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $lead_source_text = $data_msg['lead_source'];
        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $email = trim($data_msg['LeadEmail']);
        $number1 = trim($data_msg['LeadPhone']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $zip = trim($data_msg['Zipcode']);
        $state = trim($data_msg['State']);
        $statename_code = $data_msg['state_code'];
        $user_id = $crm_details['buyer_id'];
        $OriginalURL = $data_msg['OriginalURL'];

        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        if ($listOFCampainDB_type == "Exclusive") {
            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Exclusive";
        } else {
            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Shared";
        }

        $url_api = $crm_details['ZapierCrm']['post_url'];

        $httpheader = array(
            'Accept: application/json',
            'Content-Type: application/json'
        );

        $Lead_data_array = array(
            "Lead_ID" => $leadsCustomerCampaign_id,
            "Source" => $lead_source_text,
            "Campaign" => $crm_details['campaign_id'],
            "First" => $first_name,
            "Last" => $last_name,
            "Email" => $email,
            "Phone" => $number1,
            "Street" => $street,
            "City" => $city,
            "State" => $statename_code,
            "Zip" => $zip,
        );

        switch ($crm_details['service_id']){
            case 2:
                $utility_provider = $crm_details['data']['utility_provider'];
                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                $roof_shade = trim($crm_details['data']['roof_shade']);
                $property_type = trim($crm_details['data']['property_type']);
                $power_solution = trim($crm_details['data']['power_solution']);

                $Lead_data_array['Utility_Company'] = $utility_provider;

                switch ($crm_details['buyer_id']) {
                    case 1254:
                        //Sunvision LLC 1254
                        $Lead_data_array['avgbill'] = $monthly_electric_bill;
                        $Lead_data_array['shade'] = $roof_shade;
                        $Lead_data_array['propertytype'] = "single family home";
                        $Lead_data_array['credit'] = "Good";
                        break;
                }
                break;
            case 4:
                // Flooring
                $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                $project_nature = trim($crm_details['data']['project_nature']);
                $start_time = trim($crm_details['data']['start_time']);
                $ownership = trim($crm_details['data']['homeOwn']);

                $Lead_data_array['flooring_type'] = $Type_OfFlooring;
                $Lead_data_array['project_nature'] = $project_nature;
                $Lead_data_array['start_time'] = $start_time;
                $Lead_data_array['property_owner'] = $ownership;
                break;
        }

        switch ($user_id){
            case 1117:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Cleveland";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 1116:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Tide Water";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 712:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Pittsburgh";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 711:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Mid Atlantic";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 710:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "New Jersey";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 708:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Philadelphia";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 1289:
                $Lead_data_array['url'] = $OriginalURL;
                $Lead_data_array['Division'] = "Richmond";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                $Lead_data_array['Price'] = $Lead_Cost;
                break;
            case 1294:
                $Lead_data_array['Division'] = "Columbus";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                break;
            case 1293:
                $Lead_data_array['Division'] = "Long Island";
                $Lead_data_array['Service'] = $crm_details['service_campaign_name'];
                break;
        }

        $result =  $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        if (!empty($result2['status'])) {
            if( $result2['status'] == "success" ){
                return 1;
            }
        }
        return 0;
    }

    public function SetShapeCrm($data_msg, $crm_details){
        //SetShapeCrm
        if(empty($crm_details['SetShapeCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "SetShapeCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $lead_source_text = $data_msg['lead_source'];
        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $email = trim($data_msg['LeadEmail']);
        $number1 = trim($data_msg['LeadPhone']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $zip = trim($data_msg['Zipcode']);
        $state = trim($data_msg['State']);
        $statename_code = $data_msg['state_code'];

        $url_api = $crm_details['SetShapeCrm']['post_url'];

        $httpheader = array(
            "cache-control: no-cache",
            "Accept: application/json",
            "Content-Type: application/json"
        );

        $Lead_data_array_post = array(
            "ImportleadId" => $leadsCustomerCampaign_id,
            "firstname" => $first_name,
            "lastname" => $last_name,
            "email" => $email,
            "phone" => $number1,
            "city" => $city,
            "state" => $statename_code,
            "zip" => $zip,
            "leadfulladdress" => $street,
            "leadsource" => $lead_source_text,
        );

        switch ($crm_details['service_id']) {
            case 2:
                //Solar
                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                $utility_provider = trim($crm_details['data']['utility_provider']);
                $roof_shade = trim($crm_details['data']['roof_shade']);
                $property_type = trim($crm_details['data']['property_type']);
                $power_solution = trim($crm_details['data']['power_solution']);

                $Lead_data_array_post['avgsummerbill'] = $monthly_electric_bill;
                $Lead_data_array_post['electricCompany'] = $utility_provider;
                $Lead_data_array_post['creditscore'] = "Good";
                $Lead_data_array_post['bestContactTime'] = "Morning";
                $Lead_data_array_post['typeOfsolution'] = $power_solution;
                break;
        }

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        if (!empty($result2['msg'])) {
            if ($result2['msg'] == "success") {
                return 1;
            }
        }
        return 0;
    }

    public function jobNimbusCrm($data_msg, $crm_details){
        //jobNimbusCrm
        if(empty($crm_details['SetJobNimbusCrm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "SetJobNimbusCrm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $lead_source_text = $data_msg['lead_source'];
        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $email = trim($data_msg['LeadEmail']);
        $number1 = trim($data_msg['LeadPhone']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $zip = trim($data_msg['Zipcode']);
        $state = trim($data_msg['State']);
        $statename_code = $data_msg['state_code'];
        $user_id = $crm_details['buyer_id'];

        $api_key = $crm_details['SetJobNimbusCrm']['api_key'];
        $url_api = "https://app.jobnimbus.com/api1/contacts";

        $httpheader = array(
            'Accept: application/json',
            'Content-Type: application/json',
            "Authorization: Bearer ".$api_key
        );

        $Lead_data_array_post = array(
            "first_name" => $first_name,
            "last_name" => $last_name,
            "status_name" => "Lead",
            "address_line1" => $street,
            "city" => $city,
            "state_text" => $statename_code,
            "zip" => $zip,
            "email" => $email,
            "number" => $number1,
            "home_phone" => $number1,
            "mobile_phone" => $number1,
        );

        switch ($user_id){
            case 1243:
                $Lead_data_array_post['source_name'] = "AlliedLead";
                $Lead_data_array_post['sales_rep_name'] = "Jessica Fristoe";
                break;
        }

        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
        $result2 = json_decode($result, true);
        if (!empty($result2)) {
            if(!empty($result2["type"])){
                return 1;
            }
        }
        //return 1;
    }

    public function SunBaseDataCrm($data_msg, $crm_details){
        //Sunbase CRM
        if(empty($crm_details['set_sunbase_crm'])){
            Log::info('Campaign Error Massage', array('campaign_id' => $crm_details['campaign_id'], 'CRM_type' => "set_sunbase_crm"));
            return 0;
        }
        $crm_api_file = new CrmApi();

        $first_name = trim($data_msg['first_name']);
        $last_name = trim($data_msg['last_name']);
        $number1 = trim($data_msg['LeadPhone']);
        $zip = trim($data_msg['Zipcode']);
        $street = trim($data_msg['street']);
        $city = trim($data_msg['City']);
        $email = trim($data_msg['LeadEmail']);
        $statename_code = trim($data_msg['state_code']);
        $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
        $lead_source_text = $data_msg['lead_source'];
        $google_ts = $data_msg['google_ts'];

        $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
        if ($listOFCampainDB_type == "Exclusive") {
            $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Exclusive";
        } else {
            $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
            $Lead_Cost_type = "Shared";
        }

        $url_api = $crm_details['set_sunbase_crm']['url'];
        $schema_name = $crm_details['set_sunbase_crm']['schema_name'];
        $lead_other = config('app.name', '');
        $lead_source = (!empty($google_ts) ? $google_ts : $lead_source_text);

        $Lead_data_array = array(
            "schema_name" => $schema_name,
            "first_name" => $first_name,
            "last_name" => $last_name,
            "address1" => $street,
            "city" => $city,
            "state" => $statename_code,
            "zip_code" => $zip,
            "phone" => $number1,
            "email" => $email,
            "lead_other" => $lead_other,
            "lead_source" => $lead_source,
            "lead_cost" => $Lead_Cost,
        );

        switch ($crm_details['service_id']){
            case 2:
                //Solar
                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                $utility_provider = trim($crm_details['data']['utility_provider']);

                switch ($monthly_electric_bill){
                    case '$0 - $50':
                        $average_bill = 50;
                        break;
                    case '$51 - $100':
                        $average_bill = 100;
                        break;
                    case '$101 - $150':
                        $average_bill = 150;
                        break;
                    case '$151 - $200':
                        $average_bill = 200;
                        break;
                    case '$201 - $300':
                        $average_bill = 300;
                        break;
                    case '$301 - $400':
                        $average_bill = 400;
                        break;
                    case '$401 - $500':
                        $average_bill = 500;
                        break;
                    default:
                        $average_bill = 600;
                }

                $Lead_data_array['customField1'] = $utility_provider;
                $Lead_data_array['customField37'] = $average_bill;
                break;
        }

        $httpheader = array(
            "Accept: application/json",
            "content-type: application/x-www-form-urlencoded"
        );

        $result =  $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, http_build_query($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
        if(str_contains(strtolower($result) , 'successfully')){
            return 1;
        }
        return 0;
    }

    public function googleSheets($spreadsheetId, $range, $values){
        try {
            $crm_api_file = new CrmApi();

            $client = new \Google_Client();
            $client->setApplicationName('GoogleSheetAllied');
            $client->setScopes([\Google_Service_Sheets::SPREADSHEETS]);
            $client->setAccessType('offline');
            $client->setAuthConfig(public_path() . '/GoogleFile/eloquent-victor-324807-eeb1c833bce2.json');
            $service = new \Google_Service_Sheets($client);

            //$spreadsheetId = "1VPBqPd8HSDkfwQo1rrOXweicwHcB5m_g3ubRQ7VB9M0";
            //$range = "Sheet1";
            //$values = [
            //    ["test", "test", 'test', 'test'],
            //];

            $body = new \Google_Service_Sheets_ValueRange([
                'values' => $values
            ]);

            $params = ["valueInputOption" => "RAW"];
            $insert = ["insertDataOption" => "INSERT_ROWS"];

            $result = $service->spreadsheets_values->append($spreadsheetId, $range, $body, $params, $insert);
        } catch (Exception $e) {

        }
        return 1;
    }

    public function CustomCrm($data_msg, $crm_details,$user_id){
        try {
            $crm_api_file = new CrmApi();

            $lead_source_text = $data_msg['lead_source'];
            $lead_source_id = $data_msg['lead_source_id'];
            $campaign_name = $crm_details['campaign_name'];
            $first_name = $data_msg['first_name'];
            $last_name = $data_msg['last_name'];
            $number1 = $data_msg['LeadPhone'];
            $email = $data_msg['LeadEmail'];
            $zip = $data_msg['Zipcode'];
            $street = $data_msg['street'];
            $city = $data_msg['City'];
            $county = $data_msg['county'];
            $statename_code = $data_msg['state_code'];
            $state = $data_msg['State'];
            $trusted_form = $data_msg['trusted_form'];
            $lead_type_service_id = $data_msg['service_id'];
            $leadsCustomerCampaign_id = $crm_details['leadsCustomerCampaign_id'];
            $service_campaign_name = $crm_details['service_campaign_name'];
            $TCPAText = $data_msg['TCPAText'];
            $UserAgent = $data_msg['UserAgent'];
            $OriginalURL = $data_msg['OriginalURL'];
            $OriginalURL2 = $data_msg['OriginalURL2'];
            $SessionLength = $data_msg['SessionLength'];
            $IPAddress = $data_msg['IPAddress'];
            $LeadId = $data_msg['LeadId'];
            $lead_browser_name = $data_msg['browser_name'];
            $tcpa_compliant = $data_msg['tcpa_compliant'];
            $traffic_source = $data_msg['traffic_source'];
            $google_ts = $data_msg['google_ts'];
            $lead_source_name = $data_msg['lead_source_name'];
            if( $tcpa_compliant == 1 ){
                $tcpa_compliant2 = "Yes";
                $tcpa_compliant3 = "yes";
                $tcpa_compliant4 = true;
                $tcpa_compliant5 = 1;
            } else {
                $tcpa_compliant2 = "No";
                $tcpa_compliant3 = "no";
                $tcpa_compliant4 = false;
                $tcpa_compliant5 = 2;
            }

            $listOFCampainDB_type = $crm_details['listOFCampainDB_type'];
            if ($listOFCampainDB_type == "Exclusive") {
                $Lead_Cost = $crm_details['campaign_budget_bid_exclusive'] - $crm_details['virtual_price'];
                $Lead_Cost_type = "Exclusive";
            } else {
                $Lead_Cost = $crm_details['campaign_budget_bid_shared'] - $crm_details['virtual_price'];
                $Lead_Cost_type = "Shared";
            }

            //CustomCrm CRM
            switch ($user_id) {
                case 39:
                    if (!empty($crm_details['data'])) {
                        $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                        $utility_provider = $crm_details['data']['utility_provider'];
                        $roof_shade = $crm_details['data']['roof_shade'];
                        $property_type = $crm_details['data']['property_type'];

                        $homeowner = ($property_type == 'Rented' ? 'Yes' : 'No');

                        $key = "BgJ04jlVTSq2VEXU&source=AlliedDigital";
                        $source = "AlliedDigital";
                        $list_id = "1091";
                        $vendor_lead_code = "LEAD_PROVIDERS_REFERENCE";
                        $CC_HOME_OWNER = $homeowner;
                        $CC_ELECTRIC_CO = $utility_provider;
                        $CC_AVG_ELEC_BILL = $monthly_electric_bill;
                        $CC_SHADING_OPTION = $roof_shade;

                        $url_api = "https://erus.kslconnect.co.uk/api/lead/insert?key=$key&source=$source&list_id=$list_id&vendor_lead_code=$vendor_lead_code&first_name=$first_name&last_name=$last_name&phone_number=$number1&address1=$street&city=$city&state=$state&postal_code=$zip&email=$email&CC_HOME_OWNER=$CC_HOME_OWNER&CC_ELECTRIC_CO=$CC_ELECTRIC_CO&CC_AVG_ELEC_BILL=$CC_AVG_ELEC_BILL&CC_SHADING_OPTION=$CC_SHADING_OPTION";
                        $url_api = str_replace(" ", "%", $url_api);

                        $httpheader = array(
                            "cache-control: no-cache",
                            "Accept: application/json",
                            "content-type: application/json"
                        );

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "GET", 1, $crm_details['campaign_id']);
                        return 1;
                    }
                    break;
                case 44:
                    //exact customer 44
                    $postURL1 = "https://Leads.EcDashboard.com/HomePing.aspx?";
                    $areaCode = substr($number1, 0, 3);
                    $phonePrefix = substr($number1, 3, 3);
                    $phoneSuffix = substr($number1, 6, 4);
                    $phoneNum = $areaCode . "-" . $phonePrefix . "-" . $phoneSuffix;

                    $postURL1 .= "Source=ADM20&Address1=$street&City=$city&State=$statename_code&Zipcode=$zip&HomePhone=$phoneNum&Email=$email";
                    $postURL1 = str_replace(" ", "%20", $postURL1);
                    $httpheader1 = array();
                    $Lead_data_array1 = array();
                    $result_ping = $crm_api_file->api_send_data($postURL1, $httpheader1, $leadsCustomerCampaign_id, json_encode($Lead_data_array1), "POST", 1, $crm_details['campaign_id']);
                    $ping_accept = 0;
                    if (strpos("-" . $result_ping, 'Success') == true) {
                        $ping_accept = 1;
                    }

                    if ($ping_accept == 1 || $crm_details['campaign_Type'] != 7) {
                        $SRCID = 'SCRID';
                        $SourceDescr = 'Allied-Digital-Media';
                        $project = $crm_details['service_campaign_name'];

                        if ($crm_details['campaign_Type'] == 7) {
                            $CampaignId = '1930'; // Pay Per Verified Lead
                        } else {
                            $CampaignId = '1838'; // Pay Per Lead
                        }

                        if (config('app.env', 'local') == "local") {
                            //Test
                            $TestMode = 1;
                            $url_api = "https://Leads.EcDashboard.com/HomePost.aspx?TestMode=$TestMode&Campaignid=$CampaignId&SRCID=$SRCID&SourceDescr=$SourceDescr&FirstName=$first_name&LastName=$last_name&Address1=$street&City=$city&State=$statename_code&Zipcode=$zip&HomePhone=$number1&Email=$email&Project=$project&LeadPrice=$Lead_Cost&TrustedForm=$trusted_form";
                        } else {
                            //Live
                            $url_api = "https://Leads.EcDashboard.com/HomePost.aspx?Campaignid=$CampaignId&SRCID=$SRCID&SourceDescr=$SourceDescr&FirstName=$first_name&LastName=$last_name&Address1=$street&City=$city&State=$statename_code&Zipcode=$zip&HomePhone=$number1&Email=$email&Project=$project&LeadPrice=$Lead_Cost&TrustedForm=$trusted_form";
                        }
                        $url_api = str_replace(" ", "%20", $url_api);

                        $httpheader = array(
                            "cache-control: no-cache",
                            "Accept: application/json",
                            "content-type: application/json"
                        );

                        $Lead_data_array = array();

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'Success') == true) {
                            return 1;
                        }
                    }
                    break;
                case 61:
                    //Castle Windows 61

                    if (!empty($crm_details['data']['homeOwn'])) {
                        $ownership = ($crm_details['data']['homeOwn'] != "Yes" ? "N" : "Y");
                    } else {
                        if (!empty($crm_details['data']['property_type'])) {
                            $ownership = ($crm_details['data']['property_type'] == "Rented" ? "N" : "Y");
                        } else {
                            $ownership = "Y";
                        }
                    }

                    if (strpos("-" . $campaign_name, '2') == true) {
                        $url_api = "http://mdhburg.castleapi.com/schedules/opp.php";
                    } else {
                        if (config('app.env', 'local') == "local") {
                            //Test
                            $url_api = "http://www.castleapi.com/schedules/TEST/opp.php";
                        } else {
                            //Live
                            $url_api = "http://www.castleapi.com/schedules/opp.php";
                        }
                    }


                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/x-www-form-urlencoded"
                    );

                    $Proc = "POST";
                    $ID = "6288";
                    $Lead_data_array = "Proc=$Proc&ID=$ID&jdata=%5B%7B%22Phone%22%3A%22$number1%22%2C%22Email%22%3A%22$email%22%2C%22FirstName%22%3A%22$first_name%22%2C%22LastName%22%3A%22$last_name%22%2C%22Address%22%3A%22$street%22%2C%22City%22%3A%22$city%22%2C%22State%22%3A%22$statename_code%22%2C%22Zip%22%3A%22$zip%22%2C%22LeadKey%22%3A%22$leadsCustomerCampaign_id%22%2C%22HomeOwner%22%3A%22$ownership%22%2C%22Product%22%3A%22$service_campaign_name%22%7D%5D";
                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), 'accepted')) {
                        return 1;
                    }
                    break;
                case 51:
                    //PX API 51
                    $request_date = trim(date('m/d/Y'));

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    if ($trusted_form == "NA" || $trusted_form == "N/A"
                        || $trusted_form == "https://cert.trustedform.com/Will_Provide_on_Post"
                        || $trusted_form == "https://cert.trustedform.com/will_send_on_post"
                        || $trusted_form == "https://cert.trustedform.com") {
                        $trusted_form = "";
                    }

                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            if ($crm_details['campaign_Type'] == 6) {
                                //Warm Transfer
                                $OwnRented = (strtolower($ownership) == 'yes' ? 'Own' : 'Rented');

                                switch ($start_time) {
                                    case 'Immediately':
                                        $start_time = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $start_time = "Not Sure";
                                        break;
                                    default:
                                        $start_time = "Within a Year";
                                }

                                switch ($number_of_windows) {
                                    case '1':
                                        $number_windows = "1 window";
                                        break;
                                    case '2':
                                        $number_windows = "2 windows";
                                        break;
                                    case '3-5':
                                        $number_windows = "3 to 5 windows";
                                        break;
                                    case '6-9':
                                        $number_windows = "6 to 9 windows";
                                        break;
                                    default:
                                        $number_windows = "10+ windows";
                                }

                                switch ($project_nature) {
                                    case "Install":
                                    case "Replace":
                                        $project_nature_data = "New Unit Installed";
                                        break;
                                    default:
                                        $project_nature_data = "Repair";
                                }

                                $url_api = "https://leadapi.px.com/api/lead/post";
                                $PartnerToken = "4C738DD2-01D5-4AA7-979F-184E8CEBBE7F";
                                $AffiliateData_OfferId = "2015";

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $google_ts = "test";
                                    $zip = "90100";
                                }

                                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                    $Lead_data_array = array(
                                        "ApiToken" => "$PartnerToken",
                                        "Vertical" => "Windows",
                                        "SubId" => "$google_ts",
                                        "UserAgent" => "$UserAgent",
                                        "OriginalUrl" => "$OriginalURL2",
                                        "Source" => "All",
                                        "JornayaLeadId" => "$LeadId",
                                        "TrustedForm" => "$trusted_form",
                                        "SessionLength" => "$SessionLength",
                                        "TcpaText" => "$TCPAText",
                                        "VerifyAddress" => "false",
                                        "OfferId" => "$AffiliateData_OfferId",
                                        "TransactionId" => "$TransactionId",
                                        "ContactData" => array(
                                            "FirstName" => "$first_name",
                                            "LastName" => "$last_name",
                                            "Address" => "$street",
                                            "City" => "$city",
                                            "State" => "$statename_code",
                                            "ZipCode" => "$zip",
                                            "EmailAddress" => "$email",
                                            "PhoneNumber" => "$number1",
                                            "DayPhoneNumber" => "$number1",
                                            "IpAddress" => "$IPAddress"
                                        ),
                                        "Person" => array(
                                            "FirstName" => "$first_name",
                                            "LastName" => "$last_name",
                                            "BirthDate" => "1980-07-27",
                                            "Gender" => "Male",
                                            "BestTimeToCall" => "Any time"
                                        ),
                                        "Custom" => array(
                                            "Field1" => "Free text",
                                            "Field2" => "Free text",
                                            "Field3" => "Free text",
                                            "Field4" => "Free text",
                                            "Field5" => "Free text",
                                            "Field6" => "Free text",
                                            "Field7" => "Free text",
                                            "Field8" => "Free text",
                                            "Field9" => "Free text",
                                            "Field10" => "Free text"
                                        ),
                                        "Home" => array(
                                            "ProjectType" => "$project_nature_data",
                                            "NumberOfWindows" => "$number_windows",
                                            "WindowStyle" => "Unsure",
                                            "PropertyType" => "Residential",
                                            "OwnRented" => "$OwnRented",
                                            "AuthorizedToMakeChanges" => "Yes",
                                            "PurchaseTimeframe" => "$start_time",
                                        )
                                    );

                                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                    $result2 = json_decode($result, true);
                                    if (!empty($result2['Success'])) {
                                        if ($result2['Success'] == "true") {
                                            return 1;
                                        }
                                    }
                                }
                            } else {
                                $OwnRented = (strtolower($ownership) == 'yes' ? 'Own' : 'Rented');

                                switch ($start_time) {
                                    case 'Immediately':
                                        $start_time = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $start_time = "Not Sure";
                                        break;
                                    default:
                                        $start_time = "Within a Year";
                                }

                                switch ($number_of_windows) {
                                    case '1' || '2':
                                        $number_windows = "2 windows";
                                        break;
                                    case '3-5':
                                        $number_windows = "3 to 5 windows";
                                        break;
                                    case '6-9':
                                        $number_windows = "6 to 9 windows";
                                        break;
                                    default:
                                        $number_windows = "10+ windows";
                                }

                                switch ($project_nature) {
                                    case "Install":
                                        $project_nature_data = "New Unit Installed";
                                        break;
                                    case "Replace":
                                        $project_nature_data = "Replace Unit";
                                        break;
                                    default:
                                        $project_nature_data = "Repair";
                                }

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $url_api = "http://api.open.stagingpx.com/px";
                                    $PartnerToken = "C1BDC394-5005-4A01-8703-F90ABC58AAA5";
                                    $AffiliateData_id = "325";
                                    $AffiliateData_OfferId = "2015";
                                } else {
                                    //Live Mode
                                    $url_api = "https://secureopenapi.px.com/px";
                                    $PartnerToken = "4C738DD2-01D5-4AA7-979F-184E8CEBBE7F";
                                    $AffiliateData_id = "10629";
                                    $AffiliateData_OfferId = "2015";
                                }

                                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                    $Lead_data_array = array(
                                        "type" => "jsonwsp/request",
                                        "version" => "1.0",
                                        "methodname" => "Lead.Post",
                                        "LeadData" => array(
                                            "Target" => "Lead.Post",
                                            "PartnerToken" => "$PartnerToken",
                                            "RequestTime" => "$request_date",
                                            "UserAgent" => "$UserAgent",
                                            "OriginalURL" => "$OriginalURL2",
                                            "SessionLength" => "$SessionLength",
                                            "TransactionId" => "$TransactionId",
                                            "TCPAText" => "$TCPAText",
                                            "AffiliateData" => array(
                                                "Id" => "$AffiliateData_id",
                                                "OfferId" => "$AffiliateData_OfferId",
                                                "SubId" => "$google_ts",
                                                "Source" => "All",
                                                "VerifyAddress" => "false",
                                                "RespondOnNoSale" => "true",
                                                "SellResponseURL" => "",
                                                "LeadId" => "$LeadId",
                                                "TrustedForm" => "$trusted_form",
                                                "ClickConsentID" => ""
                                            ),
                                            "ContactData" => array(
                                                "FirstName" => "$first_name",
                                                "LastName" => "$last_name",
                                                "Address" => "$street",
                                                "City" => "$city",
                                                "State" => "$statename_code",
                                                "ZIPCode" => "$zip",
                                                "EmailAddress" => "$email",
                                                "PhoneNumber" => "$number1",
                                                "DayPhoneNumber" => "$number1",
                                                "IPAddress" => "$IPAddress"
                                            ),
                                            "QuoteRequest" => array(
                                                "QuoteType" => "Windows",
                                                "Persons" => array(
                                                    "Person" => array(
                                                        "FirstName" => "$first_name",
                                                        "LastName" => "$last_name",
                                                        "BirthDate" => "1980-02-02",
                                                        "Gender" => "Unspecified",
                                                        "BestTimeToCall" => "Any time",
                                                    ),
                                                ),
                                                "CustomField1" => "Free text",
                                                "CustomField2" => "Free text",
                                                "CustomField3" => "Free text",
                                                "CustomField4" => "Free text",
                                                "CustomField5" => "Free text",
                                                "CustomField6" => "Free text",
                                                "CustomField7" => "Free text",
                                                "CustomField8" => "Free text",
                                                "CustomField9" => "Free text",
                                                "CustomField10" => "Free text",
                                                "Homes" => array(
                                                    "Home" => array(
                                                        "ProjectType" => "$project_nature_data",
                                                        "NumberOfWindows" => "$number_windows",
                                                        "WindowStyle" => "Unsure",
                                                        "PropertyType" => "Residential",
                                                        "OwnRented" => "$OwnRented",
                                                        "AuthorizedToMakeChanges" => "Yes",
                                                        "PurchaseTimeframe" => "$start_time",
                                                    )
                                                )
                                            )
                                        )
                                    );

                                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                    $result2 = json_decode($result, true);
                                    if (!empty($result2)) {
                                        if (!empty($result2['Result'])) {
                                            if ($result2['Result'] == "BaeOK") {
                                                return 1;
                                            }
                                        }
                                    }
                                }
                            }
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            if ($crm_details['campaign_Type'] == 6) {
                                $SecurityUsage = ($property_type == "Business" ? "Commercial" : "Residential");
                                $property_type = ($property_type == "Owned" ? "Own" : "Rented");

                                switch ($power_solution) {
                                    case "Solar Water Heating for my Home":
                                        $SolarSystemType = "Solar hot water";
                                        break;
                                    case "Solar Electricity & Water Heating for my Home":
                                        $SolarSystemType = "Solar electricity and hot water";
                                        break;
                                    default:
                                        $SolarSystemType = "Solar electricity";
                                }

                                switch ($roof_shade) {
                                    case "Full Sun":
                                        $roof_shade_data = "Full sun";
                                        break;
                                    case "Mostly Shaded":
                                        $roof_shade_data = "Mostly shaded";
                                        break;
                                    case "Partial Sun":
                                        $roof_shade_data = "Partial sun";
                                        break;
                                    default:
                                        $roof_shade_data = "Not sure";
                                }

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50' || '$51 - $100':
                                        $monthly_electric = "$51-75";
                                        break;
                                    case '$101 - $150' || '$151 - $200':
                                        $monthly_electric = "$151-175";
                                        break;
                                    case '$201 - $300':
                                        $monthly_electric = "$201-300";
                                        break;
                                    case '$301 - $400':
                                        $monthly_electric = "$301-400";
                                        break;
                                    case '$401 - $500':
                                        $monthly_electric = "$401-500";
                                        break;
                                    default:
                                        $monthly_electric = "$500+";
                                }

                                $url_api = "https://leadapi.px.com/api/lead/post";
                                $PartnerToken = "C1FD93F3-50CB-42FA-9B67-9F0DAE79DEFA";
                                $AffiliateData_OfferId = "122";

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $google_ts = "test";
                                    $zip = "90100";
                                }

                                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                    $Lead_data_array = array(
                                        "ApiToken" => "$PartnerToken",
                                        "Vertical" => "Solar",
                                        "SubId" => "$google_ts",
                                        "UserAgent" => "$UserAgent",
                                        "OriginalUrl" => "$OriginalURL2",
                                        "Source" => "All",
                                        "JornayaLeadId" => "$LeadId",
                                        "TrustedForm" => "$trusted_form",
                                        "SessionLength" => "$SessionLength",
                                        "TcpaText" => "$TCPAText",
                                        "VerifyAddress" => "false",
                                        "OfferId" => "$AffiliateData_OfferId",
                                        "TransactionId" => "$TransactionId",
                                        "ContactData" => array(
                                            "ZipCode" => "$zip",
                                            "FirstName" => "$first_name",
                                            "LastName" => "$last_name",
                                            "City" => "$city",
                                            "EmailAddress" => "$email",
                                            "PhoneNumber" => "$number1",
                                            "State" => "$statename_code",
                                            "Address" => "$street",
                                            "IpAddress" => "$IPAddress"
                                        ),
                                        "Custom" => array(
                                            "Field1" => "Free text",
                                            "Field2" => "Free text",
                                            "Field3" => "Free text",
                                            "Field4" => "Free text",
                                            "Field5" => "Free text",
                                            "Field6" => "Free text",
                                            "Field7" => "Free text",
                                            "Field8" => "Free text",
                                            "Field9" => "Free text",
                                            "Field10" => "Free text"
                                        ),
                                        "Home" => array(
                                            "Ownership" => "$property_type",
                                            "RoofShade" => "$roof_shade_data",
                                            "AuthorizedForPropertyChanges" => "Yes",
                                            "CurrentUtilityProvider" => "$utility_provider",
                                            "ElectricityBill" => "$monthly_electric",
                                            "ProjectStatus" => "Existing home",
                                            "PropertyUsage" => "$SecurityUsage",
                                            "SolarSystemType" => "$SolarSystemType",
                                            "PropertyStories" => "Two stories",
                                            "SolarInstallationLocation" => "Roof"
                                        )
                                    );

                                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                    $result2 = json_decode($result, true);
                                    if (!empty($result2['Success'])) {
                                        if ($result2['Success'] == "true") {
                                            return 1;
                                        }
                                    }
                                }
                            } else {
                                $SecurityUsage = ($property_type == "Business" ? "Business" : "Residential");
                                $property_type = ($property_type == "Owned" ? "Own" : $property_type);

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50' || '$51 - $100':
                                        $monthly_electric = "$51-75";
                                        break;
                                    case '$101 - $150' || '$151 - $200':
                                        $monthly_electric = "$151-175";
                                        break;
                                    case '$201 - $300':
                                        $monthly_electric = "$201-300";
                                        break;
                                    case '$301 - $400':
                                        $monthly_electric = "$301-400";
                                        break;
                                    case '$401 - $500':
                                        $monthly_electric = "$401-500";
                                        break;
                                    default:
                                        $monthly_electric = "$500+";
                                }

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $url_api = "http://api.open.stagingpx.com/px";
                                    $PartnerToken = "C1BDC394-5005-4A01-8703-F90ABC58AAA5";
                                    $AffiliateData_id = "325";
                                    $AffiliateData_OfferId = "2015";
                                } else {
                                    //Live
                                    $url_api = "https://secureopenapi.px.com/px";
                                    $PartnerToken = "33A951DA-2252-437D-8E22-AF0B43755F4F";
                                    $AffiliateData_id = "10636";
                                    $AffiliateData_OfferId = "1045";
                                }

                                if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                    $Lead_data_array = array(
                                        "type" => "jsonwsp/request",
                                        "version" => "1.0",
                                        "methodname" => "Lead.Post",
                                        "LeadData" => array(
                                            "Target" => "Lead.Post",
                                            "PartnerToken" => "$PartnerToken",
                                            "RequestTime" => "$request_date",
                                            "UserAgent" => "$UserAgent",
                                            "OriginalURL" => "$OriginalURL2",
                                            "SessionLength" => "$SessionLength",
                                            "TransactionId" => "$TransactionId",
                                            "TCPAText" => "$TCPAText",
                                            "AffiliateData" => array(
                                                "Id" => "$AffiliateData_id",
                                                "OfferId" => "$AffiliateData_OfferId",
                                                "SubId" => "$google_ts",
                                                "Source" => "All",
                                                "VerifyAddress" => "false",
                                                "RespondOnNoSale" => "true",
                                                "SellResponseURL" => "",
                                                "LeadId" => "$LeadId",
                                                "TrustedForm" => "$trusted_form",
                                                "ClickConsentID" => ""
                                            ),
                                            "ContactData" => array(
                                                "FirstName" => "$first_name",
                                                "LastName" => "$last_name",
                                                "Address" => "$street",
                                                "City" => "$city",
                                                "State" => "$statename_code",
                                                "ZIPCode" => "$zip",
                                                "EmailAddress" => "$email",
                                                "PhoneNumber" => "$number1",
                                                "DayPhoneNumber" => "$number1",
                                                "IPAddress" => "$IPAddress"
                                            ),
                                            "QuoteRequest" => array(
                                                "QuoteType" => "Solar",
                                                "Person" => array(
                                                    "BirthDate" => "1980-02-02",
                                                    "Gender" => "Unspecified",
                                                ),
                                                "CustomField1" => "Free text",
                                                "CustomField2" => "Free text",
                                                "CustomField3" => "Free text",
                                                "CustomField4" => "Free text",
                                                "CustomField5" => "Free text",
                                                "CustomField6" => "Free text",
                                                "CustomField7" => "Free text",
                                                "CustomField8" => "Free text",
                                                "CustomField9" => "Free text",
                                                "CustomField10" => "Free text",
                                                "Homes" => array(
                                                    "Home" => array(
                                                        "PropertyUsage" => "$SecurityUsage",
                                                        "OwnRented" => "$property_type",
                                                        "AuthorizedForPropertyChanges" => "Yes",
                                                        "ProjectStatus" => "Existing home",
                                                        "RoofShade" => "$roof_shade",
                                                        "ElectricityBill" => "$monthly_electric",
                                                        "SolarSystem" => array(
                                                            "SolarSystemType" => "Solar electricity",
                                                            "SolarInstallationLocation" => "Roof",
                                                            "InstallationTimeFrame" => "Not sure",
                                                            "OffSetElectricityWithSolar" => "25%25",
                                                            "CurrentUtilityProvider" => "$utility_provider"
                                                        )
                                                    )
                                                )
                                            )
                                        )
                                    );

                                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                    $result2 = json_decode($result, true);
                                    if (!empty($result2)) {
                                        if (!empty($result2['Result'])) {
                                            if ($result2['Result'] == "BaeOK") {
                                                return 1;
                                            }
                                        }
                                    }
                                }
                            }
                            break;
                        case 3:
                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $SecurityUsage = ($property_type == "Business" ? "Business" : "Residential");
                            $property_type = ($property_type == "Owned" ? "Own" : $property_type);
                            $start_time = ($start_time == "Immediately" ? "Immediately" : "More than two months");

                            if (config('app.env', 'local') == "local") {
                                //Test Mode
                                $url_api = "http://api.open.stagingpx.com/px";
                                $PartnerToken = "C1BDC394-5005-4A01-8703-F90ABC58AAA5";
                                $AffiliateData_id = "325";
                                $AffiliateData_OfferId = "2015";
                            } else {
                                //Live
                                $url_api = "https://secureopenapi.px.com/px";
                                $PartnerToken = "62C39DDB-58CE-4A02-9D5F-F0CB82C7FFA4";
                                $AffiliateData_id = "10619";
                                $AffiliateData_OfferId = "453";
                            }

                            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                $Lead_data_array = array(
                                    "type" => "jsonwsp/request",
                                    "version" => "1.0",
                                    "methodname" => "Lead.Post",
                                    "LeadData" => array(
                                        "Target" => "Lead.Post",
                                        "PartnerToken" => "$PartnerToken",
                                        "RequestTime" => "$request_date",
                                        "UserAgent" => "$UserAgent",
                                        "OriginalURL" => "$OriginalURL2",
                                        "SessionLength" => "$SessionLength",
                                        "TransactionId" => "$TransactionId",
                                        "TCPAText" => "$TCPAText",
                                        "AffiliateData" => array(
                                            "Id" => "$AffiliateData_id",
                                            "OfferId" => "$AffiliateData_OfferId",
                                            "SubId" => "$google_ts",
                                            "Source" => "All",
                                            "VerifyAddress" => "false",
                                            "RespondOnNoSale" => "true",
                                            "SellResponseURL" => "",
                                            "LeadId" => "$LeadId",
                                            "TrustedForm" => "$trusted_form",
                                            "ClickConsentID" => ""
                                        ),
                                        "ContactData" => array(
                                            "FirstName" => "$first_name",
                                            "LastName" => "$last_name",
                                            "Address" => "$street",
                                            "City" => "$city",
                                            "State" => "$statename_code",
                                            "ZIPCode" => "$zip",
                                            "EmailAddress" => "$email",
                                            "PhoneNumber" => "$number1",
                                            "DayPhoneNumber" => "$number1",
                                            "IPAddress" => "$IPAddress"
                                        ),
                                        "QuoteRequest" => array(
                                            "QuoteType" => "HomeSecurity",
                                            "Person" => array(
                                                "BirthDate" => "1980-02-02",
                                                "Gender" => "Unspecified",
                                            ),
                                            "CustomField1" => "Free text",
                                            "CustomField2" => "Free text",
                                            "CustomField3" => "Free text",
                                            "CustomField4" => "Free text",
                                            "CustomField5" => "Free text",
                                            "CustomField6" => "Free text",
                                            "CustomField7" => "Free text",
                                            "CustomField8" => "Free text",
                                            "CustomField9" => "Free text",
                                            "CustomField10" => "Free text",
                                            "Homes" => array(
                                                "Home" => array(
                                                    "SqFootage" => "1001 to 2500",
                                                    "OwnRented" => "$property_type",
                                                    "EntrancesExits" => "2 to 4",
                                                    "HasSystem" => "$lead_have_item_before_it",
                                                    "CurrentSecuritySystemCompany" => "Other",
                                                    "SecuritySystem" => array(
                                                        "SecurityType" => "Both burglar and fire detection",
                                                        "SecurityUsage" => "$SecurityUsage",
                                                        "InstallationTimeFrame" => "$start_time"
                                                    )
                                                )
                                            )
                                        )
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                $result2 = json_decode($result, true);
                                if (!empty($result2)) {
                                    if (!empty($result2['Result'])) {
                                        if ($result2['Result'] == "BaeOK") {
                                            return 1;
                                        }
                                    }
                                }
                            }
                            break;
                        case 5:
                            //WALK-IN TUBS
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $reason = trim($crm_details['data']['reason']);
                            $features = trim($crm_details['data']['features']);

                            $reasonData = ($reason == 'Others' ? "Other" : $reason);
                            switch ($ownership) {
                                case 'Yes':
                                    $OwnRented = "Own";
                                    $ResidenceType = "My own house";
                                    break;
                                case 'No':
                                    $OwnRented = "Rented";
                                    $ResidenceType = "I am renting";
                                    break;
                                default:
                                    $OwnRented = "Rented but I can make improvements";
                                    $ResidenceType = "I am renting";
                            }

                            $url_api = "https://leadapi.px.com/api/lead/post";
                            $PartnerToken = "569069BC-004C-402F-B51B-9B1AE3BE65FF";

                            if (config('app.env', 'local') == "local") {
                                //Test Mode
                                $google_ts = "test";
                                $zip = "90100";
                            }

                            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                                $Lead_data_array = array(
                                    "ApiToken" => "$PartnerToken",
                                    "Vertical" => "WalkinTubs",
                                    "SubId" => "$google_ts",
                                    "UserAgent" => "$UserAgent",
                                    "OriginalUrl" => "$OriginalURL2",
                                    "Source" => "All",
                                    "JornayaLeadId" => "$LeadId",
                                    "TrustedForm" => "$trusted_form",
                                    "SessionLength" => "$SessionLength",
                                    "TcpaText" => "$TCPAText",
                                    "VerifyAddress" => "false",
                                    "TransactionId" => "$TransactionId",
                                    "ContactData" => array(
                                        "FirstName" => "$first_name",
                                        "LastName" => "$last_name",
                                        "Address" => "$street",
                                        "City" => "$city",
                                        "State" => "$statename_code",
                                        "ZipCode" => "$zip",
                                        "EmailAddress" => "$email",
                                        "PhoneNumber" => "$number1",
                                        "DayPhoneNumber" => "$number1",
                                        "IpAddress" => "$IPAddress"
                                    ),
                                    "Custom" => array(
                                        "Field1" => "Free text",
                                        "Field2" => "Free text",
                                        "Field3" => "Free text",
                                        "Field4" => "Free text",
                                        "Field5" => "Free text",
                                        "Field6" => "Free text",
                                        "Field7" => "Free text",
                                        "Field8" => "Free text",
                                        "Field9" => "Free text",
                                        "Field10" => "Free text"
                                    ),
                                    "Person" => array(
                                        "FirstName" => "$first_name",
                                        "LastName" => "$last_name",
                                        "BirthDate" => "1980-07-27",
                                        "Gender" => "Male",
                                        "ResidenceType" => "$ResidenceType"
                                    ),
                                    "WalkinTub" => array(
                                        "ReasonForInstallation" => "$reasonData",
                                        "OwnRented" => "$OwnRented",
                                        "ProjectTimeFrame" => "$start_time",
                                        "CurrentBath" => "Standard bathtub",
                                        "BathFeatures" => "Not sure",
                                        "BathFinish" => "White",
                                        "BathMaterial" => "Acrylic",
                                        "BathType" => "Air bath",
                                        "FixtureSide" => "Right Hand",
                                        "HotWaterHeaterSize" => "Less than 30 gallons",
                                        "InstallationType" => "Not Sure"
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                $result2 = json_decode($result, true);
                                if (!empty($result2)) {
                                    if (!empty($result2['Success'])) {
                                        if ($result2['Success'] == "true") {
                                            return 1;
                                        }
                                    }
                                }
                            }
                            break;
                        case 6:
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $start_time = trim($crm_details['data']['start_time']);

                            switch ($project_nature) {
                                case "Completely replace roof":
                                    $project_nature_text = "New Roof for an Existing Home";
                                    break;
                                case "Repair existing roof":
                                    $project_nature_text = "Repair";
                                    break;
                                default:
                                    $project_nature_text = "New Roof for New Home";
                            }

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roof_type_text = "Asphalt Shingle";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roof_type_text = "Cedar Shake";
                                    break;
                                case "Metal Roofing":
                                    $roof_type_text = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_text = "Natural Slate";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_text = "Tile";
                                    break;
                            }

                            if (config('app.env', 'local') == "local") {
                                //Test Mode
                                $url_api = "http://api.open.stagingpx.com/px";
                                $PartnerToken = "C1BDC394-5005-4A01-8703-F90ABC58AAA5";
                                $AffiliateData_id = "325";
                                $AffiliateData_OfferId = "2015";
                            } else {
                                //Live Mode
                                $url_api = "https://secureopenapi.px.com/px";
                                $PartnerToken = "EE17B5A2-FC59-40A3-A7D8-60022FB4A66B";
                                $AffiliateData_id = "10633";
                                $AffiliateData_OfferId = "2043";
                            }

                            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                                $Lead_data_array = array(
                                    "type" => "jsonwsp/request",
                                    "version" => "1.0",
                                    "methodname" => "Lead.Post",
                                    "LeadData" => array(
                                        "Target" => "Lead.Post",
                                        "PartnerToken" => "$PartnerToken",
                                        "RequestTime" => "$request_date",
                                        "UserAgent" => "$UserAgent",
                                        "OriginalURL" => "$OriginalURL2",
                                        "SessionLength" => "$SessionLength",
                                        "TransactionId" => "$TransactionId",
                                        "TCPAText" => "$TCPAText",
                                        "AffiliateData" => array(
                                            "Id" => "$AffiliateData_id",
                                            "OfferId" => "$AffiliateData_OfferId",
                                            "SubId" => "$google_ts",
                                            "Source" => "All",
                                            "VerifyAddress" => "false",
                                            "RespondOnNoSale" => "true",
                                            "SellResponseURL" => "",
                                            "LeadId" => "$LeadId",
                                            "TrustedForm" => "$trusted_form",
                                            "ClickConsentID" => ""
                                        ),
                                        "ContactData" => array(
                                            "FirstName" => "$first_name",
                                            "LastName" => "$last_name",
                                            "Address" => "$street",
                                            "City" => "$city",
                                            "State" => "$statename_code",
                                            "ZIPCode" => "$zip",
                                            "EmailAddress" => "$email",
                                            "PhoneNumber" => "$number1",
                                            "DayPhoneNumber" => "$number1",
                                            "IPAddress" => "$IPAddress"
                                        ),
                                        "QuoteRequest" => array(
                                            "QuoteType" => "Roofing",
                                            "Persons" => array(
                                                "Person" => array(
                                                    "FirstName" => "$first_name",
                                                    "LastName" => "$last_name",
                                                    "BirthDate" => "1980-02-02",
                                                    "Gender" => "Unspecified",
                                                    "BestTimeToCall" => "Any time",
                                                ),
                                            ),
                                            "CustomField1" => "Free text",
                                            "CustomField2" => "Free text",
                                            "CustomField3" => "Free text",
                                            "CustomField4" => "Free text",
                                            "CustomField5" => "Free text",
                                            "CustomField6" => "Free text",
                                            "CustomField7" => "Free text",
                                            "CustomField8" => "Free text",
                                            "CustomField9" => "Free text",
                                            "CustomField10" => "Free text",
                                            "Homes" => array(
                                                "Home" => array(
                                                    "ProjectType" => "$project_nature_text",
                                                    "PropertyType" => "$property_type",
                                                    "OwnRented" => "Own",
                                                    "AuthorizedToMakeChanges" => "Yes",
                                                    "RoofType" => "$roof_type_text"
                                                )
                                            )
                                        )
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                $result2 = json_decode($result, true);
                                if (!empty($result2)) {
                                    if (!empty($result2['Result'])) {
                                        if ($result2['Result'] == "BaeOK") {
                                            return 1;
                                        }
                                    }
                                }
                            }
                            break;
                        case 24:
                            //Auto Insurance 24
                            $VehicleYear = trim($crm_details['data']['VehicleYear']);
                            $VehicleMake = trim($crm_details['data']['VehicleMake']);
                            $car_model = trim($crm_details['data']['car_model']);
                            $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                            $driversNum = trim($crm_details['data']['driversNum']);
                            $birthday = trim($crm_details['data']['birthday']);
                            $genders = trim($crm_details['data']['genders']);
                            $married = trim($crm_details['data']['married']);
                            $license = trim($crm_details['data']['license']);
                            $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                            $driver_experience = trim($crm_details['data']['driver_experience']);
                            $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                            $DUI_charges = trim($crm_details['data']['DUI_charges']);
                            $SR_22_need = trim($crm_details['data']['SR_22_need']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $ownership_data = ($ownership == "Yes" ? "My own house" : "I am renting");
                            $married_data = ($married == "Yes" ? "Married" : "Single");
                            $license_data = ($license == "Yes" ? "Current" : "Expired");
                            $SR_22_need = ($SR_22_need == "Yes" ? "Yes" : "No");

                            $url_api = "https://leadapi.px.com/api/lead/post";
                            $PartnerToken = "73CD0E0E-6695-4515-AF44-0148B0C7823E";

                            if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                                $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $google_ts = "test";
                                }

                                $Lead_data_array = array(
                                    "ApiToken" => "$PartnerToken",
                                    "Vertical" => "Auto",
                                    "SubId" => "$google_ts",
                                    "OriginalUrl" => "$OriginalURL2",
                                    "Source" => "mixed",
                                    "JornayaLeadId" => "$LeadId",
                                    "SessionLength" => "$SessionLength",
                                    "TcpaText" => "$TCPAText",
                                    "VerifyAddress" => "false",
                                    "TransactionId" => "$TransactionId",
                                    "ContactData" => array(
                                        "FirstName" => "$first_name",
                                        "LastName" => "$last_name",
                                        "Address" => "$street",
                                        "City" => "$city",
                                        "State" => "$statename_code",
                                        "ZipCode" => "$zip",
                                        "EmailAddress" => "$email",
                                        "PhoneNumber" => "$number1",
                                        "DayPhoneNumber" => "$number1",
                                        "IpAddress" => "$IPAddress",
                                        "ResidenceType" => "$ownership_data",
                                        "YearsAtResidence" => "2",
                                        "MonthsAtResidence" => "1"
                                    ),
                                    "Driver" => array(
                                        "FirstName" => "$first_name",
                                        "LastName" => "$last_name",
                                        "BirthDate" => "$birthday",
                                        "Gender" => "$genders",
                                        "MaritalStatus" => "$married_data",
                                        "RelationshipToApplicant" => "Self",
                                        "LicenseState" => "$statename_code",
                                        "AgeLicensed" => "16",
                                        "LicenseStatus" => "$license_data",
                                        "LicenseEverSuspendedRevoked" => "No",
                                        "Occupation" => "Unknown",
                                        "YearsAtEmployer" => "10",
                                        "Education" => "Other",
                                        "RequiresSR22Filing" => "$SR_22_need",
                                        "CreditRating" => "Good"
                                    ),
                                    "Vehicle" => array(
                                        "VIN" => "",
                                        "Year" => "$VehicleYear",
                                        "Make" => "$VehicleMake",
                                        "Model" => "$car_model",
                                        "WeeklyCommuteDays" => "7",
                                        "Garage" => "No Cover",
                                        "Ownership" => "$ownership",
                                        "PrimaryUse" => "Commute To/From Work",
                                        "AnnualMiles" => "2500",
                                        "ComprehensiveDeductible" => "500",
                                        "OneWayDistance" => "1-3",
                                        "CollisionDeductible" => "100"
                                    ),
                                    "CurrentInsurancePolicy" => array(
                                        "InsuranceCompany" => "",
                                        "ExpirationDate" => "",
                                        "InsuredSince" => ""
                                    ),
                                    "RequestedInsurancePolicy" => array(
                                        "CoverageType" => "Superior Protection",
                                        "BodilyInjury" => "25/50",
                                        "PropertyDamage" => "5000"
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                $result2 = json_decode($result, true);
                                if (!empty($result2)) {
                                    if (!empty($result2['Success'])) {
                                        if ($result2['Success'] == "true") {
                                            return 1;
                                        }
                                    }
                                }
                            }
                            break;
                    }
                    break;
                case 38:
                    //Astoria
                    $lead_type = 18;
                    if (config('app.env', 'local') == "local") {
                        $lead_mode = 0;
                    } else {
                        $lead_mode = 1;
                    }
                    $vendor_id = 45696;
                    $sub_id = $lead_source_text;
                    $tcpa_optin = $tcpa_compliant;
                    $origination_datetime = date('Y-m-d H:i:s');
                    $origination_timezone = 4;
                    $timeframe = 1;
                    $project_status = 1;

                    $home_owner = 1;
                    if (isset($crm_details['data']['property_type'])) {
                        $property_type = trim($crm_details['data']['property_type']);
                        $home_owner = ($property_type != "Owned" ? 0 : 1);
                    } else if (isset($crm_details['data']['homeOwn'])) {
                        $ownership = trim($crm_details['data']['homeOwn']);
                        $home_owner = ($ownership == "No" ? 0 : 1);
                    }

                    $url_api_post = "https://api.astoriacompany.com/v2/post/";

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded"
                    );

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $confirmation_id = $data_msg['ping_post_data']['TransactionId'];

                        $Lead_data_post = "confirmation_id=$confirmation_id&lead_type=$lead_type&lead_mode=$lead_mode&vendor_id=$vendor_id&sub_id=$sub_id&tcpa_optin=$tcpa_optin&tcpa_text=$TCPAText&universal_leadid=$LeadId&origination_datetime=$origination_datetime&origination_timezone=$origination_timezone&ipaddress=$IPAddress&url=$OriginalURL&first_name=$first_name&last_name=$last_name&email=$email&address=$street&zip=$zip&primary_phone=$number1&timeframe=$timeframe&home_owner=$home_owner&project_status=$project_status&xxtrustedformcerturl=$trusted_form";

                        //Services
                        switch ($crm_details['service_id']) {
                            case 1:
                                //windows
                                $project_nature = trim($crm_details['data']['project_nature']);
                                if ($project_nature != "Repair") {
                                    $project = 96;
                                    $task_ID = 128;
                                    $Lead_data_post .= "&project=$project&task=$task_ID";
                                } else {
                                    $project = 90;
                                    $Lead_data_post .= "&project=$project";
                                }
                                break;
                            case 2:
                                //Solar
                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);

                                $current_provider = 1;
                                $roof_type = 1;
                                $credit_rating = 2;
                                $property_type_data = 1;
                                $project = 91;

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50':
                                        $average_bill = 1;
                                        break;
                                    case '$51 - $100':
                                        $average_bill = 2;
                                        break;
                                    case '$101 - $150':
                                        $average_bill = 3;
                                        break;
                                    case '$151 - $200':
                                        $average_bill = 4;
                                        break;
                                    case '$201 - $300':
                                        $average_bill = 5;
                                        break;
                                    case '$301 - $400':
                                        $average_bill = 6;
                                        break;
                                    case '$401 - $500':
                                        $average_bill = 7;
                                        break;
                                    default:
                                        $average_bill = 8;
                                }

                                switch ($roof_shade) {
                                    case "Full Sun":
                                        $roof_shade_data = 0;
                                        break;
                                    case "Mostly Shaded":
                                        $roof_shade_data = 1;
                                        break;
                                    case "Partial Sun":
                                        $roof_shade_data = 2;
                                        break;
                                    default:
                                        $roof_shade_data = 3;
                                }

                                $Lead_data_post .= "&project=$project&current_provider=$current_provider&monthly_bill=$average_bill&property_type=$property_type_data&roof_type=$roof_type&roof_shade=$roof_shade_data&credit_rating=$credit_rating";
                                break;
                            case 3:
                                //Home Security
                                $project = 97;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 4:
                                //Flooring
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $project = ($project_nature != "Repair Existing Flooring" ? 77 : 90);
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 6:
                                //Roofing
                                $Type_OfRoofing = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);

                                $project = 88;
                                if ($project_nature == "Repair existing roof") {
                                    $task_ID = 108;
                                } else {
                                    switch ($Type_OfRoofing) {
                                        case "Asphalt Roofing":
                                            $task_ID = 101;
                                            break;
                                        case "Wood Shake/Composite Roofing":
                                            $task_ID = 107;
                                            break;
                                        case "Metal Roofing":
                                            $task_ID = 104;
                                            break;
                                        case "Natural Slate Roofing":
                                            $task_ID = 105;
                                            break;
                                        case "Tile Roofing":
                                            $task_ID = 106;
                                            break;
                                        default:
                                            $task_ID = 109;
                                    }
                                }
                                $Lead_data_post .= "&project=$project&task=$task_ID";
                                break;
                            case 7:
                                //Siding
                                $type_of_siding = trim($crm_details['data']['type_of_siding']);
                                $project_nature = trim($crm_details['data']['project_nature']);

                                if ($project_nature != "Repair section(s) of siding") {
                                    $project = 89;

                                    switch ($type_of_siding) {
                                        case "Vinyl Siding":
                                            $task_ID = 113;
                                            break;
                                        case "Brickface Siding" || "Stoneface Siding":
                                            $task_ID = 110;
                                            break;
                                        case "Composite wood Siding" || "Fiber Cement Siding":
                                            $task_ID = 114;
                                            break;
                                        default:
                                            $task_ID = 115;
                                    }

                                    $Lead_data_post .= "&project=$project&task=$task_ID";
                                } else {
                                    $project = 90;
                                    $Lead_data_post .= "&project=$project";
                                }
                                break;
                            case 8:
                                //Kitchen
                                $project = 82;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 9:
                                //Bathroom
                                $project = 63;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 11 || 12 || 13:
                                //HVAC
                                $project = 81;

                                $project_nature = trim($crm_details['data']['project_nature']);
                                if ($project_nature == "Repair") {
                                    $task_ID = 78;
                                } else {
                                    switch ($crm_details['service_id']) {
                                        case 11:
                                            $type_of_heating = trim($crm_details['data']['type_of_heating']);

                                            switch ($type_of_heating) {
                                                case "Do Not Know":
                                                    $task_ID = 78;
                                                    break;
                                                case "Oil":
                                                    $task_ID = 76;
                                                    break;
                                                default:
                                                    $task_ID = 73;
                                            }
                                            break;
                                        case 12:
                                            $type_of_heating = trim($crm_details['data']['type_of_heating']);

                                            switch ($type_of_heating) {
                                                case "Do Not Know":
                                                    $task_ID = 78;
                                                    break;
                                                case "Oil":
                                                    $task_ID = 75;
                                                    break;
                                                default:
                                                    $task_ID = 72;
                                            }
                                            break;
                                        case 13:
                                            $task_ID = 71;
                                            break;
                                    }
                                }

                                $Lead_data_post .= "&project=$project&task=$task_ID";
                                break;
                            case 14:
                                //Cabinet
                                $project = 64;
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $task_ID = ($project_nature == "Cabinet Install" ? 14 : 15);
                                $Lead_data_post .= "&project=$project&task=$task_ID";
                                break;
                            case 15:
                                //Plumbing
                                $project = 87;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 17:
                                //Sunrooms
                                $project = 92;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 18:
                                //Handyman
                                $project = 80;
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 19:
                                //CounterTops
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $project = ($project_nature != "Repair" ? 64 : 90);
                                $Lead_data_post .= "&project=$project";
                                break;
                            case 20:
                                //Doors
                                $door_type = trim($crm_details['data']['door_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                if ($project_nature != "Repair") {
                                    $project = 72;
                                    $task_ID = ($door_type == "Exterior" ? 49 : 50);
                                    $Lead_data_post .= "&project=$project&task=$task_ID";
                                } else {
                                    $project = 90;
                                    $Lead_data_post .= "&project=$project";
                                }
                                break;
                            case 21:
                                //Gutters
                                $project = 88;
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $task_ID = ($project_nature == "Repair" ? 108 : 103);
                                $Lead_data_post .= "&project=$project&task=$task_ID";
                                break;
                            case 23:
                                //Painting
                                $project = 85;
                                $service_type = trim($crm_details['data']['service']);

                                switch ($service_type) {
                                    case "Exterior Home or Structure - Paint or Stain":
                                        $task_ID = 90;
                                        break;
                                    case "Interior Home or Surfaces - Paint or Stain":
                                        $task_ID = 91;
                                        break;
                                    case "Specialty Painting - Textures":
                                        $task_ID = 93;
                                        break;
                                    default:
                                        $task_ID = 94;
                                }

                                $Lead_data_post .= "&project=$project&task=$task_ID";
                                break;
                        }

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                        try {
                            libxml_use_internal_errors(true);
                            $result2 = simplexml_load_string($result);
                            $result3 = json_encode($result2);
                            $result4 = json_decode($result3, TRUE);

                            if (!empty($result4)) {
                                if (!empty($result4['Response'])) {
                                    if ($result4['Response'] == "Accepted") {
                                        return 1;
                                    }
                                }
                            }
                        } catch (Exception $e) {

                        }
                    }
                    break;
                case 72:
                    //Adopt A Contractor =======================================================================================
                    $numcategory = 0;
                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $number_of_window = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            if ($project_nature != "Repair") {
                                $numcategory = ($number_of_window == 1 ? "318" : "232");
                            } else {
                                $numcategory = "299";
                            }
                            break;
                        case 2:
                            //Solar
                            $numcategory = "80";
                            break;
                        case 3:
                            //Home Security
                            $property_type = trim($crm_details['data']['property_type']);
                            $numcategory = ($property_type == "Business" ? "311" : "310");
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($Type_OfFlooring) {
                                case "Tile Flooring":
                                    $numcategory = ($project_nature == "Repair" ? "227" : "226");
                                    break;
                                case "Hardwood Flooring":
                                    $numcategory = "112";
                                    break;
                                case "Laminate Flooring":
                                    $numcategory = ($project_nature == "Repair" ? "114" : "113");
                                    break;
                                default:
                                    $numcategory = ($project_nature == "Repair" ? "116" : "115");
                            }
                            break;
                        case 5:
                            // Walk-In Tubs
                            $numcategory = "368";
                            break;
                        case 6:
                            //Roofing
                            $property_type = trim($crm_details['data']['property_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $roof_type = trim($crm_details['data']['roof_type']);

                            if ($property_type == "Commercial") {
                                $numcategory = "205";
                            } else {
                                switch ($roof_type) {
                                    case "Asphalt Roofing":
                                        switch ($project_nature) {
                                            case "Repair existing roof":
                                                $numcategory = "265";
                                                break;
                                            case "Completely replace roof":
                                                $numcategory = "271";
                                                break;
                                            default:
                                                $numcategory = "259";
                                        }
                                        break;
                                    case "Wood Shake/Composite Roofing":
                                        switch ($project_nature) {
                                            case "Repair existing roof":
                                                $numcategory = "269";
                                                break;
                                            case "Completely replace roof":
                                                $numcategory = "276";
                                                break;
                                            default:
                                                $numcategory = "264";
                                        }
                                        break;
                                    case "Metal Roofing":
                                        switch ($project_nature) {
                                            case "Repair existing roof":
                                                $numcategory = "266";
                                                break;
                                            case "Completely replace roof":
                                                $numcategory = "273";
                                                break;
                                            default:
                                                $numcategory = "261";
                                        }
                                        break;
                                    case "Natural Slate Roofing":
                                        switch ($project_nature) {
                                            case "Repair existing roof":
                                                $numcategory = "267";
                                                break;
                                            case "Completely replace roof":
                                                $numcategory = "274";
                                                break;
                                            default:
                                                $numcategory = "262";
                                        }
                                        break;
                                    case "Tile Roofing":
                                        switch ($project_nature) {
                                            case "Repair existing roof":
                                                $numcategory = "268";
                                                break;
                                            case "Completely replace roof":
                                                $numcategory = "275";
                                                break;
                                            default:
                                                $numcategory = "263";
                                        }
                                        break;
                                }
                            }
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $numcategory = ($project_nature == "Repair" ? "297" : "23");
                            break;
                        case 8:
                            //Kitchen
                            $numcategory = "199";
                            break;
                        case 9:
                            //Bathroom
                            $numcategory = "193";
                            break;
                        case 11:
                            //Furnace
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $numcategory = ($project_nature == "Repair" ? "145" : "144");
                            break;
                        case 12:
                            //Boiler
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $numcategory = ($project_nature == "Repair" ? "179" : "178");
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $numcategory = ($project_nature == "Repair" ? "137" : "136");
                            break;
                        case 14:
                            //Cabinet
                            $numcategory = "24";
                            break;
                        case 15:
                            //Plumbing
                            $numcategory = "184";
                            break;
                        case 18:
                            //Handyman
                            $numcategory = "295";
                            break;
                        case 19:
                            //Countertops
                            $countertops_service = trim($crm_details['data']['service']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($countertops_service) {
                                case "Laminate":
                                    $numcategory = ($project_nature == "Repair" ? "326" : "325");
                                    break;
                                case "Stainless Steel":
                                    $numcategory = ($project_nature == "Repair" ? "48" : "334");
                                    break;
                                case "Other Solid Stone (e.g Quartz)":
                                    $numcategory = ($project_nature == "Repair" ? "48" : "335");
                                    break;
                                default:
                                    $numcategory = "48";
                            }
                            break;
                        case 20:
                            //Doors
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $numcategory = ($project_nature == "Repair" ? "131" : "31");
                            break;
                        case 21:
                            //Gutter
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $service = trim($crm_details['data']['service']);

                            switch ($service) {
                                case "Galvanized Steel":
                                    $numcategory = ($project_nature == "Repair" ? "324" : "323");
                                    break;
                                case "PVC":
                                    $numcategory = ($project_nature == "Repair" ? "331" : "330");
                                    break;
                                case "Seamless Aluminum":
                                    $numcategory = ($project_nature == "Repair" ? "333" : "332");
                                    break;
                                case "Wood":
                                    $numcategory = ($project_nature == "Repair" ? "339" : "338");
                                    break;
                                default:
                                    $numcategory = ($project_nature == "Repair" ? "294" : "206");
                            }
                            break;
                        case 22:
                            //Paving
                            $numcategory = "242";
                            break;
                        case 23:
                            //Painting
                            $service_type = trim($crm_details['data']['service']);

                            switch ($service_type) {
                                case "Interior Home or Surfaces - Paint or Stain":
                                    $rooms_number = trim($crm_details['data']['rooms_number']);
                                    $numcategory = ($rooms_number == "1-2" ? "170" : "169");
                                    break;
                                case "Specialty Painting - Textures":
                                    $numcategory = "176";
                                    break;
                                default:
                                    $numcategory = "167";
                            }
                            break;
                        case 32:
                            //Home Warranty
                            $numcategory = "532";
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        $key = "test_mode";
                        $google_ts = "match";
                    } else {
                        if (strpos("-" . strtolower($campaign_name), 'premium') == true) {
                            $key = "8f8e198a7bdf919736a97535923787e0";
                            $partnerid = "ADM2";
                        } else {
                            $key = "aa0da7f3c033c2244b72dbdbaf969847";
                            $partnerid = "ADM";
                        }
                    }


                    $trusted_form = substr($data_msg['trusted_form'], strrpos($data_msg['trusted_form'], '/') + 1);

                    $trusted_form_available = $universal_leadid_available = 0;
                    if (!empty($trusted_form)) {
                        $trusted_form_available = 1;
                    }
                    if (!empty($LeadId)) {
                        $universal_leadid_available = 1;
                    }

                    $url_api_post = "http://api.letsmakealead.com/Post_Partner.php?";

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $confirmation_id = $data_msg['ping_post_data']['TransactionId'];

                        $TCPAText = urlencode($TCPAText);

                        $url_api_post .= "partnerid=$partnerid&subid=$google_ts&key=$key&numcategory=$numcategory&token=$confirmation_id&zipcode=$zip&firstname=$first_name&lastname=$last_name&address=$street&telephone=$number1&email=$email&trusted_form_available=$trusted_form_available&universal_leadid_available=$universal_leadid_available&trusted_form_token=$trusted_form&universal_leadid=$LeadId&city=$city&ip=$IPAddress&tcpa_optin=$tcpa_compliant&tcpa_text=$TCPAText";

                        if ($crm_details['service_id'] == 2) {
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = '50';
                                    break;
                                case '$51 - $100':
                                    $average_bill = '100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '300';
                                    break;
                                case '$301 - $400':
                                    $average_bill = '400';
                                    break;
                                case '$401 - $500':
                                    $average_bill = '500';
                                    break;
                                default:
                                    $average_bill = '600';
                            }

                            $url_api_post .= "&average_monthly_electricity_bill=$average_bill&electricity_service_provider=$utility_provider";
                        }

                        $numberOfCamp = $crm_details['count_of_camp'];
                        if ($listOFCampainDB_type == "Shared") {
                            $hash1 = md5($leadsCustomerCampaign_id);
                            if ($numberOfCamp >= 3) {
                                $numberOfCamp = 3;
                                $hash1 .= "," . md5($leadsCustomerCampaign_id + 1) . "," . md5($leadsCustomerCampaign_id + 2);
                            } else if ($numberOfCamp == 2) {
                                $hash1 .= "," . md5($leadsCustomerCampaign_id + 1);
                            }

                            $url_api_post .= "&shared=1&nb_legs_available=3&nb_legs_sold=$numberOfCamp&hash_legs_sold=$hash1";
                        }

                        $url_api_post = str_replace(" ", "%20", $url_api_post);

                        $Lead_data_post = "";

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                        if (!empty($result)) {
                            if (strpos("-" . $result, 'ACCEPTED') == true) {
                                return 1;
                            }
                        }
                    }
                    break;
                case 78:
                    //Sun Run / Clean Energy 78
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    $property_ownership = ($property_type == "Rented" ? "RENT" : "OWN");
                    $solar_electric = ($power_solution == "Solar Water Heating for my Home" ? "false" : "true");
                    $solar_hot_water = ($power_solution == "Solar Electricity for my Home" ? "false" : "true");

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $monthly_bill = "$0-50";
                            break;
                        case '$51 - $100':
                            $monthly_bill = "$51-100";
                            break;
                        case '$101 - $150':
                            $monthly_bill = "$101-150";
                            break;
                        case '$151 - $200':
                            $monthly_bill = "$151-200";
                            break;
                        case '$201 - $300':
                            $monthly_bill = "$201-300";
                            break;
                        case '$301 - $400':
                            $monthly_bill = "$301-400";
                            break;
                        case '$401 - $500':
                            $monthly_bill = "$401-500";
                            break;
                        default:
                            $monthly_bill = "$501-600";
                    }

                    switch ($roof_shade) {
                        case "Full Sun":
                            $roof_shade_data = "No Shade";
                            break;
                        case "Mostly Shaded":
                            $roof_shade_data = "A Lot Of Shade";
                            break;
                        case "Partial Sun":
                            $roof_shade_data = "A Little Shade";
                            break;
                        default:
                            $roof_shade_data = "Uncertain";
                    }

                    $camp_name = "";
                    if ($crm_details['is_ping_account'] == 1) {
                        if (strpos("-" . $campaign_name, '(New)') == true) {
                            $camp_name = "ALLDM:SREL-PingPost (ALT PRICING)";
                            $camp_key = "8AE6AAA3DE4E7618";
                        } else {
                            $camp_name = "ALLDM:SREL-PingPost";
                            $camp_key = "920CCA8F725B49D1";
                        }

                        $url_post = "http://receiver.ceeleads.info/leads/pingpost";
                    } else {
                        $camp_key = "4DDF7B0035345227";
                        $url_post = "http://receiver.ceeleads.info/leads/post2";
                    }

                    $url_api = "$url_post?campid=$camp_key&city=$city&state=$statename_code&zip=$zip&property_ownership=$property_ownership&electric_bill=$monthly_bill&electricUtilityProviderText=$utility_provider&roof_shade=$roof_shade_data&solar_electric=$solar_electric&solar_hot_water=$solar_hot_water&ip_address=$IPAddress&s1=$google_ts&s3=$OriginalURL&s4=$camp_name&first_name=$first_name&last_name=$last_name&street=$street&email=$email&phone_home=$number1&universal_leadid=$LeadId&xxTrustedFormCertUrl=$trusted_form";

                    if ($crm_details['is_ping_account'] == 1) {
                        if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                            $ping_id = $data_msg['ping_post_data']['TransactionId'];
                            $url_api .= "&ping_id=$ping_id";
                        }
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/x-www-form-urlencoded"
                    );

                    $Lead_data_array = "";

                    $url_api = str_replace(" ", "%20", $url_api);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2['status'])) {
                            if ($crm_details['is_ping_account'] == 1) {
                                if ($result2['status'] == "PING_POST_VALID") {
                                    return 1;
                                }
                            } else {
                                if ($result2['status'] == "POST_VALID") {
                                    return 1;
                                }
                            }
                        }
                    }
                    break;
                case 77:
                    //lightfirecrm
                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $api_key = "D3D9BA96-0552-4266-86AE-1B9C744569F6";
                            $source = "ADM-WINDOWS";
                            $windows = trim($crm_details['data']['number_of_window']);

                            $url_api_post = "https://www.lightfirecrm.com/api/tubpost.php?api_key=$api_key&source=$source&fname=$first_name&lname=$last_name&street=$street&city=$city&state=$state&zip=$zip&phone=$number1&email=$email&ip=$IPAddress&windows=$windows&xxTrustedFormToken=$trusted_form&xxTrustedFormCertUrl=$trusted_form";
                            $url_api_post = str_replace(" ", "%20", $url_api_post);
                            $httpheader = array();

                            $Lead_data_post = "";
                            $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $crm_details['leadsCustomerCampaign_id'], $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                            break;
                        case 9:
                            //Bathroom
                            $api_key = "F221BC3E-33C8-4687-8763-930A203D5B2D";
                            $source = "ADM-BATHWRAP";

                            $url_api_post = "https://www.lightfirecrm.com/api/tubpost.php?api_key=$api_key&source=$source&fname=$first_name&lname=$last_name&street=$street&city=$city&state=$state&zip=$zip&phone=$number1&email=$email&ip=$IPAddress&xxTrustedFormToken=$trusted_form&xxTrustedFormCertUrl=$trusted_form";
                            $url_api_post = str_replace(" ", "%20", $url_api_post);
                            $httpheader = array();

                            $Lead_data_post = "";
                            $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $crm_details['leadsCustomerCampaign_id'], $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                            break;
                    }
                    return 1;
                    break;
                case "OldHomeAdviser":
                    // //home advisor =======================================================================================
                    $r_username = "allied_ping";
                    $r_accesskey = "sj7ayz8t";
                    $partnerSourceID = $lead_source_text;
                    $partnerReferenceID = $crm_details['leadsCustomerCampaign_id'];

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $testOnly = "true";
                    } else {
                        //Live Mode
                        $testOnly = "false";
                    }

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $bidKey = $data_msg['ping_post_data']['TransactionId'];
                        $url_api_post = "https://api.homeadvisor.com/resource/external/sr/bid/$bidKey?r_username=$r_username&r_accesskey=$r_accesskey";

                        $httpheader = array(
                            "Content-Type: application/xml",
                            "Cookie: __cfduid=d0e5180095f49307a6f84bfe625526e0e1597046007; JSESSIONID=DA92CF8E0D7BA4962F378C7F8217A738.pu000api001-1; __cflb=04dTocdHXGGtou6tT8LbP4R8BxhRsYvJp59Zpvc6w5"
                        );

                        $Lead_data_post = '<?xml version="1.0" encoding="UTF-8"?>
                            <serviceRequest affiliateCode="' . $r_username . '" version="1.0" partnerSourceID="' . $partnerSourceID . '" partnerReferenceID="' . $partnerReferenceID . '" testOnly="' . $testOnly . '">
                                <customer>
                                    <contact>
                                    <firstName>' . $first_name . '</firstName>
                                        <lastName>' . $last_name . '</lastName>
                                        <contactMethods>
                                        <contactMethod type="dayPhone">' . $number1 . '</contactMethod>
                                        <contactMethod type="eveningPhone">' . $number1 . '</contactMethod>
                                        <contactMethod type="email">' . $email . '</contactMethod>
                                        </contactMethods>
                                    <optIn>yes</optIn>
                                    </contact>
                                    <location>
                                        <addressLine1>' . $street . '</addressLine1>
                                        <city>' . $city . '</city>
                                        <zip>' . $zip . '</zip>
                                    </location>
                                </customer>';

                        switch ($crm_details['service_id']) {
                            case 1:
                                //Windows
                                $number_of_window = trim($crm_details['data']['number_of_window']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);

                                if ($project_nature != "Repair") {
                                    switch ($number_of_window) {
                                        case 1 || 2:
                                            $task_oid = "61900";
                                            $task_text = "New Windows - 2";
                                            break;
                                        case "3-5":
                                            $task_oid = "61901";
                                            $task_text = "New Windows - 3-5";
                                            break;
                                        default:
                                            $task_oid = "61902";
                                            $task_text = "New Windows - 6 +";
                                    }
                                }

                                $project_nature_data = "New Window(s) - Installation";
                                $project_nature_answer_id = "9732";
                                if ($project_nature == "Repair") {
                                    $project_nature_data = "Repair Window Frame";
                                    $project_nature_answer_id = "9735";
                                }

                                switch ($number_of_window) {
                                    case 1:
                                        $number_of_window_data = "1";
                                        $number_of_window_id = "10707";
                                        break;
                                    case 2:
                                        //Solar
                                        $number_of_window_data = "2";
                                        $number_of_window_id = "10271";
                                        break;
                                    case "3-5":
                                        $number_of_window_data = "3 - 5";
                                        $number_of_window_id = "10831";
                                        break;
                                    case "6-9":
                                        $number_of_window_data = "6 - 9";
                                        $number_of_window_id = "10832";
                                        break;
                                    default:
                                        $number_of_window_data = "10+";
                                        $number_of_window_id = "10833";
                                }

                                switch ($start_time) {
                                    case "Immediately":
                                        $start_time_data = "Within 1 week";
                                        $start_time_id = "11150";
                                        $emergency_data = "Yes";
                                        $emergency_id = "10001";
                                        break;
                                    case "Within 6 months":
                                        $start_time_data = "More than 2 weeks";
                                        $start_time_id = "11152";
                                        $emergency_data = "No";
                                        $emergency_id = "10002";
                                        break;
                                    default:
                                        $start_time_data = "Timing is flexible";
                                        $start_time_id = "11149";
                                        $emergency_data = "No";
                                        $emergency_id = "10002";
                                }

                                $Lead_data_post .= '
                                    <task description="' . $task_text . '" oid="' . $task_oid . '">
                                        <interview>
                                            <question id="6829" description="What is the nature of this project?" type="TASK_INTERVIEW">
                                                <answer id="' . $project_nature_answer_id . '" questionID="6829">' . $project_nature_data . '</answer>
                                            </question>
                                            <question id="6830" description="How many Windows are involved?" type="TASK_INTERVIEW">
                                                <answer id="' . $number_of_window_id . '" questionID="6830">' . $number_of_window_data . '</answer>
                                            </question>
                                            <question id="8152" description="Is this an emergency?" type="TASK_INTERVIEW">
                                                <answer id="' . $emergency_id . '" questionID="8152">' . $emergency_data . '</answer>
                                            </question>
                                            <question id="80000" description="When would you like this request to be completed?" type="TASK_INTERVIEW">
                                                <answer id="' . $start_time_id . '" questionID="80000">' . $start_time_data . '</answer>
                                            </question>
                                        </interview>
                                    </task>';
                                break;
                            case 6:
                                //Roofing
                                $Type_OfFlooring = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($Type_OfFlooring) {
                                    case "Asphalt Roofing":
                                        if ($project_nature != "Repair existing roof") {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40133";
                                                $task_text = "Asphalt Shingle Roofing - Install or Replace";
                                            } else {
                                                $task_oid = "60419";
                                                $task_text = "Asphalt Shingle Roofing - Install or Replace - For Business";
                                            }
                                        } else {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40391";
                                                $task_text = "Asphalt Shingle Roofing - Repair";
                                            } else {
                                                $task_oid = "60526";
                                                $task_text = "Asphalt Shingle Roofing - Repair - For Business";
                                            }
                                        }
                                        break;
                                    case "Wood Shake/Composite Roofing":
                                        if ($project_nature != "Repair existing roof") {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40404";
                                                $task_text = "Wood Shake or Composite Roofing - Install or Replace";
                                            } else {
                                                $task_oid = "60523";
                                                $task_text = "Wood Shake or Composite Roofing - Install or Replace- For Business";
                                            }
                                        } else {
                                            if ($property_type == "Residential") {
                                                $task_oid = "41122";
                                                $task_text = "Wood Shake or Composite Roofing - Repair";
                                            } else {
                                                $task_oid = "60527";
                                                $task_text = "Wood Shake or Composite Roofing - Repair- For Business";
                                            }
                                        }
                                        break;
                                    case "Metal Roofing":
                                        if ($project_nature != "Repair existing roof") {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40396";
                                                $task_text = "Metal Roofing - Install or Replace";
                                            } else {
                                                $task_oid = "60422";
                                                $task_text = "Metal Roofing - Install or Replace - For Business";
                                            }
                                        } else {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40397";
                                                $task_text = "Metal Roofing - Repair";
                                            } else {
                                                $task_oid = "60530";
                                                $task_text = "Metal Roofing - Repair - For Business";
                                            }
                                        }
                                        break;
                                    case "Natural Slate Roofing":
                                        if ($project_nature != "Repair existing roof") {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40400";
                                                $task_text = "Natural Slate Roofing - Install or Replace";
                                            } else {
                                                $task_oid = "60525";
                                                $task_text = "Natural Slate Roofing - Install or Replace- For Business";
                                            }
                                        } else {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40401";
                                                $task_text = "Natural Slate Roofing - Repair";
                                            } else {
                                                $task_oid = "60531";
                                                $task_text = "Natural Slate Roofing - Repair- For Business";
                                            }
                                        }
                                        break;
                                    case "Tile Roofing":
                                        if ($project_nature != "Repair existing roof") {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40402";
                                                $task_text = "Traditional Tile Roofing - Install or Replace";
                                            } else {
                                                $task_oid = "60533";
                                                $task_text = "Traditional Tile Roofing - Install or Replace- For Business";
                                            }
                                        } else {
                                            if ($property_type == "Residential") {
                                                $task_oid = "40403";
                                                $task_text = "Traditional Tile Roofing - Repair";
                                            } else {
                                                $task_oid = "60532";
                                                $task_text = "Traditional Tile Roofing - Repair- For Business";
                                            }
                                        }
                                        break;
                                }

                                switch ($project_nature) {
                                    case "Repair existing roof":
                                        $project_nature_answer_id = "9814";
                                        $project_nature_data = "Install roof on new construction";
                                        break;
                                    case "Completely replace roof":
                                        $project_nature_answer_id = "9813";
                                        $project_nature_data = "Completely replace roof";
                                        break;
                                    default:
                                        $project_nature_answer_id = "9815";
                                        $project_nature_data = "Repair existing roof";
                                }

                                switch ($start_time) {
                                    case "Immediately":
                                        $start_time_data = "Within 1 week";
                                        $start_time_id = "11150";
                                        break;
                                    case "Within 6 months":
                                        $start_time_data = "More than 2 weeks";
                                        $start_time_id = "11152";
                                        break;
                                    default:
                                        $start_time_data = "Timing is flexible";
                                        $start_time_id = "11149";
                                }

                                $Lead_data_post .= '
                                    <task description="' . $task_text . '" oid="' . $task_oid . '">
                                        <interview>
                                            <question id="6869" description="What is the nature of this project?" type="TASK_INTERVIEW">
                                                <answer id="' . $project_nature_answer_id . '" questionID="6869">' . $project_nature_data . '</answer>
                                            </question>
                                            <question id="160806" description="When would you like this request to be completed?" type="TASK_INTERVIEW">
                                                <answer id="' . $start_time_id . '" questionID="160806">' . $start_time_data . '</answer>
                                            </question>
                                            <question id="501504" description="Are you the owner or authorized to make property changes?" type="TASK_INTERVIEW">
                                                <answer id="10001" questionID="501504">Yes</answer>
                                            </question>
                                        </interview>
                                    </task>';
                                break;
                            case 7:
                                //Home Siding
                                $type_of_siding = trim($crm_details['data']['type_of_siding']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($type_of_siding) {
                                    case "Vinyl Siding":
                                        if ($project_nature != "Repair section(s) of siding") {
                                            $task_oid = "40146";
                                            $task_text = "Vinyl Siding - Install or Completely Replace";
                                        } else {
                                            $task_oid = "40147";
                                            $task_text = "Vinyl Siding - Repair or Partially Replace";
                                        }
                                        break;
                                    case "Brickface Siding" || "Stoneface Siding":
                                        if ($project_nature != "Repair section(s) of siding") {
                                            $task_oid = "40142";
                                            $task_text = "Brick or Stone Siding: Install or Completely Replace";
                                        } else {
                                            $task_oid = "40143";
                                            $task_text = "Brick or Stone Siding: Repair or Partially Replace";
                                        }
                                        break;
                                    case "Composite wood Siding" || "Fiber Cement Siding":
                                        if ($project_nature != "Repair section(s) of siding") {
                                            $task_oid = "40148";
                                            $task_text = "Wood or Fiber-Cement Siding - Install or Completely Replace";
                                        } else {
                                            $task_oid = "40149";
                                            $task_text = "Wood or Fiber-Cement Siding - Repair or Partially Replace";
                                        }
                                        break;
                                }

                                switch ($project_nature) {
                                    case "Siding for a new home":
                                        $project_nature_answer_id = "5686";
                                        $project_nature_data = "Siding for a new home";
                                        break;
                                    case "Siding for a new addition":
                                        $project_nature_answer_id = "5685";
                                        $project_nature_data = "Siding for a new addition";
                                        break;
                                    case "Replace existing siding":
                                        $project_nature_answer_id = "5261";
                                        $project_nature_data = "Replace existing siding";
                                        break;
                                    default:
                                        $project_nature_answer_id = "9876";
                                        $project_nature_data = "Repair section(s) of siding";
                                }

                                switch ($start_time) {
                                    case "Immediately":
                                        $start_time_data = "Within 1 week";
                                        $start_time_id = "11150";
                                        break;
                                    case  "Within 6 months":
                                        $start_time_data = "More than 2 weeks";
                                        $start_time_id = "11152";
                                        break;
                                    default:
                                        $start_time_data = "Timing is flexible";
                                        $start_time_id = "11149";
                                }

                                $ownership_data = "Yes";
                                $ownership_id = "10001";
                                if ($ownership == "No") {
                                    $ownership_data = "No";
                                    $ownership_id = "10002";
                                }

                                $Lead_data_post .= '
                                    <task description="' . $task_text . '" oid="' . $task_oid . '">
                                        <interview>
                                            <question id="6889" description="What type of project is this?" type="TASK_INTERVIEW">
                                                <answer id="' . $project_nature_answer_id . '" questionID="6889">' . $project_nature_data . '</answer>
                                            </question>
                                             <question id="5498" description="What kind of siding is on your home now?" type="TASK_INTERVIEW">
                                                <answer id="16749" questionID="5498">Don\'t know</answer>
                                            </question>
                                            <question id="80000" description="When would you like this request to be completed?" type="TASK_INTERVIEW">
                                                <answer id="' . $start_time_id . '" questionID="80000">' . $start_time_data . '</answer>
                                            </question>
                                             <question id="501504" description="Are you the owner or authorized to make property changes?" type="TASK_INTERVIEW">
                                                <answer id="' . $ownership_id . '" questionID="501504">' . $ownership_data . '</answer>
                                            </question>
                                        </interview>
                                    </task>';
                                break;
                        }

                        $Lead_data_post .= '<showResponseStatus>true</showResponseStatus>
                            </serviceRequest>';

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $crm_details['leadsCustomerCampaign_id'], $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                        if (!empty($result)) {
                            if (strpos("-" . $result, 'success') == true) {
                                $url_api2 = "https://app.leadconduit.com/flows/5db883be252772187733ac86/sources/5e8c6b460522c3d926fbf80a/submit";
                                $input_data2 = array(
                                    "trustedform_cert_url" => $trusted_form,
                                    "ip_address" => $IPAddress,
                                    "user_agent" => $UserAgent,
                                    "bid_key_hadv" => $data_msg['ping_post_data']['TransactionId'],
                                    "partner_reference_id_hadv" => $lead_source_text,
                                );
                                $httpheader2 = array(
                                    "content-type: application/json"
                                );

                                $result = $crm_api_file->api_send_data($url_api2, $httpheader2, $crm_details['leadsCustomerCampaign_id'], json_encode($input_data2), "POST", 1, $crm_details['campaign_id']);
                                return 1;
                            }
                        }
                    }
                    break;
                case 103:
                    //Quinstreet 103
                    if (config('app.env', 'local') == "local") {
                        $tagID = "204670250";
                        $url_api_ping = "http://hsleadpost1.quinstage.com/coreg/hsleadcapture?";
                    } else {
                        $tagID = "204673076";
                        $url_api_post = "http://hs.leadpost.net/coreg/hsleadcapture?";
                    }

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded"
                    );

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $PingToken = $data_msg['ping_post_data']['TransactionId'];

                        $Lead_data_post = "tagID=$tagID&PC=$zip&PartnerSourceID=$lead_source_text&TrustedFormToken=$trusted_form&FN=$first_name&LN=$last_name&S1=$street&CT=$city&SP=$statename_code&HP=$number1&EM=$email&PingToken=$PingToken&LeadIDToken=$LeadId&PublisherSubID=$lead_source_text&IPAddress=$IPAddress&HomePhoneConsentLanguage=$TCPAText";

                        //Services
                        switch ($crm_details['service_id']) {
                            case 1:
                                //WINDOWS
                                $service = "WINDOWS";

                                $ownership = trim($crm_details['data']['homeOwn']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $number_of_windows = trim($crm_details['data']['number_of_window']);
                                $project_nature = trim($crm_details['data']['project_nature']);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $project_nature = ($project_nature == "Replace" ? "Install" : $project_nature);
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                $Lead_data_post .= "&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&service=$service&NumberOfWindows=$number_of_windows&WindowsProjectScope=$project_nature";
                                break;
                            case 2:
                                //Solar
                                $service = "SOLAR";

                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $power_solution = trim($crm_details['data']['power_solution']);

                                $OwnHome = ($property_type == "Owned" ? "Yes" : "No");
                                $start_time = "Not Sure";

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50' || '$51 - $100':
                                        $ElectricBill = "Under $100";
                                        break;
                                    case '$101 - $150' || '$151 - $200':
                                        $ElectricBill = "$100 - $200";
                                        break;
                                    case '$201 - $300':
                                        $ElectricBill = "$200 - $300";
                                        break;
                                    default:
                                        $ElectricBill = "$300+";
                                }

                                $Lead_data_post .= "&UtilityProvider=$utility_provider&ElectricBill=$ElectricBill&service=$service&BuyTimeframe=$start_time&OwnHome=$OwnHome";
                                break;
                            case 3:
                                //Home Security
                                $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                                $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $property_type = trim($crm_details['data']['property_type']);

                                $service = "HOME_SECURITY";
                                $HomeSecurityProjectScope = "Install";
                                $SecuritySystemInstallationType = ucwords($Installation_Preferences);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                switch ($property_type) {
                                    case 'Business':
                                        $CommercialLocation = "Business";
                                        $OwnHome = "Yes";
                                        break;
                                    case 'Rented':
                                        $CommercialLocation = "Home";
                                        $OwnHome = "No";
                                        break;
                                    default:
                                        $CommercialLocation = "Home";
                                        $OwnHome = "Yes";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$OwnHome&HomeSecurityProjectScope=$HomeSecurityProjectScope&SecuritySystemInstallationType=$SecuritySystemInstallationType&CommercialLocation=$CommercialLocation";
                                break;
                            case 4:
                                //Flooring
                                $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $CommercialLocation = "Home";
                                $MaterialPurchase = "Yes";
                                $FlooringProjectScope = ($project_nature != "Repair Existing Flooring" ? "Install" : "Repair");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($Type_OfFlooring) {
                                    case "Tile Flooring":
                                        $service = "FLOORING_TILE";
                                        break;
                                    case "Hardwood Flooring":
                                        $service = "FLOORING_HARDWOOD";
                                        switch ($project_nature) {
                                            case "Install New Flooring":
                                                $FlooringProjectScope = "Install";
                                                break;
                                            case "Refinish Existing Flooring":
                                                $FlooringProjectScope = "Refinishing";
                                                break;
                                            default:
                                                $FlooringProjectScope = "Repair";
                                        }
                                        break;
                                    case "Laminate Flooring":
                                        $service = "FLOORING_LAMINATE";
                                        break;
                                    default:
                                        $service = "FLOORING_VINYL_LINOLEUM";
                                }

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&FlooringProjectScope=$FlooringProjectScope&CommercialLocation=$CommercialLocation&MaterialPurchase=$MaterialPurchase";
                                break;
                            case 5:
                                //WALK-IN TUBS
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $reason = trim($crm_details['data']['reason']);
                                $features = trim($crm_details['data']['features']);

                                $service = "WALK_IN_TUBS";
                                $reason = ($reason == 'Others' ? "Other" : $reason);
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&Interest=$reason";
                                break;
                            case 6:
                                $roof_type = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($roof_type) {
                                    case "Wood Shake/Composite Roofing":
                                        $service = "ROOFING_CEDAR_SHAKE";
                                        break;
                                    case "Metal Roofing":
                                        $service = "ROOFING_METAL";
                                        break;
                                    case "Natural Slate Roofing":
                                        $service = "ROOFING_NATURAL_SLATE";
                                        break;
                                    case "Tile Roofing":
                                        $service = "ROOFING_TILE";
                                        break;
                                    default:
                                        $service = "ROOFING_ASPHALT";
                                }

                                $ownership_data = "Yes";

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&RoofingPlan=$project_nature";
                                break;
                            case 7:
                                //Home Siding
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $type_of_siding = trim($crm_details['data']['type_of_siding']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                switch ($type_of_siding) {
                                    case "Vinyl Siding":
                                        $service = "SIDING_VINYL";
                                        break;
                                    case "Brickface Siding":
                                        $service = "SIDING_BRICKFACE";
                                        break;
                                    case "Composite wood Siding":
                                        $service = "SIDING_COMPOSITE_WOOD";
                                        break;
                                    case "Aluminium Siding":
                                        $service = "SIDING_ALUMINIUM";
                                        break;
                                    default:
                                        $service = "SIDING_STONEFACE";
                                }

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&ProjectPlan=$project_nature";
                                break;
                            case 8:
                                //Kitchen
                                $service_kitchen = trim($crm_details['data']['services']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                                $service = "KITCHEN_REMODEL";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&OptIn=$demolishing_walls";
                                break;
                            case 9:
                                //bathroom
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "BATH_REMODEL";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&OptIn=Yes";
                                break;
                            case 11:
                                //Furnace
                                $type_of_heating = trim($crm_details['data']['type_of_heating']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "HVAC";
                                $HVACInterest = ($project_nature == "Repair" ? "Repair Central Heating" : "Install Central Heating");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&CentralHeatingInstallType=$type_of_heating&HVACInterest=$HVACInterest";
                                break;
                            case 12:
                                //Boiler
                                $type_of_heating = trim($crm_details['data']['type_of_heating']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "HVAC";
                                $HVACInterest = ($project_nature == "Repair" ? "Repair Boiler/Radiator" : "Install Boiler/Radiator");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&BoilerSystemInstallType=$type_of_heating&HVACInterest=$HVACInterest";
                                break;
                            case 13:
                                //Central A/C
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "HVAC";
                                $HVACInterest = ($project_nature == "Repair" ? "Repair Central AC" : "Install Central AC");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&HVACInterest=$HVACInterest";
                                break;
                            case 14:
                                //Cabinet
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = ($project_nature == "Cabinet Install" ? "CABINET_INSTALL" : "CABINET_REFACING");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data";
                                break;
                            case 15:
                                //Plumbing
                                $services = trim($crm_details['data']['services']);
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "PLUMBING";
                                $PlumbingProjectScope = "Install";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&PlumbingProjectScope=$PlumbingProjectScope";
                                break;
                            case 17:
                                //Sunrooms
                                $start_time = trim($crm_details['data']['start_time']);

                                $service = "SUNROOM";
                                $ownership_data = "Yes";

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data";
                                break;
                            case 18:
                                //Handyman
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $service = "HANDYMAN";
                                $CommercialLocation = "Home";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&CommercialLocation=$CommercialLocation";
                                break;
                            case 19:
                                //Countertops
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $countertops_service = trim($crm_details['data']['service']);
                                $project_nature = trim($crm_details['data']['project_nature']);

                                $service = "COUNTERTOP";
                                $CommercialLocation = "Home";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);
                                $project_nature_data = ($project_nature == "Repair" ? "Repair" : "Install");

                                switch ($countertops_service) {
                                    case "Granite":
                                        $CountertopType = "Granite";
                                        break;
                                    case "Solid Surface (e.g corian)":
                                        $CountertopType = "Solid Surface";
                                        break;
                                    case "Marble":
                                        $CountertopType = "Marble";
                                        break;
                                    case "Wood (e.g butcher block)":
                                        $CountertopType = "Wood";
                                        break;
                                    case "Stainless Steel":
                                        $CountertopType = "Stainless Steel";
                                        break;
                                    case "Laminate":
                                        $CountertopType = "Laminate";
                                        break;
                                    case "Concrete":
                                        $CountertopType = "Concrete";
                                        break;
                                    default:
                                        $CountertopType = "Other Solid Stone";
                                }

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&CountertopType=$CountertopType&CountertopProjectScope=$project_nature_data&CommercialLocation=$CommercialLocation";
                                break;
                            case 20:
                                //Doors
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $door_type = trim($crm_details['data']['door_type']);
                                $number_of_door = trim($crm_details['data']['number_of_door']);
                                $project_nature = trim($crm_details['data']['project_nature']);

                                $service = "DOOR";
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);
                                $project_nature_data = ($project_nature == "Repair" ? "Repair" : "Install");

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&DoorType=$door_type&DoorProjectScope=$project_nature_data";
                                break;
                            case 21:
                                //Gutter
                                $start_time = trim($crm_details['data']['start_time']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $servicedata = trim($crm_details['data']['service']);
                                $project_nature = trim($crm_details['data']['project_nature']);

                                $service = "GUTTERS";
                                $CommercialLocation = "Home";
                                $GuttersProjectScope = ($project_nature == "Repair" ? "Repair" : "Install");
                                $ownership_data = ($ownership == "No, But Authorized to Make Changes" ? "No, but I am authorized to make improvements" : $ownership);

                                switch ($servicedata) {
                                    case "Copper":
                                        $servicedata = "Copper";
                                        break;
                                    case "Galvanized Steel":
                                        $servicedata = "Galvanized";
                                        break;
                                    case "PVC":
                                        $servicedata = "PVC";
                                        break;
                                    case "Wood":
                                        $servicedata = "Wood";
                                        break;
                                    default:
                                        $servicedata = "Seamless Metal";
                                }

                                switch ($start_time) {
                                    case 'Immediately':
                                        $BuyTimeframe = "Immediately";
                                        break;
                                    case 'Not Sure':
                                        $BuyTimeframe = "Don't know";
                                        break;
                                    default:
                                        $BuyTimeframe = "1-6 months";
                                }

                                $Lead_data_post .= "&service=$service&BuyTimeframe=$BuyTimeframe&OwnHome=$ownership_data&GuttersProjectScope=$GuttersProjectScope&CommercialLocation=$CommercialLocation&GutterType=$servicedata";
                                break;
                        }

                        $Lead_data_post = str_replace(" ", "+", $Lead_data_post);

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $crm_details['leadsCustomerCampaign_id'], $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                        $result2 = json_decode($result, true);
                        if (!empty($result2)) {
                            if (!empty($result2['STATUS'])) {
                                if ($result2['STATUS'] == "SUCCESS" || $result2['STATUS'] == "ACCEPTED") {
                                    return 1;
                                }
                            }
                        }
                    }
                    break;
                case 48:
                    //Transform SR Home API
                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api = "https://api.qa.porch.com/v2/lead/callback";
                    } else {
                        //Live Mode
                        $url_api = "https://api.porch.com/v2/lead/callback";
                    }

                    switch ($crm_details['service_id']) {
                        case 1:
                            $product = 1;
                            break;
                        case 7:
                            $product = 0;
                            break;
                        case 14:
                            $product = 4;
                            break;
                        case 8:
                            $product = 5;
                            break;
                        case 20:
                            $product = 6;
                            break;
                        case 9:
                            $product = 7;
                            break;
                        case 11 || 12 || 13:
                            $project_nature_name = trim($crm_details['data']['project_nature']);
                            $product = ($project_nature_name == "Repair" ? 201 : 8);
                            break;
                        case 6:
                            $product = 11;
                            break;
                        case 4:
                            $product = 13;
                            break;
                        case 19:
                            $product = 14;
                            break;
                        case 23:
                            $product = 16;
                            break;
                    }

                    $Lead_data_array = array(
                        'Customer' =>
                            array(
                                'Address' =>
                                    array(
                                        "City" => $city,
                                        "State" => $statename_code,
                                        "StreetAddress" => $street,
                                        "StreetAddress2" => "",
                                        "Zip" => $zip,
                                    ),
                                "ConsentToCallGiven" => true,
                                "ConsentToCallText" => "",
                                "Email" => $email,
                                "FirstName" => $first_name,
                                "LastName" => $last_name,
                                'PhoneNumbers' =>
                                    array(
                                        0 =>
                                            array(
                                                "ConsentToCallCell" => "true",
                                                "ConsentToCallCellText" => "",
                                                "PhoneNumber" => $number1,
                                                "PhoneType" => "0",
                                            ),
                                    ),
                                'PreferredContactTime' => '0',
                            ),
                        'CustomerComments' => '',
                        'ImportVendorID' => '201',
                        'LeadSourceTypeID' => 8105,
                        'Notes' => '',
                        'Product' => $product,
                        'PromoteOptIn' => true,
                        'VendorLeadID' => $LeadId,
                    );

                    $httpheader = array(
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $crm_details['leadsCustomerCampaign_id'], stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'true') == true) {
                        return 1;
                    }
                    break;
                case 111:
                    //leadperfection
                    $phone1type = 1;
                    $phone2type = 0;
                    $phone3type = 0;
                    $LogNumber = 1;
                    $sender = "Allied-Digital-Media";
                    $sentto = "Leadperfection";
                    $srs_id = 224;

                    $url_api = "http://zl97.leadperfection.com/batch/addleads.asp?firstname=$first_name&lastname=$last_name&address1=$street&city=$city&state=$statename_code&zip=$zip&phone1type=$phone1type&phone1=$number1&phone2type=$phone2type&phone3type=$phone3type&email=$email&LogNumber=$LogNumber&sender=$sender&sentto=$sentto&srs_id=$srs_id";

                    $httpheader = array(
                        "content-type: application/json"
                    );

                    $url_api = str_replace(" ", "%20", $url_api);
                    $result_1 = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    $result1 = 0;
                    if (strpos("-" . strtolower($result_1), 'ok') == true) {
                        $result1 = 1;
                    }

                    $project = $crm_details['service_campaign_name'];
                    $phone1type = "Home";
                    $date = date('Y-m-d');
                    $source_type = "Websitea";
                    $source = "Allied Digital";
                    $url_link = "https://floridawindowanddoor.secure.force.com/services/apexrest/i360/eLead";

                    $url_api2 = "$url_link?FirstName=$first_name&LastName=$last_name&StreetAddress=$street&City=$city&State=$statename_code&Zip=$zip&Email=$email&Phone1=$number1&Phone1Type=$phone1type&Product=$project&Date=$date&Source=$source&SourceType=$source_type&i360__Market_Segment_Editable__c=Florida Window and Door";

                    $url_api2 = str_replace(" ", "%20", $url_api2);
                    $result_2 = $crm_api_file->api_send_data($url_api2, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    $result2 = 0;
                    if (strpos("-" . strtolower($result_2), 'success') == true) {
                        $result2 == 1;
                    }

                    if ($result1 == 1 || $result2 == 1) {
                        return 1;
                    }
                    break;
                case 56:
                    //Trinity Solar
                    $country_code = "US";
                    $lead_source = "Purchased%3A%20AlliedDigitalMedia";
                    $QualificationNotes = "";        //00N60000001WOw7
                    $Lead_Provider_Lead_ID = "Solar" . $leadsCustomerCampaign_id;     //00N32000002Z0wr

                    $url_api = "https://NA110.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8";
                    $Lead_data_array = "oid=00D6000000077D0&retURL=http%3A//&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&street=$street&city=$city&state_code=$statename_code&zip=$zip&country_code=$country_code&lead_source=$lead_source&00N60000001WOw7=$QualificationNotes&00N32000002Z0wr=$Lead_Provider_Lead_ID&00N32000002jpeH=$Lead_Cost";
                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded",
                        "Cookie: BrowserId=cDZghvzqEeqVPLVV8x7_Fg"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 80:
                case 1210:
                    //momentumsolar 80
                    //Momentum AC Services Inc 1210
                    $campaignTypeNmae = ($crm_details['campaign_Type'] == 6 ? "Solar Transfer" : "Solar Non-Exclusive");
                    $url_api = "https://app.leadconduit.com/flows/602d48ebd2fadd5d883d7a7f/sources/5e8c6b460522c3d926fbf80a/submit";
                    $httpheader = array(
                        "content-type: application/json"
                    );

                    $Lead_data_array = array(
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone_1" => $number1,
                        "email" => $email,
                        "address_1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postal_code" => $zip,
                        "trustedform_cert_url" => $trusted_form,
                        "universal_leadid" => $LeadId,
                        "lead_cost_solar" => "$Lead_Cost",
                        "price" => "$Lead_Cost",
                        "original_source" => $google_ts,
                        "reference" => $leadsCustomerCampaign_id,
                        "campaign_type_solar" => $campaignTypeNmae,
                        "list_id_solar" => "932",
                        "comments" => "From Allied-Digital-Media",
                    );

                    switch ($crm_details['service_id']) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $monthly_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $monthly_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $monthly_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $monthly_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $monthly_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $monthly_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $monthly_bill = 500;
                                    break;
                                default:
                                    $monthly_bill = 600;
                            }

                            $Lead_data_array["utility.electric.monthly_amount"] = $monthly_bill;
                            $Lead_data_array["utility.electric.company.name"] = $utility_provider;
                            $Lead_data_array["roof_shade_solar"] = $roof_shade;
                            $Lead_data_array["home_type_solar"] = $property_type;
                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'success') == true) {
                        return 1;
                    }
                    break;
                case 15:
                    //RGR Marketing	15
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    switch ($crm_details['service_id']) {
                        case 1:
                            //Window
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $ProjectType = ($project_nature == "Repair" ? "repair" : "replace");

                            $Lead_data_array = array(
                                "type" => "homeimprovementwindow",
                                "publisher_id" => "58",
                                "rcid" => "166",
                                "apikey" => "3b5a49bb-ab07-438f-924a-2f59b3e0aa5b",
                                "subid" => $google_ts,
                                "trustedformtoken" => $trusted_form,
                                "leadidtoken" => $LeadId, //Jornaya LeadiD Token
                                "tcpa" => $TCPAText,
                                "ping_id" => $TransactionId,
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "address" => $street,
                                "phone" => $number1,
                                "email" => $email,
                                "city" => $city,
                                "zip" => $zip,
                                "state" => $statename_code,
                                "homeowner" => $homeowner, //Home Owner
                                "projecttype" => $ProjectType, //project nature
                                "windowcount" => $number_of_windows, //number of windows
                                "ipaddress" => $IPAddress,
                            );
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == 'Rented' ? 'no' : 'yes');

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "no shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "a lot of shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "a little shade";
                                    break;
                                default:
                                    $roof_shade_data = "uncertain";
                            }

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $monthly_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $monthly_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $monthly_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $monthly_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $monthly_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $monthly_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $monthly_bill = 500;
                                    break;
                                default:
                                    $monthly_bill = 600;
                            }

                            $Lead_data_array = array(
                                "publisher_id" => "494",
                                "rcid" => "1100",
                                "apikey" => "3510f2c2-ddec-4935-9ca1-6949e7fc64cb",
                                "ping_id" => $TransactionId,
                                "type" => "solar",
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "city" => $city,
                                "address" => $street,
                                "phone" => $number1,
                                "email" => $email,
                                "upload_type" => "RGR",
                                "state" => $statename_code,
                                "zip" => $zip,
                                "electricityprovider" => $utility_provider, //Electricity Provider
                                "creditscore" => "good", //Credit Status
                                "powerbill" => $monthly_bill, //Power Bill.
                                "leadidtoken" => $LeadId, //Jornaya LeadiD Token
                                "homeowner" => $homeowner, //home owner
                                "roofshade" => $roof_shade_data, //Roof Shade
                                "ipaddress" => $IPAddress,
                                "trustedformtoken" => $trusted_form
                            );

                            break;
                        case 6:
                            //Roofing
                            $Type_OfRoofing = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $property_type = trim($crm_details['data']['property_type']);

                            switch ($Type_OfRoofing) {
                                case "Asphalt Roofing":
                                    $roofmaterial = "asphalt";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofmaterial = "wood";
                                    break;
                                case "Metal Roofing":
                                    $roofmaterial = "metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofmaterial = "slate";
                                    break;
                                default:
                                    $roofmaterial = "unsure";
                            }

                            $ProjectType = ($project_nature == "Repair existing roof" ? "repair" : "replace");

                            $Lead_data_array = array(
                                "type" => "homeimprovementroofing",
                                "publisher_id" => "58",
                                "rcid" => "213",
                                "apikey" => "3b5a49bb-ab07-438f-924a-2f59b3e0aa5b",
                                "subid" => $google_ts,
                                "ipaddress" => $IPAddress,
                                "trustedformtoken" => $trusted_form,
                                "leadidtoken" => $LeadId,//Jornaya LeadiD Token
                                "tcpa" => $TCPAText,
                                "ping_id" => $TransactionId,
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "email" => $email,
                                "phone" => $number1,
                                "address" => $street,
                                "city" => $city,
                                "state" => $statename_code,
                                "zip" => $zip,
                                "homeowner" => "yes",//HomeOwner
                                "projecttype" => $ProjectType, //project nature
                                "roofmaterial" => $roofmaterial, //number of windows
                            );
                            break;
                        case 7:
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $projecttype = ($project_nature == "Repair section(s) of siding" ? "repair" : "replace");

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $SidingType = "vinyl";
                                    break;
                                case "Fiber Cement Siding":
                                    $SidingType = "fiber";
                                    break;
                                case "Composite wood Siding":
                                    $SidingType = "wood";
                                    break;
                                default:
                                    $SidingType = "unsure";
                            }

                            $Lead_data_array = array(
                                "type" => "homeimprovementsiding",
                                "publisher_id" => "58",
                                "rcid" => "167",
                                "apikey" => "3b5a49bb-ab07-438f-924a-2f59b3e0aa5b",
                                "subid" => $google_ts,
                                "trustedformtoken" => $trusted_form,
                                "leadidtoken" => $LeadId, //Jornaya LeadiD Token
                                "tcpa" => $TCPAText,
                                "ping_id" => $TransactionId,
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "address" => $street,
                                "phone" => $number1,
                                "email" => $email,
                                "city" => $city,
                                "zip" => $zip,
                                "state" => $statename_code,
                                "homeowner" => $homeowner, //Home Owner
                                "projecttype" => $projecttype, //project nature
                                "sidingtype" => $SidingType, //Siding Type
                                "ipaddress" => $IPAddress,
                            );
                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $projecttype = "bath / shower replacement";

                            $Lead_data_array = array(
                                "type" => "homeimprovementbath",
                                "publisher_id" => "58",
                                "rcid" => "168",
                                "apikey" => "3b5a49bb-ab07-438f-924a-2f59b3e0aa5b",
                                "subid" => $google_ts,
                                "trustedformtoken" => $trusted_form,
                                "leadidtoken" => $LeadId, //Jornaya LeadiD Token
                                "tcpa" => $TCPAText,
                                "ping_id" => $TransactionId,
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "address" => $street,
                                "phone" => $number1,
                                "email" => $email,
                                "city" => $city,
                                "zip" => $zip,
                                "state" => $statename_code,
                                "homeowner" => $homeowner,
                                "projecttype" => $projecttype,
                                "addremovewalls" => "no",
                                "ipaddress" => $IPAddress,
                            );
                            break;
                    }

                    switch ($lead_type_service_id) {
                        case 1:
                        case 2:
                        case 6:
                        case 7:
                        case 9:
                            if (config('app.env', 'local') == "local") {
                                //Test Mode
                                $Lead_data_array['subid'] = "matched";
                                $url_api = "https://api.reallygreatrate.com/test/pingpost/post";
                            } else {
                                $url_api = "https://api.reallygreatrate.com/lead/pingpost/post";
                            }

                            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                            $result2 = json_decode($result, true);
                            if (!empty($result2['status'])) {
                                if ($result2['status'] == "matched") {
                                    return 1;
                                }
                            }
                            break;
                    }
                    break;
                case 121:
                    //Suntuity Solar 121
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $monthly_bill = 50;
                            break;
                        case '$51 - $100':
                            $monthly_bill = 100;
                            break;
                        case '$101 - $150':
                            $monthly_bill = 150;
                            break;
                        case '$151 - $200':
                            $monthly_bill = 200;
                            break;
                        case '$201 - $300':
                            $monthly_bill = 300;
                            break;
                        case '$301 - $400':
                            $monthly_bill = 400;
                            break;
                        case '$401 - $500':
                            $monthly_bill = 500;
                            break;
                        default:
                            $monthly_bill = 600;
                    }

                    $url_api_post = "https://suntuity.quickbase.com/db/bkdhkmy4a";
                    $usertoken = "b3jtnz_g536_ces4w6jdj6pfs265nw3kvnx8iu";

                    if ($crm_details['campaign_Type'] == 1) {
                        $lead_source = "Allied Digital";
                        $campaign_code = "505";
                        $lead_source_code = "81";

                        $Lead_data_post = '<?xml version="1.0" ?>
<qdbapi>
<udata>mydata</udata>
<usertoken>' . $usertoken . '</usertoken>
<field fid="7">' . $lead_source . '</field>
<field fid="660">' . $campaign_code . '</field>
<field fid="773">' . $lead_source_code . '</field>
<field fid="6">' . $first_name . '</field>
<field fid="56">' . $last_name . '</field>
<field fid="11">' . $street . '</field>
<field fid="13">' . $city . '</field>
<field fid="14">' . $state . '</field>
<field fid="15">' . $zip . '</field>
<field fid="20">' . $email . '</field>
<field fid="17">' . $number1 . '</field>
<field fid="627">' . $monthly_bill . '</field>
<field fid="632">' . $utility_provider . '</field>
</qdbapi>';
                    } else if ($crm_details['campaign_Type'] == 6) {
                        $lead_source = "Allied Digital Warms";
                        $campaign_code = "602";
                        $lead_source_code = "109";
                        $Warm_Transfer = "1";
                        $apitoken = "d6qqnxdbu75ntdbyq65rb2i78ky";

                        $Lead_data_post = '<?xml version="1.0" ?>
<qdbapi>
<udata>mydata</udata>
<usertoken>' . $usertoken . '</usertoken>
<apptoken>' . $apitoken . '</apptoken>
<field fid="7">' . $lead_source . '</field>
<field fid="660">' . $campaign_code . '</field>
<field fid="773">' . $lead_source_code . '</field>
<field fid="6">' . $first_name . '</field>
<field fid="56">' . $last_name . '</field>
<field fid="11">' . $street . '</field>
<field fid="13">' . $city . '</field>
<field fid="14">' . $state . '</field>
<field fid="15">' . $zip . '</field>
<field fid="20">' . $email . '</field>
<field fid="17">' . $number1 . '</field>
<field fid="627">' . $monthly_bill . '</field>
<field fid="632">' . $utility_provider . '</field>
<field fid="669">' . $Warm_Transfer . '</field>
</qdbapi>';
                    }

                    $content_lengthe = strlen($Lead_data_post);

                    $httpheader = array(
                        "Content-Type: application/xml",
                        "Content-Length: $content_lengthe",
                        "QUICKBASE-ACTION: API_AddRecord",
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                    try {
                        libxml_use_internal_errors(true);
                        $result2 = simplexml_load_string($result);
                        $result3 = json_encode($result2);
                        $result4 = json_decode($result3, TRUE);

                        if (!empty($result4)) {
                            if (!empty($result4['errtext'])) {
                                if ($result4['errtext'] == "No error") {
                                    return 1;
                                }
                            }
                        }
                    } catch (Exception $e) {

                    }
                    break;
                case 136:
                    //Solar Program 136
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $monthly_electric = "$50";
                            break;
                        case '$51 - $100':
                            $monthly_electric = "$100";
                            break;
                        case '$101 - $150':
                            $monthly_electric = "$150";
                            break;
                        case '$151 - $200':
                            $monthly_electric = "$200";
                            break;
                        case '$201 - $300':
                            $monthly_electric = "$300";
                            break;
                        case '$301 - $400':
                            $monthly_electric = "$400";
                            break;
                        case '$401 - $500':
                            $monthly_electric = "$500";
                            break;
                        default:
                            $monthly_electric = "$600";
                    }

                    $url_api_post = "https://api.leadmailbox.com/v2/leads/add/nyref01/allied";

                    $Lead_data_post = array(
                        "FirstName" => $first_name,
                        "LastName" => $last_name,
                        "Email" => $email,
                        "HomePhone" => $number1,
                        "MobilePhone" => $number1,
                        "Mailing Addres" => $street,
                        "Mailing City" => $city,
                        "Mailing Zip" => $zip,
                        "Field_001" => $monthly_electric,
                        "Field_002" => $roof_shade
                    );

                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_post), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    $status = 0;
                    if (($result2['code'] == '0' || $result2['message'] == 'Success') && $result2['duplicate'] == false) {
                        $status = 1;
                    }
                    return $status;
                    break;
                case 142:
                    //Coastal Green Energy Solutions 142
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $start_time = trim($crm_details['data']['start_time']);
                    $number_of_windows = trim($crm_details['data']['number_of_window']);
                    $project_nature = trim($crm_details['data']['project_nature']);

                    $street2 = "";
                    $MSM_custom_Interests = "Windows";
                    $MSM_source = "216d7826-f0db-49f7-8a7b-07bed989cbf1";
                    $MSM_coy = "3642";
                    $MSM_formId = "216d7826-f0db-49f7-8a7b-07bed989cbf1";
                    $MSM_leadCaptureName = "MarketSharp";

                    $url_api = "https://haaws.marketsharpm.com/LeadCapture/MarketSharp/LeadCapture.ashx";

                    $Lead_data_array = "MSM_firstname=$first_name&MSM_lastname=$last_name&MSM_address1=$street&MSM_address2=$street2&MSM_state=$state&MSM_city=$city&MSM_zip=$zip&MSM_email=$email&MSM_homephone=$number1&MSM_cellphone=$number1&MSM_workphone=$number1&MSM_custom_Interests=$MSM_custom_Interests&MSM_custom_Best_Time_To_Reach=$start_time&MSM_source=$MSM_source&MSM_coy=$MSM_coy&MSM_formId=$MSM_formId&MSM_leadCaptureName=$MSM_leadCaptureName";
                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 130:
                    //enewing-energy (Solar Me USA) "infusionsoft"
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    $inf_form_xid = "a738d320651cabe0b5952efc17a89078";
                    $inf_form_name = "Allied%20Digital%20Media%26nbsp%3BWeb%20Form";
                    $infusionsoft_version = "1.70.0.299639";
                    $type_of_project = "Install";

                    $url_api = "https://av825.infusionsoft.com/app/form/process/$inf_form_xid";

                    $Lead_data_array = "inf_form_xid=$inf_form_xid&inf_form_name=$inf_form_name&infusionsoft_version=$infusionsoft_version&inf_field_FirstName=$first_name&inf_field_LastName=$last_name&inf_field_Email=$email&inf_field_Phone1=$number1&inf_field_StreetAddress1=$street&inf_field_City=$city&inf_field_State=$statename_code&inf_field_PostalCode=$zip";

                    //Custom Field
                    $Lead_data_array .= "&inf_custom_SolarReviewsSource=$power_solution&inf_custom_RoofShading=$roof_shade&inf_custom_PowerCompany=$utility_provider&inf_custom_ElectricBill=$monthly_electric_bill&inf_custom_Notes=$type_of_project&inf_custom_Comments=$property_type";

                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/x-www-form-urlencoded"
                    );

                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 146:
                case 958:
                    // ICW Leads
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                        $TestMode = 0;
                        if (config('app.env', 'local') == "local") {
                            //Test Mode
                            $TestMode = 1;
                        }

                        date_default_timezone_set('America/Los_Angeles');
                        $LeadDateTime = date('Y-m-d H:i:s');
                        $LeadTimeZone = "PST";
                        $TCPAOptin = $tcpa_compliant;
                        $BestCallTime = 1;

                        $url_api_post = "https://api.icwleads.com/Post";

                        if ($crm_details['service_id'] == 2) {
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $CampaignID = "12";
                            $VendorID = "195";
                            $APIKey = "e38b5f373b05fa6d4c312b33122aa995";
                            $PurchaseTimeFrame = 1;
                            $CreditRating = 3;
                            $PropertyType = 1;
                            $RoofType = 1;
                            $ProjectStatusCode = 1;
                            $PreferredPhone = "Cell";
                            $OwnProperty = ($property_type == 'Rented' ? "0" : "1");
                            $SolarElectric = ($power_solution == "Solar Water Heating for my Home" ? "0" : "1");

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = 1;
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = 3;
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = 2;
                                    break;
                                default:
                                    $roof_shade_data = 4;
                            }

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $monthly_electric = 1;
                                    break;
                                case '$51 - $100':
                                    $monthly_electric = 2;
                                    break;
                                case '$101 - $150':
                                    $monthly_electric = 3;
                                    break;
                                case '$151 - $200':
                                    $monthly_electric = 4;
                                    break;
                                case '$201 - $300':
                                    $monthly_electric = 5;
                                    break;
                                case '$301 - $400':
                                    $monthly_electric = 6;
                                    break;
                                case '$401 - $500':
                                    $monthly_electric = 7;
                                    break;
                                default:
                                    $monthly_electric = 8;
                            }

                            $Lead_data_post = '<?xml version="1.0"?>
<Request>
    <CampaignID>' . $CampaignID . '</CampaignID>
    <PingID>' . $TransactionId . '</PingID>
    <VendorID>' . $VendorID . '</VendorID>
    <APIKey>' . $APIKey . '</APIKey>
    <TestMode>' . $TestMode . '</TestMode>
    <SubID>' . $lead_source_text . '</SubID>
    <xxTrustedFormCertUrl>' . $trusted_form . '</xxTrustedFormCertUrl>
    <UniversalLeadID>' . $LeadId . '</UniversalLeadID>
    <UserAgent>' . $UserAgent . '</UserAgent>
    <IPAddress>' . $IPAddress . '</IPAddress>
    <LeadDateTime>' . $LeadDateTime . '</LeadDateTime>
    <LeadTimeZone>' . $LeadTimeZone . '</LeadTimeZone>
    <TCPAOptin>' . $TCPAOptin . '</TCPAOptin>
    <TCPAText>' . $TCPAText . '</TCPAText>
    <URL>' . $OriginalURL . '</URL>
    <BestCallTime>' . $BestCallTime . '</BestCallTime>
    <PurchaseTimeFrame>' . $PurchaseTimeFrame . '</PurchaseTimeFrame>
    <OwnProperty>' . $OwnProperty . '</OwnProperty>
    <FirstName>' . $first_name . '</FirstName>
    <LastName>' . $last_name . '</LastName>
    <Email>' . $email . '</Email>
    <HomePhone>' . $number1 . '</HomePhone>
    <CellPhone>' . $number1 . '</CellPhone>
    <WorkPhone>' . $number1 . '</WorkPhone>
    <PreferredPhone>' . $PreferredPhone . '</PreferredPhone>
    <Address>' . $street . '</Address>
    <City>' . $city . '</City>
    <State>' . $statename_code . '</State>
    <Zip>' . $zip . '</Zip>
    <RoofShade>' . $roof_shade_data . '</RoofShade>
    <CreditRating>' . $CreditRating . '</CreditRating>
    <SolarElectric>' . $SolarElectric . '</SolarElectric>
    <ElectricBill>' . $monthly_electric . '</ElectricBill>
    <CurrentElectricityProvider>' . $utility_provider . '</CurrentElectricityProvider>
    <PropertyType>' . $PropertyType . '</PropertyType>
    <RoofType>' . $RoofType . '</RoofType>
    <ProjectStatusCode>' . $ProjectStatusCode . '</ProjectStatusCode>
</Request>';
                        } else {
                            $CampaignID = "6";
                            $VendorID = "194";
                            $APIKey = "306caf858a0184802cb21ca6aef5f370";
                            $PreferredPhone = "Cell";

                            $OwnProperty = 1;
                            if (isset($crm_details['data']['homeOwn'])) {
                                $ownership = trim($crm_details['data']['homeOwn']);
                                if ($ownership == "No") {
                                    $OwnProperty = 0;
                                }
                            }

                            $PurchaseTimeFrame = 1;
                            if (isset($crm_details['data']['start_time'])) {
                                $start_time = trim($crm_details['data']['start_time']);
                                if ($start_time == 'Immediately' || $start_time == 'Not Sure') {
                                    $PurchaseTimeFrame = 1;
                                } else {
                                    $PurchaseTimeFrame = 3;
                                }
                            }

                            $Lead_data_post = '<?xml version="1.0"?>
<Request>
    <CampaignID>' . $CampaignID . '</CampaignID>
    <PingID>' . $TransactionId . '</PingID>
    <VendorID>' . $VendorID . '</VendorID>
    <APIKey>' . $APIKey . '</APIKey>
    <TestMode>' . $TestMode . '</TestMode>
    <SubID>' . $lead_source_text . '</SubID>
    <xxTrustedFormCertUrl>' . $trusted_form . '</xxTrustedFormCertUrl>
    <UniversalLeadID>' . $LeadId . '</UniversalLeadID>
    <UserAgent>' . $UserAgent . '</UserAgent>
    <IPAddress>' . $IPAddress . '</IPAddress>
    <LeadDateTime>' . $LeadDateTime . '</LeadDateTime>
    <LeadTimeZone>' . $LeadTimeZone . '</LeadTimeZone>
    <TCPAOptin>' . $TCPAOptin . '</TCPAOptin>
    <TCPAText>' . $TCPAText . '</TCPAText>
    <URL>' . $OriginalURL . '</URL>
    <BestCallTime>' . $BestCallTime . '</BestCallTime>
    <PurchaseTimeFrame>' . $PurchaseTimeFrame . '</PurchaseTimeFrame>
    <OwnProperty>' . $OwnProperty . '</OwnProperty>
    <FirstName>' . $first_name . '</FirstName>
    <LastName>' . $last_name . '</LastName>
    <Email>' . $email . '</Email>
    <HomePhone>' . $number1 . '</HomePhone>
    <CellPhone>' . $number1 . '</CellPhone>
    <WorkPhone>' . $number1 . '</WorkPhone>
    <PreferredPhone>' . $PreferredPhone . '</PreferredPhone>
    <Address>' . $street . '</Address>
    <City>' . $city . '</City>
    <State>' . $statename_code . '</State>
    <Zip>' . $zip . '</Zip>
    <Projects>';

                            switch ($crm_details['service_id']) {
                                case 1:
                                    //Windows
                                    $number_of_windows = trim($crm_details['data']['number_of_window']);
                                    $project_nature = trim($crm_details['data']['project_nature']);

                                    $ProjectType = ($project_nature == "Repair" ? "Need repair services at this time" : "Interested in replacement windows");
                                    $ProjectCategory = "Windows";

                                    switch ($number_of_windows) {
                                        case "1":
                                            $NumWindows = 1;
                                            break;
                                        case "2":
                                            $NumWindows = 2;
                                            break;
                                        case "3-5":
                                            $NumWindows = 4;
                                            break;
                                        case "6-9":
                                            $NumWindows = 7;
                                            break;
                                        default:
                                            $NumWindows = 10;
                                    }

                                    $Lead_data_post .= '<Project>
                                    <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                    <ProjectType>' . $ProjectType . '</ProjectType>
                                    <NumWindows>' . $NumWindows . '</NumWindows>
                                  </Project>';
                                    break;
                                case 3:
                                    //HomeSecurity
                                    $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                                    $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                                    $property_type = trim($crm_details['data']['property_type']);

                                    $SecurityUsage = ($property_type == "Business" ? "Commercial" : "Residential");
                                    $ProjectType = "House";
                                    $ProjectCategory = "HomeSecurity";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <Usage>' . $SecurityUsage . '</Usage>
                                      </Project>';
                                    break;
                                case 4:
                                    //Flooring
                                    $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                                    $project_nature = trim($crm_details['data']['project_nature']);

                                    switch ($Type_OfFlooring) {
                                        case "Tile Flooring":
                                            $FlooringType = "Tile";
                                            break;
                                        case "Hardwood Flooring":
                                            $FlooringType = "Hardwood";
                                            break;
                                        case "Laminate Flooring":
                                            $FlooringType = "Composite";
                                            break;
                                        case "Carpet":
                                            $FlooringType = "Carpet";
                                            break;
                                        default:
                                            $FlooringType = "Vinyl";
                                    }

                                    $ProjectType = ($project_nature == "Repair Existing Flooring" ? "Repair" : "Installation");
                                    $ProjectCategory = "Flooring";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <FlooringType>' . $FlooringType . '</FlooringType>
                                      </Project>';
                                    break;
                                case 6:
                                    //Roofing
                                    $Type_OfRoofing = trim($crm_details['data']['roof_type']);
                                    $project_nature = trim($crm_details['data']['project_nature']);
                                    $property_type = trim($crm_details['data']['property_type']);

                                    switch ($Type_OfRoofing) {
                                        case "Wood Shake/Composite Roofing":
                                            $RoofingType = "Cedar shake";
                                            break;
                                        case "Metal Roofing":
                                            $RoofingType = "Metal";
                                            break;
                                        case "Natural Slate Roofing":
                                            $RoofingType = "Natural state";
                                            break;
                                        case "Tile Roofing":
                                            $RoofingType = "Tile";
                                            break;
                                        default:
                                            $RoofingType = "Asphalt shingle";
                                    }

                                    $ProjectType = ($project_nature == "Repair existing roof" ? "Repair" : "New roof for new home");
                                    $ProjectCategory = "Roof";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <RoofingType>' . $RoofingType . '</RoofingType>
                                      </Project>';
                                    break;
                                case 7:
                                    //Home Siding
                                    $type_of_siding = trim($crm_details['data']['type_of_siding']);
                                    $project_nature = trim($crm_details['data']['project_nature']);

                                    switch ($type_of_siding) {
                                        case "Vinyl Siding":
                                            $SidingType = "Vinyl";
                                            break;
                                        case "Brickface Siding" || "Stoneface Siding":
                                            $SidingType = "Brick or stone";
                                            break;
                                        case "Composite wood Siding":
                                            $SidingType = "Wood";
                                            break;
                                        default:
                                            $SidingType = "Other";
                                    }

                                    $ProjectType = ($project_nature == "Repair section(s) of siding" ? "Repair" : "Replace");
                                    $ProjectCategory = "Siding";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <SidingType>' . $SidingType . '</SidingType>
                                      </Project>';
                                    break;
                                case 8:
                                    //Kitchen
                                    $service_kitchen = trim($crm_details['data']['services']);

                                    switch ($service_kitchen) {
                                        case 'Cabinet Refacing':
                                            $ProjectType = "Cabinets";
                                            $CabinetJob = "Reface existing cabinets";
                                            break;
                                        default:
                                            $ProjectType = "Cabinets";
                                            $CabinetJob = "Install new custom cabinets";
                                    }

                                    $ProjectCategory = "Kitchen";

                                    $Lead_data_post .= ' <Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <CabinetJob>' . $CabinetJob . '</CabinetJob>
                                      </Project>';
                                    break;
                                case 9:
                                    //Bathroom
                                    $bathroom_type_name = trim($crm_details['data']['services']);

                                    switch ($bathroom_type_name) {
                                        case "Full Remodel":
                                            $bathroom_type_name_data = "Full bathroom";
                                            break;
                                        case "Flooring":
                                            $bathroom_type_name_data = "Tile";
                                            break;
                                        case "Sinks":
                                            $bathroom_type_name_data = "Sinks";
                                            break;
                                        default:
                                            $bathroom_type_name_data = "Bath";
                                    }

                                    $ProjectCategory = "Bathroom";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $bathroom_type_name_data . '</ProjectType>
                                      </Project>';
                                    break;
                                case 11:
                                    //HVAC
                                    $project_nature = trim($crm_details['data']['project_nature']);
                                    $type_of_heating = trim($crm_details['data']['type_of_heating']);

                                    $ProjectCategory = "HVAC";
                                    $ProjectType = ($project_nature == "Repair" ? "Repair" : "New unit installed");

                                    switch ($type_of_heating) {
                                        case "Natural Gas":
                                            $SystemType = "Gas furnace";
                                            break;
                                        case "Oil":
                                            $SystemType = "Oil furnace";
                                            break;
                                        case "Propane Gas":
                                            $SystemType = "Propane furnace";
                                            break;
                                        default:
                                            $SystemType = "Electric furnace";
                                    }

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <AirType>Heating and cooling</AirType>
                                        <SystemType>' . $SystemType . '</SystemType>
                                      </Project>';
                                    break;
                                case 12:
                                    //HVAC
                                    $project_nature = trim($crm_details['data']['project_nature']);
                                    $type_of_heating = trim($crm_details['data']['type_of_heating']);

                                    $ProjectCategory = "HVAC";
                                    $ProjectType = ($project_nature == "Repair" ? "Repair" : "New unit installed");

                                    switch ($type_of_heating) {
                                        case "Natural Gas" || "Oil" || "Propane Gas":
                                            $SystemType = "Water heater";
                                            break;
                                        default:
                                            $SystemType = "Electric boiler";
                                    }

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <AirType>Heating and cooling</AirType>
                                        <SystemType>' . $SystemType . '</SystemType>
                                      </Project>';
                                    break;
                                case 13:
                                    //HVAC
                                    $project_nature = trim($crm_details['data']['project_nature']);
                                    $type_of_heating = trim($crm_details['data']['type_of_heating']);

                                    $ProjectCategory = "HVAC";
                                    $ProjectType = ($project_nature == "Repair" ? "Repair" : "New unit installed");
                                    $SystemType = "Central AC";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <AirType>Heating and cooling</AirType>
                                        <SystemType>' . $SystemType . '</SystemType>
                                      </Project>';
                                    break;
                                case 14:
                                    //Cabinet
                                    $project_nature = trim($crm_details['data']['project_nature']);

                                    $ProjectType = ($project_nature == "Cabinet Install" ? "Install new custom cabinets" : "Reface existing cabinets");
                                    $ProjectCategory = "Cabinets";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <LocationInHouse>Kitchen</LocationInHouse>
                                        <CurrentMaterials>Other</CurrentMaterials>
                                      </Project>';
                                    break;
                                case 15:
                                    $ProjectCategory = "Plumbing";
                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>Install</ProjectType>
                                        <ServiceType>Septic repair</ServiceType>
                                      </Project>';
                                    break;
                                case 17:
                                    $ProjectCategory = "Sunrooms";
                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>1</ProjectType>
                                        <Length>10</Length>
                                        <Width>13</Width>
                                      </Project>';
                                    break;
                                case 18:
                                    $ProjectCategory = "HandyMan";
                                    $Lead_data_post .= ' <Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>Clean</ProjectType>
                                        <LocationInHome>House</LocationInHome>
                                      </Project>';
                                    break;
                                case 20:
                                    //Doors
                                    $project_nature = trim($crm_details['data']['project_nature']);

                                    $ProjectType = ($project_nature == "Repair" ? "Repair" : "New Installation");
                                    $ProjectCategory = "Doors";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                        <Material>Other</Material>
                                        <PreHung>True</PreHung>
                                      </Project>';
                                    break;
                                case 21:
                                    $ProjectCategory = "Gutters";
                                    $Lead_data_post .= ' <Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>Protection</ProjectType>
                                      </Project>';
                                    break;
                                case 23:
                                    $service = trim($crm_details['data']['service']);

                                    switch ($service) {
                                        case "Exterior Home or Structure - Paint or Stain":
                                            $ProjectType = "Exterior Painting";
                                            break;
                                        case "Interior Home or Surfaces - Paint or Stain":
                                            $ProjectType = "Interior Painting";
                                            break;
                                        case "Specialty Painting - Textures":
                                            $ProjectType = "Specialty Painting - Textures";
                                            break;
                                        default:
                                            $ProjectType = "Other";
                                    }

                                    $ProjectCategory = "Painting";

                                    $Lead_data_post .= '<Project>
                                        <ProjectCategory>' . $ProjectCategory . '</ProjectCategory>
                                        <ProjectType>' . $ProjectType . '</ProjectType>
                                      </Project>';
                                    break;
                            }

                            $Lead_data_post .= '</Projects>
                            </Request>';
                        }

                        $httpheader = array(
                            "Content-Type: application/xml",
                            "Accept: application/xml"
                        );

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                        if (!empty($result)) {
                            if (strpos("-" . $result, 'Accepted') == true) {
                                return 1;
                            }
                        }
                    }
                    break;
                case 208:
                    //	Clean Energy Authoroty 208
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                        $lead_coust = $data_msg['ping_post_data']['Payout'];

                        switch ($crm_details['service_id']) {
                            case 1:
                                //Windows
                                $number_of_windows = trim($crm_details['data']['number_of_window']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                switch ($number_of_windows) {
                                    case "1":
                                        $NumWindows = "New Window - Single";
                                        break;
                                    case "2":
                                        $NumWindows = "New Windows - 2";
                                        break;
                                    case "3-5":
                                        $NumWindows = "New Windows - 3-5";
                                        break;
                                    case "6-9":
                                        $NumWindows = "New Windows - 6-9";
                                        break;
                                    default:
                                        $NumWindows = "New Windows - 10+";
                                }

                                $ownership = ($ownership != "Yes" ? "Yes" : "No");

                                $url_api_post = "https://live.sbbnetinc.com/rest/api/windows/submit-inquiry";

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $source_name = "test";
                                    $vendor_id = "8";
                                } else {
                                    //Live Mode
                                    $source_name = "alliedw";
                                    $vendor_id = "8";
                                }

                                $Lead_data_array_post = array(
                                    "Request" => array(
                                        "Key" => "d65a1e05c2f788c17954f386a18690503a260f799db79979fd2e23fb4fd8e1a9",
                                        "API_Action" => "pingPostLead",
                                        "Mode" => "post",
                                        "Return_Best_Price" => "1",
                                        "TYPE" => "18",
                                        "IP_Address" => $IPAddress,
                                        "SRC" => $source_name,
                                        "Landing_Page" => $OriginalURL2,
                                        "source_number" => $vendor_id,
                                        "Sub_ID" => $leadsCustomerCampaign_id,
                                        "Pub_ID" => $google_ts,
                                        "Universal_Lead_ID" => $LeadId,
                                        "Active_Prospect_URL" => $trusted_form,
                                        "Best_Time_To_Call" => "Anytime",
                                        "Property_Zip" => $zip,
                                        "Property_City" => $city,
                                        "Property_State" => $statename_code,
                                        "Property_Address" => $street,
                                        "Window_Task" => $NumWindows,
                                        "Property_Owner" => $ownership,
                                        "NoSale" => "No",
                                        "Timing" => "Immediately",
                                        "vendor_lead_id" => $leadsCustomerCampaign_id,
                                        "Lead_ID" => $TransactionId,
                                        "Lead_Cost" => $lead_coust,
                                        "First_Name" => $first_name,
                                        "Last_Name" => $last_name,
                                        "Email" => $email,
                                        "Primary_Phone" => $number1,
                                    )
                                );
                                $httpheader = array(
                                    'Authorization: Basic cmVzdC11c2VyOjVTOGNCRHEmRWYha3BMKk5XNXVM',
                                    'Content-Type: application/json',
                                    'Accept: application/xml',
                                );

                                $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                                if (strpos("-" . $result, 'Accepted') == true || strpos("-" . $result, 'Match') == true) {
                                    return 1;
                                }
                                break;
                            case 2:
                                //Solar
                                $property_type_data = 1;
                                $property_owner = 1;
                                $times_remaining_to_sell = 4;
                                $times_previously_sold = 0;
                                $inquiry_datetime = date('m/d/Y H:i:s');

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $source_name = "test";
                                    $vendor_id = "8";
                                } else {
                                    //Live Mode
                                    $source_name = (empty($LeadId) ? "alliednid" : "allied");
                                    $vendor_id = "2506";
                                }

                                $httpheader = array(
                                    'Authorization: Basic cmVzdC11c2VyOjVTOGNCRHEmRWYha3BMKk5XNXVM',
                                    'Content-Type: application/xml',
                                );

                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50':
                                        $monthly_bill = 50;
                                        break;
                                    case '$51 - $100':
                                        $monthly_bill = 100;
                                        break;
                                    case '$101 - $150':
                                        $monthly_bill = 150;
                                        break;
                                    case '$151 - $200':
                                        $monthly_bill = 200;
                                        break;
                                    case '$201 - $300':
                                        $monthly_bill = 300;
                                        break;
                                    case '$301 - $400':
                                        $monthly_bill = 400;
                                        break;
                                    case '$401 - $500':
                                        $monthly_bill = 500;
                                        break;
                                    default:
                                        $monthly_bill = 600;
                                }

                                switch ($roof_shade) {
                                    case "Mostly Shaded":
                                        $roof_shade_data = 4;
                                        break;
                                    case "Partial Sun":
                                        $roof_shade_data = 2;
                                        break;
                                    default:
                                        $roof_shade_data = 1;
                                }

                                $url_api_post = "https://live.loanbright.com/rest/api/solar/submit-inquiry";

                                $utility_company_id = "00000000";
                                $hot_water_inquiry = 0;
                                $electric_inquiry = 1;

                                $Lead_data_post = '<cea_post>
  <consumer_inquiry>
    <property_sun_exposure>' . $roof_shade_data . '</property_sun_exposure>
    <property_owner>' . $property_owner . '</property_owner>
    <property_type>' . $property_type_data . '</property_type>
    <property_zip_code>' . $zip . '</property_zip_code>
    <property_state_code>' . $statename_code . '</property_state_code>
    <property_city>' . $city . '</property_city>
    <property_street_address>' . $street . '</property_street_address>
    <monthly_electricity_cost>' . $monthly_bill . '</monthly_electricity_cost>
    <utility_company_id>' . $utility_company_id . '</utility_company_id>
    <contact_phone>' . $number1 . '</contact_phone>
    <contact_email>' . $email . '</contact_email>
    <contact_last_name>' . $last_name . '</contact_last_name>
    <contact_first_name>' . $first_name . '</contact_first_name>
    <times_remaining_to_sell>' . $times_remaining_to_sell . '</times_remaining_to_sell>
    <times_previously_sold>' . $times_previously_sold . '</times_previously_sold>
    <hot_water_inquiry>' . $hot_water_inquiry . '</hot_water_inquiry>
    <electric_inquiry>' . $electric_inquiry . '</electric_inquiry>
    <consumer_ip_address>' . $IPAddress . '</consumer_ip_address>
    <inquiry_datetime>' . $inquiry_datetime . '</inquiry_datetime>
    <vendor_lead_id>' . $leadsCustomerCampaign_id . '</vendor_lead_id>
    <source_name>' . $source_name . '</source_name>
    <vendor_id>' . $vendor_id . '</vendor_id>
    <consumer_inquiry_id>' . $TransactionId . '</consumer_inquiry_id>
    <universal_lead_id>' . $LeadId . '</universal_lead_id>
    <active_prospect_url>' . $trusted_form . '</active_prospect_url>
    <vendor_pub_id>' . $google_ts . '</vendor_pub_id>
  </consumer_inquiry>
</cea_post>';

//                        <vendor_sub_id>' . $leadsCustomerCampaign_id . '</vendor_sub_id>

                                $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $crm_details['leadsCustomerCampaign_id'], $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                                if (!empty($result)) {
                                    if (strpos("-" . $result, 'Accepted') == true || strpos("-" . $result, 'Match') == true) {
                                        return 1;
                                    }
                                }
                                break;
                            case 3:
                                //Home Security
                                $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                                $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($Installation_Preferences) {
                                    case 'Professional installation':
                                        $Install_Preference = "Professional";
                                        $Home_Security_Task = "New System Installation";
                                        break;
                                    case 'Self installation':
                                        $Install_Preference = "Self";
                                        $Home_Security_Task = "Equipment Only";
                                        break;
                                    default:
                                        $Install_Preference = "None";
                                        $Home_Security_Task = "New System Installation";
                                }

                                $Timing = ($start_time == 'Immediately' ? "immediately" : "not sure");
                                $homeowner = ($property_type == "Owned" ? "Yes" : "No");

                                $url_api_post = "https://partners.quotedesk.net/apiJSON.php";

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $Test_Lead = "1";
                                    $vendor_id = "8";
                                } else {
                                    //Live Mode
                                    $Test_Lead = "0";
                                    $vendor_id = "8";
                                }

                                $Lead_data_array_post = array(
                                    "Request" => array(
                                        "Key" => "d65a1e05c2f788c17954f386a18690503a260f799db79979fd2e23fb4fd8e1a9",
                                        "API_Action" => "pingPostLead",
                                        "Format" => "JSON",
                                        "Mode" => "post",
                                        "Return_Best_Price" => "1",
                                        "TYPE" => "19",
                                        "IP_Address" => $IPAddress,
                                        "SRC" => "allieda",
                                        "Test_Lead" => $Test_Lead,
                                        "Landing_Page" => $OriginalURL2,
                                        "source_number" => $vendor_id,
                                        "Sub_ID" => $leadsCustomerCampaign_id,
                                        "Pub_ID" => $google_ts,
                                        "Universal_Lead_ID" => $LeadId,
                                        "Best_Time_To_Call" => "Anytime",
                                        "Property_Zip" => $zip,
                                        "Property_City" => $city,
                                        "Property_State" => $statename_code,
                                        "Home_Security_Task" => $Home_Security_Task,
                                        "Install_Preference" => $Install_Preference,
                                        "Existing_Alarm" => $lead_have_item_before_it,
                                        "Property_Owner" => $homeowner,
                                        "NoSale" => "No",
                                        "Timing" => $Timing,
                                        "vendor_lead_id" => $leadsCustomerCampaign_id,

                                        "Lead_ID" => $TransactionId,
                                        "Lead_Cost" => $lead_coust,
                                        "First_Name" => $first_name,
                                        "Last_Name" => $last_name,
                                        "Email" => $email,
                                        "Primary_Phone" => $number1,
                                        "Property_Address" => $street,
                                        "Active_Prospect_URL" => $trusted_form,
                                    )
                                );

                                $httpheader = array(
                                    'Content-Type: application/json',
                                    'Accept: application/json',
                                );

                                $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                                $result2 = json_decode($result, true);

                                if (!empty($result2['response']['status'])) {
                                    if ($result2['response']['status'] == "Matched") {
                                        return 1;
                                    }
                                }
                                break;
                            case 6:
                                //Roofing
                                $Type_OfRoofing = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($Type_OfRoofing) {
                                    case "Asphalt Roofing":
                                        $Type_OfRoofing_data = "Asphalt Shingles";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Asphalt Shingle Roofing - Repair" : "Asphalt Shingle Roofing - Install or Replace");
                                        break;
                                    case "Wood Shake/Composite Roofing":
                                        $Type_OfRoofing_data = "Wood Shake";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Wood Shake or Composite Roofing - Repair" : "Wood Shake or Composite Roofing - Install or Replace");
                                        break;
                                    case "Metal Roofing":
                                        $Type_OfRoofing_data = "Metal";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Metal Roofing - Repair" : "Metal Roofing - Install or Replace");
                                        break;
                                    case "Natural Slate Roofing":
                                        $Type_OfRoofing_data = "Slate";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Natural Slate Roofing - Repair" : "Natural Slate Roofing - Install or Replace");
                                        break;
                                    case "Tile Roofing":
                                        $Type_OfRoofing_data = "Cement Tile";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Traditional Tile Roofing - Repair" : "Traditional Tile Roofing - Install or Replace");
                                        break;
                                    default:
                                        $Type_OfRoofing_data = "Other or Unknown";
                                        $roof_task = ($project_nature == "Repair existing roof" ? "Flat, Foam or Single Ply Roofing - Repair" : "Flat, Foam, or Single Ply Roofing - Install or Replace");
                                }

                                $url_api_post = "https://live.sbbnetinc.com/rest/api/roofing/submit-inquiry";

                                if (config('app.env', 'local') == "local") {
                                    //Test Mode
                                    $source_name = "test";
                                    $vendor_id = "8";
                                } else {
                                    //Live Mode
                                    $source_name = "alliedr";
                                    $vendor_id = "8";
                                }

                                $Lead_data_array_post = array(
                                    "Request" => array(
                                        "Key" => "SQ.sSO1huWFhgZuhg-vwSWpRSQ3XD-hiSW3Ng-vrM0MiuWbsD510DTNh7sbL",
                                        "API_Action" => "pingPostLead",
                                        "Format" => "JSON",
                                        "Mode" => "post",
                                        "Return_Best_Price" => "1",
                                        "TYPE" => "16",
                                        "IP_Address" => $IPAddress,
                                        "SRC" => $source_name,
                                        "Landing_Page" => $OriginalURL2,
                                        "source_number" => $vendor_id,
                                        "Sub_ID" => $leadsCustomerCampaign_id,
                                        "Pub_ID" => $google_ts,
                                        "Universal_Lead_ID" => $LeadId,
                                        "Best_Time_To_Call" => "Anytime",
                                        "Property_Zip" => $zip,
                                        "Property_City" => $city,
                                        "Property_State" => $statename_code,
                                        "Roof_Material" => $Type_OfRoofing_data,
                                        "Roof_Task" => $roof_task,
                                        "Property_Owner" => "Yes",
                                        "NoSale" => "No",
                                        "Timing" => "Immediately",
                                        "vendor_lead_id" => $leadsCustomerCampaign_id,

                                        "Lead_ID" => $TransactionId,
                                        "Lead_Cost" => $lead_coust,
                                        "First_Name" => $first_name,
                                        "Last_Name" => $last_name,
                                        "Email" => $email,
                                        "Primary_Phone" => $number1,
                                        "Property_Address" => $street,
                                        "Active_Prospect_URL" => $trusted_form,
                                    )
                                );

                                $httpheader = array(
                                    'Authorization: Basic cmVzdC11c2VyOjVTOGNCRHEmRWYha3BMKk5XNXVM',
                                    'Content-Type: application/json',
                                    'Accept: application/xml',
                                );

                                $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                                if (strpos("-" . $result, 'Accepted') == true || strpos("-" . $result, 'Match') == true) {
                                    return 1;
                                }
                                break;
                            case 9:
                                //Bathroom
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $Property_Owner = ($ownership == "Yes" ? "Yes" : "No");

                                $url_api = "https://live.sbbnetinc.com/rest/api/home-services/submit-inquiry";
                                $srs_name = "alliedbre";
                                if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                                    //Test Mode
                                    $url_api = "https://uat.loanbright.com/rest/api/home-services/submit-inquiry";
                                    $srs_name = "REMODELHS";
                                }

                                $httpheader = array(
                                    'Authorization: Basic cmVzdC11c2VyOjVTOGNCRHEmRWYha3BMKk5XNXVM',
                                    'Content-Type: application/json',
                                    'Accept: application/json',
                                );

                                $Lead_data_array = array(
                                    "Request" => array(
                                        "Mode" => "post",
                                        "Lead_ID" => $TransactionId,
                                        "IP_Address" => $IPAddress,
                                        "SRC" => $srs_name,
                                        "Landing_Page" => $OriginalURL2,
                                        "Sub_ID" => $leadsCustomerCampaign_id,
                                        "Pub_ID" => $google_ts,
                                        "Universal_Lead_ID" => $LeadId,
                                        "Active_Prospect_URL" => $trusted_form,
                                        "Best_Time_To_Call" => "Anytime",
                                        "Property_State" => $statename_code,
                                        "Property_Zip" => $zip,
                                        "Property_Owner" => $Property_Owner,
                                        "Tcpa_Language" => $TCPAText,
                                        "Category" => "Remodeling",
                                        "Category_Type" => "Bathroom",

                                        "First_Name" => $first_name,
                                        "Last_Name" => $last_name,
                                        "Email" => $email,
                                        "Primary_Phone" => $number1,
                                        "Property_Address" => $street,
                                        "Property_City" => $city
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                if (strpos("-" . $result, 'Accepted') == true || strpos("-" . $result, 'Match') == true) {
                                    return 1;
                                }
                                break;
                            case 21:
                                //Gutter
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $service = trim($crm_details['data']['service']);

                                $Property_Owner = ($ownership == "Yes" ? "Yes" : "No");
                                $Category_Action = ($project_nature == "Repair" ? "Repair" : "Install");
                                switch ($service) {
                                    case "Copper":
                                        $Category_Type = "Copper";
                                        break;
                                    case "Seamless Aluminum":
                                        $Category_Type = "Aluminum";
                                        break;
                                    default:
                                        $Category_Type = "Other";
                                }

                                $url_api = "https://live.sbbnetinc.com/rest/api/home-services/submit-inquiry";
                                $srs_name = "alliedgu";
                                if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                                    //Test Mode
                                    $url_api = "https://uat.loanbright.com/rest/api/home-services/submit-inquiry";
                                    $srs_name = "GUTTERHS";
                                }

                                $httpheader = array(
                                    'Authorization: Basic cmVzdC11c2VyOjVTOGNCRHEmRWYha3BMKk5XNXVM',
                                    'Content-Type: application/json',
                                    'Accept: application/json',
                                );

                                $Lead_data_array = array(
                                    "Request" => array(
                                        "Mode" => "post",
                                        "Lead_ID" => $TransactionId,
                                        "IP_Address" => $IPAddress,
                                        "SRC" => $srs_name,
                                        "Landing_Page" => $OriginalURL2,
                                        "Sub_ID" => $leadsCustomerCampaign_id,
                                        "Pub_ID" => $google_ts,
                                        "Universal_Lead_ID" => $LeadId,
                                        "Active_Prospect_URL" => $trusted_form,
                                        "Best_Time_To_Call" => "Anytime",
                                        "Property_State" => $statename_code,
                                        "Property_Zip" => $zip,
                                        "Property_Owner" => $Property_Owner,
                                        "Tcpa_Language" => $TCPAText,
                                        "Category" => "Gutters",
                                        "Category_Type" => $Category_Type,
                                        "Category_Action" => $Category_Action,

                                        "First_Name" => $first_name,
                                        "Last_Name" => $last_name,
                                        "Email" => $email,
                                        "Primary_Phone" => $number1,
                                        "Property_Address" => $street,
                                        "Property_City" => $city
                                    )
                                );

                                $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                                if (strpos("-" . $result, 'Accepted') == true || strpos("-" . $result, 'Match') == true) {
                                    return 1;
                                }
                                break;
                        }
                    }
                    break;
                case 289:
                    //SunPower By Hooked On Solar
                    $lead_source = "Allied Digital Media";
                    $ElectricalProvider = "Other";        //00N40000002mYgp
                    $AverageMonthlyBill = trim($crm_details['data']['monthly_electric_bill']);;     //00N40000002mYfn

                    $url_api = "https://webto.salesforce.com/servlet/servlet.WebToLead?encoding=UTF-8";
                    $Lead_data_array = "oid=00D40000000MxKd&retURL=http://&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&street=$street&city=$city&zip=$zip&state=$state&lead_source=$lead_source&00N40000002mYgp=$ElectricalProvider&00N40000002mYfn=$AverageMonthlyBill&00N1W000002sYTb=$Lead_Cost";
                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded",
                        "Cookie: BrowserId=cDZghvzqEeqVPLVV8x7_Fg"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 75:
                    //home advisor New =======================================================================================
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $CjLeadKey = $data_msg['ping_post_data']['TransactionId'];
                        $property_type_data = "Home/Residence";
                        $ownership_data = "Yes";
                        $CJ_Service_ID = 0;

                        switch ($crm_details['service_id']) {
                            case 1:
                                //Windows
                                $number_of_window = trim($crm_details['data']['number_of_window']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                $ownership_data = ($ownership == "Yes" ? true : false);

                                if ($project_nature != "Repair") {
                                    switch ($number_of_window) {
                                        case 1 || 2:
                                            $CJ_Service_ID = 20;
                                            $task_text = "Window Installation (1-2 windows)";
                                            break;
                                        case "3-5":
                                            $CJ_Service_ID = 21;
                                            $task_text = "Window Installation (3+ windows)";
                                            break;
                                        default:
                                            $CJ_Service_ID = 8086;
                                            $task_text = "New Windows - 6 +";
                                    }
                                } else {
                                    $CJ_Service_ID = 22;
                                    $task_text = "Window or Glass Repair";
                                }
                                break;
                            case 2:
                                //Solar
                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $power_solution = trim($crm_details['data']['power_solution']);

                                switch ($property_type) {
                                    case "Owned":
                                        $property_type_data = "Home/Residence";
                                        $ownership_data = true;
                                        break;
                                    case "Rented":
                                        $property_type_data = "Home/Residence";
                                        $ownership_data = false;
                                        break;
                                    default:
                                        $property_type_data = "Business";
                                        $ownership_data = true;
                                }

                                switch ($power_solution) {
                                    case "Solar Water Heating for my Home":
                                        $CJ_Service_ID = ($property_type == "Business" ? 5202 : 5001);
                                        //$task_text = "Install or Replace Solar Water Heater For Business";//5202
                                        //$task_text = "Install or Replace Solar Water Heater";//5001
                                        break;
                                    case "Solar for my Business":
                                        $CJ_Service_ID = 5204;
                                        //$task_text = "Install Electric Solar Panels For Business";//5204
                                        break;
                                    default:
                                        $CJ_Service_ID = ($property_type == "Business" ? 5204 : 5200);
                                    //$task_text = "Install Electric Solar Panels For Business";//5204
                                    //$task_text = "Install Electric Solar Panels";//5200
                                }
                                break;
                            case 3:
                                //Home Security
                                $property_type = trim($crm_details['data']['property_type']);

                                switch ($property_type) {
                                    case "Owned":
                                        $property_type_data = "Home/Residence";
                                        $ownership_data = true;
                                        break;
                                    case "Rented":
                                        $property_type_data = "Home/Residence";
                                        $ownership_data = false;
                                        break;
                                    default:
                                        $property_type_data = "Business";
                                        $ownership_data = true;
                                }

                                $CJ_Service_ID = 8266;
                                $task_text = "Alarm or Security System - Install";
                                break;
                            case 4:
                                //Flooring
                                $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($Type_OfFlooring) {
                                    case "Vinyl Linoleum Flooring":
                                        //$task_text = "Repair Vinyl/Linoleum Flooring";//3980
                                        //$task_text = "Install or Replace Vinyl/Linoleum Flooring";//3930
                                        //$CJ_Service_ID = "($project_nature == "Repair Existing Flooring" ? 3980 : 3930)";

                                        //$task_text = "Vinyl or Linoleum Sheet Flooring or Tiles - Install - Materials Not Provided"; //46342
                                        $CJ_Service_ID = "46342";
                                        break;
                                    case "Tile Flooring":
                                        //$task_text = "Vinyl or Linoleum Sheet Flooring or Tiles - Repair";//8141
                                        //$task_text = "Tile: Natural Stone (Granite, Marble, Slate, Quartz, etc) - Install";//8336
                                        //$CJ_Service_ID = ($project_nature == "Repair Existing Flooring" ? 8141 : 8336);

                                        //$task_text = "Vinyl or Linoleum Sheet Flooring or Tiles - Install - Materials Not Provided"; //46342
                                        $CJ_Service_ID = "46342";
                                        break;
                                    case "Hardwood Flooring":
                                        //$task_text = "Repair Hardwood Flooring";//3950
                                        //$task_text = "Refinish Hardwood Flooring";//4000
                                        //$CJ_Service_ID = ($project_nature == "Repair Existing Flooring" ? 3950 : 4000);

                                        //$task_text = "Wood Flooring - Install or Completely Replace"; //46338
                                        $CJ_Service_ID = "46338";
                                        break;
                                    case "Laminate Flooring":
                                        //$task_text = "Repair Laminate Flooring";//3960
                                        //$task_text = "Install or Replace Laminate Flooring";//3910
                                        //$CJ_Service_ID = ($project_nature == "Repair Existing Flooring" ? 3960 : 3910);

                                        //$task_text = "Laminate Wood or Stone Flooring - Install"; //46340
                                        $CJ_Service_ID = "46340";
                                        break;
                                    case "Carpet":
                                        //$task_text = "Repair Carpet Flooring";//3940
                                        //$task_text = "Install or Replace Carpet Flooring";//3880
                                        //$CJ_Service_ID = ($project_nature == "Repair Existing Flooring" ? 3940 : 3880);

                                        //$task_text = "Carpet - Install - Materials Not Provided"; //46346
                                        $CJ_Service_ID = "46346";
                                        break;
                                }
                                break;
                            case 6:
                                //Roofing
                                $Type_OfRoofing = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                if ($property_type == "Residential") {
                                    $property_type_data = "Home/Residence";
                                    $ownership_data = true;
                                } else {
                                    $property_type_data = "Business";
                                    $ownership_data = true;
                                }

                                switch ($Type_OfRoofing) {
                                    case "Asphalt Roofing":
                                        //$task_text = "Repair Asphalt Shingle Roofing";//3530
                                        //$task_text = "Install Asphalt Shingle Roofing";//3440
                                        $CJ_Service_ID = ($project_nature == "Repair existing roof" ? 3530 : 3440);
                                        break;
                                    case "Wood Shake/Composite Roofing":
                                        //$task_text = "Repair Wood or Composite Roofing";//3580
                                        //$task_text = "Install Wood or Composite Roofing";//3520
                                        $CJ_Service_ID = ($project_nature == "Repair existing roof" ? 3580 : 3520);
                                        break;
                                    case "Metal Roofing":
                                        //$task_text = "Repair Metal Roofing";//3550
                                        //$task_text = "Install Metal Roofing";//3480
                                        $CJ_Service_ID = ($project_nature == "Repair existing roof" ? 3550 : 3480);
                                        break;
                                    case "Natural Slate Roofing":
                                        //$task_text = "Repair Natural Slate Roofing";//3560
                                        //$task_text = "Install Natural Slate Roofing";//3490
                                        $CJ_Service_ID = ($project_nature == "Repair existing roof" ? 3560 : 3490);
                                        break;
                                    case "Tile Roofing":
                                        //$task_text = "Repair Tile Roofing";//3570
                                        //$task_text = "Install Tile Roofing";//3500
                                        $CJ_Service_ID = ($project_nature == "Repair existing roof" ? 3570 : 3500);
                                        break;
                                }
                                break;
                            case 7:
                                //Home Siding
                                $type_of_siding = trim($crm_details['data']['type_of_siding']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($type_of_siding) {
                                    case "Vinyl Siding":
                                        //$task_text = "Repair Vinyl Siding";//3670
                                        //$task_text = "Install or Replace Vinyl Siding";//3590
                                        $CJ_Service_ID = ($project_nature == "Repair section(s) of siding" ? 3670 : 3590);
                                        break;
                                    case "Brickface Siding" || "Stoneface Siding":
                                        //$task_text = "Repair Brick or Stone Siding";//3710
                                        //$task_text = "Install or Replace Brick or Stone Siding";//3640
                                        $CJ_Service_ID = ($project_nature == "Repair section(s) of siding" ? 3710 : 3640);
                                        break;
                                    case "Composite wood Siding":
                                        //$task_text = "Repair Wood or Fiber-Cement Siding";//3680
                                        //$task_text = "Install or Replace Wood or Composite Siding";//3600
                                        $CJ_Service_ID = ($project_nature == "Repair section(s) of siding" ? 3680 : 3600);
                                        break;
                                    case "Fiber Cement Siding":
                                        //$task_text = "Repair Wood or Fiber-Cement Siding";//3680
                                        // $task_text = "Wood or Fiber-Cement Siding - Repair or Partially Replace";//8282
                                        $CJ_Service_ID = ($project_nature == "Repair section(s) of siding" ? 3680 : 8282);
                                        break;
                                }
                                break;
                            case 8:
                                //Kitchen
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                $CJ_Service_ID = 4030;
                                $task_text = "Additions & Remodels Kitchen Remodel";
                                break;
                            case 9:
                                //Bathroom
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                $CJ_Service_ID = 4040;
                                $task_text = "Additions & Remodels Bathroom Remodel";
                                break;
                            case 11:
                                //Furnace
                                $type_of_heating = trim($crm_details['data']['type_of_heating']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($type_of_heating) {
                                    case "Do Not Know" || "Electric":
                                        //$task_text = "Electric Furnace / Forced Air Heating System - Repair";//8183
                                        //$task_text = "Electric Furnace / Forced Air Heating System - Install";//8182
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8183 : 8182);
                                        break;
                                    case "Natural Gas" || "Propane Gas":
                                        //$task_text = "Gas Furnace / Forced Air Heating System - Repair";//8185
                                        //$task_text = "Gas Furnace / Forced Air Heating System - Install";//8184
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8185 : 8184);
                                        break;
                                    case "Oil":
                                        //$task_text = "Oil Furnace / Forced Air Heating System - Repair";//8189
                                        //$task_text = "Oil Furnace / Forced Air Heating System - Install";//8188
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8189 : 8188);
                                        break;
                                }
                                break;
                            case 12:
                                //Boiler
                                $type_of_heating = trim($crm_details['data']['type_of_heating']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($type_of_heating) {
                                    case "Do Not Know" || "Electric":
                                        //$task_text = "Electric Boiler or Radiator Heating System - Repair";//8239
                                        //$task_text = "Electric Boiler or Radiator Heating System - Install";//8238
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8239 : 8238);
                                        break;
                                    case "Natural Gas" || "Propane Gas":
                                        //$task_text = "Gas Boiler or Radiator Heating System - Repair";//8241
                                        //$task_text = "Gas Boiler or Radiator Heating System - Install";//8240
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8241 : 8240);
                                        break;
                                    case "Oil":
                                        //$task_text = "Oil Boiler or Radiator Heating System - Repair";//8243
                                        //$task_text = "Oil Boiler or Radiator Heating System - Install";//8242
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 8243 : 8242);
                                        break;
                                }
                                break;
                            case 13:
                                //Central A/C
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                //$task_text = "Central A/C - Repair or Service";//8243
                                //$task_text = "Central A/C - Install or Replace";//4330
                                $CJ_Service_ID = ($project_nature == "Repair" ? 4340 : 4330);
                                break;
                            case 14:
                                //Cabinet
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                //$task_text = "Refinish Cabinets";//4130
                                //$task_text = "Cabinets - Install";//8327
                                $CJ_Service_ID = ($project_nature == "Cabinet Refacing" ? 4130 : 8327);
                                break;
                            case 15:
                                //Plumbing
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                $CJ_Service_ID = 5005;
                                $task_text = "Plumbing for a remodel or addition - Install";
                                break;
                            case 18:
                                //Handyman
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                $CJ_Service_ID = 5801;
                                $task_text = "Handyman for Multiple Small Projects";
                                break;
                            case 19:
                                //Countertops
                                $countertops_service = trim($crm_details['data']['service']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($countertops_service) {
                                    case "Laminate":
                                        //$task_text = "Repair Laminate Countertops";//4300
                                        //$task_text = "Install Laminate Countertops";//4290
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 4300 : 4290);
                                        break;
                                    case "Other Solid Stone (e.g Quartz)":
                                        //$task_text = "Repair Solid Surface Countertops (Corian, Wood, Concrete, Stainless Steel, etc.)";//4280
                                        //$task_text = "Install Solid Surface Countertops (Corian, Wood, Concrete, Stainless Steel, etc)";//4270
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 4280 : 4270);
                                        break;
                                    default:
                                        //$task_text = "Repair Stone Slab Countertops (Granite, Marble, Quartz, etc)";//4250
                                        //$task_text = "Install Stone Slab Countertops (Granite, Marble, Quartz, etc)";//4240
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 4250 : 4240);
                                }
                                break;
                            case 20:
                                //Doors
                                $door_type = trim($crm_details['data']['door_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                if ($project_nature != "Repair") {
                                    //$task_text = "Doors (Exterior) - Install or Replace";//8083
                                    //$task_text = "Doors (Interior) - Install or Replace";//8084
                                    $CJ_Service_ID = ($project_nature == "Repair" ? 8083 : 8084);
                                } else {
                                    $CJ_Service_ID = 8082;
                                    $task_text = "Doors - Repair";
                                }
                                break;
                            case 21:
                                //Gutter
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $service = trim($crm_details['data']['service']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($service) {
                                    case "Galvanized Steel":
                                        //$task_text = "Repair Galvanized Gutters";//5106
                                        //$task_text = "Install Galvanized Gutters";//5101
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 5106 : 5101);
                                        break;
                                    case "PVC":
                                        //$task_text = "Repair PVC Gutters";//5107
                                        //$task_text = "Install PVC Gutters";//5102
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 5107 : 5102);
                                        break;
                                    case "Seamless Aluminum":
                                        //$task_text = "Repair Seamless Metal Gutters";//5108
                                        //$task_text = "Install Seamless Metal Gutters";//5103
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 5108 : 5103);
                                        break;
                                    case "Wood":
                                        //$task_text = "Repair Wood Gutters";//5109
                                        //$task_text = "Install Wood Gutters";//5104
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 5109 : 5104);
                                        break;
                                    default:
                                        //$task_text = "Repair Copper Gutters";//5105
                                        //$task_text = "Install Copper Gutters";//5100
                                        $CJ_Service_ID = ($project_nature == "Repair" ? 5105 : 5100);
                                }
                                break;
                            case 22:
                                //Paving
                                $service = trim($crm_details['data']['service']);
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);

                                switch ($service) {
                                    case "Asphalt Paving - Install" || "Asphalt Sealing":
                                        $CJ_Service_ID = 4820;
                                        $task_text = "Asphalt Paving - Install";
                                        break;
                                    case "Gravel or Loose Fill Paving - Install, Spread or Scrape":
                                        $CJ_Service_ID = 4824;
                                        $task_text = "Gravel or Loose Fill Paving - Install, Spread or Scrape";
                                        break;
                                    default:
                                        $CJ_Service_ID = 4821;
                                        $task_text = "Asphalt Paving - Repair or Patch";
                                }
                                break;
                            case 23:
                                //Painting
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? true : false);
                                $service = trim($crm_details['data']['service']);

                                switch ($service) {
                                    case "Exterior Home or Structure - Paint or Stain":
                                        $CJ_Service_ID = 36;
                                        $task_text = "Exterior Painting";
                                        break;
                                    case "Interior Home or Surfaces - Paint or Stain":
                                        $rooms_number = trim($crm_details['data']['rooms_number']);
                                        switch ($rooms_number) {
                                            case "1-2":
                                                $CJ_Service_ID = 1001;
                                                $task_text = "Interior Painting (1-2 rooms)";
                                                break;
                                            case "3-4":
                                                $CJ_Service_ID = 1002;
                                                $task_text = "Interior Painting (3-4 rooms)";
                                                break;
                                            default:
                                                $CJ_Service_ID = 1003;
                                                $task_text = "Interior Painting (5+ rooms)";
                                        }
                                        break;
                                    case "Painting or Staining - Small Projects":
                                        $CJ_Service_ID = 8228;
                                        $task_text = "Painting or Staining - Small Projects";
                                        break;
                                    case "Metal Roofing - Paint":
                                        $CJ_Service_ID = 1011;
                                        $task_text = "Paint Metal Roofing";
                                        break;
                                    case "Specialty Painting - Textures":
                                        $CJ_Service_ID = 8230;
                                        $task_text = "Specialty Painting - Textures";
                                        break;
                                }
                                break;
                        }

                        if (config('app.env', 'local') == "local") {
                            //Test Mode
                            $IsTest = false;
                            $url_api_post = "https://api.cj-x.com/v1/post";
                            // $url_api_post = "https://api.cj-x.com/v1/post";
                        } else {
                            //Live Mode
                            $IsTest = false;
                            $url_api_post = "https://api.cj-x.com/v1/post";
                        }

                        $httpheader = array(
                            "x-api-key:KNTH0HGtTc7nJ4TcQFj5U2cuIbbDV8rC2xXSjNJV",
                            "content-type: application/json",
                            "User-Agent: pro.allieddigitalmedia PingPost"
                        );

                        $Lead_data_array = array(
                            "CjLeadKey" => $CjLeadKey,
                            "FirstName" => $first_name,
                            "LastName" => $last_name,
                            "Address" => $street,
                            "City" => $city,
                            "State" => $statename_code,
                            "ZipCode" => $zip,
                            "PhoneNumber" => $number1,
                            "EmailAddress" => $email,
                            "HomeOwner" => $ownership_data,
                            "PropertyType" => $property_type_data,
                            "ServiceID" => $CJ_Service_ID,
                            "TCPAConsentLanguage" => $TCPAText,
                            "TCPAConsent" => $tcpa_compliant4,
                            "IpAddress" => $IPAddress,
                            "IsTest" => $IsTest,
                            "TrafficSource" => $lead_source_text,
                            "TrustedFormUrl" => $trusted_form,
                            "thirdpartyleadID" => $leadsCustomerCampaign_id,
                        );

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array, JSON_UNESCAPED_SLASHES), "POST", 1, $crm_details['campaign_id']);
                        $result2 = json_decode($result, true);
                        if (!empty($result2['success'])) {
                            if ($result2['success'] == "true" || $result2['success'] == 1) {
                                return 1;
                            }
                        }
                    }
                    break;
                case 280:
                    // eLocal 280
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $ping_token = $data_msg['ping_post_data']['TransactionId'];
                        $Need_Id = 0;

                        switch ($crm_details['service_id']) {
                            case 1:
                                //Windows
                                $project_nature = trim($crm_details['data']['project_nature']);

                                if ($project_nature == "Replace") {
                                    $Need_Id = "160-11854";
                                    $CopyPoint = "Window Replacement";
                                } else {
                                    $Need_Id = "160-11855";
                                    $CopyPoint = "Window Installation";
                                }
                                break;
                            case 2:
                                //Solar
                                $Need_Id = "483-12942";
                                $CopyPoint = "Solar Energy Systems";
                                break;
                            case 5:
                                //Walk-In Tubs
                                $Need_Id = "836-14631";
                                $CopyPoint = "Walk-In Tubs";
                                break;
                            case 6:
                                //Roofing
                                $roof_type = trim($crm_details['data']['roof_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $start_time = trim($crm_details['data']['start_time']);

                                switch ($roof_type) {
                                    case "Asphalt Roofing":
                                        $Need_Id = ($project_nature == "Repair existing roof" ? "11000-10166" : "11000-10157");
                                        break;
                                    case "Wood Shake/Composite Roofing":
                                        $Need_Id = ($project_nature == "Repair existing roof" ? "11000-10167" : "11000-10158");
                                        break;
                                    case "Metal Roofing":
                                        $Need_Id = ($project_nature == "Repair existing roof" ? "11000-10170" : "11000-10161");
                                        break;
                                    case "Natural Slate Roofing":
                                        $Need_Id = ($project_nature == "Repair existing roof" ? "11000-10171" : "11000-10162");
                                        break;
                                    case "Tile Roofing":
                                    default:
                                        $Need_Id = ($project_nature == "Repair existing roof" ? "11000-10168" : "11000-10159");
                                }
                                break;
                            case 8:
                                //Kitchen
                                $Need_Id = "250-12055";
                                $CopyPoint = "Kitchen Remodeling";
                                break;
                            case 9:
                                //Bathroom
                                $Need_Id = "249-12048";
                                $CopyPoint = "Bathroom Remodeling";
                                break;
                        }

                        $url_api_post = "https://api.elocal.com/lead/post";

                        $httpheader = array(
                            "content-type: application/json",
                        );

                        $Lead_data_array = array(
                            "post" => array(
                                "key" => "fe7e7c284be747d9669c68c0ab3b186824a4b2da",
                                "ping_token" => $ping_token,
                                "zip_code" => $zip,
                                "need_id" => $Need_Id,
                                "first_name" => $first_name,
                                "last_name" => $last_name,
                                "phone" => $number1,
                                "tcpa_consent" => $tcpa_compliant4,
                                "trusted_form_cert_id" => $trusted_form,
                                "email" => $email,
                                "address" => $street,
                                "sender_id" => $leadsCustomerCampaign_id,
                                "leadid_identifier" => $LeadId,
                                "web_lead_source_url" => $OriginalURL2
                            )
                        );

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'success') == true) {
                            return 1;
                        }
                    }
                    break;
                case 293:
                    //callshaper CRM for visionsolar Buyer 293
                    $Lead_Cost = "$" . $Lead_Cost;
                    //Solar
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);
                    $CreditScore = "OVER 630";
                    $InquiryDate = date("Y-m-d");
                    $LeadSubCategory = "Online";
                    $LeadVendor = 'Allied Digital';
                    $CallableUntil = date("Y-m-d", strtotime('+3 days'));
                    $ExpressConsent = 1;

                    $monthly_electric_bill = str_replace('$', '', $monthly_electric_bill);

                    $httpheader = array();

                    $url_api_ping = "https://manage.callshaper.com/lead/ping/7d2b8892a3374a2b209dbf235815d5d69bcbfe34?PhoneNumber=$number1";
                    $url_api_ping = str_replace(" ", "%20", $url_api_ping);
                    $result_ping = $crm_api_file->api_send_data($url_api_ping, $httpheader, $crm_details['leadsCustomerCampaign_id'], "", "POST", 1, $crm_details['campaign_id']);

                    if ($result_ping == "Success|OK") {
                        $url_api_post = "https://manage.callshaper.com/lead/post/7d2b8892a3374a2b209dbf235815d5d69bcbfe34?Address=$street&City=$city&State=$statename_code&CreditScore=$CreditScore&ElectricBill=$monthly_electric_bill&Email=$email&FirstName=$first_name&InquiryDate=$InquiryDate&LastName=$last_name&LeadCost=$Lead_Cost&LeadSubCategory=$LeadSubCategory&PhoneNumber=$number1&Zip=$zip&UtilityProvider=$utility_provider&PubID=$LeadVendor&LeadVendor=$LeadVendor&CallableUntil=$CallableUntil&ExpressConsent=$ExpressConsent";
                        $url_api_post = str_replace(" ", "%20", $url_api_post);
                        $result_post = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);

                        if (strpos("-" . $result_post, 'Success') == true) {
                            return 1;
                        }
                    }
                    break;
                case 321:
                    //digital media solutions The DMS Group	321
                    if ($crm_details['campaign_Type'] == 6) {
                        $url_api = "https://display.ringba.com/enrich/2234858665335064274?callerid=$number1&first_name=$first_name&last_name=$last_name&zipcode=$zip&email=$email&jornaya_id=$LeadId&trusted_form=$trusted_form&address=$street&address2=&city=$city";
                        $url_api = str_replace(" ", "%20", $url_api);
                        $httpheader = array();

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                        if (str_contains($result, "ok")) {
                            return 1;
                        }
                    } else {
                        $httpheader = array(
                            "content-type: application/json",
                            "Accept : application/xml",
                        );

                        $utm_campaign = "702732";
                        $UserAgent = (!empty($UserAgent) ? $UserAgent : "Mozilla/5.0");

                        if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                            $resvcode = $data_msg['ping_post_data']['TransactionId'];

                            switch ($crm_details['service_id']) {
                                case 1:
                                    //Windows
                                    $url_api_post = "https://post.digitalmediasolutions.com/81716142c610965081d1164a9f578a5f/post";
                                    break;
                                case 2:
                                    //Solar
                                    $url_api_post = "https://post.digitalmediasolutions.com/0924e528e66897c0d026fe70f67c13dc/post";
                                    break;
                                case 3:
                                    //Home Security
                                    $url_api_post = "https://post.digitalmediasolutions.com/a3c65c8c4339c8003c980e00d3871344/post";
                                    break;
                                case 4:
                                    //Flooring
                                    $url_api_post = "https://post.digitalmediasolutions.com/788c7325e161aa2224c6053be452c4ac/post";
                                    break;
                                case 6:
                                    //Roofing
                                    $url_api_post = "https://post.digitalmediasolutions.com/5cab79e7de435e35b742e649aca0f078/post";
                                    break;
                                case 9:
                                    //Bathroom
                                    $url_api_post = "https://post.digitalmediasolutions.com/bec9eea77bee5aa163acf3e6b1f9e936/post";
                                    break;
                                case 24:
                                    //Auto Insurance
                                    $url_api_post = "https://post.digitalmediasolutions.com/b67ad8f316f272b5f155c21d0e8876b4/post";
                                    break;
                            }

                            $Lead_data_array = array(
                                "resvcode" => $resvcode,
                                "firstname" => $first_name,
                                "lastname" => $last_name,
                                "email" => $email,
                                "phone" => $number1,
                                "address1" => $street,
                                "utm_campaign" => $lead_source_text,
                                "sub1" => $google_ts,
                                "utm_source" => $utm_campaign,
                                "city" => $city,
                                "jornayaleadid" => $LeadId,
                                "xx_trusted_form_cert_url" => $trusted_form,
                                "user_agent" => $UserAgent,
                                "tcpa_text" => "[$TCPAText]",
                                "utm_term" => ($listOFCampainDB_type == "Exclusive" ? "" : "shared")
                            );

                            if (config('app.env', 'local') == "local") {
                                //Test Mode
                                $Lead_data_array['test'] = 1;
                            }

                            $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);

                            if (strpos("-" . $result, 'accepted') == true) {
                                return 1;
                            }
                        }
                    }
                    break;
                case 345:
                    //Ping Tree System (where is my contractor) 345
                    $Lead_data_Post = "";
                    $windowCount = "";
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        switch ($crm_details['service_id']) {
                            case 1:
                                //Window
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $number_of_windows = trim($crm_details['data']['number_of_window']);
                                $ownership = trim($crm_details['data']['homeOwn']);

                                if ($project_nature == "Repair") {
                                    $category = "414";
                                } else {
                                    $category = ($number_of_windows == '1' ? "413" : "412");
                                }

                                $windowCount = ($number_of_windows == "10+" ? 10 : $number_of_windows);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                break;
                            case 2:
                                //Solar
                                $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                                $utility_provider = trim($crm_details['data']['utility_provider']);
                                $roof_shade = trim($crm_details['data']['roof_shade']);
                                $property_type = trim($crm_details['data']['property_type']);
                                $power_solution = trim($crm_details['data']['power_solution']);

                                switch ($monthly_electric_bill) {
                                    case '$0 - $50':
                                        $average_bill = '50';
                                        break;
                                    case '$51 - $100':
                                        $average_bill = '100';
                                        break;
                                    case '$101 - $150':
                                        $average_bill = '150';
                                        break;
                                    case '$151 - $200':
                                        $average_bill = '200';
                                        break;
                                    case '$201 - $300':
                                        $average_bill = '300';
                                        break;
                                    case '$301 - $400':
                                        $average_bill = '400';
                                        break;
                                    case '$401 - $500':
                                        $average_bill = '500';
                                        break;
                                    default:
                                        $average_bill = '600';
                                }

                                $ownership_data = ($property_type == "Owned" ? "1" : "0");
                                $purchaseTimeFrame = "Immediately";
                                $bestContactTime = "Any Time";
                                $category = "349";

                                switch ($roof_shade) {
                                    case "Full Sun":
                                        $roof_shade_data = "No Shade";
                                        break;
                                    case "Mostly Shaded":
                                        $roof_shade_data = "Full Shade";
                                        break;
                                    case "Partial Sun":
                                        $roof_shade_data = "Some Shade";
                                        break;
                                    default:
                                        $roof_shade_data = "Not Sure";
                                }

                                $Lead_data_Post .= "electricBill=$average_bill&electricalSupplier=$utility_provider&purchaseTimeFrame=$purchaseTimeFrame&bestContactTime=$bestContactTime&homeOwner=$ownership_data&roofShade=$roof_shade_data";
                                break;
                            case 3:
                                //Home Security
                                $property_type = trim($crm_details['data']['property_type']);
                                $ownership_data = ($property_type == "Owned" ? "1" : "0");
                                $category = "186";
                                break;
                            case 4:
                                //Flooring
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "143";
                                break;
                            case 6:
                                //Roofing
                                $ownership_data = "1";
                                $category = "321";
                                break;
                            case 7:
                                //Home Siding
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $category = ($project_nature == "Repair section(s) of siding" ? "342" : "339");
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                break;
                            case 8:
                                //Kitchen
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "206";
                                break;
                            case 9:
                                //Bathroom
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "21";
                                break;
                            case 11:
                                //Furnace
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = ($project_nature == "Repair" ? "152" : "151");
                                break;
                            case 12:
                                //Boiler
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = ($project_nature == "Repair" ? "32" : "31");
                                break;
                            case 13:
                                //Central A/C
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = ($project_nature == "Repair" ? "52" : "51");
                                break;
                            case 14:
                                //Cabinet
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "88";
                                break;
                            case 15:
                                //Plumbing
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "269";
                                break;
                            case 16:
                                //Bathtubs
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "24";
                                break;
                            case 18:
                                //Handyman
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "175";
                                break;
                            case 19:
                                //CounterTops
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "86";
                                break;
                            case 20:
                                //Doors
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = ($project_nature == "Repair" ? "94" : "92");
                                break;
                            case 21:
                                //Gutter
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "173";
                                break;
                            case 22:
                                //Paving
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $project_type = trim($crm_details['data']['project_type']);
                                $project_nature = trim($crm_details['data']['project_nature']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = ($project_nature == "Repair" ? "10" : "11");
                                break;
                            case 23:
                                //Painting
                                $ownership = trim($crm_details['data']['homeOwn']);
                                $ownership_data = ($ownership == "Yes" ? "1" : "0");
                                $category = "256";
                                break;
                        }

                        $pingid = $data_msg['ping_post_data']['TransactionId'];

                        if ($lead_type_service_id == 2) {
                            $VID = 35;//Solar
                            $url_api_post = "http://lms.whereismycontractor.com/leadSolar/post/";
                            $Lead_data_Post .= "&vid=$VID&zip=$zip&ipaddress=$IPAddress&url=$OriginalURL2&browser=$UserAgent&tcpaConsent=$tcpa_compliant5&tcpaText=$TCPAText&xxTrustedFormCertUrl=$trusted_form&universalLeadid=$LeadId&firstName=$first_name&lastName=$last_name&email=$email&phone=$number1&address=$street&city=$city&state=$statename_code&subid=$google_ts";
                        } else {
                            $VID = 30;//Home Improvement Ex
                            if ($listOFCampainDB_type == "Shared") {
                                $VID = 36;//Home Improvement Sh
                            }
                            $url_api_post = "http://lms.whereismycontractor.com/leadHomeImprovement/post/";
                            $Lead_data_Post .= "vid=$VID&pingid=$pingid&universalLeadid=$LeadId&firstName=$first_name&lastName=$last_name&email=$email&phone=$number1&address=$street&city=$city&state=$statename_code&zip=$zip&category=$category&homeOwner=$ownership_data&ip_address=$IPAddress&url=$OriginalURL&browser=$lead_browser_name&xxTrustedFormCertUrl=$trusted_form&windowCount=$windowCount&tcpaConsent=$tcpa_compliant5&tcpaLanguage=$TCPAText&subid=$google_ts";
                        }

                        $httpheader = array(
                            'Accept: application/xml',
                            'Content-Type: application/x-www-form-urlencoded',
                        );

                        if (config('app.env', 'local') == "local") {
                            //Test Mode
                            $Lead_data_Post .= "&istest=true";
                        }

                        $Lead_data_Post = str_replace(" ", "+", $Lead_data_Post);

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'Accepted') == true) {
                            return 1;
                        }
                    }
                    break;
                case 348:
                    // Suncoast USA (Luminescent Enc.) 348
                    if ($crm_details['service_id'] == 7) {
                        $project = "Siding";
                    } else if (in_array($crm_details['service_id'], [11, 12, 13])) {
                        $project = "HVAC";
                    } else {
                        $project = $data_msg['LeadService'];
                    }

                    if (!empty($crm_details['data']['homeOwn'])) {
                        $ownership_data = ($crm_details['data']['homeOwn'] == "Yes" ? "Y" : "N");
                    } else {
                        if (!empty($crm_details['data']['property_type'])) {
                            $ownership_data = ($crm_details['data']['property_type'] == "Rented" ? "N" : "Y");
                        } else {
                            $ownership_data = "Y";
                        }
                    }

                    $url_api_post = "http://www.lightfirecrm.com/api/post_lead_lf.php";

                    $httpheader = array(
                        'Accept: application/xml',
                        'Content-Type: application/x-www-form-urlencoded',
                    );

                    $lead_source = "Allied Digital Media";
                    $api_key = "6681BCEF-4113-4CBE-845D-292297189327";

                    $Lead_data_Post = "api_key=$api_key&lead_source=$lead_source&first_name=$first_name&last_name=$last_name&street=$street&city=$city&state=$statename_code&zip=$zip&email=$email&number1=$number1&homeowner=$ownership_data&program=$project";
                    $Lead_data_Post = str_replace(" ", "+", $Lead_data_Post);

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'SUCCESS') == true) {
                        return 1;
                    }
                    break;
                case 351:
                    // Vivint security 351
                    if (!empty($crm_details['data']['homeOwn'])) {
                        $ownership = trim($crm_details['data']['homeOwn']);
                        $ownership_data = ($ownership == "Yes" ? 1 : 0);
                    } else {
                        if (!empty($crm_details['data']['property_type'])) {
                            $ownership = trim($crm_details['data']['property_type']);
                            $ownership_data = ($ownership == "Rented" ? 0 : 1);
                        } else {
                            $ownership_data = "1";
                        }
                    }

                    $lp_response = "JSON";

                    if ($crm_details['campaign_Type'] == 6) {
                        $url = "https://t.vivint.com/post.do";
                        $lp_campaign_id = "6530b5816a079";
                        $lp_campaign_key = "KbjHV789kfTPXypn6JcL";
                        $number2 = $number1;
                        $url_api = "$url?lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=$lp_response&first_name=$first_name&last_name=$last_name&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&email_address=$email&ip_address=$IPAddress&home_owner=$ownership_data&full_referrer_url=$OriginalURL&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&lp_caller_id=$number2";
                    } else {
                        $url = "https://t.vivint.com/post.do";
                        $lp_campaign_id = "6089932ccef5d";
                        $lp_campaign_key = "BDMhwrq6gZbkW3cJY72z";
                        $number2 = "001" . $number1;
                        $url_api = "$url&lp_campaign_id=$lp_campaign_id&lp_campaign_key=$lp_campaign_key&lp_response=$lp_response&first_name=$first_name&last_name=$last_name&phone_cell=$number1&address=$street&city=$city&state=$state&zip_code=$zip&email_address=$email&ip_address=$IPAddress&home_owner=$ownership_data&full_referrer_url=$OriginalURL&jornaya_lead_id=$LeadId&trusted_form_cert_id=$trusted_form&lp_caller_id=$number1";
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api .= "&lp_test=1";
                    }

                    $url_api = str_replace(" ", "%20", $url_api);

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, '', "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    $status = 0;
                    if (!empty($result2['result'])) {
                        if ($result2['result'] == 'success' || $result2['msg'] == 'Lead Accepted') {
                            $status = 1;
                        }
                    }
                    return $status;
                    break;
                case 299:
                    // FHIA Remodeling 299
                    //Five9 API ======================================================
                    $five9_domian = "Florida Home Improvement";
                    $five9_list = "Allied Digital Media";
                    $Product = strtoupper($crm_details['service_campaign_name']);

                    $url_api1 = "https://api.five9.com/web2campaign/AddToList?F9domain=$five9_domian&F9list=$five9_list&number1=$number1&first_name=$first_name&last_name=$last_name&email=$email&street=$street&city=$city&zip=$zip&Leadkey=$leadsCustomerCampaign_id&Product=$Product&F9CallASAP=True%20Response%20String%20:";
                    $url_api1 = str_replace(" ", "+", $url_api1);

                    $httpheader1 = array();

                    $result1 = $crm_api_file->api_send_data($url_api1, $httpheader1, $leadsCustomerCampaign_id, "", "GET", 1, $crm_details['campaign_id']);

                    //Hatch API ======================================================
                    $url_api_post = "https://prod.usehatchapp.com/api/webhooks/00000879/newlead";

                    $httpheader = array(
                        'X-API-KEY: c650beae-dc92-7916-0e70-ff71147b',
                        'Content-Type: application/json',
                        "Accept : application/xml"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "source" => "Allied-Digital-Media",
                        "id" => $leadsCustomerCampaign_id
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'true') == true) {
                        return 1;
                    }
                    break;
                case 373:
                    //Bishamon Media 373
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        //Solar
                        $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                        $utility_provider = trim($crm_details['data']['utility_provider']);
                        $roof_shade = trim($crm_details['data']['roof_shade']);
                        $property_type = trim($crm_details['data']['property_type']);
                        $power_solution = trim($crm_details['data']['power_solution']);

                        switch ($monthly_electric_bill) {
                            case '$0 - $50':
                                $monthly_bill = "0 - 50";
                                break;
                            case '$51 - $100':
                                $monthly_bill = "51 - 100";
                                break;
                            case '$101 - $150':
                                $monthly_bill = "101 - 150";
                                break;
                            case '$151 - $200':
                                $monthly_bill = "151 - 200";
                                break;
                            case '$201 - $300':
                                $monthly_bill = "201 - 300";
                                break;
                            case '$301 - $400':
                                $monthly_bill = "301 - 400";
                                break;
                            case '$401 - $500':
                                $monthly_bill = "401 - 500";
                                break;
                            default:
                                $monthly_bill = "501 - 600";
                        }

                        $ownership = ($property_type == "Owned" ? "Yes" : "No");
                        $OrderID = $data_msg['ping_post_data']['TransactionId'];

                        $VID = "69913";
                        $LID = "5869";
                        $AID = "29999";

                        $url_api_post = "https://leads.leadexec.net/processor/insert/general";

                        $httpheader = array(
                            'Accept: application/xml',
                            'Content-Type: application/x-www-form-urlencoded',
                        );

                        $Lead_data_Post = "VID=$VID&LID=$LID&AID=$AID&OrderID=$OrderID&DoYouOwnYourHome=$ownership&ZipCode=$zip&AverageMonthlyElectricityBill=$monthly_bill&NameOfYourUtilityCompany=$utility_provider&FirstName=$first_name&LastName=$last_name&HomeAddress=$street&EmailAddress=$email&PhoneNumber=$number1&IPAddress=$IPAddress&RoofShade=$roof_shade&City=$city&State=$state&XXTRUSTEDFORMURL=$trusted_form&LeadID=$LeadId&SubID=$lead_source_text";

                        $Lead_data_Post = str_replace(" ", "+", $Lead_data_Post);

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'true') == true) {
                            return 1;
                        }
                    }
                    break;
                case 385:
                    //Broker Calls, LLC 385
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

//                $url_api_post = "https://retreaverdata.com/data_writing?key=52927d19-88cf-4d4d-ab10-b2784dad92ec";
                    $url_api_post = "https://retreaverdata.com/data_writing?key=b68420e8-a7eb-4a60-a3d0-237a23ba6467";

                    $httpheader = array(
                        'Accept: application/xml',
                        'Content-Type: application/x-www-form-urlencoded',
                    );

                    $Lead_data_Post = "&caller_number=$number1&first_name=$first_name&last_name=$last_name&address_1=$street&city=$city&state=$statename_code&postal_code=$zip&email=$email&homeowner_name=$first_name $last_name&age_of_roof=NA&avg_bill=$monthly_electric_bill&electric_company=$utility_provider";
                    $Lead_data_Post = str_replace(" ", "%20", $Lead_data_Post);

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 415:
                    //kMaps - Kitchen Magic 415
                    switch ($crm_details['service_id']) {
                        case 8:
                            //Kitchen service
                            $service_kitchen = trim($crm_details['data']['services']);
                            $services = ($service_kitchen == 'Cabinet Refacing' ? "1" : "2");
                            $work_type = "Kitchen";
                            break;
                        case 9:
                            //Bathroom service
                            $work_type = "Elements";
                            $services = "11";
                            break;
                    }

                    $url_api_post = "https://kmapis.herokuapp.com/api/leads/048dc2ac-e49f-5d5f-b9f1";

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api_post .= "/test";
                    }

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                    );

                    $Lead_data_array = array(
                        "firstname" => $first_name,
                        "lastname" => $last_name,
                        "address" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zip" => $zip,
                        "email" => $email,
                        "phone" => $number1,
                        "services" => $services,
                        "work_type" => $work_type
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    if (!strpos("-" . $result, 'error') == true) {
                        return 1;
                    }
                    break;
                case 58:
                    //Sunworks USA 58
                    $url_api_post = "https://api.hsforms.com/submissions/v3/integration/submit/6589919/bddfe1e9-1ea5-4469-a0fe-a41688665542";

                    $Lead_data_array = '{
      "skipValidation": "True",
      "fields": [
        {
            "name": "email",
            "value": "' . $email . '"
        },
        {
            "name": "firstname",
            "value": "' . $first_name . '"
        },
        {
            "name": "lastname",
            "value": "' . $last_name . '"
        },
        {
            "name": "phone",
            "value": "' . $number1 . '"
        },
        {
            "name": "address",
            "value": "' . $street . '"
        },
        {
            "name": "city",
            "value": "' . $city . '"
        },
        {
            "name": "state",
            "value": "' . $state . '"
        },
        {
            "name": "zip",
            "value": "' . $zip . '"
        },
        {
            "name": "sunworks_lead_source",
            "value": "Google"
        }
      ]
    }';

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 448:
                    //Salesforce West Shore Home 448
                    switch ($crm_details['service_id']) {
                        case 1:
                            $Product_Interest__c = "Window & Door";
                            break;
                        case 5:
                            $Product_Interest__c = "Walk-in tubs";
                            break;
                        case 9:
                            $Product_Interest__c = "Shower & Bath";
                            break;
                        default:
                            $Product_Interest__c = "";
                    }
                    //To Generate Token
                    $url_api_post_token = 'https://login.salesforce.com/services/oauth2/token?grant_type=password&client_id=3MVG98SW_UPr.JFggJg8AgAvI94WZM6AUwIAM.kMh6SoeESbTxCJr_MsPHofXXAWN_Xpq5lhjKzArTchjRf8s&client_secret=2910B45D195D72A30A41B5923148E10CA8CEB272E361EFC573D0C64D38517ABE&username=leadsgeneric@westshorehome.com&password=yR9BkHP4R9XnMn5Y&redirect_uri=https://login.salesforce.com/services/oauth2/callback';

                    $httpheader_token = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        'Authorization: Bearer wsHcQb8LCLPsEJGCF82VoDLBv'
                    );

                    $Lead_data_array_token = array();

                    $result_token = $crm_api_file->api_send_data($url_api_post_token, $httpheader_token, $leadsCustomerCampaign_id, $Lead_data_array_token, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result_token, true);
                    if (!empty($result2['access_token'])) {
                        $access_token = $result2['access_token'];
                        //Send Lead Info
                        $url_api_post = "https://westshorehome.my.salesforce.com/services/apexrest/api/leadsgeneric";

                        $Lead_data_array = array(
                            "FirstName" => $first_name,
                            "LastName" => $last_name,
                            "Street" => $street,
                            "City" => $city,
                            "StateCode" => $statename_code,
                            "PostalCode" => $zip,
                            "Phone" => $number1,
                            "Email" => $email,
                            "Paid_Lead_ID__c" => $leadsCustomerCampaign_id, //use for Lead ID
                            "LeadSource" => "Paid Lead", //static value
                            "Campaign__c" => "7011G000000cjRRQAY", //static value
                            "Product_Interest__c" => $Product_Interest__c,
                            "Form_id__c" => $OriginalURL2, //url for lead form
                            "Company" => "$street. $city, $statename_code" //this field is required, can just contain full address
                        );

                        $httpheader = array(
                            'Accept: application/json',
                            'Content-Type: application/json',
                            "Authorization: Bearer $access_token"
                        );

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'Success') == true) {
                            return 1;
                        }
                    }
                    break;
                case 454:
                    //Lead Vision	454
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    switch ($crm_details['service_id']) {
                        case 2:
                            $url_api_post = "https://www.greenlifesolar.com/post";
                            break;
                        default:
                            $url_api_post = "https://www.quickquotefinder.com/post/";
                    }

                    $httpheader = array('Accept: application/json');

                    $affiliate_key = "e2c420d928d4bf8ce0ff2ec19b371514";

                    $lead_type = '1';//Regular Lead
                    if ($crm_details['campaign_Type'] == 4) {
                        $lead_type = '2';//Appointment Lead
                    }

                    $test_lead = 0;
                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $test_lead = 1;
                        $zip = "99505 ";
                    }

                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $home_type = "Single-Family";
                            $ProjectType = ($project_nature == "Repair" ? 312 : 311);
                            $project_type = "Windows";
                            switch ($number_of_windows) {
                                case "1":
                                case "2":
                                    $NumWindows = "1-2";
                                    break;
                                case "3-5":
                                    $NumWindows = "3-5";
                                    break;
                                case "6-9":
                                    $NumWindows = "6-9";
                                    break;
                                default:
                                    $NumWindows = "10+";
                            }

                            $ownership = ($ownership != "Yes" ? "Rent" : "Own");

                            $url_api_post .= "?window_quantity=$NumWindows&project_sub_type=$ProjectType&project_type=$project_type&home_type=$home_type&home_owner=$ownership";
                            break;
                        case 2:
                            //solar service
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $affiliate_key = "d1f255a373a3cef72e03aa9d980c7eca";
                            $ownership = ($property_type == "Rented" ? "Rent" : "Own");
                            switch ($monthly_electric_bill) {
                                case '$0 - $50' || '$51 - $100':
                                    $monthly_bill = "1";//Less than $100
                                    break;
                                case '$101 - $150' || '$151 - $200':
                                    $monthly_bill = "2";//From $100 to $200
                                    break;
                                case '$201 - $300':
                                    $monthly_bill = "3";//From $200 to $300
                                    break;
                                default:
                                    $monthly_bill = "4";//More than $300
                            }


                            $url_api_post .= "?electric_bill=$monthly_bill&utility_provider_name=$utility_provider&rent_own=$ownership";
                            break;
                        case 9:
                            //Bathroom service
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $home_type = "Single-Family";
                            $project_type = "Bathroom Remodeling";
                            switch ($bathroom_type_name) {
                                case "Shower / Bath":
                                    $ProjectType = "304";
                                    break;
                                default:
                                    $ProjectType = "301";
                            }
                            $ownership = ($ownership != "Yes" ? "Rent" : "Own");

                            $url_api_post .= "?project_sub_type=$ProjectType&project_type=$project_type&home_type=$home_type&home_owner=$ownership";
                            break;
                    }


                    $url_api_post .= "&test_lead=$test_lead&affiliate_key=$affiliate_key&lead_type=$lead_type&zip=$zip&city=$city&state=$statename_code&lead_ip=$IPAddress&transaction_id=$leadsCustomerCampaign_id&universal_leadid=$LeadId&trusted_form_cert_url=$trusted_form&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&address=$street&ping_key=$TransactionId&sub_id=$google_ts";
                    $url_api_post = str_replace(" ", "%20", $url_api_post);

                    $Lead_data_array = array();

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);

                    if (!empty($result2)) {
                        if ($result2['status'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 484:
                    //Power Solar 484
                    //Google Sheets
                    $appointment_date = "";
                    $appointment_time = "";
                    $appointment_type = "";
                    if ($crm_details['campaign_Type'] == 4 && $data_msg['appointment_date'] != "") {
                        $appointment_date = date('m/d/Y', strtotime($data_msg['appointment_date']));
                        $appointment_time = date('h:i A', strtotime($data_msg['appointment_date']));
                    }

                    if ($crm_details['campaign_Type'] == 4 && $data_msg['appointment_type'] != "") {
                        $appointment_type = $data_msg['appointment_type'];
                    }

                    $date_submitted = date('m/d/Y');

                    $spreadsheetId = "1VPBqPd8HSDkfwQo1rrOXweicwHcB5m_g3ubRQ7VB9M0";
                    $range = "Sheet1";

                    $values = [
                        [$date_submitted, $first_name, $last_name, $email, $number1, $zip, $street, $appointment_type, $appointment_date, $appointment_time],
                    ];

                    $this->googleSheets($spreadsheetId, $range, $values);

                    //go high level
                    $url_api_post = "https://rest.gohighlevel.com/v1/appointments/";

                    $gohighlevelkey = "cf40fe17-72c3-4d48-9782-bcfbe750c81f";
                    $calendarId = "MwEyqDpzfXVYcvo9pHlT";
                    $selectedTimezone = "America/Los_Angeles";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        "Authorization: Bearer $gohighlevelkey"
                    );

                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    $monthly_bill = str_replace(" ", "", $monthly_electric_bill);
                    $monthly_bill = str_replace("$", "", $monthly_bill);
                    $ownership = ($property_type == "Rented" ? "No" : "Yes");

                    $selectedSlot = "";
                    if ($crm_details['campaign_Type'] == 4) {
                        if ($data_msg['appointment_date'] != "") {
                            $appointment_date = date('Y-m-d', strtotime($data_msg['appointment_date']));
                            $appointment_time = date('H:i:s', strtotime($data_msg['appointment_date']));
                            $selectedSlot = $appointment_date . "T" . $appointment_time . "-07:00";
                        }
                    }

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "name" => "$first_name $last_name",
                        "address" => $street,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "website" => $OriginalURL2,
                        "selectedTimezone" => $selectedTimezone,
                        "calendarId" => $calendarId,
                        "selectedSlot" => $selectedSlot,
                        "email" => $email,
                        "phone" => "+1$number1",
                        "tags" => "Allied Digital",
                        "postalCode" => $zip,
                        "1n3YkEN19cyQMyr8V5vl" => $ownership,//homeowner
                        "KTOHXaHkI41rSktqa3gD" => $roof_shade, //Roof Shaded
                        "3jid87FTFLUh5V1HYRzN" => $monthly_bill, //Monthly Electric Bill
                        "KihWZ5OP2JcnzssXOzsJ" => $utility_provider //Utility Providers
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['id'])) {
                        if (!empty($result2['contact']['id'])) {
                            $contuct_id = $result2['contact']['id'];

                            $url_api_post2 = "https://rest.gohighlevel.com/v1/contacts/$contuct_id/tags/";
                            $Lead_data_array2 = array(
                                "tags" => [
                                    "Allied Digital"
                                ]
                            );
                            $result = $crm_api_file->api_send_data($url_api_post2, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array2), "POST", 1, $crm_details['campaign_id']);
                        }
                        return 1;
                    }
                    break;
                case 491:
                    //Zoho Form (Insight solar 491)
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    $Dropdown1 = "Allied Exclusive";
                    if ($listOFCampainDB_type == "Shared") {
                        $Dropdown1 = "Allied Shared";
                    }

                    $url_api_post = "https://forms.zohopublic.com/insightsolar/form/AlliedLeads/formperma/BPTzq88GEd8JKPWB3CmSFktVHYv8RNHzoQIKri8GYaw/records";

                    $httpheader = array(
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "Address" => array(
                            "Address_AddressLine1" => $street,
                            "Address_AddressLine2" => "",
                            "Address_City" => $city,
                            "Address_Country" => "United State",
                            "Address_Region" => $statename_code,
                            "Address_ZipCode" => $zip
                        ),
                        "Dropdown1" => $Dropdown1,
                        "Email" => $email,
                        "Name" => array(
                            "Name_First" => $first_name,
                            "Name_Last" => $last_name
                        ),
                        "PhoneNumber" => $number1,
                        "SingleLine" => $monthly_electric_bill,
                        "SingleLine1" => $roof_shade,
                        "SingleLine2" => $utility_provider
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 509:
                    //Blue Raven Solar 509
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $monthly_bill = 50;
                            break;
                        case '$51 - $100':
                            $monthly_bill = 100;
                            break;
                        case '$101 - $150':
                            $monthly_bill = 150;
                            break;
                        case '$151 - $200':
                            $monthly_bill = 200;
                            break;
                        case '$201 - $300':
                            $monthly_bill = 300;
                            break;
                        case '$301 - $400':
                            $monthly_bill = 400;
                            break;
                        case '$401 - $500':
                            $monthly_bill = 500;
                            break;
                        default:
                            $monthly_bill = 600;
                    }

                    //$api_key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5OTk5OTk5OSIsImlhdCI6MTYzODMwNDkwMCwiZXhwIjoxNjY5ODQwOTAwfQ.UyUpjHk4RvL_2ih2Pf39w2qSHjZUXkvfB2I06AuKc4U";
                    //$api_key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5OTk5OTk5OSIsImlhdCI6MTY2ODU1MjA3OCwiZXhwIjoxNzAwMTEzMjc4fQ.yOuI5Dld3CdnJt7XLBip61L19w8AXA8ABqvwphhx64Q";
                    $api_key = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiI5OTk5OTk5OSIsImlhdCI6MTY4MTk1NDY1MSwiZXhwIjoxNzEzNTc4ODU2fQ.n6R6Ge07RrRZ2gH1SOBKKQPeK6Ycx3PRjs3y6fueLmc";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        "Authorization: Bearer $api_key",
                    );

                    $url_api_post = "https://albatross-api.myblueraven.com/api/v1/company/blueraven/contact/allieddigitalmedia";

                    $Lead_data_array = array(
                        "email" => $email,
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "phone" => $number1,
                        "zip" => $zip,
                        "state" => $state,
                        "address" => $street,
                        "city" => $city,
                        "country" => "United States",
                        "leadSourceDetail" => "AlliedDigitalMedia",
                        "leadSource" => "Paid Lead Gen",//No ====================
                        "tcpaOptIn" => $TCPAText,
                        "activeProspectUrl" => $trusted_form,
                        "tier" => "2",
                        "leadType" => $Lead_Cost_type,
                        "ipAddress" => $IPAddress,
                        "market" => "market",//No ====================
                        "website" => $OriginalURL2,
                        "company" => "AlliedDigitalMedia",
                        "roofMaterial" => "",//No ====================
                        "sunExposure" => $roof_shade,
                        "electricProvider" => $utility_provider,
                        "roofDesign" => "",//No ====================
                        "roofShade" => $roof_shade,
                        "comments" => "",
                        "homeOwner" => $property_type,
                        "vendorId" => "AlliedDigitalMedia",
                        "leadId" => $LeadId,
                        "creditScore" => "",//No ====================
                        "householdIncome" => "",//No ====================
                        "electricMonthly" => $monthly_bill,
                        "leadLevel" => "2",
                        "leadPrice" => $Lead_Cost
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 520:
                    //Core Home Security 520 (OLD)
                    //$phone_code = "1";
                    //$list_id = "3215996453";
                    //$source = "Digital Media";
                    //$user = "CHSAPI";
                    //$pass = "core2020";
                    //$function = "add_lead";
                    //$dnc_check = "Y";
                    //$Hopper_local_call_time_check = "Y";
                    //$duplicate_check = "DUPCAMP";
                    //$url_api = "https://v34.mycallcloud.com/vicidial/non_agent_api.php";
                    //$url_api .= "?dnc_check=$dnc_check&Hopper_local_call_time_check=$Hopper_local_call_time_check&duplicate_check=$duplicate_check&phone_number=$number1&phone_code=$phone_code&list_id=$list_id&source=$source&first_name=$first_name&last_name=$last_name&address1=$street&city=$city&State=$state&email=$email&user=$user&pass=$pass&function=$function";

                    //Core Home Security 520 (New)
                    $user = "ADapi";
                    $pass = "apiuser7799";
                    $function = "add_lead";
                    $phone_code = "1";
                    $list_id = "7766";
                    $url_api = "http://v34.mycallcloud.com:58888/vicidial/non_agent_api.php?source=$lead_source_text&user=$user&pass=$pass&function=$function&phone_number=$number1&phone_code=$phone_code&list_id=$list_id&first_name=$first_name&last_name=$last_name&address1=$street&city=$city&state=$statename_code&postal_code=$zip&email=$email";

                    $url_api = str_replace(" ", "+", $url_api);
                    $httpheader = array("Content-Type: application/json");

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'SUCCESS') == true) {
                        return 1;
                    }
                    break;
                case 525:
                    //intel house marketing 525
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $lead_id = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $source = $lead_source_text;
                    $phone = $number1;
                    $postalCode = $zip;
                    $address = $street;
                    $universal_lead_id = $LeadId;
                    $trusted_form_token = $trusted_form;
                    $ip = $IPAddress;
                    $best_call_time = "morning";

                    if (config('app.env', 'local') == "local") {
                        $test = 1;
                    } else {
                        $test = 0;
                    }

                    $httpheader = array(
                        "Accept: application/json",
                        'Content-Type: application/x-www-form-urlencoded',
                    );

                    $email = urlencode($email);
                    $url_api_post = "https://api.intelhousemarketing.com/api/1.0/lead/post";
                    $Lead_data_Post = "test=$test&lead_id=$lead_id&source=$source&phone=$phone&address=$address&postcode=$postalCode&first_name=$first_name&last_name=$last_name&email=$email&ip=$ip&trusted_form_token=$trusted_form_token&universal_lead_id=$universal_lead_id&best_call_time=$best_call_time&tcpa_text=$TCPAText&landing_page=$OriginalURL2";

                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $number_of_window = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "050538EA-7554-420D-BA1C-F620769EE05B";
                            } else {
                                $api_key = "624C1DFA-B431-4FF9-B758-8EC32B0FB541";
                            }

                            $project_nature_data = (($project_nature == 'Install' || $project_nature == 'Replace') ? 'replace' : 'repair');
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            $Lead_data_Post .= "&api_key=$api_key&windows=$number_of_window&nature=$project_nature_data&homeowner=$homeowner";
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "2F64E5FB-07BD-42C5-A41E-90636D2146D1";
                            } else {
                                $api_key = "6F1133FE-0832-419D-95F5-4C4CB6FE83EC";
                            }

                            $credit = "good";
                            $project_type = "new_home";
                            $homeowner = ($property_type == "Owned" ? "yes" : "no");

                            switch ($monthly_electric_bill) {
                                case '$0 - $50' || '$51 - $100':
                                    $monthly_electric_bill_data = 'less_than_100';
                                    break;
                                case '$101 - $150':
                                    $monthly_electric_bill_data = '100-149';
                                    break;
                                case '$151 - $200':
                                    $monthly_electric_bill_data = '150-199';
                                    break;
                                case '$201 - $300':
                                    $monthly_electric_bill_data = '250-299';
                                    break;
                                default:
                                    $monthly_electric_bill_data = 'more_than_350';
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "no_shade";
                                    break;
                                case "Mostly Shaded" || "Partial Sun":
                                    $roof_shade_data = "partially_shaded";
                                    break;
                                default:
                                    $roof_shade_data = "uncertain";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$project_type&electric_bill=$monthly_electric_bill_data&utility_provider=$utility_provider&shade=$roof_shade_data&credit=$credit&homeowner=$homeowner";
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "3B390BAC-369C-4245-A238-2DA28F818791";
                            } else {
                                $api_key = "20459B69-E798-42D5-9ADA-13FE5C259D3C";
                            }

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $flooring_type = "vinyl";
                                    break;
                                case "Tile Flooring":
                                    $flooring_type = "tile";
                                    break;
                                case "Hardwood Flooring":
                                    $flooring_type = "wooden";
                                    break;
                                case "Laminate Flooring":
                                    $flooring_type = "laminate";
                                    break;
                                default:
                                    $flooring_type = "other";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            switch ($project_nature) {
                                case "Repair Existing Flooring":
                                    $project_type_data = "repair";
                                    break;
                                case "Refinish Existing Flooring":
                                    $project_type_data = "replace";
                                    break;
                                default:
                                    $project_type_data = "install";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$project_type_data&flooring_type=$flooring_type&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 5:
                            //walk In Tubs
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "7C26FB59-C49D-47C1-8433-587B0288EC8A";
                            } else {
                                $api_key = "D32ED261-CCF2-4FD4-BB2D-F0A58D6AB755";
                            }

                            $bathroom_type_name_data = "walk_in_tub";
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$bathroom_type_name_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "1AADE3A3-3BAD-4B8E-95DE-E1D980C801E4";
                            } else {
                                $api_key = "2CEA0824-8331-42B3-B3B1-6076DB290855";
                            }

                            $homeowner = "yes";

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roofing_type_data = 'asphalt_shingle';
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofing_type_data = 'cedar_shake';
                                    break;
                                case "Metal Roofing":
                                    $roofing_type_data = 'metal';
                                    break;
                                case "Natural Slate Roofing":
                                    $roofing_type_data = 'natural_state';
                                    break;
                                case "Tile Roofing":
                                    $roofing_type_data = 'tile';
                                    break;
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            switch ($project_nature) {
                                case "Install roof on new construction":
                                    $project_nature_data = "new_home";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "existing_home";
                                    break;
                                default:
                                    $project_nature_data = "repair";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$project_nature_data&roofing_type=$roofing_type_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "6B76998C-C8AE-4FF5-9BDF-688EACFA2090";
                            } else {
                                $api_key = "115C8378-9804-4376-8829-E0BA7157041E";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            switch ($project_nature) {
                                case "Repair section(s) of siding":
                                    $project_type_data = "repair";
                                    break;
                                case "Replace existing siding":
                                    $project_type_data = "replace";
                                    break;
                                default:
                                    $project_type_data = "install";
                            }

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $sliding_type_data = "vinyl";
                                    break;
                                case "Composite wood Siding":
                                    $sliding_type_data = "wood";
                                    break;
                                case "Brickface Siding":
                                case "Stoneface Siding":
                                    $sliding_type_data = "brick_or_stone";
                                    break;
                                case "Aluminium Siding":
                                default:
                                    $sliding_type_data = "aluminum";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$project_type_data&siding_type=$sliding_type_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "4752D035-F888-47F2-8C2F-C7FF2D0C1908";
                            } else {
                                $api_key = "347EDD8E-D1A7-40B5-BDE0-B6846BCD1BF6";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($service_kitchen) {
                                case 'Full Kitchen Remodeling':
                                    $service_kitchen_data = "full_kitchen";
                                    break;
                                case 'Cabinet Refacing':
                                    $service_kitchen_data = "cabinets_repair";
                                    break;
                                case 'Cabinet Install':
                                    $service_kitchen_data = "cabinets_install";
                                    break;
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$service_kitchen_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "7C26FB59-C49D-47C1-8433-587B0288EC8A";
                            } else {
                                $api_key = "D32ED261-CCF2-4FD4-BB2D-F0A58D6AB755";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($bathroom_type_name) {
                                case "Full Remodel":
                                    $bathroom_type_name_data = "full_remodel";
                                    break;
                                case "Cabinets / Vanity":
                                    $bathroom_type_name_data = "cabinets_vanity";
                                    break;
                                case "Countertops":
                                    $bathroom_type_name_data = "countertops";
                                    break;
                                case "Flooring":
                                    $bathroom_type_name_data = "flooring";
                                    break;
                                case "Shower / Bath":
                                    $bathroom_type_name_data = "shower_bath";
                                    break;
                                case "Sinks":
                                    $bathroom_type_name_data = "sinks";
                                    break;
                                case "Toilet":
                                    $bathroom_type_name_data = "toilet";
                                    break;
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$bathroom_type_name_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 11:
                            //Furnace
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "059E2DD7-175B-43C1-8A44-0DBF40726527";
                            } else {
                                $api_key = "9CDD24A7-1D8A-48AF-A0EB-8254CB70C1A7";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $project_nature_data = ($project_nature != 'Repair' ? "install" : "repair");
                            $air_type = 'heating';

                            switch ($type_of_heating) {
                                case "Oil":
                                    $system_type = "oil_furnace";
                                    break;
                                case "Electric":
                                    $system_type = "electric_furnace";
                                    break;
                                case "Propane Gas":
                                    $system_type = "propane_furnace";
                                    break;
                                default:
                                    $system_type = "gas_furnace";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&system_type=$system_type&purchase_time=$start_time_data&homeowner=$homeowner&air_type=$air_type&project_type=$project_nature_data";
                            break;
                        case 12:
                            //Boiler
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "059E2DD7-175B-43C1-8A44-0DBF40726527";
                            } else {
                                $api_key = "9CDD24A7-1D8A-48AF-A0EB-8254CB70C1A7";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $project_nature_data = ($project_nature != 'Repair' ? "install" : "repair");
                            $air_type = 'heating';

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            switch ($type_of_heating) {
                                case "Oil":
                                    $system_type = "oil_boiler";
                                    break;
                                case "Electric":
                                    $system_type = "electric_boiler";
                                    break;
                                case "Propane Gas":
                                    $system_type = "propane_boiler";
                                    break;
                                default:
                                    $system_type = "gas_boiler";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&system_type=$system_type&purchase_time=$start_time_data&homeowner=$homeowner&air_type=$air_type&project_type=$project_nature_data";
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "059E2DD7-175B-43C1-8A44-0DBF40726527";
                            } else {
                                $api_key = "9CDD24A7-1D8A-48AF-A0EB-8254CB70C1A7";
                            }

                            $project_nature_data = ($project_nature != 'Repair' ? "install" : "repair");
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");
                            $air_type = 'cooling';
                            $system_type = "central_ac";

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&system_type=$system_type&purchase_time=$start_time_data&homeowner=$homeowner&air_type=$air_type&project_type=$project_nature_data";
                            break;
                        case 15:
                            //Plumbing
                            $services = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "677E19EB-ABD1-45FA-8F19-22E7C3C4CC55";
                            } else {
                                $api_key = "428AB702-CAA9-4904-B1B1-532B120A3012";
                            }

                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            switch ($services) {
                                case "Faucet/ Fixture Services":
                                    $project_type = "faucets_fixtures_pipes";
                                    break;
                                case "Pipe Services":
                                    $project_type = "gas_pipes";
                                    break;
                                case "Leak Repair":
                                    $project_type = "leak_detection_and_repair";
                                    break;
                                case "Remodeling/ Construction":
                                    $project_type = "remodeling_and_construction";
                                    break;
                                case "Drain/ Sewer Services":
                                    $project_type = "sewer_and_drain";
                                    break;
                                case "Shower Services":
                                    $project_type = "showers";
                                    break;
                                case "Sump Pump Services":
                                    $project_type = "sump_pump";
                                    break;
                                case "Toilet Services":
                                    $project_type = "toilet";
                                    break;
                                case "Water Heater Services":
                                    $project_type = "solar_water_heater_system";
                                    break;
                                case "Water/ Fuel Tank":
                                    $project_type = "water_or_fuel_tank";
                                    break;
                                case "Water Treatment and Purification":
                                    $project_type = "Water Treatment and Purification";
                                    break;
                                case "Well Pump Services":
                                    $project_type = "well_pump";
                                    break;
                                case "Basement Plumbing":
                                    $project_type = "basement_drainage_channel";
                                    break;
                                default:
                                    $project_type = "other";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$project_type&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                        case 16:
                            //Bathtubs
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $api_key = "7C26FB59-C49D-47C1-8433-587B0288EC8A";
                            } else {
                                $api_key = "D32ED261-CCF2-4FD4-BB2D-F0A58D6AB755";
                            }

                            $bathroom_type_name_data = "bathtub_liner";
                            $homeowner = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_Post .= "&api_key=$api_key&project_type=$bathroom_type_name_data&purchase_time=$start_time_data&homeowner=$homeowner";
                            break;
                    }

                    $Lead_data_Post = str_replace("+", "%2B", $Lead_data_Post);

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2['status'])) {
                            if ($result2['status'] == "success" || $result2['message'] == "Lead accepted") {
                                return 1;
                            }
                        }
                    }
                    break;
                case 152:
                    //Porch 152
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    switch ($crm_details['service_id']) {
                        case 2:
                        case 3:
                            //Solar
                            //Home Security
                            $property_type = trim($crm_details['data']['property_type']);
                            switch ($property_type) {
                                case "Owned":
                                    $isHomeowner = true;
                                    $isCommercial = false;
                                    break;
                                case "Rented":
                                    $isHomeowner = false;
                                    $isCommercial = false;
                                    break;
                                default:
                                    $isHomeowner = false;
                                    $isCommercial = true;
                            }
                            break;
                        case 6:
                            //Roofing
                            $property_type = trim($crm_details['data']['property_type']);
                            if ($property_type == "Residential") {
                                $isHomeowner = true;
                                $isCommercial = false;
                            } else {
                                $isHomeowner = false;
                                $isCommercial = true;
                            }
                            break;
                        default:
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $isHomeowner = ($ownership == "Yes" ? true : false);
                            $isCommercial = false;
                    }

                    if (config('app.env', 'local') == "local") {
                        $url_api_post = "https://api.qa.porch.com/v2/lead/callback/";
                        $api_key = "bfc98f16-e310-40dc-908a-60b68805292f";
                    } else {
                        $url_api_post = "https://api.porch.com/v2/lead/callback/";
                        $api_key = "2d72abb8-0485-41c1-8377-d7545c106725";
                    }

                    $Lead_data_array = array(
                        "referenceId" => $TransactionId,
                        "status" => "ACCEPTED",
                        "customerPhone" => $number1,
                        "customerEmail" => $email,
                        "postalCode" => $zip,
                        "address" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "leadId" => $leadsCustomerCampaign_id,
                        "isMobileTCPA" => true,
                        "TCPALanguage" => $TCPAText,
                        "TCPACertificationURL" => $trusted_form,
                        "homeownerIPAddress" => $IPAddress,
                        "isHomeowner" => $isHomeowner,
                        "isCommercial" => $isCommercial,
                        "externalSourceId" => $google_ts,
                        "timeFrame" => "flexible",
                        "isExclusive" => true
                    );

                    $httpheader = array(
                        "Authorization: PORCH_API_KEY:$api_key",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['success'])) {
                        if ($result2['success'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 536:
                    //Billy.com	536
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $property_type_data = "UNKNOWN";
                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "786B3695F3124658AD4942AE00219CCC";
                                $apiPassword = "e79441b5";
                            } else {
                                $apiId = "C0CCC335BBDE487DAAAA5CC8032BF57F";
                                $apiPassword = "a36acfff";
                            }

                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            if ($project_nature == "Repair") {
                                $taskId = "WINDOW_REPAIR";
                            } else {
                                $taskId = ($number_of_windows == 1 ? "WINDOW_INSTALL_SINGLE" : "WINDOWS_INSTALL_MULTIPLE");
                            }

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 268,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "7ABB4685506F4B3CAE8B2918DCBC0E46";
                                $apiPassword = "87148dc";
                            } else {
                                $apiId = "04254994567442619742D23549CCFDBB";
                                $apiPassword = "dd4562d6";
                            }

                            switch ($monthly_electric_bill) {
                                case '$0 - $50' || '$51 - $100':
                                    $average_bill = 'Below100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = 'Above100Below150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = 'Above150Below200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = 'Above250Below300';
                                    break;
                                default:
                                    $average_bill = 'Above350';
                            }

                            switch ($property_type) {
                                case "Business":
                                    $homeowner = "Unknown";
                                    $property_type_data = "Business";
                                    break;
                                case "Rented":
                                    $homeowner = "Rent";
                                    break;
                                default:
                                    $homeowner = "Own";
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "Full";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Shaded";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial";
                                    break;
                                default:
                                    $roof_shade_data = "Unknown";
                            }

                            $taskId = "SL01";

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 265,
                                "residenceOwnership" => $homeowner,
                                "sunExposure" => $roof_shade_data,
                                "averageBill" => $average_bill,
                                "taskId" => $taskId
                            );
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "11714E54BA2E4DED8EDD6F9ED49645A7";
                                $apiPassword = "53194403";
                            } else {
                                $apiId = "B66256A0C87A4AED9E46C3D0E680E06C";
                                $apiPassword = "b7fa088";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $taskId = ($project_nature == "Repair Existing Flooring" ? "VINYL_OR_LINOLEUM_FLOORING_REPAIR" : "VINYL_OR_LINOLEUM_FLOORING_INSTALL");
                                    break;
                                case "Tile Flooring":
                                    $taskId = ($project_nature == "Repair Existing Flooring" ? "TILE_FLOORING_REPAIR" : "TILE_FLOORING_INSTALL");
                                    break;
                                case "Hardwood Flooring":
                                    $taskId = ($project_nature == "Repair Existing Flooring" ? "WOOD_FLOOR_REPAIR" : "HARDWOOD_FLOOR_INSTALL");
                                    break;
                                case "Laminate Flooring":
                                    $taskId = ($project_nature == "Repair Existing Flooring" ? "LAMINATE_FLOORING_REPAIR" : "LAMINATE_FLOORING_INSTALL");
                                    break;
                                default:
                                    $taskId = ($project_nature == "Repair Existing Flooring" ? "CARPET_REPAIR" : "CARPET_INSTALL");
                            }

                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 296,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 5:
                            //Walk-In Tubs
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "E613988B6DAD46999BC87DDCD96B598B";
                                $apiPassword = "6272f2461";
                            } else {
                                $apiId = "6A06932627054925BE702BF5F054B3FA";
                                $apiPassword = "3da6e4a6";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $taskId = "BATHROOM_REMODEL_WALK_IN_TUB_INSTALLATION_OR_CONVERSION";
                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 272,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "F32D059DDD1744CBAD1B057F07978571";
                                $apiPassword = "47c84c557";
                            } else {
                                $apiId = "11DF9345C65344219369AF3738D323F2";
                                $apiPassword = "2f8927e0";
                            }

                            $property_type_data = ($property_type == "Residential" ? "RESIDENTIAL" : "BUSINESS");
                            $roofJob = ($project_nature == "Repair existing roof" ? "ROOFREPAIR" : "ROOFINSTALL");

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $taskId = ($project_nature == "Repair existing roof" ? "ROOF_REPAIR_ASPHALT_SHINGLE" : "ROOF_INSTALL_ASPHALT_SHINGLE");
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $taskId = ($project_nature == "Repair existing roof" ? "ROOF_REPAIR_WOOD_SHAKE_COMP" : "ROOF_INSTALL_WOOD_SHAKE_COMP");
                                    break;
                                case "Metal Roofing":
                                    $taskId = ($project_nature == "Repair existing roof" ? "ROOF_REPAIR_METAL" : "ROOF_INSTALL_METAL");
                                    break;
                                case "Natural Slate Roofing":
                                    $taskId = ($project_nature == "Repair existing roof" ? "ROOF_REPAIR_NATURAL_SLATE" : "ROOF_INSTALL_NATURAL_SLATE");
                                    break;
                                default:
                                    $taskId = ($project_nature == "Repair existing roof" ? "ROOF_REPAIR_TILE" : "ROOF_INSTALL_TILE");
                            }

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 267,
                                "residenceOwnership" => "UNKNOWN",
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "roofJob" => $roofJob,
                                "taskId" => $taskId
                            );
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "A3FB0923EFA542308D4D0D7B3A5AC690";
                                $apiPassword = "77f31a512d";
                            } else {
                                $apiId = "03F057B0009843DE97C51321A3F7ABDE";
                                $apiPassword = "0f0849c6";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $taskId = ($project_nature == "Repair section(s) of siding" ? "VINYL_REPAIR" : "VINYL_INSTALL");
                                    break;
                                case "Brickface Siding":
                                case "Stoneface Siding":
                                    $taskId = ($project_nature == "Repair section(s) of siding" ? "BRICK_OR_STONE_REPAIR" : "BRICK_OR_STONE_INSTALL");
                                    break;
                                case "Composite wood Siding":
                                    $taskId = ($project_nature == "Repair section(s) of siding" ? "WOOD_REPAIR" : "WOOD_INSTALL");
                                    break;
                                default:
                                    $taskId = ($project_nature == "Repair section(s) of siding" ? "OTHER_REPAIR" : "OTHER_INSTALL");
                            }

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 270,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 8:
                            //Kitchen
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "E613988B6DAD46999BC87DDCD96B598B";
                                $apiPassword = "6272f2461";
                            } else {
                                $apiId = "6A06932627054925BE702BF5F054B3FA";
                                $apiPassword = "3da6e4a6";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $taskId = "KITCHEN_REMODEL_FULL_REMODEL";
                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 272,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 9:
                            //Bathroom
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $bathroom_type = trim($crm_details['data']['services']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "E613988B6DAD46999BC87DDCD96B598B";
                                $apiPassword = "6272f2461";
                            } else {
                                $apiId = "6A06932627054925BE702BF5F054B3FA";
                                $apiPassword = "3da6e4a6";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            switch ($bathroom_type) {
                                case "Full Remodel":
                                    $taskId = "BATHROOM_REMODEL_COMPLETE_REMODEL";
                                    break;
                                case "Shower / Bath":
                                    $taskId = "BATHROOM_REMODEL_SHOWER_INSTALL_OR_UPGRADE";
                                    break;
                                default:
                                    $taskId = "BATHROOM_REMODEL_VANITY_FIXTURES_SINKS_TOILETS_OTHER";
                            }

                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 272,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 11:
                            //Furnace
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "DDCADDE8EA3243A0AE74773FEDF22E38";
                                $apiPassword = "780653716";
                            } else {
                                $apiId = "3328BA95151844CD8C5C7392AA7C1631";
                                $apiPassword = "b403f7e7";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $taskId = ($project_nature == "Repair" ? "FURNACE_HEATING_SYSTEM_REPAIR" : "FURNACE_HEATING_SYSTEM_INSTALL");
                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 295,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 12:
                            //Boiler
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "DDCADDE8EA3243A0AE74773FEDF22E38";
                                $apiPassword = "780653716";
                            } else {
                                $apiId = "3328BA95151844CD8C5C7392AA7C1631";
                                $apiPassword = "b403f7e7";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $taskId = ($project_nature == "Repair" ? "BOILER_REPAIR" : "BOILER_INSTALL");
                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 295,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "DDCADDE8EA3243A0AE74773FEDF22E38";
                                $apiPassword = "780653716";
                            } else {
                                $apiId = "3328BA95151844CD8C5C7392AA7C1631";
                                $apiPassword = "b403f7e7";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            $taskId = ($project_nature == "Repair" ? "CENTRAL_AC_REPAIR" : "CENTRAL_AC_INSTALL");
                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 295,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                        case 21:
                            //Gutter
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $service = trim($crm_details['data']['service']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            if (str_contains($campaign_name, 'Affiliate')) {
                                $apiId = "30C0192829814AF5A457400DE0BBC199";
                                $apiPassword = "ad3afb64";
                            } else {
                                $apiId = "BE4E358AC8F540E7AEFA9CCC7F99F5A1";
                                $apiPassword = "3aa5b7a9";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "IMMEDIATELY";
                                    break;
                                case 'Within 6 months':
                                default:
                                    $timeframe = "1-3_MONTHS";
                            }

                            switch ($service) {
                                case "Galvanized Steel":
                                    $taskId = ($project_nature == "Repair" ? "GALVANIZED_GUTTERS_REPAIR" : "GALVANIZED_GUTTERS_INSTALL");
                                    break;
                                case "PVC":
                                    $taskId = ($project_nature == "Repair" ? "PVC_GUTTERS_REPAIR" : "PVC_GUTTERS_INSTALL");
                                    break;
                                case "Wood":
                                    $taskId = ($project_nature == "Repair" ? "WOOD_GUTTERS_REPAIR" : "WOOD_GUTTERS_INSTALL");
                                    break;
                                case "Seamless Aluminum":
                                default:
                                    $taskId = ($project_nature == "Repair" ? "SEAMLESS_METAL_GUTTERS_REPAIR" : "SEAMLESS_METAL_GUTTERS_INSTALL");
                            }

                            $homeowner = ($ownership == "Yes" ? "OWN" : "RENT");

                            $Lead_data_array_service = array(
                                "apiId" => $apiId,
                                "apiPassword" => $apiPassword,
                                "productId" => 271,
                                "residenceOwnership" => $homeowner,
                                "bestTimeToCall" => "ANYTIME",
                                "timeframe" => $timeframe,
                                "taskId" => $taskId
                            );
                            break;
                    }

                    $Lead_data_array_general = array(
                        "state" => $statename_code,
                        "zip" => $zip,
                        "tcpa" => $tcpa_compliant2,
                        "landingPage" => $OriginalURL2,
                        "city" => $city,
                        "ipAddress" => $IPAddress,
                        "tcpaText" => $TCPAText,
                        "jornayaLeadId" => $LeadId,
                        "trustedFormURL" => $trusted_form,
                        "userAgent" => $UserAgent,
                        "source" => $google_ts,
                        "propertyType" => $property_type_data,

                        "promise" => $TransactionId,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "phone" => $number1,
                        "address" => $street,
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "description" => config('app.name', '')
                    );

                    $Lead_data_array = array_merge($Lead_data_array_general, $Lead_data_array_service);

//                    if (config('app.env', 'local') == "local") {
//                        //Test Mode
//                        $Lead_data_array['testMode'] = "1";
//                    }

                    $url_api = "https://leads.billy-partners.com/post/";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == 1) {
                            return 1;
                        }
                    }
                    break;
                case 501:
                    //Frontpoint 501
                    $url_api = "https://leads.frontpointsecurity.com/api/v1/partners/adb7fbc5-93de-4329-bc3e-00456b5f73ae/leads";

                    $httpheader = array(
                        'Content-Type: application/json',
                        "Accept: application/json"
                    );

                    $isResidential = true;
                    if (!empty($crm_details['data']['property_type'])) {
                        $property_type = trim($crm_details['data']['property_type']);

                        if ($property_type == "Business") {
                            $isResidential = false;
                        }
                    }

                    $Lead_data_array = array(
                        "contact" => array(
                            "companyName" => "Allied Digital Media",
                            "isResidential" => $isResidential,
                            "firstName" => $first_name,
                            "lastName" => $last_name,
                            "email" => $email,
                            "phone" => array(
                                "number" => $number1,
                                "type" => "Mobile",
                            ),
                            "address" => array(
                                "line1" => $street,
                                "city" => $city,
                                "state" => $statename_code,
                                "country" => "US",
                                "postalCode" => $zip,
                            ),
                            "compliance" => array(
                                "tcpaPermissionGranted" => true,
                                "tcpaPermissionLink" => $trusted_form,
                            )
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);

                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2['acceptedDateUtc'])) {
                            return 1;
                        }
                    }
                    break;
                case 526:
                    //Solar Energy World 526
//                    $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
//                    $utility_provider = $crm_details['data']['utility_provider'];
//
//                    $Company = "$first_name $last_name";
//                    $lead_source_data = "Pay-Per-Lead";
//                    $LEADCF7 = "Allied Digital Media";
//                    $xnQsjsdp = "41f747380f010a458a444b089732df9a0c574356888ea8dd8864ede9202aaf2a";
//                    $xmIwtLD = "3bf9380084653126c6ecd6e234c8746d8ec94eb0d65151f53a7eb33186cfee16";
//                    $returnURL = "https%26%23x3a;%26%23x2f;%26%23x2f;www.solarenergyworld.com";
//                    $actionType = "TGVhZHM=";
//
//                    $url_api = "https://crm.zoho.com/crm/WebToLeadForm?First Name=$first_name&Last Name=$last_name&Street=$street&City=$city&State=$statename_code&Zip Code=$zip&Email=$email&Phone=$number1&LEADCF8=$monthly_electric_bill&LEADCF9=$utility_provider&LEADCF10=$leadsCustomerCampaign_id&Lead Source=$lead_source_data&LEADCF7=$LEADCF7&Company=$Company&LEADCF13=$Lead_Cost_type&xnQsjsdp=$xnQsjsdp&zc_gad&xmIwtLD=$xmIwtLD&actionType=$actionType&returnURL=$returnURL&WebToLeads4433847000011642145";
//
//                    $Lead_data_array = "";
//                    $httpheader = array(
//                        "cache-control: no-cache"
//                    );
//
//                    $url_api = str_replace(" ", "%20", $url_api);
//
//                    $result =  $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "GET", 1, $crm_details['campaign_id']);
//                    return 1;

                    $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                    $utility_provider = $crm_details['data']['utility_provider'];
                    $campaignNameSolarWorld = "Allied Digital Media";

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $MonthlyPowerBill = "50";
                            break;
                        case '$51 - $100':
                            $MonthlyPowerBill = "100";
                            break;
                        case '$101 - $150':
                            $MonthlyPowerBill = "150";
                            break;
                        case '$151 - $200':
                            $MonthlyPowerBill = "200";
                            break;
                        case '$201 - $300':
                            $MonthlyPowerBill = "300";
                            break;
                        case '$301 - $400':
                            $MonthlyPowerBill = "400";
                            break;
                        case '$401 - $500':
                            $MonthlyPowerBill = "500";
                            break;
                        default:
                            $MonthlyPowerBill = "600";
                    }

                    switch ($Lead_Cost_type) {
                        case 'Shared':
                            $Lead_Cost_type_data = "Non-Exclusive";
                            break;
                        default:
                            $Lead_Cost_type_data = "Exclusive";
                    }

                    $url_api = "https://prod-92.eastus.logic.azure.com:443/workflows/fc7ed960dffe40a4a67624c4f8d7d638/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=bp9Lo67rUmnSH5ms2ZYcTvTwPuK8qFoboCk6vKMtr68";
                    if (config('app.env', 'local') == "local") {
                        $url_api = "https://prod-01.northcentralus.logic.azure.com:443/workflows/e276100cdcdf4576b4ba4095bd04d220/triggers/manual/paths/invoke?api-version=2016-10-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=UFvxo9bSfVzpQL3cZEpdOA6sXWIhy8wtFvw12dJ3z5I";
                    }

                    $Lead_data_array = array(
                        "body" => array(
                            "firstname" => $first_name,
                            "lastname" => $last_name,
                            "address1_line1" => $street,
                            "address1_city" => $city,
                            "address1_state" => $statename_code,
                            "address1_postalcode" => $zip,
                            "mobilephone" => $number1,
                            "emailaddress1" => $email,
                            "dc_highestutilitybill" => $MonthlyPowerBill,
                            "dc_utilitycompanyid" => $utility_provider,
                            "campaignname" => $campaignNameSolarWorld,
                            "VendorLeadGUID" => $leadsCustomerCampaign_id,
                            "LeadCost" => $Lead_Cost,
                            "LeadType" => $Lead_Cost_type_data
                        )
                    );

                    $Lead_data_post = json_encode($Lead_data_array);
                    $content_lengthe = strlen($Lead_data_post);

                    $httpheader = array(
                        "Content-Type: application/json; charset=utf-8",
                        "Content-Length: $content_lengthe",
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . strtolower($result), 'accepted') == true) {
                        return 1;
                    }
                    break;
                case 583:
                    //Adventum LLC 583
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $bid_id = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $url_api = "https://api.adventum.co/post/";

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $test = "1";
                    } else {
                        //Live Mode
                        $test = "0";
                    }

                    $type = "json";
                    $api_key = "38CB63DC-DCF1-0BA9-346D-5E1EAC08D971";
                    $affiliate_id = "788308";

                    $Lead_data1 = array(
                        "type" => $type,
                        "test" => $test,
                        "api_key" => $api_key,
                        "bid_id" => $bid_id,
                        "affiliate_id" => $affiliate_id,
                        "sourceurl" => $OriginalURL2,
                        "campaign_id" => $lead_source_text,
                        "sub_id" => $google_ts,
                        "request" => array(
                            "trustedform" => $trusted_form,
                            "leadid" => $LeadId,
                            "date" => trim(date('Y-m-d H:i:s')),
                            "ip" => $IPAddress,
                            "useragent" => $UserAgent,
                            "zip" => $zip,
                            "firstname" => $first_name,
                            "lastname" => $last_name,
                            "address" => $street,
                            "email" => $email,
                            "phone" => $number1
                        ),
                    );

                    switch ($crm_details['service_id']) {
                        case 1:
                            //Windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $quantity = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $besttimecall = "any time";
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $timeframe = "3-6 months";
                                    break;
                                default:
                                    $timeframe = "not sure";
                            }

                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "new";
                                    break;
                                case "Replace":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            $Lead_data2 = array(
                                "quote_type" => "windows",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "quantity" => $quantity,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => $besttimecall,
                                    "homeowner" => $homeowner,
                                ),
                            );
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $project_type_new = "new";

                            switch ($property_type) {
                                case "Owned":
                                    $homeowner = "yes";
                                    $property_type_data = "residential";
                                    break;
                                case "Business":
                                    $homeowner = "no";
                                    $property_type_data = "commercial";
                                    break;
                                default:
                                    $homeowner = "no";
                                    $property_type_data = "residential";
                            }

                            switch ($power_solution) {
                                case "Solar Water Heating for my Home":
                                    $power_solution_data = "hotwater";
                                    break;
                                case "Solar Electricity & Water Heating for my Home":
                                    $power_solution_data = "both";
                                    break;
                                default:
                                    $power_solution_data = "electricity";
                            }

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $electricity_bill = "0-49";
                                    break;
                                case '$51 - $100':
                                    $electricity_bill = "50-99";
                                    break;
                                case '$101 - $150':
                                    $electricity_bill = "100-149";
                                    break;
                                case '$151 - $200':
                                    $electricity_bill = "150-199";
                                    break;
                                case '$201 - $300':
                                    $electricity_bill = "250-299";
                                    break;
                                case '$301 - $400':
                                    $electricity_bill = "350-399";
                                    break;
                                default:
                                    $electricity_bill = "400+";
                            }

                            $Lead_data2 = array(
                                "quote_type" => "solar",
                                "attributes" => array(
                                    "project_type" => $project_type_new,
                                    "roof_shade" => strtolower($roof_shade),
                                    "solar_system_type" => $power_solution_data,
                                    "install_location" => "roof",
                                    "current_provider" => $utility_provider,
                                    "electricity_bill" => $electricity_bill,
                                    "timeframe" => "not sure",
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner,
                                    "property_type" => $property_type_data
                                ),
                            );
                            break;
                        case 3:
                            //Home Security
                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');

                            switch ($property_type) {
                                case "Owned":
                                    $homeowner = "yes";
                                    $property_type_data = "residential";
                                    break;
                                case "Business":
                                    $homeowner = "no";
                                    $property_type_data = "commercial";
                                    break;
                                default:
                                    $homeowner = "no";
                                    $property_type_data = "residential";
                            }

                            $Lead_data2 = array(
                                "quote_type" => "homesecurity",
                                "attributes" => array(
                                    "project_type" => "new",
                                    "security_type" => "burglar and fire detection",
                                    "building_type" => "house",
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner,
                                    "property_type" => $property_type_data
                                ),
                            );
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($project_nature) {
                                case "Install New Flooring":
                                    $project_type = "new";
                                    break;
                                case "Refinish Existing Flooring":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $flooring_type = "vinyl";
                                    break;
                                case "Tile Flooring":
                                    $flooring_type = "tile";
                                    break;
                                case "Hardwood Flooring":
                                    $flooring_type = "hardwood";
                                    break;
                                case "Carpet":
                                    $flooring_type = "carpet";
                                    break;
                                default:
                                    $flooring_type = "other";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "flooring",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "flooring_type" => $flooring_type,
                                    "room_type" => "other",
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 5:
                            //WALK-IN TUBS
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $reason = trim($crm_details['data']['reason']);
                            $features = trim($crm_details['data']['features']);

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            switch ($reason) {
                                case "Safety":
                                    $reasonData = "safety";
                                    break;
                                case "Therapeutic":
                                    $reasonData = "therapeutic";
                                    break;
                                default:
                                    $reasonData = "other";
                            }

                            $Lead_data2 = array(
                                "quote_type" => "walkintubs",
                                "attributes" => array(
                                    "project_type" => "new",
                                    "install_reason" => $reasonData,
                                    "bath_type" => "other",
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $start_time = trim($crm_details['data']['start_time']);

                            switch ($project_nature) {
                                case "Install roof on new construction":
                                    $project_nature_text = "new";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_text = "replace";
                                    break;
                                default:
                                    $project_nature_text = "repair";
                            }

                            switch ($roof_type) {
                                case "Wood Shake/Composite Roofing":
                                    $roof_type_text = "cedar";
                                    break;
                                case "Metal Roofing":
                                    $roof_type_text = "metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_text = "natural";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_text = "tile";
                                    break;
                                default:
                                    $roof_type_text = "asphalt";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $timeframe = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $timeframe = "3-6 months";
                                    break;
                                default:
                                    $timeframe = "not sure";
                            }

                            $Lead_data2 = array(
                                "quote_type" => "roofing",
                                "attributes" => array(
                                    "project_type" => $project_nature_text,
                                    "roof_material" => $roof_type_text,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => "yes",
                                    "property_type" => strtolower($property_type)
                                ),
                            );
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($project_nature) {
                                case "Repair section(s) of siding":
                                    $project_type = "repair";
                                    break;
                                case "Replace existing siding":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "new";
                            }

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $sliding_type = "vinyl";
                                    break;
                                case "Composite wood Siding":
                                    $sliding_type = "wood";
                                    break;
                                case "Stoneface Siding":
                                    $sliding_type = "stone";
                                    break;
                                case "Fiber Cement Siding":
                                    $sliding_type = "cement";
                                    break;
                                default:
                                    $sliding_type = "other";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "siding",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "siding_type" => $sliding_type,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($service_kitchen) {
                                case 'Cabinet Refacing':
                                    $remodel_type = "cabinets";
                                    $project_type = "replace";
                                    break;
                                case 'Cabinet Install':
                                    $remodel_type = "cabinets";
                                    $project_type = "new";
                                    break;
                                default:
                                    $remodel_type = "floorplan";
                                    $project_type = "new";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "kitchen",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "remodel_type" => $remodel_type,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($bathroom_type_name) {
                                case "Flooring":
                                    $remodel_type = "tile";
                                    break;
                                case "Shower / Bath" || "Sinks" || "Toilet":
                                    $remodel_type = "bath or sink";
                                    break;
                                default:
                                    $remodel_type = "full bathroom";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "bathroom",
                                "attributes" => array(
                                    "project_type" => "new",
                                    "remodel_type" => $remodel_type,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 11:
                            //Furnace
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($type_of_heating) {
                                case "Natural Gas":
                                    $type_of_heating_data = "gas furnace";
                                    break;
                                case "Oil":
                                    $type_of_heating_data = "oil furnace";
                                    break;
                                case "Propane Gas":
                                    $type_of_heating_data = "propane furnace";
                                    break;
                                default:
                                    $type_of_heating_data = "electric furnace";
                            }

                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "new";
                                    break;
                                case "Replace":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "hvac",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "air_type" => "heating",
                                    "system_type" => $type_of_heating_data,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 12:
                            //Boiler
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($type_of_heating) {
                                case "Natural Gas":
                                    $type_of_heating_data = "gas boiler";
                                    break;
                                case "Oil":
                                    $type_of_heating_data = "oil boiler";
                                    break;
                                case "Propane Gas":
                                    $type_of_heating_data = "propane boiler";
                                    break;
                                default:
                                    $type_of_heating_data = "electric boiler";
                            }

                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "new";
                                    break;
                                case "Replace":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "hvac",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "air_type" => "heating",
                                    "system_type" => $type_of_heating_data,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "new";
                                    break;
                                case "Replace":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "hvac",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "air_type" => "heating and cooling",
                                    "system_type" => "central air",
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 15:
                            //Plumbing
                            $services = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($services) {
                                case "Faucet/ Fixture Services":
                                    $plumbing_type = "faucets";
                                    break;
                                case "Pipe Services":
                                    $plumbing_type = "pipe";
                                    break;
                                case "Septic Systems":
                                    $plumbing_type = "septic";
                                    break;
                                case "Drain/ Sewer Services":
                                    $plumbing_type = "sewer";
                                    break;
                                case "Water Heater Services":
                                    $plumbing_type = "water heater";
                                    break;
                                case "Water/ Fuel Tank" || "Water Leak Services" || "Water Jetting" || "Water Damage Restoration" || "Water Treatment and Purification":
                                    $plumbing_type = "water main";
                                    break;
                                default:
                                    $plumbing_type = "other";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "plumbing",
                                "attributes" => array(
                                    "project_type" => "new",
                                    "plumbing_type" => $plumbing_type,
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                        case 20:
                            //Doors
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $door_type = trim($crm_details['data']['door_type']);
                            $number_of_door = trim($crm_details['data']['number_of_door']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "new";
                                    break;
                                case "Replace":
                                    $project_type = "replace";
                                    break;
                                default:
                                    $project_type = "repair";
                            }

                            $timeframe = ($start_time == 'Immediately' ? 'immediately' : 'not sure');
                            $homeowner = ($ownership == 'Yes' ? "yes" : "no");

                            $Lead_data2 = array(
                                "quote_type" => "doors",
                                "attributes" => array(
                                    "project_type" => $project_type,
                                    "door_material" => "other",
                                    "timeframe" => $timeframe,
                                    "besttimecall" => "any time",
                                    "homeowner" => $homeowner
                                ),
                            );
                            break;
                    }

                    $Lead_data_array = array_merge($Lead_data1, $Lead_data2);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "success") {
                            return 1;
                        }
                    }
                    return 0;
                    break;
                case 567:
                    //TBG Traffic Exchange 567
                    //Auto Insurance
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $VehicleYear = trim($crm_details['data']['VehicleYear']);
                    $VehicleMake = trim($crm_details['data']['VehicleMake']);
                    $car_model = trim($crm_details['data']['car_model']);
                    $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                    $driversNum = trim($crm_details['data']['driversNum']);
                    $birthday = trim($crm_details['data']['birthday']);
                    $genders = trim($crm_details['data']['genders']);
                    $married = trim($crm_details['data']['married']);
                    $license = trim($crm_details['data']['license']);
                    $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                    $driver_experience = trim($crm_details['data']['driver_experience']);
                    $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                    $DUI_charges = trim($crm_details['data']['DUI_charges']);
                    $SR_22_need = trim($crm_details['data']['SR_22_need']);
                    $ownership = trim($crm_details['data']['homeOwn']);

                    $url_api = "https://leads.tbgtraffic.net/post/";

                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/x-www-form-urlencoded"
                    );

                    $apiId = "AF7E1670FCB94CE6A0B47028BB366C46";
                    $apiPassword = "2a6198b";
                    $productId = "187";
                    $insurancePolicy = "YES";

                    $tcpa_compliant = strtoupper($tcpa_compliant2);
                    $ownership_data = ($ownership == "Yes" ? "OWN" : "RENT");
                    $genders_data = ($genders == "Male" ? "MALE" : "FEMALE");
                    $birthday_data = date("y-m-d", strtotime($birthday));
                    $married_data = ($married == "Yes" ? "MARRIED" : "SINGLE");
                    $SR_22_need_data = ($SR_22_need == "Yes" ? "YES" : "NO");

                    $Lead_data = "apiId=$apiId&apiPassword=$apiPassword&productId=$productId
                        &universalLeadId=$LeadId&tcpa=$tcpa_compliant&tcpaLanguage=$TCPAText&userIp=$IPAddress&userAgent=$UserAgent&webSiteUrl=$OriginalURL2
                        &zip=$zip&state=$statename_code&isRented=$ownership_data&insurancePolicy=$insurancePolicy&currentInsuranceCompany=$InsuranceCarrier
                        &driver1Gender=$genders_data&driver1Dob=$birthday_data&driver1MaritalStatus=$married_data&driver1RequiredSR22=$SR_22_need_data&vehicle1Year=$VehicleYear
                        &vehicle1Make=$VehicleMake&vehicle1Model=$car_model&promise=$TransactionId&trustedFormUrl=$trusted_form&trustedForm=$trusted_form
                        &firstName=$first_name&lastName=$last_name&email=$email&phone=$number1&address=$street&driver1FirstName=$first_name&driver1LastName=$last_name";

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $Lead_data .= "&testMode=1&testSold=1";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == 1) {
                            return 1;
                        }
                    }
                    break;
                case 589:
                case 750:
                    //Encor Solar/ Fluent Solar 589
                    //HOME SOLAR 750
                    $utility_provider = $crm_details['data']['utility_provider'];

                    //$url_api = "https://hooks.zapier.com/hooks/catch/2442113/bdjyl5c/";
                    $url_api = "https://hooks.zapier.com/hooks/catch/2442113/bkclsso/";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "Lead_ID" => $leadsCustomerCampaign_id,
                        "Source" => $lead_source_id,
                        "Campaign" => $crm_details['campaign_id'],
                        "First" => $first_name,
                        "Last" => $last_name,
                        "Email" => $email,
                        "Phone" => $number1,
                        "Street" => $street,
                        "City" => $city,
                        "State" => $statename_code,
                        "Zip" => $zip,
                        "Utility_Company" => $utility_provider
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 588:
                    //1800 remodel 588
                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api = "https://post.1800remodel.com/ping/post/test?";
                    } else {
                        $url_api = "https://post.1800remodel.com/ping/post?";
                    }

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    switch ($crm_details['service_id']) {
                        case 2:
                            // Solar
                            $property_type = trim($crm_details['data']['property_type']);
                            $ownership_data = ($property_type == "Owned" ? "Yes" : "No");
                            break;
                        case 3:
                            // Home Security
                            $property_type = trim($crm_details['data']['property_type']);
                            $ownership_data = ($property_type == "Owned" ? "Yes" : "No");
                            break;
                        case 6:
                            // Roofing
                            $property_type = trim($crm_details['data']['property_type']);
                            $ownership_data = ($property_type == "Residential" ? "Yes" : "No");
                            break;
                        default:
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $ownership_data = ($ownership == "Yes" ? "Yes" : "No");
                    }

                    $Lead_data = "";
                    $httpheader = array(
                        "Accept: application/json",
                    );

                    $TCPAText = str_replace(",", "%2C", $TCPAText);
                    $TCPAText = str_replace("&", "%26", $TCPAText);

                    $url_api .= "bid_key=$TransactionId&First_Name=$first_name&Last_Name=$last_name&Address=$street&City=$city&State=$statename_code&Phone=$number1&Email=$email&Homeowner=$ownership_data&Best_Time_To_Call=Afternoon&token_type=trusted_form_cert_id&token=$trusted_form&TCPA=$TCPAText&Sub_ID_1=$lead_source_text&Affiliate_ID=$leadsCustomerCampaign_id";
                    $url_api = str_replace(" ", "%20", $url_api);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains($result, 'ACCEPTED')) {
                        return 1;
                    }
                    break;
                case 585:
                    //Avenge Digital Lead 585
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $PingId = $data_msg['ping_post_data']['TransactionId'];
                        $CallerPhoneNumber = $data_msg['ping_post_data']['CallerPhoneNumber'];
                    } else {
                        return 0;
                    }

                    //Check if it is warm transfer
                    if ($crm_details['campaign_Type'] == 6) {
                        //Pay Per Warm Transfer
                        $api_key = "29a5d3e14104463786405a26a6d04f8e";
                        $url_api = "https://www.avengehub.com/Api/PostV1?apiKey=$api_key";

                        $Lead_data_array_ping = array();
                        if ($lead_type_service_id == 24) {
                            //Auto Insurance 24
                            $VehicleYear = trim($crm_details['data']['VehicleYear']);
                            $VehicleMake = trim($crm_details['data']['VehicleMake']);
                            $car_model = trim($crm_details['data']['car_model']);
                            $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                            $driversNum = trim($crm_details['data']['driversNum']);
                            $birthday = trim($crm_details['data']['birthday']);
                            $genders = trim($crm_details['data']['genders']);
                            $married = trim($crm_details['data']['married']);
                            $license = trim($crm_details['data']['license']);
                            $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                            $driver_experience = trim($crm_details['data']['driver_experience']);
                            $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                            $DUI_charges = trim($crm_details['data']['DUI_charges']);
                            $SR_22_need = trim($crm_details['data']['SR_22_need']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $ownership_data = ($ownership == "Yes" ? "true" : "false");
                            $more_than_one_vehicle_data = ($more_than_one_vehicle == "Yes" ? "true" : "false");

                            $Lead_data_array = '{
                            "Id": "' . $PingId . '",
                            "CallerPhoneNumber": "+1' . $CallerPhoneNumber . '",
                            "ExternalId": "23fadvarawrgs",
                            "CustomerData": {
                                "FirstName": "' . $first_name . '",
                                "LastName": "' . $last_name . '",
                                "Address": "' . $street . '",
                                "City": "' . $city . '",
                                "ZipCode": "' . $zip . '",
                                "Email": "' . $email . '",
                                "Birthdate": "' . $birthday . '",
                                "ContactPhoneNumber": "+1' . $number1 . '",
                                "CurrentInsuranceCompany": "' . $InsuranceCarrier . '",
                                "IsHomeOwner": ' . $ownership_data . ',
                                "HasMultipleVehicles" : ' . $more_than_one_vehicle_data . ',
                                "Vehicles":
                                    [
                                        {
                                            "Make": "' . $VehicleMake . '",
                                            "Model": "' . $car_model . '",
                                            "Year": ' . $VehicleYear . '
                                        }
                                    ]
                                }
                            }';
                        }

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                        $result2 = json_decode($result, true);
                        if (!empty($result2['IsAccepted'])) {
                            if ($result2['IsAccepted'] == "true") {
                                return 1;
                            }
                        }
                    } else {
                        //Pay Per Lead
                        $url_api = "https://www.avengehub-test1.fun/Api/Leads/Post";

                        $api_key = "7c44e7e252b24a9c87014d45a3ce295a";

                        $Lead_data1 = array(
                            "PingId" => $PingId,
                            "ApiKey" => $api_key,
                            "ZipCode" => $zip,
                        );

                        $Lead_data2 = array();
                        if ($lead_type_service_id == 24) {
                            //Auto Insurance 24
                            $VehicleYear = trim($crm_details['data']['VehicleYear']);
                            $VehicleMake = trim($crm_details['data']['VehicleMake']);
                            $car_model = trim($crm_details['data']['car_model']);
                            $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                            $driversNum = trim($crm_details['data']['driversNum']);
                            $birthday = trim($crm_details['data']['birthday']);
                            $genders = trim($crm_details['data']['genders']);
                            $married = trim($crm_details['data']['married']);
                            $license = trim($crm_details['data']['license']);
                            $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                            $driver_experience = trim($crm_details['data']['driver_experience']);
                            $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                            $DUI_charges = trim($crm_details['data']['DUI_charges']);
                            $SR_22_need = trim($crm_details['data']['SR_22_need']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $StatusType = ($ownership == "Yes" ? "Own" : "Rent");
                            $MaritalStatusType = ($married == "Yes" ? "Married" : "Single");
                            $Gender = ($genders == "Non-Binary" ? "Other" : $genders);
                            $LicenseStatusType = ($license == "Yes" ? "Valid" : "Expired");

                            $Lead_data2 = array(
                                "LeadCampaignId" => "3",
                                "Vertical" => "AutoInsurance",
                                "Applicant" => array(
                                    "Credit" => array(
                                        "StatusType" => "Okay"
                                    ),
                                    "CurrentResidence" => array(
                                        "StatusType" => $StatusType
                                    ),
                                    "Origin" => array(
                                        "Url" => $OriginalURL2,
                                        "IpAddress" => $IPAddress,
                                        "UserAgent" => $UserAgent,
                                        "Created" => date("Y-m-d"),
                                        "Source" => $traffic_source,
                                        "TcpaText" => $tcpa_compliant2,
                                        "TrustedFormCertificateUrl" => $trusted_form,
                                        "JornayaId" => $LeadId
                                    )
                                ),
                                "ApplicantContactInfo" => array(
                                    "FirstName" => $first_name,
                                    "LastName" => $last_name,
                                    "Address" => $street,
                                    "City" => $city,
                                    "ZipCode" => $zip,
                                    "Email" => $email,
                                    "PhoneNumbers" => array([
                                        "Type" => "Cell",
                                        "Number" => "1" . $number1
                                    ])
                                ),
                                "AutoInsurance" => array(
                                    "Vehicles" => array([
                                        "Year" => $VehicleYear,
                                        "Make" => $VehicleMake,
                                        "Model" => $car_model
                                    ]),
                                    "Drivers" => array([
                                        "Id" => $leadsCustomerCampaign_id,
                                        "FirstName" => $first_name,
                                        "LastName" => $last_name,
                                        "Gender" => $Gender,
                                        "MaritalStatusType" => $MaritalStatusType,
                                        "DateOfBirth" => $birthday,
                                        "RelationshipToApplicant" => "Self",
                                        "LicenseStatusType" => $LicenseStatusType
                                    ]),
                                    "CurrentCoverage" => array(
                                        "Company" => $InsuranceCarrier
                                    )
                                ),
                            );
                        }

                        $Lead_data_array = array_merge($Lead_data1, $Lead_data2);

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                        $result2 = json_decode($result, true);
                        if (!empty($result2['Result'])) {
                            if ($result2['Result'] == "Ok") {
                                return 1;
                            }
                        }
                    }
                    break;
                case 630:
                    //Zone 1 Remodeling 630
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $campaign_id_data = "Z1O2N31R20EM0DE22LI89NG";
                    $campaign_key = "Z1O2N31ALLR20EM0DE22LI89NGTAMOREDIMI22";

                    $url_api = "https://pro.zone1remodeling.com/api/rest/post/add_lead";

                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data = array(
                        "campaign_id" => $campaign_id_data,
                        "campaign_key" => $campaign_key,
                        "street" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zipcode" => $zip,
                        "SessionLength" => $SessionLength,
                        "ip_address" => $IPAddress,
                        "OriginalURL" => $OriginalURL2,
                        "browser_name" => $lead_browser_name,
                        "UserAgent" => $UserAgent,
                        "trusted_form" => $trusted_form,
                        "lead_id" => $LeadId,
                        "tcpa_compliant" => $tcpa_compliant,
                        "tcpa_consent_text" => $TCPAText,
                        "sub_id" => $google_ts,
                        "service" => $lead_type_service_id,
                        //POST Data
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone_number" => $number1,
                        "email" => $email,
                        "transaction_id" => $TransactionId,
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //Windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673535779";
                            } else {
                                $vendor_id = "1641809612";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['windows_number'] = $number_of_windows;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['start_time'] = $start_time;
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673595973";
                            } else {
                                $vendor_id = "1641809690";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['power_solution'] = $power_solution;
                            $Lead_data['roof_shade'] = $roof_shade;
                            $Lead_data['monthly_electric_bill'] = $monthly_electric_bill;
                            $Lead_data['property_type'] = $property_type;
                            $Lead_data['utility_provider'] = $utility_provider;
                            break;
                        case 3:
                            //Home Security
                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596050";
                            } else {
                                $vendor_id = "1641909803";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['installation_preferences'] = $Installation_Preferences;
                            $Lead_data['lead_have_item_before_it'] = $lead_have_item_before_it;
                            $Lead_data['property_type'] = $property_type;
                            $Lead_data['start_time'] = $start_time;
                            break;
                        case 4:
                            //Flooring
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596413";
                            } else {
                                $vendor_id = "1641910197";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['type_of_flooring'] = $Type_OfFlooring;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 5:
                            //WALK-IN TUBS
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $reason = trim($crm_details['data']['reason']);
                            $features = trim($crm_details['data']['features']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596492";
                            } else {
                                $vendor_id = "1641910256";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['reason'] = $reason;
                            $Lead_data['features'] = $features;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596477";
                            } else {
                                $vendor_id = "1641809744";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['roof_type'] = $roof_type;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['property_type'] = $property_type;
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596446";
                            } else {
                                $vendor_id = "1641910325";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['type_of_siding'] = $type_of_siding;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596465";
                            } else {
                                $vendor_id = "1641911234";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['kitchen_type'] = $service_kitchen;
                            $Lead_data['removing_adding_walls'] = $demolishing_walls;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 9:
                            //BathRoom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596205";
                            } else {
                                $vendor_id = "1641809816";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['bathroom_type'] = $bathroom_type_name;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 10:
                            //Stairs
                            $stairs_type = trim($crm_details['data']['stairs_type']);
                            $reason = trim($crm_details['data']['reason']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $vendor_id = "1641911372";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['stairs_type'] = $stairs_type;
                            $Lead_data['stairs_reason'] = $reason;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 11:
                            //Furnace
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596430";
                            } else {
                                $vendor_id = "1641911425";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['furnace_type'] = $type_of_heating;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 12:
                            //Boiler
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596358";
                            } else {
                                $vendor_id = "1641911489";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['boiler_type'] = $type_of_heating;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596388";
                            } else {
                                $vendor_id = "1641911533";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 14:
                            //Cabinet
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $vendor_id = "1641911577";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 15:
                            //Plumbing
                            $services = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $vendor_id = "1641911708";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['plumbing_service'] = $services;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 16:
                            //Bathtubs
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596232";
                            } else {
                                $vendor_id = "1641911769";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 17:
                            //sunrooms
                            $services = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $vendor_id = "1641911843";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['sunroom_service'] = $services;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['property_type'] = $property_type;
                            break;
                        case 18:
                            //Handyman
                            $handyman_ammount_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $vendor_id = "1641911886";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['amount_work'] = $handyman_ammount_name;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 19:
                            //Countertops
                            $countertops_service = trim($crm_details['data']['service']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596280";
                            } else {
                                $vendor_id = "1641911946";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['countertops_material'] = $countertops_service;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 20:
                            //Doors
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $door_type = trim($crm_details['data']['door_type']);
                            $number_of_door = trim($crm_details['data']['number_of_door']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $vendor_id = "1641911996";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['number_of_doors'] = $number_of_door;
                            $Lead_data['project_type'] = $door_type;
                            $Lead_data['project_nature'] = $project_nature;
                            break;
                        case 21:
                            //Gutter
                            $start_time = trim($crm_details['data']['start_time']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $service = trim($crm_details['data']['service']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $vendor_id = "1673596258";
                            } else {
                                $vendor_id = "1641912125";
                            }

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['gutter_material'] = $service;
                            $Lead_data['project_nature'] = $project_nature;
                            break;
                        case 24:
                            //Auto Insurance
                            $VehicleYear = trim($crm_details['data']['VehicleYear']);
                            $VehicleMake = trim($crm_details['data']['VehicleMake']);
                            $car_model = trim($crm_details['data']['car_model']);
                            $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                            $driversNum = trim($crm_details['data']['driversNum']);
                            $birthday = trim($crm_details['data']['birthday']);
                            $genders = trim($crm_details['data']['genders']);
                            $married = trim($crm_details['data']['married']);
                            $license = trim($crm_details['data']['license']);
                            $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                            $driver_experience = trim($crm_details['data']['driver_experience']);
                            $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                            $DUI_charges = trim($crm_details['data']['DUI_charges']);
                            $SR_22_need = trim($crm_details['data']['SR_22_need']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $vendor_id = "1641912211";

                            $Lead_data['vendor_id'] = $vendor_id;
                            $Lead_data['car_year'] = $VehicleYear;
                            $Lead_data['car_make'] = $VehicleMake;
                            $Lead_data['car_model'] = $car_model;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['birthday'] = $birthday;
                            $Lead_data['gender'] = $genders;
                            $Lead_data['marital_status'] = $married;
                            $Lead_data['license'] = $license;
                            $Lead_data['multi_vehicles'] = $more_than_one_vehicle;
                            $Lead_data['multi_drivers'] = $driversNum;
                            $Lead_data['insurance_provider'] = $InsuranceCarrier;
                            $Lead_data['driver_experience'] = $driver_experience;
                            $Lead_data['number_of_tickets'] = $number_of_tickets;
                            $Lead_data['DUI_charges'] = $DUI_charges;
                            $Lead_data['SR_22_need'] = $SR_22_need;
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $Lead_data['is_test'] = 1;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);

                    if (!empty($result2)) {
                        if (!empty($result2['response_code'])) {
                            if ($result2['response_code'] == "true") {
                                return 1;
                            }
                        }
                    }
                    break;
                case 660:
                    // ecrux 660
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }
                    $url_api = "https://leadvantage.co/api/228ee86d570c6a05bc58c6ee877b11b9fb56/";
                    $httpheader = array(
                        "Accept: application/json",
                    );
                    $start_time = (!empty($crm_details['data']['start_time']) ? trim($crm_details['data']['start_time']) : "Not Sure");
                    switch ($start_time) {
                        case "Immediately":
                            $start_time_data = "Immediately";
                            break;
                        case "Not Sure":
                            $start_time_data = "Don’t Know";
                            break;
                        default:
                            $start_time_data = "More than 2 weeks";
                    }

                    $ownership = (!empty($crm_details['data']['homeOwn']) ? trim($crm_details['data']['homeOwn']) : "");
                    $property_type_roofing = (!empty($crm_details['data']['property_type']) ? trim($crm_details['data']['property_type']) : "");

                    switch ($property_type_roofing) {
                        case "Residential":
                            $property_type_data = "Yes";
                            break;
                        default:
                            switch ($ownership) {
                                case "Yes":
                                    $property_type_data = "Yes";
                                    break;
                                case "No, But Authorized to Make Changes":
                                    $property_type_data = "Authorized";
                                    break;
                                default:
                                    $property_type_data = "No";
                            }
                    }

                    $Lead_data_array = array(
                        'email' => $email,
                        'SRC' => 'ADM',
                        'zip' => $zip,
                        'ipAddress' => $IPAddress,
                        'TCPAConsent' => $tcpa_compliant,
                        'TCPAConsentLanguage' => $TCPAText,
                        'firstname' => $first_name,
                        'lastname' => $last_name,
                        'phone' => $number1,
                        'address' => $street,
                        'city' => $street,
                        'state' => $street,
                        "timeframe" => $start_time_data,
                        "homeowner" => $property_type_data,
                        "lead_id" => $TransactionId,
                        "TrustedForm" => $trusted_form,
                    );

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $Lead_data_array['Test_Lead'] = "1";
                    }

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_natureWindows = trim($crm_details['data']['project_nature']);

                            $Lead_data_array['Home_Improvement_Product'] = "Windows";
                            $Lead_data_array['subcat'] = "Windows - Window Installation";
                            $Lead_data_array['No_Of_Windows'] = $number_of_windows;
                            $Lead_data_array['WindowMaterial'] = "NA";
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $flooring_typesubcat = "Flooring - Vinyl";
                                    break;
                                case "Hardwood Flooring":
                                    $flooring_typesubcat = "Flooring - Hardwood";
                                    break;
                                case "Carpet":
                                    $flooring_typesubcat = "Flooring - Carpet";
                                    break;
                                case "Laminate Flooring":
                                    $flooring_typesubcat = "Flooring - Laminate";
                                    break;
                                case "Tile Flooring":
                                default:
                                    $flooring_typesubcat = "Flooring - Tile";
                            }

                            $Lead_data_array['Home_Improvement_Product'] = "Flooring";
                            $Lead_data_array['subcat'] = $flooring_typesubcat;

                            break;
                        case 6:
                            //roofing
                            $project_natureRoofing = trim($crm_details['data']['project_nature']);

                            $roof_type = trim($crm_details['data']['roof_type']);
                            $roof_type_SubCat = "Composite Shingle Roof Installation";
                            switch ($project_natureRoofing) {
                                case "Repair existing roof":
                                    $roof_type_SubCat = "Roof Repair";
                                    break;
                                default:
                                    switch ($roof_type) {
                                        case "Asphalt Roofing":
                                            $roof_type_SubCat = "Asphalt Shingle Roof Installation";
                                            break;
                                        case "Metal Roofing":
                                            $roof_type_SubCat = "Metal Roof Installation";
                                            break;
                                        case "Natural Slate Roofing":
                                            $roof_type_SubCat = "Slate Roof Installation";
                                            break;
                                        case "Tile Roofing":
                                            $roof_type_SubCat = "Tile Roof Installation";
                                            break;
                                        case "Wood Shake/Composite Roofing":
                                        default:
                                            $roof_type_SubCat = "Composite Shingle Roof Installation";
                                    }
                            }
                            $Lead_data_array['Home_Improvement_Product'] = "Roofing";
                            $Lead_data_array['subcat'] = "Roofing - " . $roof_type_SubCat;
                            $Lead_data_array['JobType'] = $project_natureRoofing;
                            break;
                        case 8:
                            //kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $servicefloorPanKitchen = "No";
                            $serviceCabinetsKitchen = "No";
                            $serviceSinksKitchen = "No";
                            $serviceCounertopsKitchen = "No";
                            $servicefloorKitchen = "No";
                            $serviceLightingKitchen = "No";
                            switch ($service_kitchen) {
                                case "Full Kitchen Remodeling":
                                    $servicefloorPanKitchen = "Yes";
                                    $serviceCabinetsKitchen = "Yes";
                                    $serviceSinksKitchen = "Yes";
                                    $serviceCounertopsKitchen = "Yes";
                                    $servicefloorKitchen = "Yes";
                                    $serviceLightingKitchen = "Yes";
                                    break;
                                case "Cabinet Refacing":
                                case "Cabinet Install":
                                    $serviceCabinetsKitchen = "Yes";
                                    break;
                            }
                            $Lead_data_array['Home_Improvement_Product'] = "Remodels";
                            $Lead_data_array['subcat'] = "Remodels - Kitchen Remodel";
                            $Lead_data_array['Change_Kitchen_Floorpan'] = $servicefloorPanKitchen;
                            $Lead_data_array['Change_Kitchen_Cabinets'] = $serviceCabinetsKitchen;
                            $Lead_data_array['Move_Kitchen_Appliances'] = "NA";
                            $Lead_data_array['Change_Kitchen_Sinks'] = $serviceSinksKitchen;
                            $Lead_data_array['Change_Kitchen_Counertops'] = $serviceCounertopsKitchen;
                            $Lead_data_array['Change_Kitchen_Flooring'] = $servicefloorKitchen;
                            $Lead_data_array['Change_Kitchen_Lighting'] = $serviceLightingKitchen;
                            break;
                        case 9:
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $serviceBathroom_Floorplan = "No";
                            $serviceBathroom_Shower_Bath = "No";
                            $serviceBathroom_Toilet = "No";
                            $serviceBathroom_Cabinets = "No";
                            $serviceBathroom_Countertops = "No";
                            $serviceBathroom_Sinks = "No";
                            $serviceBathroom_Flooring = "No";
                            switch ($bathroom_type_name) {
                                case "Flooring":
                                    $serviceBathroom_Floorplan = "Yes";
                                    break;
                                case "Shower / Bath":
                                    $serviceBathroom_Shower_Bath = "Yes";
                                    break;
                                case "Sinks":
                                    $serviceBathroom_Sinks = "Yes";
                                    break;
                                case "Toilet":
                                    $serviceBathroom_Toilet = "Yes";
                                    break;
                            }
                            $Lead_data_array['Home_Improvement_Product'] = "Remodels";
                            $Lead_data_array['subcat'] = "Remodels - Bathroom Remodel";
                            $Lead_data_array['Change_Bathroom_Floorplan'] = $serviceBathroom_Floorplan;
                            $Lead_data_array['Change_Bathroom_Shower_Bath'] = $serviceBathroom_Shower_Bath;
                            $Lead_data_array['Change_Bathroom_Toilet'] = $serviceBathroom_Toilet;
                            $Lead_data_array['Change_Bathroom_Cabinets'] = $serviceBathroom_Cabinets;
                            $Lead_data_array['Change_Bathroom_Countertops'] = $serviceBathroom_Countertops;
                            $Lead_data_array['Change_Bathroom_Sinks'] = $serviceBathroom_Sinks;
                            $Lead_data_array['Change_Bathroom_Flooring'] = $serviceBathroom_Flooring;
                            break;
                    }
                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, http_build_query($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), "success")) {
                        return 1;
                    }
                    break;
                case 659:
                    //Tru Power SEO 659
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $campaign_typeC = "variable";
                    if (str_contains(strtolower($campaign_name), 'constant')) {
                        $campaign_typeC = "constant";
                    }

                    $Lead_data_array = array(
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                        "zip_code" => $zip,
                        "address" => $street,
                        "trusted_certificate" => $trusted_form,
                        "city" => $city,
                        "state" => $statename_code,
                        "landing_page_url" => $OriginalURL2,
                        "client_id" => 119,
                        "source_id" => "9",
                        "traffic_id" => (!empty($google_ts) ? $google_ts : $lead_source_text),
                        "campaign_type" => $campaign_typeC
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $quantity = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $homeowner = ($ownership == 'Yes' ? "Yes" : "No");
                            $project_type = ($project_nature == 'Repair' ? "Repair" : "Replace");

                            $Lead_data2 = array(
                                "replace_or_repair" => $project_type,
                                "ownership_type" => $homeowner,
                                "industry_type" => "Windows",
                                "home_type" => "Single Family Residence",
                                "task_id" => "257",
                            );

                            $url_api = "https://live.trupowerdata.com/api/lead/post/r2MtPA4u28Z8b7ZGoEj01454mVCiMJyYfxo3vRhe6CLtc/1/yonxgfj60d";
                            break;
                        case 2:
                            //solar
                            $request_date = trim(date('Y-m-d H:i:s'));
                            $url_api = "https://app.trupowerdata.com/ords/api/leads/adm/C841BB3093F53761E0539714000A7309";

                            $Lead_data_array = array(
                                "first_name" => $first_name,
                                "last_name" => $last_name,
                                "email" => $email,
                                "phone_number" => $number1,
                                "zip_code" => $zip,
                                "street_address" => $street,
                                "lead_created" => $request_date,
                                "trustedform_cert_url" => $trusted_form,
                                "Lp_s1" => "6",
                                "source_id" => "9",
                                "traffic_id" => (!empty($google_ts) ? $google_ts : $lead_source_text)
                            );
                            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                            //$result2 = json_decode($result, true);
                            //if (!empty($result2)) {
                            //    if (!empty($result2['result'])) {
                            //        if ($result2['result'] == "success") {
                            //            return 1;
                            //        }
                            //    }
                            //}
                            return 1;
                            break;
                        case 6:
                            //roofing
                            $project_natureRoofing = trim($crm_details['data']['project_nature']);
                            $roof_type = trim($crm_details['data']['roof_type']);

                            $ownership_data = 'Own';
                            $project_nature_text = ($project_natureRoofing == 'Repair existing roof' ? "Repair" : "Replace");

                            switch ($roof_type) {
                                case "Metal Roofing":
                                    $roof_type_SubCat = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roof_type_SubCat = "Natural Slate";
                                    break;
                                case "Tile Roofing":
                                    $roof_type_SubCat = "Tile";
                                    break;
                                case "Asphalt Roofing":
                                    $roof_type_SubCat = "Asphalt";
                                    break;
                                default:
                                    $roof_type_SubCat = "Other";
                            }

                            $url_api = "https://live.trupowerdata.com/api/lead/post/r2MtPA4u28Z8b7ZGoEj01454mVCiMJyYfxo3vRhe6CLtc/qY4ic4elS7/yonxgfj60d/fbpyqzr2aj";

                            $Lead_data2 = array(
                                "replace_or_repair" => $project_nature_text,
                                "ownership_type" => $ownership_data,
                                "industry_type" => "roofing",
                                "home_type" => "Single Family Home",
                                "tcpa_language" => $TCPAText,
                                "roof_type" => $roof_type_SubCat,
                                "client_id" => "bntdo110pe",
                                "source_id" => "24",
                            );
                            break;
                        case 9:
                            //Bathroom
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $homeowner = ($ownership == 'Yes' ? "Yes" : "No");

                            $Lead_data2 = array(
                                "replace_or_repair" => 'Replace',
                                "ownership_type" => $homeowner,
                                "industry_type" => "Baths",
                                "home_type" => "Single Family Residence",
                                "task_id" => "152",
                            );

                            $Lead_data_array['source_id'] = "6";
                            $Lead_data_array['client_id'] = "bntdo110pe";

                            $url_api = "https://live.trupowerdata.com/api/lead/post/r2MtPA4u28Z8b7ZGoEj01454mVCiMJyYfxo3vRhe6CLtc/1/yonxgfj60d/s2hixefnud";

                            $Lead_data_array = array_merge($Lead_data_array, $Lead_data2);
                            $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                            $result2 = json_decode($result, true);
                            if (!empty($result2['Lead Status'])) {
                                if ($result2['Lead Status'] == "Accepted") {
                                    return 1;
                                }
                            }
                            return 0;
                            break;
                    }

                    $Lead_data_array = array_merge($Lead_data_array, $Lead_data2);
                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'Lead created') == true
                        || strpos("-" . $result, 'Accepted') == true
                        || strpos("-" . $result, 'Success') == true) {
                        return 1;
                    }
                    break;
                case 677:
                    //Green Home Systems 677
                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded",
                        "Accept: application/xml"
                    );

                    $url_api_post = "https://secure.velocify.com/Import.aspx?Provider=GreenSolarTech_PPC-Google&Client=32113&CampaignId=225&XmlResponse=true";

                    $property_type = trim($crm_details['data']['property_type']);
                    $ownership_data = ($property_type == "Owned" ? "Yes" : "No");
                    $monthly_electric_bill = $crm_details['data']['monthly_electric_bill'];
                    $utility_provider = $crm_details['data']['utility_provider'];

                    switch ($crm_details['data']['roof_shade']) {
                        case "Full Sun":
                            $roof_shade = "No Shade";
                            break;
                        case "Mostly Shaded":
                            $roof_shade = "Full Shade";
                            break;
                        case "Partial Sun":
                            $roof_shade = "Partial Shade";
                            break;
                        default:
                            $roof_shade = "Not Sure";
                    }

                    $Lead_data_Post = "firstname=$first_name&lastname=$last_name&phonenumber=$number1&email=$email&address=$street&city=$city&state=$statename_code
                    &zip=$zip&ElectricBill=$monthly_electric_bill&roofshade=$roof_shade&homeowner=$ownership_data&utilityprovider=$utility_provider&creditprofile=Good";

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), "success")) {
                        return 1;
                    }
                    break;
                case 714:
                    // Sunlife Power 714
                    $url_api_post = "https://api.convoso.com/v1/leads/insert";
                    $httpheader = array(
                        "Accept: application/json",
                    );
                    $APIAuthtoken = "yh7aso0t1e0mxb3zn9jg18cdp6vkvi2j";
                    $APILSTID = "6579";
                    switch ($lead_type_service_id) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            switch ($monthly_electric_bill) {
                                case "$0 - $50":
                                    $electBill = "50";
                                    break;
                                case "$51 - $100":
                                    $electBill = "100";
                                    break;
                                case "$101 - $150":
                                    $electBill = "150";
                                    break;
                                case "$151 - $200":
                                    $electBill = "200";
                                    break;
                                case "$201 - $300":
                                    $electBill = "300";
                                    break;
                                case "$301 - $400":
                                    $electBill = "400";
                                    break;
                                case "$401 - $500":
                                default:
                                    $electBill = "500";
                                    break;
                            }
                            switch ($roof_shade) {
                                case "Full Sun":
                                    $shadeR = "No Shade";
                                    break;
                                case "Partial Sun":
                                case "Mostly Shaded":
                                    $shadeR = "A Lot Of Shade";
                                    break;
                                default:
                                    $shadeR = "A Little Shade";
                                    break;
                            }
                            break;
                    }

                    $Lead_data_Post = "auth_token=$APIAuthtoken&list_id=$APILSTID&email=$email&first_name=$first_name&last_name=$last_name&phone_number=$number1&address1=$street&city=$city&state=$state&postal_code=$zip&utility_provider=$utility_provider&the_source=Allied&avg_mon_elec_bill=$electBill&credit_score=650-674&shade_level=$shadeR&property_type=sfr&roof_type=shingles&bk_fc=0&solar_income=40k&ip_address=$IPAddress&jornaya_leadid_token=$LeadId&header_text=Vendor Transfer (Allied)";

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . $result, 'success') == true) {
                        return 1;
                    }
                    break;
                case 707:
                    //Four J's Media 707
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        $TransactionId = "";
                    }

                    $Key = "81d0ce2b454b46037d8c5062754dc1dac12e3cd86a01225498282bab4dc39e3e";
                    $API_Action = "iprSubmitLead";
                    $TYPE = 9;
                    $Country_Code = 1;
                    $App_ID = 888;

                    if (!empty($TransactionId)) {
                        $source = "FourJ-101";
                        $terPhone = "9413442547";
                        $Landing_Page = "landing";
                        $url_api = "https://helloprojectusa.leadportal.com/api.php?Mode=post&Lead_ID=$TransactionId";
                    } else {
                        $source = "FourJ-Fixed";
                        $terPhone = "9417596221";
                        $Landing_Page = "Phone";
                        $url_api = "https://helloprojectusa.leadportal.com/new_api/api.php?Mode=full";
                    }

                    $Contact_Name = "$first_name $last_name";
                    $Comments = "";
                    switch ($crm_details['service_campaign_name']) {
                        case "Window":
                            $Project = "Windows";
                            $Comments = "Number of windows: ";
                            if (!empty($crm_details['data']['number_of_window'])) {
                                $number_of_windows = trim($crm_details['data']['number_of_window']);
                                $Comments .= $number_of_windows;
                            } else {
                                $Comments .= "3-5";
                            }
                            break;
                        case "Kitchen":
                            $Project = "Kitchen Remodeling";
                            $Comments = "Services required? ";
                            if (!empty($crm_details['data']['services'])) {
                                $service_kitchen = trim($crm_details['data']['services']);
                                $Comments .= $service_kitchen;
                            } else {
                                $Comments .= "Full Kitchen Remodeling";
                            }
                            break;
                        case "Bathroom":
                            $Project = "Bathroom Remodeling";
                            $Comments = "Services required? ";
                            if (!empty($crm_details['data']['services'])) {
                                $bathroom_type_name = trim($crm_details['data']['services']);
                                $Comments .= $bathroom_type_name;
                            } else {
                                $Comments .= "Full Remodel";
                            }
                            break;
                        case "Furnace":
                        case "Boiler":
                        case "Central A/C":
                            $Project = "HVAC";
                            $Comments = "Type Of Heating? ";
                            if (!empty($crm_details['data']['type_of_heating'])) {
                                $type_of_heating = trim($crm_details['data']['type_of_heating']);
                                $Comments .= $type_of_heating;
                            } else {
                                $Comments .= "Do Not Know";
                            }
                            break;
                        default:
                            $Project = $crm_details['service_campaign_name'];
                    }

                    $areaCode = substr($number1, 0, 3);
                    $phonePrefix = substr($number1, 3, 3);
                    $phoneSuffix = substr($number1, 6, 4);
                    $datetime = date("Y-d-m H:i:s");

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $zip = 99999;
                    }

                    $url_api .= "&Key=$Key&API_Action=$API_Action&TYPE=$TYPE&SRC=$source&Landing_Page=$Landing_Page&Origin_Phone_Country_Code=$Country_Code&Origin_Phone_Area_Code=$areaCode&Origin_Phone_Prefix=$phonePrefix&Origin_Phone_Suffix=$phoneSuffix&Terminating_Phone_Country_Code=$Country_Code&Terminating_Phone=$terPhone&App_ID=$App_ID&Start_Date_Time=$datetime&Project=$Project&ZIP=$zip&Contact_Name=$Contact_Name&Address=$street&Comments=$Comments&State=$statename_code&Contact_City=$city";
                    $url_api = str_replace(" ", "%20", $url_api);

                    $Lead_data_post = '';
                    $httpheader = array(
                        "Accept: application/xml"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);
                    try {
                        libxml_use_internal_errors(true);
                        $result2 = simplexml_load_string($result);
                        $result3 = json_encode($result2);
                        $result4 = json_decode($result3, TRUE);

                        if (!empty($result4['status'])) {
                            if ($result4['status'] == "Success" || $result4['status'] == "Matched") {
                                return 1;
                            }
                        }
                    } catch (Exception $e) {

                    }
                    break;
                case 745:
                    //Networx 745
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        $TransactionId = "";
                    }

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            if ($project_nature == "Repair") {
                                $task_id = 266;//Window Repair - Frame & Glass
                            } else {
                                //$task_id = ($number_of_windows == 1 ? "Window Install - Single" : "Windows Install - Multiple");
                                $task_id = ($number_of_windows == 1 ? 256 : 257);
                            }
                            break;
                        case 6:
                            //roofing
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $roof_type = trim($crm_details['data']['roof_type']);

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 313;//Roof Install - Asphalt Shingle
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 325;//Roof Replace - Asphalt Shingle
                                            break;
                                        default:
                                            $task_id = 301;//Roof Repair - Asphalt Shingle
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 317;//Roof Install-Wood Shake/Comp.
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 329;//Roof Replace - Wood Shake
                                            break;
                                        default:
                                            $task_id = 305;//Roof Repair - Wood Shake/Comp.
                                    }
                                    break;
                                case "Metal Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 319;//Roof Install - Metal
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 331;//Roof Replace - Metal
                                            break;
                                        default:
                                            $task_id = 307;//Roof Repair - Metal
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 315;//Roof Install - Natural Slate
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 327;//Roof Replace - Natural Slate
                                            break;
                                        default:
                                            $task_id = 303;//Roof Repair - Natural Slate
                                    }
                                    break;
                                case "Tile Roofing":
                                default:
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 321;//Roof Install - Tile
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 333;//Roof Replace - Tile
                                            break;
                                        default:
                                            $task_id = 309;//Roof Repair - Tile
                                    }
                            }
                            break;
                        case 8:
                            //Kitchen
                            $task_id = 151;
                            break;
                        case 9:
                            //Bathroom
                            $task_id = 152;
                            break;
                        default:
                            $task_id = "";
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $task_id = "437";
                        $zip = "00001";
                    }

                    $nx_access_key = "8626e4bab6";
                    $nx_userId = "11227";
                    $url_api = "https://api.networx.com?nx_access_key=$nx_access_key&nx_userId=$nx_userId&f_name=$first_name&l_name=$last_name&zipcode=$zip&task_id=$task_id&phone=$number1&email=$email&tcpa_compliance_text=$TCPAText&cert_url=$trusted_form&token=$TransactionId&address=$street&custom_id=$leadsCustomerCampaign_id&source_id=$lead_source_text";
                    $url_api = str_replace(" ", "%20", $url_api);
                    $httpheader = array(
                        "Content-Type: application/xml",
                        "Accept: application/xml"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    try {
                        libxml_use_internal_errors(true);
                        $result2 = simplexml_load_string($result);
                        $result3 = json_encode($result2);
                        $result4 = json_decode($result3, TRUE);
                        if (!empty($result4['statusCode'])) {
                            if ($result4['statusCode'] == 200) {
                                return 1;
                            }
                        }
                    } catch (Exception $e) {

                    }
                    break;
                case 773:
                    //ContractorClicks.com 773
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $current_get_it = "57984352080985308345";
                    $seller_id = "allieddigital";
                    $vertical = "home improvement";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/x-www-form-urlencoded'
                    );

                    $url_api_post = "https://contractorclicks.com/api/incoming/post-us.php?";
                    $Lead_data_Post = "current_get_it=$current_get_it&seller_id=$seller_id&vertical=$vertical&user_ip=$IPAddress&cc_lead_id=$TransactionId&tf_token=$trusted_form&jornaya_lead_id=$LeadId&first=$first_name&last=$last_name&street=$street&city=$city&state=$statename_code&phone=$number1&email=$email";

                    switch ($lead_type_service_id) {
                        case 1:
                            //Windows
                            $service = "windows";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 2:
                            //Solar
                            $service = "solar";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 3:
                            //home security
                            $service = "home security";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 4:
                            //Flooring
                            $service = "flooring";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 6:
                            //Roofing
                            $service = "roofing";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 7:
                            //Siding
                            $service = "siding";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 8:
                            //Kitchen
                            $service = "kitchen remodeling";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 9:
                            //Bathroom
                            $service = "bathroom remodeling";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 11:
                            //Furnace
                            $service = "hvac";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 12:
                            //Boiler
                            $service = "hvac";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 13:
                            //Central A/C
                            $service = "hvac";
                            $Lead_data_Post .= "&service=$service";
                            break;
                        case 14:
                            //Cabinet
                            $service = "cabinet refacing";
                            $Lead_data_Post .= "&service=$service";
                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_Post, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2['status'])) {
                            if ($result2['status'] == "success") {
                                return 1;
                            }
                        }
                    }
                    break;
                case 27:
                    //BCI ACRYLIC 27

                $trusted_form_link = substr($data_msg['trusted_form'], strrpos($data_msg['trusted_form'], '/') + 1);

                $url_api_post = "https://app.leadconduit.com/flows/65e9e6bc8438994533611203/sources/65e22c36458d897f96bfa96b/submit";
                $httpheader = array(
                    'Accept: application/json',
                    'Content-Type: application/json',
                );

                $Lead_data_array = array(
                    "first_name" => $first_name,
                    "last_name" => $last_name,
                    "phone_1" => $number1,
                    "email" => $email,
                    "address_1" => $street,
                    "city" => $city,
                    "state" => $statename_code,
                    "postal_code" => $zip,
                    "campaign_id" => $campaign_name,
                    "trustedform_cert_url" => $trusted_form,

                    "dialed_tollfree_bci" => "0000000504",
                    "userid_bci" => "Thryvea",
                    "password_bci" => "GtK9)%fg",

                );
                $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                $result2 = json_decode($result, true);
                if (!empty($result2)) {
                    if (!empty($result2['outcome'])) {
                        if ($result2['outcome'] == "success") {
                            $TransactionId = $result2['lead']['id'];
                            $Payout = $result2['price'];
                            $multi_type = 0;
                            $Result = 1;
                            return 1;
                        }
                    }
                }
                    break;
                case 760:
                    //HELLO PROJECT USA
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $url_api = "https://helloprojectusa.leadportal.com/apiJSON.php";
                    $Key = "61023eecd99769759ed4022590594f4a5e6135340fd4f1d3b763596b612d4130";
                    $API_Action = "pingPostLead";
                    $TYPE = 18;
                    $SRC = "Allied_Bathroom";
                    $Sub_ID = "ADMA20";
                    $Pub_ID = "ADMA20";
                    $Format = "JSON";
                    switch ($lead_type_service_id) {
                        case 9:
                            $Project = "Bathroom Remodeling";
                            $ownership = trim($crm_details['data']['homeOwn']);
                            break;
                        default:
                            $Project = "";
                    }

//                    if( config('app.env', 'local') == "local" ) {
//                        //Test Mode
//                        $SRC = "test";
//                        $statename_code = "IL";
//                        $zip = "99999";
//                        $IPAddress = "75.2.92.149";
//                        $OriginalURL2 = "landing";
//                        $email = "test@nags.us";
//                    }

                    $Lead_data_array = array(
                        "Request" => array(
                            "Key" => $Key,
                            "API_Action" => "pingPostLead",
                            "Format" => "JSON",
                            "Mode" => "post",
                            "TYPE" => $TYPE,
                            "SRC" => $SRC,
                            "Pub_ID" => $Pub_ID,
                            "Sub_ID" => $Sub_ID,
                            "First_Name" => $first_name,
                            "Last_Name" => $last_name,
                            "Address" => $street,
                            "Primary_Phone" => $number1,
                            "Email" => $email,
                            "Lead_ID" => $TransactionId,
                            "Homeowner" => $ownership,
                            "City" => $city,
                            "State" => $statename_code,
                            "Zip" => $zip,
                            "Project" => $Project,
                            "IP_Address" => $IPAddress,
                            "TCPA_Consent" => $tcpa_compliant2,
                            "TCPA_Language" => $TCPAText,
                            "Landing_Page" => $OriginalURL2,
                            "User_Agent" => "Mozilla/5.0 (Linux; Android 11; motorola one 5G UW ace Build/RRV31.Q3-8; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/103.0.5060.71 Mobile Safari/537.36 [FB_IAB/FB4A;FBAV/374.0.0.20.109;]",
                            "Trusted_Form_URL" => $trusted_form,
                            "xxTrustedFormCertUrl" => $trusted_form,
                            "LeadiD_Token" => $LeadId
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['response'])) {
                        if (!empty($result2['response']['status'])) {
                            if ($result2['response']['status'] == "Success") {
                                $TransactionId = $result2['response']['lead_id'];
                                return $TransactionId;
                            }
                        }
                    }
                    break;
                case 818:
                    //Nessco Construction LLC 818
                    $url_api = "https://flow.zoho.com/686192442/flow/webhook/incoming?zapikey=1001.dc3646b97b6efc7ae803cf181d284f12.09610c1dddc1ab067034dbf8f83999ab&isdebug=false";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );
                    $Lead_data_array = array(
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                        "zip_code" => $zip,
                        "street" => $street,
                        "city" => $city,
                        "state" => $state,
                        "company" => config('app.name', ''),
                        "interested_in" => $crm_details['service_campaign_name']
                    );
                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 844:
                    //Alpine Digital Group, Inc. 844
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://adgtrax.com/submit/home-improvement";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data = array(
                        "product" => "Home Improvement",
                        "method" => "post",
                        "campaignId" => "6307cf5aae79e045e5a4a300",
                        "key" => "6307ca45ae79e045e5a4a2fd",
                        "city" => $city,
                        "state" => $statename_code,
                        "zipCode" => $zip,
                        "leadId" => $LeadId,
                        "xxTrustedFormCertUrl" => $trusted_form,
                        "consentLang" => $TCPAText,
                        "sourceIP" => $IPAddress,
                        "userAgent" => $UserAgent,
                        "leadBornOnDateTime" => date("c"),
                        "submissionURL" => $OriginalURL2,
                        "s1" => "ADM",
                        "s2" => "ADM",
                        "mobile" => false,
                        "test" => false,
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "pingId" => $TransactionId,
                        "address" => $street,
                        "phone" => $number1,
                        "email" => $email
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            $replace_repair = ($project_nature == "Repair" ? 12 : 4);
                            switch ($number_of_windows) {
                                case "3-5":
                                    $number_of_windows_data = 4;
                                    break;
                                case "6-9":
                                    $number_of_windows_data = 7;
                                    break;
                                case "10+":
                                    $number_of_windows_data = 10;
                                    break;
                                default:
                                    $number_of_windows_data = $number_of_windows;
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = $replace_repair;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['windows'] = $number_of_windows_data;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $homeowner = ($property_type == 'Rented' ? false : true);
                            $residential = ($property_type == 'Business' ? false : true);
                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = 1;//1 - No Shade
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = 3;//3 - Majority Shade
                                    break;
                                case "Partial Sun":
                                default:
                                    $roof_shade_data = 2;//2 - Some Shade
                            }
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $monthly_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $monthly_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $monthly_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $monthly_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $monthly_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $monthly_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $monthly_bill = 500;
                                    break;
                                default:
                                    $monthly_bill = 600;
                            }

                            $Lead_data['projectType'] = 9;
                            $Lead_data['timeframe'] = 2;
                            $Lead_data['solar'] = array(
                                "electricProvider" => $utility_provider,
                                "avgElectricBill" => $monthly_bill,
                                "shade" => $roof_shade_data
                            );
                            $Lead_data['residential'] = $residential;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 3:
                            //Home Security
                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == 'Rented' ? false : true);
                            $residential = ($property_type == 'Business' ? false : true);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = 8;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = $residential;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 4:
                            //Flooring
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $flooring_typesubcat = 4;
                                    break;
                                case "Hardwood Flooring":
                                    $flooring_typesubcat = 1;
                                    break;
                                case "Laminate Flooring":
                                    $flooring_typesubcat = 2;
                                    break;
                                case "Tile Flooring":
                                default:
                                    $flooring_typesubcat = 3;
                            }

                            $homeowner = ($ownership == "Yes" ? true : false);
                            $projectType = ($project_nature == "Repair Existing Flooring" ? 18 : 17);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = $projectType;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            $Lead_data['flooring'] = array(
                                "type" => $flooring_typesubcat,
                                "materialsPurchased" => false
                            );
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $residential = ($property_type == 'Commercial' ? false : true);
                            $replace_repair = ($project_nature == "Repair existing roof" ? 6 : 14);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = $replace_repair;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = $residential;
                            $Lead_data['homeowner'] = true;
                            break;
                        case 7:
                            //Home Siding
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            $replace_repair = ($project_nature == "Repair section(s) of siding" ? 7 : 15);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = $replace_repair;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = 10;//10 - Kitchen Remodel
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 9:
                        case 5:
                            //Walk in-tubs
                            //Bathroom
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = 11;//11 - Bathroom Remodel
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                        case 11:
                            //Furnace
                        case 12:
                            //Boiler
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            $replace_repair = ($project_nature == "Repair" ? 5 : 13);
                            switch ($start_time) {
                                case 'Immediately':
                                    $project_timeframe = 1;//1 - Emergency Service
                                    break;
                                case "Within 6 months":
                                    $project_timeframe = 4;//4 - 1 or 2 Weeks
                                    break;
                                default:
                                    $project_timeframe = 2;//2 - Timing Flexible
                            }

                            $Lead_data['projectType'] = $replace_repair;
                            $Lead_data['timeframe'] = $project_timeframe;
                            $Lead_data['residential'] = true;
                            $Lead_data['homeowner'] = $homeowner;
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $Lead_data['test'] = true;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if ($result2['success'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 849:
                    //FusedLeads 849
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );
                    $type = "21";
                    $url_api = "https://fusedleads.leadportal.com/apiJSON.php";
                    $SRC = ($lead_source_text == "ADMA20" ? "AlliedDigital_HIMP_Tier2" : "AlliedDigital_HIMP_Tier1");
                    $ProjectType = "";
                    switch ($crm_details['service_id']) {
                        case 1:
                            //windows
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Windows = "";
                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            switch ($number_of_windows) {
                                case "1":
                                    $ProjectType = "Window Replacement of One Window";
                                    $Windows = "1 Window";
                                    break;
                                case "2":
                                    $Windows = "2-3 Windows";
                                    $ProjectType = "Window Replacement of Multiple Windows";
                                    break;
                                case "3-5":
                                    $Windows = "4 Windows";
                                    $ProjectType = "Window Replacement of Multiple Windows";
                                    break;
                                default:
                                    $Windows = "4+ Windows";
                                    $ProjectType = "Window Replacement of Multiple Windows";
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            break;
                        case 2:
                            //Solar
                            $type = "23";
                            $SRC = ($lead_source_text == "ADMA20" ? "AlliedDigital_Solar_Tier2" : "AlliedDigital_Solar_Tier1");

                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $homeowner = ($property_type == "Rented" ? "No" : "Yes");
                            $ElectricityProvider = $utility_provider;
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $MonthlyPowerBill = floatval('50');
                                    break;
                                case '$51 - $100':
                                    $MonthlyPowerBill = floatval('100');
                                    break;
                                case '$101 - $150':
                                    $MonthlyPowerBill = floatval('150');
                                    break;
                                case '$151 - $200':
                                    $MonthlyPowerBill = floatval('200');
                                    break;
                                case '$201 - $300':
                                    $MonthlyPowerBill = floatval('300');
                                    break;
                                case '$301 - $400':
                                    $MonthlyPowerBill = floatval('400');
                                    break;
                                case '$401 - $500':
                                    $MonthlyPowerBill = floatval('500');
                                    break;
                                default:
                                    $MonthlyPowerBill = floatval('600');
                            }
                            switch ($roof_shade) {
                                case "Full Sun":
                                    $RoofShade = "None";
                                    break;
                                case "Mostly Shaded":
                                    $RoofShade = "A Lot";
                                    break;
                                case "Partial Sun":
                                    $RoofShade = "A Little";
                                    break;
                                default:
                                    $RoofShade = "Unknown";
                            }
                            break;
                        case 3:
                            //home Security
                            $type = "43";

                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $Residential = "Yes";
                            $HasSystem = $lead_have_item_before_it;
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            switch ($property_type) {
                                case "Owned":
                                    $homeowner = "Yes";
                                    $SecurityUsage = "Residential";
                                    break;
                                case "Rented":
                                    $homeowner = "No";
                                    $SecurityUsage = "Residential";
                                    break;
                                default:
                                    $homeowner = "No";
                                    $SecurityUsage = "Business";
                                    break;
                            }
                            break;
                        case 4:
                            //Flooring
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            switch ($Type_OfFlooring) {
                                case "Tile Flooring":
                                    $ProjectType = "Flooring Tile";
                                    break;
                                case "Hardwood Flooring":
                                    $ProjectType = "Flooring Wood";
                                    break;
                                case "Laminate Flooring":
                                    $ProjectType = "Flooring Laminate";
                                    break;
                                default:
                                    $ProjectType = "Flooring Carpet";
                            }
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $Residential = ($property_type == 'Residential' ? "Yes" : "No");
                            $homeowner = "Yes";
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }

                            switch ($project_nature) {
                                case "Repair existing roof":
                                    $ProjectType = "Roofing Repair";
                                    break;
                                default:
                                    switch ($roof_type) {
                                        case "Wood Shake/Composite Roofing":
                                            $ProjectType = "Roofing Wood Shingle";
                                            break;
                                        case "Metal Roofing":
                                            $ProjectType = "Roofing Metal";
                                            break;
                                        case "Natural Slate Roofing":
                                            $ProjectType = "Roofing Slate";
                                            break;
                                        default:
                                            $ProjectType = "Roofing Tile";
                                    }
                            }
                            break;
                        case 7:
                            //Home Siding
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $ProjectType = "Siding";
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $type_of_siding_data = "Vinyl";
                                    break;
                                case "Brickface Siding" || "Stoneface Siding":
                                    $type_of_siding_data = "Brick or Stone";
                                    break;
                                case "Composite wood Siding":
                                    $type_of_siding_data = "Wood";
                                    break;
                                case "Aluminium Siding":
                                    $type_of_siding_data = "Aluminum";
                                    break;
                                case "Fiber Cement Siding":
                                default:
                                    $type_of_siding_data = "Metal";
                            }
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $ProjectType = ($service_kitchen == 'Full Kitchen Remodeling' ? "Full Kitchen Remodel" : "Kitchen Cabinets");
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            break;
                        case 9:
                            //Bathroom
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $ProjectType = 'Partial Bathroom Update';
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            break;
                        case 15:
                            //Plumbing
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $ProjectType = 'Plumbing';
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            break;
                        case 21:
                            //Gutter
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Residential = "Yes";
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $ProjectType = ($project_nature == "Repair" ? "Gutters Repair" : "Gutters Install");
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "Emergency Service";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "More Than 2 Weeks";
                                    break;
                                default:
                                    $Timeframe = "Timing Flexible";
                            }
                            break;
                    }

                    $Lead_data_array_post = array(
                        "Request" => array(
                            "Key" => "70bb3c5874bbf54365cadd155473e59e67b9b4ada1f82caf5a46194b446a0e48",
                            "API_Action" => "pingPostLead",
                            "Mode" => (!empty($TransactionId) ? "post" : "full"),
                            "Format" => "JSON",
                            "TYPE" => $type,
                            "IP_Address" => $IPAddress,
                            "SRC" => $SRC,
                            "Sub_ID" => $leadsCustomerCampaign_id,
                            "Pub_ID" => (!empty($google_ts) ? $google_ts : $lead_source_text),
                            "Zip" => $zip,
                            "City" => $city,
                            "State" => $statename_code,
                            "Address" => $street,
                            "LeadIdToken" => $LeadId,
                            "Homeowner" => $homeowner,
                            "Landing_Page" => $OriginalURL2,
                            "TrustedForm" => $trusted_form,
                            "xxTrustedFormCertUrl" => $trusted_form,
                            "TCPAAgreed" => $tcpa_compliant2,
                            "TCPAText" => $TCPAText,
                            "FirstName" => $first_name,
                            "LastName" => $last_name,
                            "Lead_ID" => $TransactionId,
                            "EmailAddress" => $email,
                            "HomePhone" => $number1,
                        )
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $Lead_data_array_post['Request']['Residential'] = $Residential;
                            $Lead_data_array_post['Request']['ProjectType'] = $ProjectType;
                            $Lead_data_array_post['Request']['Timeframe'] = $Timeframe;
                            $Lead_data_array_post['Request']['Windows'] = $Windows;
                            break;
                        case 2:
                            //Solar
                            $Lead_data_array_post['Request']['RoofShade'] = $RoofShade;
                            $Lead_data_array_post['Request']['ElectricityProvider'] = $ElectricityProvider;
                            $Lead_data_array_post['Request']['MonthlyPowerBill'] = $MonthlyPowerBill;
                            $Lead_data_array_post['Request']['CreditScore'] = "Good";
                            break;
                        case 3:
                            //home Security
                            $Lead_data_array_post['Request']['Residential'] = $Residential;
                            $Lead_data_array_post['Request']['HasSystem'] = $HasSystem;
                            $Lead_data_array_post['Request']['Timeframe'] = $Timeframe;
                            $Lead_data_array_post['Request']['SecurityUsage'] = $SecurityUsage;
                            break;
                        case 7:
                            //Home Siding
                            $Lead_data_array_post['Request']['SidingMaterial'] = $type_of_siding_data;
                            $Lead_data_array_post['Request']['Residential'] = $Residential;
                            $Lead_data_array_post['Request']['ProjectType'] = $ProjectType;
                            $Lead_data_array_post['Request']['Timeframe'] = $Timeframe;
                            break;
                        default:
                            $Lead_data_array_post['Request']['Residential'] = $Residential;
                            $Lead_data_array_post['Request']['ProjectType'] = $ProjectType;
                            $Lead_data_array_post['Request']['Timeframe'] = $Timeframe;
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        $Lead_data_array_post['Request']['State'] = "AK";
                        $Lead_data_array_post['Request']['Zip'] = "99999";
                        $Lead_data_array_post['Request']['Test_Lead'] = "1";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['response'])) {
                        if (!empty($result2['response']['status'])) {
                            if ($result2['response']['status'] == "Matched") {
                                $TransactionId = $result2['response']['lead_id'];
                                return $TransactionId;
                            }
                        }
                    }
                    break;
                case 851:
                    //RingPartner 851
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://forms.ringpartner.com/post";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: application/json"
                    );
                    $Lead_data_array_post = array(
                        "publisher_id" => "DP11ebe5b3a4135850944e376100a01c8a",
                        "landing_page_url" => $OriginalURL2,
                        "tcpa" => $tcpa_compliant5,
                        "share_lead" => false,
                        "publisher_sub_id_1" => $lead_source_text,
                        "publisher_sub_id_2" => $google_ts,
                        "min_bid" => "1.00",
                        "trusted_form_url" => $trusted_form,
                        "jornaya_id" => $LeadId,
                        "universal_id" => $LeadId,
                        "ip" => $IPAddress,
                        "tcpa_text" => $TCPAText,
                        "user_agent" => $UserAgent,
                        "zip" => $zip,
                        "lead_id" => $TransactionId,
                        "address" => $street,
                        "address1" => $street,
                        "email" => $email,
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone" => "+1" . $number1,
                        "phone_cell" => "+1" . $number1
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Window Repair & Replacement";
                            $property_type = 'residential';
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $is_repair = ($project_nature == "Repair" ? 1 : 0);

                            switch ($number_of_windows) {
                                case "1":
                                    $wndw_number = 1;
                                    break;
                                case "2":
                                    $wndw_number = 2;
                                    break;
                                case "3-5":
                                    $wndw_number = 5;
                                    break;
                                case "6-9":
                                    $wndw_number = 8;
                                    break;
                                default:
                                    $wndw_number = 10;
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }
                            switch ($ownership) {
                                case 'Yes':
                                    $owner = "yes";
                                    break;
                                case "No":
                                    $owner = "no";
                                    break;
                                default:
                                    $owner = "authorized";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = $is_repair;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = $property_type;
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $owner;
                            $Lead_data_array_post['wndw_number'] = $wndw_number;
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $homeowner = ($property_type == "Rented" ? false : true);
                            $residential_property = ($property_type == "Business" ? false : true);
                            $power_solution_data = ($power_solution == "Solar Water Heating for my Home" ? false : true);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $electric_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $electric_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $electric_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $electric_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $electric_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $electric_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $electric_bill = 500;
                                    break;
                                default:
                                    $electric_bill = 600;
                            }
                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade = "Uncertain";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11ea3957f7eaf5509e7eef72b8aaf741";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['roof_shade'] = $roof_shade;
                            $Lead_data_array_post['solar_electric'] = $power_solution_data;
                            $Lead_data_array_post['electric_bill'] = $electric_bill;
                            $Lead_data_array_post['electrical_supplier'] = $utility_provider;
                            $Lead_data_array_post['residential_property'] = $residential_property;
                            $Lead_data_array_post['home_type'] = "Single Family";
                            $Lead_data_array_post['project_status'] = "Ready to Hire";
                            $Lead_data_array_post['best_time_contact'] = "Morning";
                            $Lead_data_array_post['roof_type'] = "asphalt";
                            $Lead_data_array_post['purchase_timeframe'] = "Within 1 Month";
                            break;
                        case 3:
                            //Home Security
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $homeowner = ($property_type == 'Rented' ? 1 : 0);
                            $homeowner2 = ($property_type == 'Rented' ? "yes" : "no");

                            $project_type = "Security Cameras Dealers";

                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_ping['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            break;
                        case 4:
                            //Flooring
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Wood & Laminate Flooring";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");
                            switch ($project_nature) {
                                case "Install New Flooring":
                                case "Refinish Existing Flooring":
                                    $is_repair = 0;
                                    break;
                                default:
                                    $is_repair = 1;
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = $is_repair;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $project_type = "Roofing Contractors";
                            $homeowner = ($property_type == 'Residential' ? 1 : 0);
                            $homeowner2 = ($property_type == 'Residential' ? "yes" : "no");

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roofing_type_data = 'asphalt';
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofing_type_data = 'composite';
                                    break;
                                case "Metal Roofing":
                                    $roofing_type_data = 'metal';
                                    break;
                                case "Natural Slate Roofing":
                                    $roofing_type_data = 'slate';
                                    break;
                                case "Tile Roofing":
                                default:
                                    $roofing_type_data = 'tile';
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }
                            switch ($project_nature) {
                                case "Install roof on new construction":
                                    $is_repair = 0;
                                    $rf_service_type = "install";
                                    break;
                                case "Completely replace roof":
                                    $is_repair = 0;
                                    $rf_service_type = "replace";
                                    break;
                                default:
                                    $is_repair = 1;
                                    $rf_service_type = "repair";
                            }


                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = $is_repair;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            $Lead_data_array_post['roofing_materials'] = $roofing_type_data;
                            $Lead_data_array_post['rf_service_type'] = $rf_service_type;
                            break;
                        case 7:
                            //Home Siding
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Siding Contractors";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");

                            switch ($project_nature) {
                                case "Siding for a new home":
                                case "Siding for a new addition":
                                    $si_service_type = "new";
                                    break;
                                case "Replace existing siding":
                                    $si_service_type = "replace";
                                    break;
                                default:
                                    $si_service_type = "replace";
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }
                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $Trade = "Vinyl";
                                    break;
                                case "Composite wood Siding":
                                    $Trade = "Wood";
                                    break;
                                default:
                                    $Trade = "Metal";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            $Lead_data_array_post['si_service_type'] = $si_service_type;
                            $Lead_data_array_post['si_material'] = $Trade;
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Kitchen Design & Remodeling";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            break;
                        case 9:
                            //Bathroom
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $bathroom_type_name = trim($crm_details['data']['services']);

                            $project_type = "Bathroom Remodeling";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");


                            switch ($bathroom_type_name) {
                                case "Full Remodel":
                                    $bathroom_type_name_data = "full_remodel";
                                    break;
                                case "Cabinets / Vanity":
                                    $bathroom_type_name_data = "cabinets_vanity";
                                    break;
                                case "Countertops":
                                    $bathroom_type_name_data = "countertops";
                                    break;
                                case "Flooring":
                                    $bathroom_type_name_data = "flooring";
                                    break;
                                case "Shower / Bath":
                                    $bathroom_type_name_data = "shower_bath";
                                    break;
                                case "Sinks":
                                    $bathroom_type_name_data = "sinks";
                                    break;
                                case "Toilet":
                                    $bathroom_type_name_data = "toilet";
                                    break;
                            }
                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            $Lead_data_array_post['bthrm_service_type'] = $bathroom_type_name_data;
                            break;
                        case 11:
                            //Furnace
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Bathroom Remodeling";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }
                            switch ($type_of_heating) {
                                case "Oil":
                                    switch ($project_nature) {
                                        case "Install":
                                            $project_type = "HVAC Contractors - Furnace - Oil - Install";
                                            break;
                                        case "Replace":
                                            $project_type = "HVAC Contractors - Furnace - Oil - Replace";
                                            break;
                                        default:
                                            $project_type = "HVAC Contractors - Furnace - Oil - Repair";
                                    }
                                    break;
                                case "Electric":
                                    switch ($project_nature) {
                                        case "Install":
                                            $project_type = "HVAC Contractors - Furnace - Electric - Install";
                                            break;
                                        case "Replace":
                                            $project_type = "HVAC Contractors - Furnace - Electric - Replace";
                                            break;
                                        default:
                                            $project_type = "HVAC Contractors - Furnace - Electric - Repair";
                                    }
                                    break;
                                case "Propane Gas":
                                case "Natural Gas":
                                    switch ($project_nature) {
                                        case "Install":
                                            $project_type = "HVAC Contractors - Furnace - Gas - Install";
                                            break;
                                        case "Replace":
                                            $project_type = "HVAC Contractors - Furnace - Gas - Replace";
                                            break;
                                        default:
                                            $project_type = "HVAC Contractors - Furnace - Gas - Repair";
                                    }
                                    break;
                            }


                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $project_type = "Bathroom Remodeling";
                            $homeowner = ($ownership == "Yes" ? 1 : 0);
                            $homeowner2 = ($ownership == "Yes" ? "yes" : "no");

                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "over_2_weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_weeks";
                            }
                            switch ($project_nature) {
                                case "Install":
                                    $project_type = "HVAC Contractors - Central AC - Install";
                                    break;
                                case "Replace":
                                    $project_type = "HVAC Contractors - Central AC - Repair";
                                    break;
                            }

                            $Lead_data_array_post['api_campaign_id'] = "AC11e9cb541bb997b0ab6b971e9eb59de3";
                            $Lead_data_array_post['is_homeowner'] = $homeowner;
                            $Lead_data_array_post['project_type'] = $project_type;
                            $Lead_data_array_post['is_repair'] = 0;
                            $Lead_data_array_post['credit'] = "Good";
                            $Lead_data_array_post['property_type'] = "residential";
                            $Lead_data_array_post['time_frame'] = $Timeframe;
                            $Lead_data_array_post['owner'] = $homeowner2;
                            break;
                    }
                    if (config('app.env', 'local') == "local") {
                        $Lead_data_array_post['zip'] = "90210";
                        $Lead_data_array_post['is_test'] = true;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "ok") {
                            return 1;
                        }
                    }
                    break;
                case 866:
                    //B & H Roofing, LLC 866
                    $url_api = "https://flow.zoho.com/703282124/flow/webhook/incoming?zapikey=1001.9bef9b2ae71418f17b6dfc0c0162f1c4.b21b13821c7639f11e5f8932abf92f0c&isdebug=false";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );
                    $Lead_data_array = array(
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                        "zip_code" => $zip,
                        "street" => $street,
                        "city" => $city,
                        "state" => $state,
                        "company" => config('app.name', ''),
                        "interested_in" => $crm_details['service_campaign_name']
                    );

                    switch ($crm_details['service_id']) {
                        case 6:
                            //Roofing
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $project_nature_data = ($project_nature == "Repair existing roof" ? "Repair" : "Replace");

                            $Lead_data_array["Scope of work"] = $project_nature_data;
                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 832:
                    //Shape Software / Sun Team	 832
                    $url_api = "https://secure.setshape.com/postlead/12685/12752";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: application/json"
                    );
                    $Lead_data_array_post = array(
                        "zip" => $zip,
                        "city" => $city,
                        "state" => $statename_code,
                        "leadfulladdress" => $street,
                        "firstname" => $first_name,
                        "lastname" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                    );

                    switch ($crm_details['service_id']) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $Lead_data_array_post['avgsummerbill'] = $monthly_electric_bill;
                            $Lead_data_array_post['electricCompany'] = $utility_provider;
                            $Lead_data_array_post['creditscore'] = "Good";
                            $Lead_data_array_post['bestContactTime'] = "Morning";
                            $Lead_data_array_post['typeOfsolution'] = $power_solution;
                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array_post)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['msg'])) {
                        if ($result2['msg'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 308:
                    //PJ Fitzpatrick 308
                    $url_token = "https://auth.servicetitan.io/connect/token";
                    $clientID = "cid.vrwpsgir9oupyieu8j4zo876l";
                    $clientSecret = "cs1.xc9cekvegbkiud7vb4e1xt1imlqke7hb5zebcwxsc6gnuoqnqr";
                    $input_token = "grant_type=client_credentials&client_id=$clientID&client_secret=$clientSecret";
                    $httpheader_token = array(
                        'Content-Type: application/x-www-form-urlencoded',
                        "Accept: application/json"
                    );

                    $result_token = $crm_api_file->api_send_data($url_token, $httpheader_token, $leadsCustomerCampaign_id, $input_token, "POST", 1, $crm_details['campaign_id']);
                    $result_token2 = json_decode($result_token, true);
                    if (!empty($result_token2['access_token'])) {
                        $access_token = $result_token2['access_token'];
                        $tenantID = "889499837";
                        $bookingProvider = "236765135";
                        $url_api = "https://api.servicetitan.io/crm/v2/tenant/$tenantID/booking-provider/$bookingProvider/bookings";
                        $appKey = "ak1.wx4w59dswx4fu73so2jwe4j49";
                        $httpheader = array(
                            "Authorization: $access_token",
                            "ST-App-Key: $appKey",
                            "Content-Type: application/json",
                            "Accept: application/json",
                        );

                        $serviceReq = "";
                        switch ($lead_type_service_id) {
                            case 1:
                                $serviceReq = "Windows Lead";
                                break;
                            case 6:
                                $serviceReq = "Roofing Lead";
                                break;
                        }

                        $Lead_data_post = array(
                            "source" => "Allied Digital Media",
                            "name" => "$first_name $last_name",
                            "address" => array(
                                "street" => $street,
                                "city" => $city,
                                "state" => $statename_code,
                                "zip" => $zip,
                                "country" => "USA"
                            ),
                            "contacts" => array(
                                array(
                                    "type" => "Phone",
                                    "value" => $number1
                                ),
                                array(
                                    "type" => "Email",
                                    "value" => $email
                                )
                            ),
                            "summary" => $serviceReq,
                            "isFirstTimeClient" => true,
                            "externalId" => $leadsCustomerCampaign_id
                        );

                        $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_post), "POST", 1, $crm_details['campaign_id']);
                        $result2 = json_decode($result, true);
                        if (!empty($result2['id'])) {
                            return 1;
                        }
                    }
                    break;
                case 904:
                    //Cubix Power 904
                    //zapier CRM
                    $utility_provider = $crm_details['data']['utility_provider'];
                    $url_api = "https://hooks.zapier.com/hooks/catch/8257369/bxomaz2/";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "Lead_ID" => $leadsCustomerCampaign_id,
                        "Source" => $lead_source_text,
                        "Campaign" => $crm_details['campaign_id'],
                        "First" => $first_name,
                        "Last" => $last_name,
                        "Email" => $email,
                        "Phone" => $number1,
                        "Street" => $street,
                        "City" => $city,
                        "State" => $statename_code,
                        "Zip" => $zip,
                        "Utility_Company" => $utility_provider
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 880:
                    //Tephra Solar 880
                    //monday CRM
                    $url_api = "https://forms.monday.com/forms/f9517f0ce1d0029602e94f9b66b80d0f/submit_form?r=use1";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "answers" => array(
                            "name" => "$first_name $last_name",
                            "phone0" => $number1,
                            "address" => "$street $zip"
                        ),
                        "address" => "$street $zip",
                        "bid" => $Lead_Cost,
                        "created_date" => date("m/d/Y"),
                        "email_address" => array(
                            "email" => $email,
                            "text" => $email,
                        ),
                        "name" => "$first_name $last_name",
                        "phone0" => $number1,
                        "text" => $Lead_Cost_type,
                        "zipcode" => $zip
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['creation_result'])) {
                        if ($result2['creation_result'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 970:
                    //AIQOO  970
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $apiVendorKey = 'EUCPK-01558';
                    $apiBucketKey = "";
                    $serviceName = "";
                    switch ($lead_type_service_id) {
                        case 1:
                            // windows
                            $apiBucketKey = "6RZBD-41721";
                            $serviceName = "Install or replace windows";
                            break;
                        case 2:
                            // Solar
                            $apiBucketKey = "95PVW-42286";
                            $serviceName = "Install solar panels for electric system";
                            break;
                        case 4:
                            // Flooring
                            $apiBucketKey = "JF7JS-79195";
                            $serviceName = "Install or replace flooring";
                            break;
                        case 6:
                            // Roofing
                            $project_nature = trim($crm_details['data']['project_nature']);
                            switch ($project_nature) {
                                case "Repair existing roof":
                                    $apiBucketKey = "F3X4H-54701";
                                    $serviceName = "Roof Repair";
                                    break;
                                default:
                                    $apiBucketKey = "KHFGN-37312";
                                    $serviceName = "Roof Replacement";
                            }
                            break;
                        case 7:
                            // Siding
                            $apiBucketKey = "X0ZN1-74409";
                            $serviceName = "Install or replace siding";
                            break;
                        case 8:
                            // kitchen
                            $apiBucketKey = "PI5XX-39013";
                            $serviceName = "Full Kitchen Remodel";
                            break;
                        case 9:
                            // Bathroom
                            $apiBucketKey = "RMKNC-25042";
                            $serviceName = "Full Bathroom Remodel";
                            break;
                        case 21:
                            // Gutter
                            $apiBucketKey = "XJL5P-58313";
                            $serviceName = "Install or replace gutters";
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api = "https://api.aiqoo.com/api/v1/PingPost/Post/Test?";
                        $apiBucketKey = "6RZBD-41721";
                        $zip = "99743";
                        $trusted_form = "d52a16b2-233f-4f75-b55d-624f187a44e8";
                    } else {
                        $url_api = "https://api.aiqoo.com/api/v1/PingPost/Post?";
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: multipart/form-data"
                    );

                    $Lead_data_array = array(
                        "apiVendorKey" => $apiVendorKey,
                        "apiBucketKey" => $apiBucketKey,
                        "bidKey" => $TransactionId,
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phone1" => $number1,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zipCode" => $zip,
                        "serviceName" => $serviceName,
                        "leadFormCertUrl" => $trusted_form
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['resSuccess'])) {
                        if ($result2['resMessage'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 980:
                    //Net Zero Solar Inc 980
                    $Lead_data_array = "";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: multipart/form-data"
                    );

                    $lead_source = "Allied";
                    $url_api = "https://server2.sunbasedata.com/sunbase/portal/api/lead_post.jsp?first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&address1=$street&city=$city&state=$statename_code&zip_code=$zip&lead_source=$lead_source&lead_cost=$Lead_Cost&county=$county";

                    if ($crm_details['campaign_Type'] == 4) {
                        if ($data_msg['appointment_date'] != "") {
                            $appointment_date = date('Y-m-d\TH:i', strtotime($data_msg['appointment_date']));
                            $url_api .= "&apptTime=$appointment_date";
                        }
                    }

                    switch ($lead_type_service_id) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $electric_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $electric_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $electric_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $electric_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $electric_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $electric_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $electric_bill = 500;
                                    break;
                                default:
                                    $electric_bill = 600;
                            }

                            $url_api .= "&schema_name=uniquesolar&customField1=$utility_provider&customField37=$electric_bill";
                            break;
                    }

                    $url_api = str_replace(" ", "%20", $url_api);
                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), 'successfully')) {
                        if ($crm_details['campaign_Type'] == 4) {
                            if ($data_msg['appointment_date'] != "") {
                                $apptDate = date('Y-m-d', strtotime($data_msg['appointment_date']));
                                $apptTime = date('H:i', strtotime($data_msg['appointment_date']));
                                $apptTime = str_replace(":", "%3A", $apptTime);

                                //Send To Calendar
                                $url_api2 = "https://server2.sunbasedata.com/sunbase/portal/calendar_cmd.jsp?cmd=insert&schema=uniquesolar&lead_src=$lead_source&firstName=$first_name&lastName=$last_name&address1=$street&apptStatus=Set&appt_zip_code=$zip&appt_state=$statename_code&appt_county=$county&appt_city=$city&phone=$number1&email=$email&notes=Allied Transfer&apptDate=$apptDate&apptDateTime=$apptTime";
                                $url_api2 = str_replace(" ", "%20", $url_api2);

                                $result2 = $crm_api_file->api_send_data($url_api2, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                                if (str_contains(strtolower($result2), 'successfully')) {
                                    return 1;
                                }
                            }
                        }
                    }
                    break;
                case 992:
                    //992 Right Plan Solar
                    //monday CRM
                    $url_api = "https://forms.monday.com/forms/6649475797e609be4100134c6a681308/submit_form?r=use1";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $Lead_data_array = array(
                        "answers" => array(
                            "name" => "$first_name $last_name",
                            "long_text0" => $street,
                            "long_text4" => $city,
                            "long_text5" => $statename_code,
                            "long_text6" => $zip,
                            "email" => array(
                                "email" => $email,
                                "text" => $email
                            ),
                            "phone" => array(
                                "phone" => "1$number1",
                                "countryShortName" => "US"
                            ),
                            "long_text9" => $monthly_electric_bill,
                            "long_text08" => $utility_provider,
                            "long_text8" => $roof_shade,
                            "long_text1" => $property_type,
                            "date4" => date("Y-m-d")
                        ),
                        "form-timezone-offset" => 480
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['creation_result'])) {
                        if ($result2['creation_result'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 993:
                    //Express Flooring LLC 993
                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api = "https://expressflooringbackend-test.azurewebsites.net/api/v1.0/Leads/process-lead";
                    } else {
                        $url_api = "https://api.expressflooring.com/api/v1.0/Leads/process-lead";
                    }

                    if ($listOFCampainDB_type == "Exclusive") {
                        $vendorid = "35KDJW1M80JL9N006LNG5Y8FLV";
                    } else {
                        $vendorid = "H67BX8ET6P8N03FF2UOH602S81";
                    }

                    $httpheader = array(
                        "x-access-key: $vendorid",
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "FirstName" => $first_name,
                        "LastName" => $last_name,
                        "AddressLine1" => $street,
                        "City" => $city,
                        "State" => $statename_code,
                        "Zip" => $zip,
                        "PhoneNumber" => $number1,
                        "EmailAddress" => $email
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 928:
                    //LeadLabx 928
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $homeowner = "YES";
                    $residential = "YES";
                    $bestCallTime = "Any Time";
                    $Timeframe = "";

                    $Lead_data_array = array(
                        "promise" => $TransactionId,
                        "tcpa" => $tcpa_compliant2,
                        "ipAddress" => $IPAddress,
                        "tcpaText" => $TCPAText,
                        "jornayaLeadId" => $LeadId,
                        "trustedFormURL" => $trusted_form,
                        "userIp" => $IPAddress,
                        "usAddress" => $street,
                        "source" => $lead_source_text,
                        "webSiteUrl" => $OriginalURL2,
                        "city" => $city,
                        "state" => $statename_code,
                        "userAgent" => $UserAgent,

                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "address" => $street,
                        "email" => $email,
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //Windows
                            $apiId = "4B62C4288D574180A8968779A74D5BB6";
                            $apiPassword = "e8485374c";
                            $productId = "286";

                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $task = ($project_nature == "Repair" ? "REPAIR" : "INSTALL");

                            switch ($number_of_windows) {
                                case "1":
                                    $wndw_number = 1;
                                    break;
                                case "2":
                                    $wndw_number = 2;
                                    break;
                                case "3-5":
                                    $wndw_number = 5;
                                    break;
                                case "6-9":
                                    $wndw_number = 8;
                                    break;
                                default:
                                    $wndw_number = 10;
                            }

                            $Lead_data_array["apiId"] = $apiId;
                            $Lead_data_array["apiPassword"] = $apiPassword;
                            $Lead_data_array["productId"] = $productId;
                            $Lead_data_array["ownHome"] = $ownership;
                            $Lead_data_array["task"] = $task;
                            $Lead_data_array["number"] = $wndw_number;
                            $Lead_data_array["zip"] = $zip;
                            $Lead_data_array["primaryPhone"] = $number1;
                            break;
                        case 2:
                            //Solar
                            $apiId = "EAA8E25300C34D07BCB6E3E1D7BA8A6A";
                            $apiPassword = "d56f309";
                            $productId = "177";

                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50' || '$51 - $100':
                                    $average_bill = '100';
                                    break;
                                case '$101 - $150':
                                    $average_bill = '150';
                                    break;
                                case '$151 - $200':
                                    $average_bill = '200';
                                    break;
                                case '$201 - $300':
                                    $average_bill = '300';
                                    break;
                                default:
                                    $average_bill = '350';
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "FULL_SHADE";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "SOME_SHADE";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "NO_SHADE";
                                    break;
                                default:
                                    $roof_shade_data = "NOT_SURE";
                            }

                            switch ($power_solution) {
                                case "Solar Electricity for my Home":
                                    $power_solution_data = "HOME_SOLAR_ELECTRICITY";
                                    break;
                                case "Solar Water Heating for my Home":
                                    $power_solution_data = "HOME_SOLAR_WATER_HEATING";
                                    break;
                                case "Solar Electricity & Water Heating for my Home":
                                    $power_solution_data = "HOME_SOLAR_ELECTRICITY_WATER_HEATING";
                                    break;
                                default:
                                    $power_solution_data = "SOLAR_BUSINESS";
                            }

                            $Lead_data_array["apiId"] = $apiId;
                            $Lead_data_array["apiPassword"] = $apiPassword;
                            $Lead_data_array["productId"] = $productId;
                            $Lead_data_array["trustedForm"] = $trusted_form;
                            $Lead_data_array["tcpaLanguage"] = $TCPAText;
                            $Lead_data_array["ownHome"] = "YES";
                            $Lead_data_array["bestCallTime"] = "Any Time";
                            $Lead_data_array["monthlyBill"] = $average_bill;
                            $Lead_data_array["utilityProvider"] = $utility_provider;
                            $Lead_data_array["roofShade"] = $roof_shade_data;
                            $Lead_data_array["creditRating"] = "GOOD";
                            $Lead_data_array["purchaseTimeFrame"] = "IMMEDIATELY";
                            $Lead_data_array["powerSolution"] = $power_solution_data;
                            $Lead_data_array["zip"] = $zip;
                            $Lead_data_array["mobilePhone"] = $number1;
                            break;
                        case 3:
                            //Home Security
                            $Installation_Preferences = trim($crm_details['data']['Installation_Preferences']);
                            $lead_have_item_before_it = trim($crm_details['data']['lead_have_item_before_it']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $existingAlarm = ($lead_have_item_before_it == "Yes" ? "YES" : "NO");

                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            switch ($property_type) {
                                case "Business":
                                    $residential = "NO";
                                    $homeowner = "NO";
                                    break;
                                case "Rented":
                                    $residential = "YES";
                                    $homeowner = "NO";
                                    break;
                                default:
                                    $residential = "YES";
                                    $homeowner = "YES";
                            }

                            $Lead_data_array["existingAlarm"] = $existingAlarm;
                            $Lead_data_array["serviceType"] = "HOME_SECURITY";
                            break;
                        case 4:
                            //Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $typeOfFlooring = "VINYL_LINOLEUM_FLOORING";
                                    break;
                                case "Tile Flooring":
                                    $typeOfFlooring = "TILE_FLOORING";
                                    break;
                                case "Hardwood Flooring":
                                    $typeOfFlooring = "HARDWOOD_FLOORING";
                                    break;
                                case "Laminate Flooring":
                                    $typeOfFlooring = "LAMINATE_FLOORING";
                                    break;
                                default:
                                    $typeOfFlooring = "CARPET";
                            }

                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            $Lead_data_array["typeOfFlooring"] = $typeOfFlooring;
                            $Lead_data_array["serviceType"] = "FLOORING";
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $residential = ($property_type == "Residential" ? "YES" : "NO");

                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roofType = "ASPHALT_ROOFING";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofType = "WOOD_SHAKE_COMPOSITE_ROOFING";
                                    break;
                                case "Metal Roofing":
                                    $roofType = "METAL_ROOFING";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofType = "NATURAL_SLATE_ROOFING";
                                    break;
                                case "Tile Roofing":
                                    $roofType = "TILE";
                                    break;
                                default:
                                    $roofType = "CEDAR_SHAKE";
                            }

                            $Lead_data_array["roofType"] = $roofType;
                            $Lead_data_array["serviceType"] = "ROOFING";
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");

                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $type_of_siding_data = "VINYL_SIDING";
                                    break;
                                case "Brickface Siding":
                                    $type_of_siding_data = "BRICKFACE_SIDING";
                                    break;
                                case "Composite wood Siding":
                                    $type_of_siding_data = "COMPOSITE_WOOD_SIDING";
                                    break;
                                case "Aluminium Siding":
                                    $type_of_siding_data = "ALUMINUM_SIDING";
                                    break;
                                case "Fiber Cement Siding":
                                    $type_of_siding_data = "FIBER_CEMENT_SIDING";
                                    break;
                                default:
                                    $type_of_siding_data = "STONEFACE_SIDING";
                            }

                            $Lead_data_array["typeOfSiding"] = $type_of_siding_data;
                            $Lead_data_array["serviceType"] = "SIDING";
                            break;
                        case 8:
                            //Kitchen
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");
                            $removingWalls = ($ownership == "Yes" ? "YES" : "NO");
                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            switch ($service_kitchen) {
                                case "Full Kitchen Remodeling":
                                    $kitchenType = "FULL_KITCHEN_REMODELING";
                                    break;
                                case "Cabinet Refacing":
                                    $kitchenType = "CABINET_REFACING";
                                    break;
                                case "Cabinet Install":
                                    $kitchenType = "CABINET_INSTALL";
                                    break;
                            }

                            $Lead_data_array["kitchenType"] = $kitchenType;
                            $Lead_data_array["removingWalls"] = $removingWalls;
                            $Lead_data_array["serviceType"] = "KITCHEN";
                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? "YES" : "NO");
                            switch ($bathroom_type_name) {
                                case "Flooring":
                                    $bathroomType = "FLOORING";
                                    break;
                                case "Shower / Bath":
                                    $bathroomType = "SHOWER_BATH";
                                    break;
                                case "Sinks":
                                    $bathroomType = "SINKS";
                                    break;
                                case "Toilet":
                                    $bathroomType = "TOILET";
                                    break;
                                default:
                                    $bathroomType = "FULL_REMODEL";
                            }
                            switch ($start_time) {
                                case "Immediately":
                                    $Timeframe = "EMERGENCY_SERVICE";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "WITHIN_6_MONTHS";
                                    break;
                                default:
                                    $Timeframe = "TIMING_FLEXIBLE";
                            }

                            $Lead_data_array["bathroomType"] = $bathroomType;
                            $Lead_data_array["serviceType"] = "BATHROOM";
                            break;
                    }

                    switch ($lead_type_service_id) {
                        case 3:
                        case 4:
                        case 6:
                        case 7:
                        case 8:
                        case 9:
                            $apiId = "5BC132F5918E4ED1A41DAE307E211F24";
                            $apiPassword = "c2632c87";
                            $productId = "265";

                            $Lead_data_array["apiId"] = $apiId;
                            $Lead_data_array["apiPassword"] = $apiPassword;
                            $Lead_data_array["productId"] = $productId;
                            $Lead_data_array["residential"] = $residential;
                            $Lead_data_array["homeowner"] = $homeowner;
                            $Lead_data_array["timeFrame"] = $Timeframe;
                            $Lead_data_array["bestCallTime"] = $bestCallTime;
                            $Lead_data_array["tcpaLanguage"] = $TCPAText;
                            $Lead_data_array["zipcode"] = $zip;
                            $Lead_data_array["homePhone"] = $number1;
                            break;
                    }

                    $url_api = "https://leads-inst339-client.phonexa.com/post/";

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        //$Lead_data_array['testMode'] = "1";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == 1) {
                            return 1;
                        }
                    }
                    break;
                case 1017:
                    //Independent Home 1017
                    $url_api = "https://leadsource-independenthome.force.com/LeadService/services/apexrest/LeadService";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $ownership = "Unknown";
                    if (!empty(trim($crm_details['data']['homeOwn']))) {
                        $homeOwn = trim($crm_details['data']['homeOwn']);
                        $ownership = ($homeOwn == "Yes" ? "YES" : "NO");
                    } elseif (!empty(trim($crm_details['data']['property_type']))) {
                        $property_type = trim($crm_details['data']['property_type']);
                        $ownership = ($property_type == "Owned" ? "YES" : "NO");
                    }

                    $Timeframe = "Within 1 week";
                    if (!empty(trim($crm_details['data']['start_time']))) {
                        $start_time = trim($crm_details['data']['start_time']);
                        $Timeframe = ($start_time == "Within 6 months" ? "More than 2 weeks" : "Within 1 week");
                    }

                    $Lead_data_array = array(
                        'leads' =>
                            array(
                                0 => array(
                                    "LastName" => $last_name,
                                    "Company" => "ADM",
                                    "LeadSource" => "ADM",
                                    "Status" => "New Lead",
                                    "Phone" => $number1,
                                    "PostalCode" => $zip,
                                    "State" => $statename_code,
                                    "Source_External_ID__c" => "$leadsCustomerCampaign_id",
                                    "Cost__c" => $Lead_Cost,
                                    "Email" => $email,
                                    "FirstName" => $first_name,
                                    "Street" => $street,
                                    "City" => $city,
                                    "Desired_Timeframe__c" => $Timeframe,
                                    "Home_Owner__c" => $ownership,
                                ),
                            ),
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), "1 successes")) {
                        return 1;
                    }
                    break;
                case 1024:
                    //Florida EcoLiving 1024
                    $url_api = "https://api.close.com/api/v1/lead/";

                    $httpheader = array(
                        'Authorization: Basic YXBpXzU2NmV6ZGV1V2hnM3BWSlNCUUJyZlouNGxFN05hUmJiQnFMYmJ0ekNuOVh0ajphcGlfNTY2ZXpkZXVXaGczcFZKU0JRQnJmWi40bEU3TmFSYmJCcUxiYnR6Q245WHRq',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = array(
                        "name" => "$first_name $last_name",
                        "url" => $OriginalURL2,
                        "contacts" => array(
                            array(
                                "name" => "$first_name $last_name",
                                "emails" => array(array("type" => "home", "email" => $email)),
                                "phones" => array(array("type" => "home", "phone" => $number1))
                            )
                        ),
                        "addresses" => array(
                            array(
                                "label" => "residential",
                                "address_1" => $street,
                                "address_2" => "",
                                "city" => $city,
                                "state" => $statename_code,
                                "zipcode" => $zip,
                                "country" => "US"
                            )
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 1031:
                    //Empire Media 1031
                    $TransactionId = "";
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    }

                    $Lead_data_array_post = "";
                    $url_api = "https://viberant.leadportal.com/new_api/api.php";
                    $Key = "69217055c2c30f3a82e5235fdda8a4feffedbcf8724b49d20fe1a2401cba89cc";
                    $httpheader = array('Content-Type: application/json');

                    if (!empty($crm_details['data']['homeOwn'])) {
                        $ownership = ($crm_details['data']['homeOwn'] != "Yes" ? "No" : "Yes");
                    } else {
                        if (!empty($crm_details['data']['property_type'])) {
                            $ownership = ($crm_details['data']['property_type'] == "Rented" ? "No" : "Yes");
                        } else {
                            $ownership = "Yes";
                        }
                    }

                    $url_api .= "?Key=$Key&Format=JSON&API_Action=pingPostLead&Mode=post&Source=$google_ts&Return_Best_Price=1&TYPE=33&IP_Address=$IPAddress&Landing_Page=$OriginalURL2&User_Agent=$UserAgent&TCPA_Consent=$tcpa_compliant2&TCPA_Language=$TCPAText&LeadiD_Token=$LeadId&Trusted_Form_URL=$trusted_form&Address=$street&Zip=$zip&City=$city&State=$statename_code&Homeowner=$ownership&xxTrustedFormCertUrl=$trusted_form&Sub_ID=$google_ts&Pub_ID=$google_ts&Best_Call_Time=Anytime&Lead_ID=$TransactionId&First_Name=$first_name&Last_Name=$last_name&Primary_Phone=$number1&Email=$email&Home_Phone=$number1";

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "windows";
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $Project_Type_Windows = ($project_nature == "Repair" ? "Repair" : "Replace");
                            $Windows_Material = "Not Sure";
                            $number_of_windows = ($number_of_windows == "10+" ? "10%2B" : $number_of_windows);

                            if (strpos("-" . strtolower($campaign_name), 'premium') == true) {
                                $SRC = "Allied_Digital_Media_windows_premium";
                            } else {
                                $SRC = "Allied_Digital_Media_windows";
                            }

                            switch ($number_of_windows) {
                                case '1':
                                    $Category_Windows = ($project_nature == "Repair" ? "Windows Repair" : "Windows Install - Single");
                                    $Project = ($project_nature == "Repair" ? "Windows Repair" : "Windows Replace - Single");
                                    break;
                                default:
                                    $Category_Windows = ($project_nature == "Repair" ? "Windows Repair" : "Windows Install - Multiple");
                                    $Project = ($project_nature == "Repair" ? "Windows Repair" : "Windows Replace - Multiple");
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&Category_Windows=$Category_Windows&Project_Type_Windows=$Project_Type_Windows&Windows_Number=$number_of_windows&Windows_Material=$Windows_Material";
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "roofs";
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $Project_Type_Roofs = ($project_nature == "Repair existing roof" ? "Repair" : "New Home");
                            $Roof_Job = ($project_nature == "Repair existing roof" ? "Roof Repair" : "Roof Install");

                            if (strpos("-" . strtolower($campaign_name), 'premium') == true) {
                                $SRC = "Allied_Digital_Media_roofs_premium";
                            } else {
                                $SRC = "Allied_Digital_Media_roofs";
                            }

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $Project = "Roofing Shingle";
                                    $Roof_Material = "Asphalt Shingle";
                                    $Category_Roofs = ($project_nature == "Repair existing roof" ? "Roof Repair - Asphalt Shingle" : "Roof Install - Asphalt Shingle");
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $Project = "Roofing Other";
                                    $Roof_Material = "Wood Shake/Comp";
                                    $Category_Roofs = ($project_nature == "Repair existing roof" ? "Roof Repair - Wood Shake/Comp" : "Roof Install - Wood Shake/Comp");
                                    break;
                                case "Metal Roofing":
                                    $Project = "Roofing Metal";
                                    $Roof_Material = "Metal";
                                    $Category_Roofs = ($project_nature == "Repair existing roof" ? "Roof Repair - Metal" : "Roof Install - Metal");
                                    break;
                                case "Natural Slate Roofing":
                                    $Project = "Roofing Slate";
                                    $Roof_Material = "Natural Slate";
                                    $Category_Roofs = ($project_nature == "Repair existing roof" ? "Roof Repair - Natural Slate" : "Roof Install - Natural Slate");
                                    break;
                                case "Tile Roofing":
                                default:
                                    $Project = "Roofing Tile";
                                    $Roof_Material = "Tile";
                                    $Category_Roofs = ($project_nature == "Repair existing roof" ? "Roof Repair - Tile" : "Roof Install - Tile");
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&Category_Roofs=$Category_Roofs&Project_Type_Roofs=$Project_Type_Roofs&Roof_Job=$Roof_Job&Roof_Material=$Roof_Material";
                            break;
                        case 8:
                            //Kitchen
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "remodel";
                            $Project = "Remodel Kitchen";
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $Remodeling_type = "Kitchen Remodel";
                            $SRC = "Allied_Digital_Media_remodel";

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&Remodeling=$Remodeling_type";
                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "bathrooms";
                            $Project = "Remodel Bathroom";
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $Category_Bathroom = "Bathroom Remodel - Vanity, Fixtures, Sinks, Toilets, Other";
                            $Remove_Walls = "No";

                            if (strpos("-" . strtolower($campaign_name), 'premium') == true) {
                                $SRC = "Allied_Digital_Media_bathrooms_premium";
                            } else {
                                $SRC = "Allied_Digital_Media_bathrooms";
                            }

                            switch ($bathroom_type_name) {
                                case "Flooring":
                                    $Project_Type_Bathroom = "Flooring";
                                    break;
                                case "Shower / Bath":
                                    $Project_Type_Bathroom = "Shower Bath";
                                    $Category_Bathroom = "Bathroom Remodel - Bathtub to Shower Conversion";
                                    break;
                                case "Sinks":
                                    $Project_Type_Bathroom = "Sinks";
                                    break;
                                case "Toilet":
                                    $Project_Type_Bathroom = "Toilet";
                                    break;
                                case "Full Remodel":
                                default:
                                    $Project_Type_Bathroom = "Full Remodel";
                                    $Category_Bathroom = "Bathroom Remodel - Complete Remodel";
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&Category_Bathroom=$Category_Bathroom&Project_Type_Bathroom=$Project_Type_Bathroom&Remove_Walls=$Remove_Walls";
                            break;
                        case 11:
                            //Furnace
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "hvac";
                            $Project = ($project_nature == "Repair" ? "HVAC Repair" : "HVAC Replace");
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $Air_Type_HVAC = "Heating";
                            $Project_Type_HVAC = ($project_nature == "Repair" ? "Repair" : "New unit installed");
                            $SRC = "Allied_Digital_Media_hvac";

                            switch ($type_of_heating) {
                                case "Oil":
                                    $HVAC_type = ($project_nature == "Repair" ? "Oil Furnace - Repair" : "Oil Furnace - Install");
                                    $System_Type_HVAC = "Oil furnace";
                                    break;
                                case "Electric":
                                    $HVAC_type = ($project_nature == "Repair" ? "Electric Furnace - Repair" : "Electric Furnace - Install");
                                    $System_Type_HVAC = "Electric furnace";
                                    break;
                                case "Propane Gas":
                                    $HVAC_type = ($project_nature == "Repair" ? "Propane Furnace - Repair" : "Propane Furnace - Install");
                                    $System_Type_HVAC = "Propane furnace";
                                    break;
                                case "Natural Gas":
                                default:
                                    $HVAC_type = ($project_nature == "Repair" ? "Gas Furnace - Repair" : "Gas Furnace - Install");
                                    $System_Type_HVAC = "Gas furnace";
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&HVAC=$HVAC_type&System_Type_HVAC=$System_Type_HVAC&Air_Type_HVAC=$Air_Type_HVAC&Project_Type_HVAC=$Project_Type_HVAC";
                            break;
                        case 12:
                            //boiler
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "hvac";
                            $Project = ($project_nature == "Repair" ? "HVAC Repair" : "HVAC Replace");
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $HVAC_type = ($project_nature == "Repair" ? "Boiler Repair/Service" : "Boiler Install/Replace");
                            $Air_Type_HVAC = "Heating";
                            $Project_Type_HVAC = ($project_nature == "Repair" ? "Repair" : "New unit installed");
                            $SRC = "Allied_Digital_Media_hvac";

                            switch ($type_of_heating) {
                                case "Oil":
                                    $System_Type_HVAC = "Oil boiler";
                                    break;
                                case "Electric":
                                    $System_Type_HVAC = "Electric boiler";
                                    break;
                                case "Propane Gas":
                                    $System_Type_HVAC = "Propane boiler";
                                    break;
                                case "Natural Gas":
                                default:
                                    $System_Type_HVAC = "Gas boiler";
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&HVAC=$HVAC_type&System_Type_HVAC=$System_Type_HVAC&Air_Type_HVAC=$Air_Type_HVAC&Project_Type_HVAC=$Project_Type_HVAC";
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "hvac";
                            $Project = ($project_nature == "Repair" ? "HVAC Repair" : "HVAC Replace");
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $HVAC_type = ($project_nature == "Repair" ? "Central A/C - Repair/Service" : "Central A/C - Install/Replace");
                            $System_Type_HVAC = "Central AC";
                            $Air_Type_HVAC = " Heating and cooling";
                            $Project_Type_HVAC = ($project_nature == "Repair" ? "Repair" : "New unit installed");
                            $SRC = "Allied_Digital_Media_hvac";

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&HVAC=$HVAC_type&System_Type_HVAC=$System_Type_HVAC&Air_Type_HVAC=$Air_Type_HVAC&Project_Type_HVAC=$Project_Type_HVAC";
                            break;
                        case 21:
                            //Gutter
                            $service = trim($crm_details['data']['service']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $Vertical = "gutters";
                            $Project = ($project_nature == "Repair" ? "Gutter Repair" : "Gutter Replace");
                            $start_time_data = ($start_time == "Immediately" ? "Immediately" : "1-3 months");
                            $SRC = "Allied_Digital_Media_gutters";

                            switch ($service) {
                                case "Copper":
                                    $Gutters_type = ($project_nature == "Repair" ? "Copper Gutters - Repair" : "Copper Gutters - Install");
                                    break;
                                case "Galvanized Steel":
                                    $Gutters_type = ($project_nature == "Repair" ? "Galvanized Gutters - Repair" : "Galvanized Gutters - Install");
                                    break;
                                case "PVC":
                                    $Gutters_type = ($project_nature == "Repair" ? "PVC Gutters - Repair" : "PVC Gutters - Install");
                                    break;
                                case "Seamless Aluminum":
                                    $Gutters_type = ($project_nature == "Repair" ? "Seamless Metal Gutters - Repair" : "Seamless Metal Gutters - Install");
                                    break;
                                case "Wood":
                                    $Gutters_type = ($project_nature == "Repair" ? "Wood Gutters - Repair" : "Wood Gutters - Install");
                                    break;
                                default:
                                    $Gutters_type = "Install or Replace Gutter Covers and Accessories";
                            }

                            $url_api .= "&SRC=$SRC&Vertical=$Vertical&Project=$Project&Timeframe=$start_time_data&Gutters=$Gutters_type";
                            break;
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $url_api .= "&Test_Lead=1";
                    }

                    $url_api = str_replace(" ", "%20", $url_api);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array_post, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['response']['status'])) {
                        if ($result2['response']['status'] == "Matched") {
                            return 1;
                        }
                    }
                    break;
                case 1044:
                    //Sunergy Solutions 1044
                    //Solar
                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);
                    $power_solution = trim($crm_details['data']['power_solution']);

                    switch ($monthly_electric_bill) {
                        case '$0 - $50':
                            $average_bill = 50;
                            break;
                        case '$51 - $100':
                            $average_bill = 100;
                            break;
                        case '$101 - $150':
                            $average_bill = 150;
                            break;
                        case '$151 - $200':
                            $average_bill = 200;
                            break;
                        case '$201 - $300':
                            $average_bill = 300;
                            break;
                        case '$301 - $400':
                            $average_bill = 400;
                            break;
                        case '$401 - $500':
                            $average_bill = 500;
                            break;
                        default:
                            $average_bill = 600;
                    }

                    $Lead_data_array = array(
                        "schema_name" => "sunergysolutions",
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zip_code" => $zip,
                        "phone" => $number1,
                        "email" => $email,
                        "lead_other" => $leadsCustomerCampaign_id,
                        "lead_source" => "ADM",
                        "lead_cost" => $Lead_Cost,
                        "customField1" => $utility_provider,
                        "customField37" => $average_bill,
                    );

                    $url_api = "http://server2.sunbasedata.com/sunbase/portal/api/lead_post.jsp";
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/x-www-form-urlencoded"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, http_build_query($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), 'successfully')) {
                        return 1;
                    }
                    break;
                case 1064:
                    //ION Solar 1064
                    $method = "allied_digital_media";
                    $api_key = "92d466ce-8ba7-4a79-9992-639c4634456a";

                    $url_api = "https://api.iondeveloper.com/rep/lead-external/lead/?api_key=$api_key&method=$method&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&street=$street&city=$city&state=$state&zip=$zip";
                    $url_api = str_replace(" ", "%20", $url_api);

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['success'])) {
                        if ($result2['success'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 1071:
                    //Astrawatt Solar 1071
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $url_api = "https://api.hsforms.com/submissions/v3/integration/submit/3446639/259c93ba-16d7-4c8b-90b8-406ff6020d21";

                    $Lead_data_array = array(
                        'fields' =>
                            array(
                                array('name' => 'firstname', 'value' => "$first_name $last_name"),
                                array('name' => 'email', 'value' => $email),
                                array('name' => 'phone', 'value' => $number1),
                                array('name' => 'address', 'value' => $street),
                                array('name' => 'city', 'value' => $city),
                                array('name' => 'state', 'value' => $statename_code),
                                array('name' => 'zip', 'value' => $zip)
                            ),
                        'legalConsentOptions' =>
                            array(
                                'consent' =>
                                    array(
                                        'consentToProcess' => $tcpa_compliant4,
                                        'text' => $TCPAText
                                    )
                            )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 1079:
                    //I360 Email
                    //2FL Windows & Siding 1079
                    $data = array(
                        'email' => $email,
                        'first_name' => $first_name,
                        'last_name' => $last_name,
                        'street' => $street,
                        'city' => $city,
                        'state' => $state,
                        'zip' => $zip,
                        'number1' => $number1,
                        'Interest' => $service_campaign_name,
                        'BestTimeToCall' => "Any Time",
                    );

                    Mail::send(['text' => 'Mail.wintekusa'], $data, function ($message) {
                        $message->to('eleadimport@h-2qqerto99cvqv4xq2ml0l51u4oj6fnneqxbwzydfubyk1nwa2c.u-imdwmak.na37.apex.salesforce.com', '2FL Windows & Siding')->subject('Provider = Allied Digital Media');
                        $message->from(config('mail.from.address', ''), config('mail.from.name', ''));
                    });
                    return 1;
                    break;
                case 1060:
                    // 1060 New Star Solar
                    $Lead_data_array = "";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: multipart/form-data"
                    );

                    $lead_other = config('app.name', '');
                    $lead_source = (!empty($google_ts) ? $google_ts : $lead_source_text);
                    $url_api = "https://server2.sunbasedata.com:443/sunbase/portal/api/lead_post.jsp?schema_name=newstarsolar&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&address1=$street&city=$city&state=$statename_code&zip_code=$zip&county=$county&lead_source=$lead_source&lead_other=$lead_other&customField30=1";

                    switch ($lead_type_service_id) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $electric_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $electric_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $electric_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $electric_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $electric_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $electric_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $electric_bill = 500;
                                    break;
                                default:
                                    $electric_bill = 600;
                            }

                            $url_api .= "&customField1=$utility_provider&customField37=$electric_bill";
                            break;
                    }

                    $url_api = str_replace(" ", "%20", $url_api);
                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), 'successfully')) {
                        return 1;
                    }
                    break;
                case 1093:
                    //Green Power Energy 1093
                    $url_api = "https://app.solarnexus.com/projects/captured_leads.json";

                    $account_id = 1369;
                    $job_process_id = 1139;
                    $lead_source = "Allied Digital Media";
                    $sales_owner_type_and_id = "Users::Group_69";
                    $notes = "";
                    $protection = "";

                    $Lead_data_array = "account_id=$account_id&job_process_id=$job_process_id&lead_source=$lead_source&sales_owner_type_and_id=$sales_owner_type_and_id&first_name=$first_name&last_name=$last_name&email=$email&phone=$number1&street1=$street&city=$city&state=$statename_code&zip=$zip&notes=$notes&protection=$protection";
                    $Lead_data_array = str_replace(" ", "%20", $Lead_data_array);

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "Content-Type: application/x-www-form-urlencoded"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['success'])) {
                        if ($result2['success'] == true) {
                            return 1;
                        }
                    }
                    break;
                case 1107:
                    //MKT Remodel 1107
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $api_key = "M12K45T78R7410-M12K45T78R7410M8520D963E789L456";
                    $url_api = "https://app.mktremodel.com/api/post/leads";
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data = array(
                        "api_key" => $api_key,
                        "address" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zipcode" => $zip,
                        "session_length" => $SessionLength,
                        "ip_address" => $IPAddress,
                        "landing_page_url" => $OriginalURL2,
                        "browser_name" => $lead_browser_name,
                        "user_agent" => $UserAgent,
                        "trusted_form" => $trusted_form,
                        "universal_leadid" => $LeadId,
                        "tcpa_compliant" => $tcpa_compliant,
                        "tcpa_text" => $TCPAText,
                        "sub_id" => $google_ts,

                        //POST Data
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone_number" => $number1,
                        "email" => $email,
                        "ping_id" => $TransactionId,
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //Windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $affiliate_id = "1683915449";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['windows_number'] = $number_of_windows;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['start_time'] = $start_time;
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $affiliate_id = "1683915583";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['power_solution'] = $power_solution;
                            $Lead_data['roof_shade'] = $roof_shade;
                            $Lead_data['monthly_electric_bill'] = $monthly_electric_bill;
                            $Lead_data['property_type'] = $property_type;
                            $Lead_data['utility_provider'] = $utility_provider;
                            break;
                        case 4:
                            //Flooring
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $affiliate_id = "1687093619";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['type_of_flooring'] = $Type_OfFlooring;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $affiliate_id = "1683915484";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['roof_type'] = $roof_type;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['property_type'] = $property_type;
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $affiliate_id = "1687093663";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['type_of_siding'] = $type_of_siding;
                            $Lead_data['project_nature'] = $project_nature;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 8:
                            //Kitchen
                            $service_kitchen = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $demolishing_walls = trim($crm_details['data']['demolishing_walls']);

                            $affiliate_id = "1691139695";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['kitchen_type'] = $service_kitchen;
                            $Lead_data['removing_adding_walls'] = $demolishing_walls;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 9:
                            //BathRoom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $affiliate_id = "1683915531";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['bathroom_type'] = $bathroom_type_name;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['ownership'] = $ownership;
                            break;
                        case 21:
                            //Gutter
                            $start_time = trim($crm_details['data']['start_time']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $service = trim($crm_details['data']['service']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $affiliate_id = "1685699688";

                            $Lead_data['affiliate_id'] = $affiliate_id;
                            $Lead_data['ownership'] = $ownership;
                            $Lead_data['start_time'] = $start_time;
                            $Lead_data['gutter_material'] = $service;
                            $Lead_data['project_nature'] = $project_nature;
                            break;
                        default:
                            return 0;
                    }

                    if (config('app.env', 'local') == "local") {
                        //Test Mode
                        $Lead_data['is_test'] = 1;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "Success") {
                            return 1;
                        }
                    }
                    break;
                case 1124:
                    //Sun Lux 1124
                    $lead_source = "Allied Leads";
                    $OID = "00D4T000000FDdI";

                    $Lead_data_array = "";
                    $httpheader = array();

                    $url_api = "http://go.sunlux.com/l/818773/2023-06-06/2mr51m";
                    $url_api .= "?email=$email&phone=$number1&firstname=$first_name&lastname=$last_name&address=$street&city=$city&state=$statename_code&zip=$zip&Comments=$google_ts&retURL=$url_api&lead_source=$lead_source&oid=$OID";
                    $url_api = str_replace(" ", "%20", $url_api);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 1135:
                    //HomeAppointments 1135
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://contractorkings.leadportal.com/apiJSON.php";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    if (!empty($crm_details['data']['homeOwn'])) {
                        $ownership = ($crm_details['data']['homeOwn'] != "Yes" ? "No" : "Yes");
                    } else {
                        if (!empty($crm_details['data']['property_type'])) {
                            $ownership = ($crm_details['data']['property_type'] == "Rented" ? "No" : "Yes");
                        } else {
                            $ownership = "Yes";
                        }
                    }

                    $Lead_data_array = array(
                        "Request" => array(
                            "Format" => "JSON",
                            "Key" => "cea311c55d1bf96c94c4fd9d81d997ba02a3b7cf958967a2f03228a7c6b37a5c",
                            "API_Action" => "pingPostLead",
                            "Mode" => "post",
                            "Return_Best_Price" => "1",
                            "SRC_ID" => $google_ts,
                            "TYPE" => 38,
                            "IP_Address" => $IPAddress,
                            "SRC" => "Allied",
                            "Landing_Page" => $OriginalURL2,
                            "Sub_ID" => $google_ts,
                            "Pub_ID" => $lead_source_text,
                            "User_Agent" => $UserAgent,
                            "TCPA_Consent" => $tcpa_compliant2,
                            "TCPA_Language" => $TCPAText,
                            "Trusted_Form_URL" => $trusted_form,
                            "LeadiD_Token" => $LeadId,
                            "City" => $city,
                            "State" => $statename_code,
                            "Zip" => $zip,
                            "Homeowner" => $ownership,

                            "First_Name" => $first_name,
                            "Last_Name" => $last_name,
                            "Address" => $street,
                            "Lead_ID" => $TransactionId,
                            "Email" => $email,
                            "Primary_Phone" => $number1
                        )
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);

                            $Lead_data_array['Request']['Trade'] = "Windows";
                            $Lead_data_array['Request']['Number_Of_Windows'] = $number_of_windows;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair" ? "Repair" : "Replacement");
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Unknown";
                            }

                            $Lead_data_array['Request']['Trade'] = "Solar";
                            $Lead_data_array['Request']['Utility_Provider'] = $utility_provider;
                            $Lead_data_array['Request']['Average_Monthly_Utility_Bill'] = $average_bill;
                            $Lead_data_array['Request']['Shade'] = $roof_shade_data;
                            break;
                        case 4:
                            //Flooring
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $typeOfFlooring = "Vinyl/Linoleum";
                                    break;
                                case "Tile Flooring":
                                    $typeOfFlooring = "Tile";
                                    break;
                                case "Hardwood Flooring":
                                    $typeOfFlooring = "Hardwood";
                                    break;
                                case "Laminate Flooring":
                                    $typeOfFlooring = "Laminate";
                                    break;
                                default:
                                    $typeOfFlooring = "Carpet";
                            }

                            $Lead_data_array['Request']['Trade'] = "Flooring";
                            $Lead_data_array['Request']['Flooring_Type'] = $typeOfFlooring;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair Existing Flooring" ? "Repair" : "Replacement");
                            break;
                        case 5:
                            //WALK-IN TUBS
                            $Lead_data_array['Request']['Trade'] = "Walk-in Tub";
                            break;
                        case 6:
                            //Roofing
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $roof_type = trim($crm_details['data']['roof_type']);

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $Project = "Shingle";
                                    break;
                                case "Metal Roofing":
                                    $Project = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $Project = "Slate";
                                    break;
                                case "Tile Roofing":
                                    $Project = "Tile";
                                    break;
                                default:
                                    $Project = "Other";
                            }

                            $Lead_data_array['Request']['Trade'] = "Roofing";
                            $Lead_data_array['Request']['Roofing_Type'] = $Project;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair existing roof" ? "Repair" : "Replacement");
                            break;
                        case 7:
                            //Home Siding
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);

                            switch ($type_of_siding) {
                                case "Vinyl Siding":
                                    $type_of_siding_data = "Vinyl";
                                    break;
                                case "Composite wood Siding":
                                    $type_of_siding_data = "Wood";
                                    break;
                                case "Fiber Cement Siding":
                                    $type_of_siding_data = "Cement";
                                    break;
                                default:
                                    $type_of_siding_data = "Other";
                            }

                            $Lead_data_array['Request']['Trade'] = "Siding";
                            $Lead_data_array['Request']['Siding_Type'] = $type_of_siding_data;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair section(s) of siding" ? "Repair" : "Replacement");
                            break;
                        case 8:
                            //Kitchen
                            $Lead_data_array['Request']['Trade'] = "Kitchen";
                            break;
                        case 9:
                            //Bathroom
                            $Lead_data_array['Request']['Trade'] = "Bathroom Remodel";
                            break;
                        case 11:
                            //Furnace
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($type_of_heating) {
                                case "Electric":
                                    $type_of_heating_data = "Electric Heat";
                                    break;
                                case "Oil":
                                    $type_of_heating_data = "Oil Heat";
                                    break;
                                default:
                                    $type_of_heating_data = "Gas Heat";
                            }

                            $Lead_data_array['Request']['Trade'] = "HVAC";
                            $Lead_data_array['Request']['Heating_Type'] = $type_of_heating_data;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair" ? "Repair" : "Replacement");
                            break;
                        case 12:
                            //Boiler
                            $type_of_heating = trim($crm_details['data']['type_of_heating']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($type_of_heating) {
                                case "Electric":
                                    $type_of_heating_data = "Electric Heat";
                                    break;
                                case "Oil":
                                    $type_of_heating_data = "Oil Heat";
                                    break;
                                default:
                                    $type_of_heating_data = "Gas Heat";
                            }

                            $Lead_data_array['Request']['Trade'] = "HVAC";
                            $Lead_data_array['Request']['Heating_Type'] = $type_of_heating_data;
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair" ? "Repair" : "Replacement");
                            break;
                        case 13:
                            //Central A/C
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $Lead_data_array['Request']['Trade'] = "HVAC";
                            $Lead_data_array['Request']['AC_Type'] = "Central Air";
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair" ? "Repair" : "Replacement");
                            break;
                        case 21:
                            //Gutter
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $Lead_data_array['Request']['Trade'] = ($project_nature == "Repair" ? "Gutter Repair" : "Gutter Replacement");
                            $Lead_data_array['Request']['Project_Type'] = ($project_nature == "Repair" ? "Repair" : "Replacement");
                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['Request']['State'] = "AK";
                        $Lead_data_array['Request']['Zip'] = "99999";
                        $Lead_data_array['Request']['Test_Lead'] = "1";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['response']['status'])) {
                        if ($result2['response']['status'] == "Matched") {
                            $TransactionId = $result2['response']['lead_id'];
                            return $TransactionId;
                        }
                    }
                    return 0;
                case 1115:
                    //J Chamberlain LLC 1115

//                    //go high level
//                    $url_api_post = "https://rest.gohighlevel.com/v1/contacts/";
//                    $gohighlevelkey = "1eb52e74-abbc-4615-b931-c5f34d253c96";
//                    $httpheader = array(
//                        'Accept: application/json',p
//                        'Content-Type: application/json',
//                        "Authorization: Bearer $gohighlevelkey"
//                    );
//
//                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
//                    $utility_provider = trim($crm_details['data']['utility_provider']);
//                    $roof_shade = trim($crm_details['data']['roof_shade']);
//                    $property_type = trim($crm_details['data']['property_type']);
//                    $power_solution = trim($crm_details['data']['power_solution']);
//
//                    $monthly_bill = str_replace(" ", "", $monthly_electric_bill);
//                    $monthly_bill = str_replace("$", "", $monthly_bill);
//                    $ownership = ($property_type == "Rented" ? "No" : "Yes");
//
//                    $Lead_data_array = array(
//                        "email" => $email,
//                        "phone" => "+1$number1",
//                        "firstName" => $first_name,
//                        "lastName" => $last_name,
//                        "name" => "$first_name $last_name",
//                        "address1" => $street,
//                        "city" => $city,
//                        "state" => $statename_code,
//                        "country" => "US",
//                        "website" => $OriginalURL2,
//                        "tags" => array("Allied Digital"),
//                        "postalCode" => $zip,
////                        "1n3YkEN19cyQMyr8V5vl" => $ownership,//homeowner
////                        "KTOHXaHkI41rSktqa3gD" => $roof_shade, //Roof Shaded
////                        "3jid87FTFLUh5V1HYRzN" => $monthly_bill, //Monthly Electric Bill
////                        "KihWZ5OP2JcnzssXOzsJ" => $utility_provider //Utility Providers
//                    );
//
//                    $result =  $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
//                    return 1;

                    // Monday CRM
                    $url_api = "https://forms.monday.com/forms/baf8ba8177c0789817bcfc92d946d9ee/submit_form?r=use1";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    $Lead_data_array = array(
                        "answers" => array(
                            "text0" => $roof_shade,
                            "text1" => $monthly_electric_bill,
                            "text16" => $property_type,
                            "name" => "$first_name $last_name",
                            "address" => $street,
                            "homeowners_phone2" => "1$number1",
                            "homeowners_e_mail6" => $email,
                            "notes" => "Zip Code: $zip"
                        ),
                        "form-timezone-offset" => 480
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['creation_result'])) {
                        if ($result2['creation_result'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 1142:
                    //LGCY Power 1142
                    $username = "allieddigitalmedia";
                    $password = "Solar2023!";
                    $api_key = "gg84ewdj8ef2839vreghjsdfh3829HhEIhgo8475houwdhfHD";
                    $url_api = "http://lgcy-marketplace.com/api/createlead/?username=$username&api_key=$api_key";

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);
                    $property_type = trim($crm_details['data']['property_type']);

                    switch ($roof_shade) {
                        case "Mostly Shaded":
                            $roof_shade_data = "medium";
                            break;
                        case "Partial Sun":
                            $roof_shade_data = "little";
                            break;
                        default:
                            $roof_shade_data = "none";
                    }

                    $Lead_data_array = array(
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone" => $number1,
                        "email" => $email,
                        "street" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zip" => $zip,
                        "provider" => "Allied Digital Media",
                        "recipient" => "LGCY Power",
                        "external_id" => $leadsCustomerCampaign_id,
                        "shade_amount" => $roof_shade_data,
                        "is_homeowner" => ($property_type == "Owned" ? "True" : "False"),
                        "utility_bill" => $monthly_electric_bill,
                        "utility_company" => $utility_provider,
                        "sub_lead_source" => $google_ts,
                        "lead_cost" => $Lead_Cost
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 466:
                    //Install America 466
                    //Hatch API ======================================================
                    $url_api_post = "https://api.usehatchapp.com/v1/contacts";

                    $httpheader = array(
                        'Authorization: Bearer 781f453d-2df4-4e9a-9b6a-dc9982446008',
                        'Content-Type: application/json',
                        "Accept : application/json"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "source" => "custom:allied-digital-media",
                        "id" => $leadsCustomerCampaign_id,
                        "details" => array(
                            "address" => $street,
                            "city" => $city,
                            "zip" => $zip,
                            "zipcode" => $zip,
                            "state" => $statename_code
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['data']['id'])) {
                        return 1;
                    }
                    break;
                case 1137:
                    //Everything Solar 1137
                    //go high level
                    $url_api_post = "https://rest.gohighlevel.com/v1/contacts/";
                    $gohighlevelkey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbl9pZCI6IlpCdjNxbW9la0RBTDNtVXA0b2REIiwiY29tcGFueV9pZCI6IkI1ZkRGM0g3RmUwOVFCVlN3VFpoIiwidmVyc2lvbiI6MSwiaWF0IjoxNjg3ODE0Nzk3Njk1LCJzdWIiOiJ1c2VyX2lkIn0.Qx0tv4_IaMC6AYbIw6R4RievoVy-yUCcVhZxHGk8Ygs";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        "Authorization: Bearer $gohighlevelkey"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "name" => "$first_name $last_name",
                        "email" => $email,
                        "phone" => "+1$number1",
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postalCode" => $zip,
                        "website" => $OriginalURL2,
                        "country" => "US",
                        "tags" => array("Allied Digital")
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 554:
                    //K-DESIGNERS 554

                    //To Generate Token
                    $url_api_post_token = 'https://lptran.k-designers.com/main/gettoken';

                    $httpheader_token = array(
                        'apikey:h$k5NW9As',
                        'apiusername:allied',
                        'clientid:10d65a2d-d1ea-4b2b-be4a-6e50d98a6097',
                    );

                    $Lead_data_array_token = array();

                    $result_token = $crm_api_file->api_send_data($url_api_post_token, $httpheader_token, $leadsCustomerCampaign_id, $Lead_data_array_token, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result_token, true);
                    if (!empty($result2['token'])) {
                        $access_token = $result2['token'];
                        //Send Lead Info
                        $url_api_post = "https://lptran.k-designers.com/main/addlead";

                        switch ($lead_type_service_id) {
                            case 1:
                                //windows
                                $project = "window";
                                break;
                            case 7:
                                //Home Siding
                                $project = "siding";
                                break;
                        }

                        $Lead_data_array = array(
                            "firstname" => $first_name,
                            "lastname" => $last_name,
                            "address" => $street,
                            "city" => $city,
                            "state" => $statename_code,
                            "zipcode" => $zip,
                            "phone" => $number1,
                            "email" => $email,
                            "leadId" => $leadsCustomerCampaign_id,
                            "Identity" => "f9c86e0a",
                            "project" => $project,
                        );

                        $httpheader = array(
                            'Accept: application/json',
                            'Content-Type: application/json',
                            "Authorization: Bearer $access_token"
                        );

                        $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                        if (strpos("-" . $result, 'Accepted') == true) {
                            return 1;
                        }
                    }


                    break;
                case 1141:
                    //SolarSME - Rev-Share 1141
                    // Hubspot CRM
                    $url_api = "https://api.hubapi.com/deals/v1/deal";
                    $api_key = "pat-na1-a975f54a-801b-448f-b41b-458afa220f7d";
                    $pipelineID = 753170;
                    $stageId = 2560120;

                    $httpheader = array(
                        "Authorization: Bearer $api_key",
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = "{\r\n  \"properties\": [\r\n
{\r\n      \"name\": \"dealname\",\r\n          \"value\": \"$first_name $last_name\"\r\n},
\r\n
{\r\n      \"name\": \"first_name\",\r\n      \"value\": \"$first_name\"\r\n},
\r\n
{\r\n      \"name\": \"last_name\",\r\n       \"value\": \"$last_name\"\r\n},
\r\n
{\r\n      \"name\": \"email\",\r\n        \"value\": \"$email\"\r\n},
\r\n
{\r\n      \"name\": \"phone\",\r\n        \"value\": \"$number1\"\r\n},
\r\n
{\r\n      \"name\": \"address\",\r\n    \"value\": \"$street, $city, $state $zip\"\r\n},
\r\n
{\r\n      \"name\": \"dealtype\",\r\n          \"value\": \"newbusiness\"\r\n},
\r\n
{\r\n      \"name\": \"city\",\r\n        \"value\": \"$city\"\r\n},
\r\n
{\r\n      \"name\": \"zipcode\",\r\n           \"value\": \"$zip\"\r\n},
\r\n
{\r\n      \"name\": \"lead_link\",\r\n            \"value\": \"Allied-Digital-Media\"\r\n},
\r\n
{\r\n      \"name\": \"dealstage\",\r\n            \"value\": \"$stageId\"\r\n},
\r\n
{\r\n      \"name\": \"pipeline\",\r\n            \"value\": \"$pipelineID\"\r\n}
\r\n
]\r\n}";

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "error") {
                            return 0;
                        }
                    }
                    return 1;
                    break;
                case 1167:
                    //Gutter Guards America 1167
                    $url_api = "https://7575520.extforms.netsuite.com/app/site/hosting/scriptlet.nl?script=821&deploy=1&compid=7575520&h=eab87992765d318ca65c";
                    $url_api .= "&firstName=$first_name&lastName=$last_name&primaryPhone=$number1&email=$email&address=$street&city=$city&postalCode=$zip&stateProvince=$statename_code&Source=Allied Digital Media";
                    $url_api .= "&LeadID=$leadsCustomerCampaign_id&LeadType=$Lead_Cost_type&LeadCost=$Lead_Cost";

                    switch ($crm_details['service_id']) {
                        case 21:
                            //Gutter
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $service = trim($crm_details['data']['service']);

                            if ($project_nature != "Repair") {
                                $taskName = "Gutter Installation";
                                switch ($service) {
                                    case "Copper":
                                        $Gutters_type = "Gutter Install - Copper";
                                        break;
                                    case "Galvanized Steel":
                                        $Gutters_type = "Gutter Install - Galvalnized";
                                        break;
                                    case "PVC":
                                        $Gutters_type = "Gutter Install - PVC";
                                        break;
                                    case "Seamless Aluminum":
                                        $Gutters_type = "Gutter Install – Seamless Aluminum";
                                        break;
                                    case "Wood":
                                        $Gutters_type = "Gutter Install - Wood";
                                        break;
                                    default:
                                        $Gutters_type = "Gutter Install";
                                }
                            } else {
                                $taskName = "Gutter Guards";
                                $Gutters_type = "Gutter Repair";
                            }

                            $url_api .= "&taskName=$taskName&Product=$Gutters_type";
                            break;
                    }

                    $url_api = str_replace(" ", "%20", $url_api);

                    $Lead_data_array = "";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "GET", 1, $crm_details['campaign_id']);
                    if (str_contains(strtolower($result), 'saved')) {
                        return 1;
                    }
                    break;
                case 1172:
                    //Houston Window Experts 1172
                    $requestID = session_id();
                    $accountID = '2453EF2C2E6A3A14B6D650AB23FB0B90';
                    $secretKey = 'B18375225FE67E01316FB0AE08E01402';
                    $method = 'createLeads';
                    $campaignIDSS = "200000002427906";
                    $url_api = "http://api.sharpspring.com/pubapi/v1/?accountID=$accountID&secretKey=$secretKey";

                    $Lead_data_array = '{
                      "method":"' . $method . '",
                      "params":
                        {"objects":
                          [
                            {
                                "firstName": "' . $first_name . '",
                                "lastName": "' . $last_name . '",
                                "street": "' . $street . '",
                                "city": "' . $city . '",
                                "state": "' . $statename_code . '",
                                "zipcode": "' . $zip . '",
                                "emailAddress": "' . $email . '",
                                "phoneNumber": "' . $number1 . '",
                                "campaignID": "' . $campaignIDSS . '"
                            }
                          ]
                        },
                      "id":"' . $requestID . '"
                    }';

                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (empty($result2['error'])) {
                        return 1;
                    }
                    break;
                case 1182:
                    //Independent Home - Walk-In Tubs - Hybrid
                    $url_api = "https://leadsource-independenthome.force.com/LeadService/services/apexrest/LeadService";
                    $httpheader = array(
                        'Content-Type: application/json'
                    );

                    $start_time = trim($crm_details['data']['start_time']);
                    $ownership = trim($crm_details['data']['homeOwn']);
                    $reason = trim($crm_details['data']['reason']);
                    $features = trim($crm_details['data']['features']);

                    $timeframe = ($start_time == 'Immediately' ? 'Within 1 week' : 'More than 2 weeks');
                    $homeowner = ($ownership == 'Yes' ? "Yes" : "No");

                    switch ($reason) {
                        case "Safety":
                            $reasonData = "Safety Reasons";
                            break;
                        case "Therapeutic":
                            $reasonData = "Therapeutic Relief";
                            break;
                        default:
                            $reasonData = "Other Benefits";
                    }

                    $Lead_data_array = '{
                        "leads": [
                            {
                                "Company": "Allied Digital Media",
                                "FirstName": "' . $first_name . '",
                                "LastName" : "' . $last_name . '",
                                "Phone" : "' . $number1 . '",
                                "Email" : "' . $email . '",
                                "Street" : "' . $street . '",
                                "City" : "' . $city . '",
                                "State" : "' . $statename_code . '",
                                "PostalCode" : "' . $zip . '",
                                "LeadSource" : "' . $lead_source_name . '",
                                "Status" : "New Lead",
                                "Tub_Requirements_Long__c" : "' . $features . '",
                                "Cost__c" : "' . $Lead_Cost . '",
                                "Desired_Timeframe__c" : "' . $timeframe . '",
                                "Home_Owner__c" : "' . $homeowner . '",
                                "Reason_for_Interest__c" : "' . $reasonData . '"
                            }
                        ]
                    }';

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    if (str_contains($result, "1 successes")) {
                        return 1;
                    }
                    break;
                case 1185:
                    //1185 Home Guard Telecom
                    // Hubspot CRM
                    $url_api = "https://api.hubapi.com/contacts/v1/contact";
                    $api_key = "pat-na1-dbca5e6c-5ad5-47a9-976c-150acd2660d6";

                    $httpheader = array(
                        "Authorization: Bearer $api_key",
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = "{\r\n  \"properties\": [\r\n
{\r\n      \"property\": \"email\",\r\n          \"value\": \"$email\"\r\n},
\r\n
{\r\n      \"property\": \"firstname\",\r\n      \"value\": \"$first_name\"\r\n},
\r\n
{\r\n      \"property\": \"lastname\",\r\n       \"value\": \"$last_name\"\r\n},
\r\n
{\r\n      \"property\": \"website\",\r\n        \"value\": \"Allied-Digital-Media\"\r\n},
\r\n
{\r\n      \"property\": \"company\",\r\n        \"value\": \"\"\r\n},
\r\n
{\r\n      \"property\": \"phone\",\r\n          \"value\": \"$number1\"\r\n},
\r\n
{\r\n      \"property\": \"address\",\r\n        \"value\": \"$street\"\r\n},
\r\n
{\r\n      \"property\": \"city\",\r\n           \"value\": \"$city\"\r\n},
\r\n
{\r\n      \"property\": \"state\",\r\n          \"value\": \"$state\"\r\n},
\r\n
{\r\n      \"property\": \"zip\",\r\n            \"value\": \"$zip\"\r\n}
\r\n  ]\r\n}";

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "error") {
                            return 0;
                        }
                    }
                    return 1;
                    break;
                case 1196:
                    //Revamp LLC  1196
                    $data = array(
                        'email' => $email,
                        'first_name' => $first_name,
                        'last_name' => $last_name,
                        'street' => $street,
                        'city' => $city,
                        'state' => $state,
                        'zip' => $zip,
                        'number1' => $number1,
                        'Interest' => $service_campaign_name,
                        'BestTimeToCall' => "Any Time",
                    );

                    Mail::send(['text' => 'Mail.wintekusa'], $data, function ($message) {
                        $message->to('05b6sp1p7ih29ob3bkc0e15ubltxvgta@hook.us1.make.com', 'Revamp')->subject('Provider = Allied Digital Media');
                        $message->from(config('mail.from.address', ''), config('mail.from.name', ''));
                    });
                    return 1;
                    break;
                case 1204:
                    //Paramount Builders 1204
                    $url_api = "https://leads-inst354-client.phonexa.com/lead/";
                    $apiId = "A5BFDCAC70C04174A8DF653C3AD23B3A";
                    $apiPassword = "690d018731";

                    $Lead_data_array = array(
                        "apiId" => $apiId,
                        "apiPassword" => $apiPassword,
                        "productId" => "191",
                        "price" => $Lead_Cost,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "state" => $statename_code,
                        "zip" => $zip,
                        "firstName" => $first_name,
                        "address" => $street,
                        "city" => $city,
                        "lastName" => $last_name,
                        "source" => $OriginalURL
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            // Windows
                            $categ = "Win";
                            $number_of_windows = trim($crm_details['data']['number_of_window']);

                            $Lead_data_array['numWindows'] = $number_of_windows;
                            $Lead_data_array['productCategory'] = $categ;
                            break;
                        case 6:
                            // Roofing
                            $categ = "Roof";
                            $Lead_data_array['productCategory'] = $categ;
                            break;
                        case 7:
                            // Siding
                            $categ = "Sid";
                            $Lead_data_array['productCategory'] = $categ;
                            break;
                        case 9:
                            // Bathroom
                            $categ = "Shwr";
                            $Lead_data_array['productCategory'] = $categ;
                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['firstName'] = "ALLIED";
                        $Lead_data_array['lastName'] = "DIGITAL MARKETING";
                    }

                    $httpheader = array();

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status_text'])) {
                        if ($result2['status_text'] == "sold") {
                            return 1;
                        }
                    }
                    break;
                case 183:
                    //Improveit USA - Hybrid 183
                    //Hatch API ======================================================
                    $url_api = "https://api.usehatchapp.com/v1/contacts";

                    $httpheader = array(
                        'Authorization: Bearer 60b582f9-ac3b-4fa4-83e7-094213a0f122',
                        'Content-Type: application/json',
                        "Accept: application/json"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "source" => "custom:allieddigital",
                        "id" => $leadsCustomerCampaign_id,
                        "details" => array(
                            "address" => $street,
                            "city" => $city,
                            "zip" => $zip,
                            "zipcode" => $zip,
                            "state" => $statename_code
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['data']['id'])) {
                        return 1;
                    }
                    break;
                case 1209:
                    //Bliss Tubs Inc. 1209
                    // Hubspot CRM
                    $url_api = "https://api.hubapi.com/contacts/v1/contact";
                    $api_key = "pat-na1-f86053b7-acf5-49c3-91f3-297edd2da541";

                    $httpheader = array(
                        "Authorization: Bearer $api_key",
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = "{\r\n  \"properties\": [\r\n
{\r\n      \"property\": \"email\",\r\n          \"value\": \"$email\"\r\n},
\r\n
{\r\n      \"property\": \"firstname\",\r\n      \"value\": \"$first_name\"\r\n},
\r\n
{\r\n      \"property\": \"lastname\",\r\n       \"value\": \"$last_name\"\r\n},
\r\n
{\r\n      \"property\": \"website\",\r\n        \"value\": \"Allied-Digital-Media\"\r\n},
\r\n
{\r\n      \"property\": \"company\",\r\n        \"value\": \"\"\r\n},
\r\n
{\r\n      \"property\": \"phone\",\r\n          \"value\": \"$number1\"\r\n},
\r\n
{\r\n      \"property\": \"address\",\r\n        \"value\": \"$street\"\r\n},
\r\n
{\r\n      \"property\": \"city\",\r\n           \"value\": \"$city\"\r\n},
\r\n
{\r\n      \"property\": \"state\",\r\n          \"value\": \"$state\"\r\n},
\r\n
{\r\n      \"property\": \"zip\",\r\n            \"value\": \"$zip\"\r\n}
\r\n  ]\r\n}";

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "error") {
                            return 0;
                        }
                    }
                    return 1;
                    break;
                case 1051:
                    //Mid America Exteriors	1051
                    //Hatch API ======================================================
                    $url_api = "https://api.usehatchapp.com/v1/contacts";

                    $httpheader = array(
                        'Authorization: Bearer 8a4d5cd6-c458-435c-93f0-f14ef68f3522',
                        'Content-Type: application/json',
                        "Accept: application/json"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "source" => "custom:allied-digitial",
                        "id" => $leadsCustomerCampaign_id,
                        "details" => array(
                            "address" => $street,
                            "city" => $city,
                            "zip" => $zip,
                            "zipcode" => $zip,
                            "state" => $statename_code
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['data']['id'])) {
                        return 1;
                    }
                    break;
                case 1217:
                    //Five Miles Media  1217
                    $Type_OfFlooring = trim($crm_details['data']['flooring_type']);

                    $url_api = "https://leads.pipes.ai/api/lead";
                    $api_key = "PKr0MwvyAWxeQRdMjqpkO61LqBDbdJj2";
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data = array(
                        "api_key" => $api_key,
                        "phone_number" => $number1,
                        "postal_code" => $zip,
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "email" => $email,
                        "address_1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "subid_1" => $google_ts,
                        "subid_2" => $leadsCustomerCampaign_id,
                        "subid_3" => $Type_OfFlooring,
                        "cost" => $Lead_Cost,
                        "subid_4" => "Flooring",
                        "subid_10" => 55,
                        "tcpa_consent" => 1,
                        "tcpa_consent_date" => date("Y-m-d"),
                        "jornaya_leadid" => $LeadId
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['success'])) {
                        if ($result2['success'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 1208:
                    //ExchangeFlo 1208
                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $data = explode("_", $data_msg['ping_post_data']['TransactionId']);
                        $TransactionId = $data[0];
                        $submission_id = $data[1];
                        $unique = $data[2];
                    } else {
                        return 0;
                    }

                    $url_api = "https://pub.exchangeflo.io/api/leads/post";
                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json",
                        "Authorization: Bearer 2a3a8dbf-ab46-4f8c-80ac-98773b528f02"
                    );

                    $Lead_data_array = array(
                        "response_type" => "detail",
                        "lead_type" => "mixed",
                        "tracking_id" => $unique,
                        "ip_address" => $IPAddress,
                        "landing_url" => $OriginalURL2,
                        "user_agent" => $UserAgent,
                        "tcpa" => $TCPAText,
                        "sub_id_1" => $lead_source_text,
                        "ping_ids" => array($TransactionId),
                        "profile" => array(
                            "zip" => $zip,
                            "email" => $email,
                            "phone" => $number1,
                            "address" => $street,
                            "city" => $city,
                            "state" => $statename_code,
                            "first_name" => $first_name,
                            "last_name" => $last_name,
                        ),
                        "submission_id" => $submission_id,
                        "trusted_form_cert_url" => $trusted_form,
                        "jornaya_leadid" => $LeadId
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? true : false);
                            switch ($number_of_windows) {
                                case "1":
                                    $wndw_number = 1;
                                    break;
                                case "2":
                                    $wndw_number = 2;
                                    break;
                                case "3-5":
                                    $wndw_number = 5;
                                    break;
                                case "6-9":
                                    $wndw_number = 8;
                                    break;
                                default:
                                    $wndw_number = 10;
                            }

                            $Lead_data_array['source_id'] = "86e48d30-b02a-43fa-81ce-e8b490b23b28";
                            $Lead_data_array['profile']['property_owner'] = $homeowner;
                            $Lead_data_array['profile']['property_type'] = "single_family";
                            $Lead_data_array['profile']['num_windows'] = $wndw_number;
                            $Lead_data_array['profile']['window_age'] = "10";
                            $Lead_data_array['profile']['window_material'] = "unknown";
                            $Lead_data_array['profile']['credit'] = "good";
                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == "Rented" ? false : true);
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "unshaded";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "full_shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "partial_shade";
                                    break;
                                default:
                                    $roof_shade_data = "unknown";
                            }

                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $Lead_data_array['source_id'] = "242ca35b-5c80-4ae4-a1f5-362cd8e3e1d6";
                            } else {
                                $Lead_data_array['source_id'] = "9560ddcc-1da4-41ef-b5ef-c7861acef1a1";
                            }

                            $Lead_data_array['profile']['utility_bill'] = $average_bill;
                            $Lead_data_array['profile']['utility_company'] = $utility_provider;
                            $Lead_data_array['profile']['property_owner'] = $homeowner;
                            $Lead_data_array['profile']['roof_shading'] = $roof_shade_data;
                            $Lead_data_array['profile']['credit'] = "good";
                            $Lead_data_array['profile']['property_type'] = "single_family";
                            break;
                        case 9:
                            //Bathroom
                            $Lead_data_array['source_id'] = "c7d76b74-da2e-4086-ab8d-95a92f3c5c0a";
                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['test'] = "true";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "success") {
                            return 1;
                        }
                    }
                    break;
                case 1226:
                    //1226 Srinergy
                    // Hubspot CRM
                    $url_api = "https://api.hubapi.com/contacts/v1/contact";
                    $api_key = "pat-na1-9b04cda5-e8a9-4e73-98bb-791206e7a10c";

                    $httpheader = array(
                        "Authorization: Bearer $api_key",
                        'Accept: application/json',
                        'Content-Type: application/json'
                    );

                    $Lead_data_array = "{\r\n  \"properties\": [\r\n
{\r\n      \"property\": \"email\",\r\n          \"value\": \"$email\"\r\n},
\r\n
{\r\n      \"property\": \"firstname\",\r\n      \"value\": \"$first_name\"\r\n},
\r\n
{\r\n      \"property\": \"lastname\",\r\n       \"value\": \"$last_name\"\r\n},
\r\n
{\r\n      \"property\": \"website\",\r\n        \"value\": \"Allied-Digital-Media\"\r\n},
\r\n
{\r\n      \"property\": \"company\",\r\n        \"value\": \"\"\r\n},
\r\n
{\r\n      \"property\": \"phone\",\r\n          \"value\": \"$number1\"\r\n},
\r\n
{\r\n      \"property\": \"address\",\r\n        \"value\": \"$street\"\r\n},
\r\n
{\r\n      \"property\": \"city\",\r\n           \"value\": \"$city\"\r\n},
\r\n
{\r\n      \"property\": \"state\",\r\n          \"value\": \"$state\"\r\n},
\r\n
{\r\n      \"property\": \"zip\",\r\n            \"value\": \"$zip\"\r\n}
\r\n  ]\r\n}";

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, $Lead_data_array, "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "error") {
                            return 0;
                        }
                    }
                    return 1;
                    break;
                case 722:
                    // 722 EcoView Windows of South Central Florida
                    $url_api = "http://www.lightfirecrm.com/api/post_lead_lf.php";
                    $api_key = "9F386ABD-D945-4684-AD2F-4CE54B703AD1";
                    $leadSrce = "AlliedDigitalMedia";
                    $program = "Windows";

                    $httpheader = array();

                    $Lead_data_array = array(
                        "api_key" => $api_key,
                        "lead_source" => $leadSrce,
                        "ext_lead_id" => $google_ts,
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "street" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zip" => $zip,
                        "email" => $email,
                        "number1" => $number1,
                        "program" => $program,
                        "jornaya_id" => $LeadId,
                        "trusted_form" => $trusted_form
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, http_build_query($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    if (!empty($result)) {
                        if (!str_contains(strtolower($result), 'success')) {
                            return 0;
                        }
                    }
                    return 1;
                    break;
                case 1246:
                    //VIP Response B.V 1246

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://admin.vipleads.nl/api/ping/tree/buyers";
                    $httpheader = array(
                        "X-AUTH-TOKEN: 63dc6d66f26b7db5ebc8cb912a67eff0",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data_array = array(
                        "seller_lead_id" => $TransactionId,
                        "firstname" => $first_name,
                        "lastname" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                        "street" => $street,
                        "city" => $city,
                        "zip" => $zip,
                        "state" => $statename_code,
                        "ip" => $IPAddress,
                        "user_agent" => $UserAgent,
                        "source_id" => $google_ts,
                        "source_url" => $OriginalURL2,
                        "certification_1" => $trusted_form,
                        "certification_2" => $LeadId,
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);

                            $Lead_data_array['campaign_id'] = "108";
                            $Lead_data_array['questions'] = array(
                                "question_1" => array(
                                    "question" => "Service",
                                    "answer" => $project_nature,
                                ),
                                "question_2" => array(
                                    "question" => "Homeowner",
                                    "answer" => $ownership,
                                ),
                                "question_3" => array(
                                    "question" => "Number of Windows",
                                    "answer" => $number_of_windows,
                                ),
                                "question_4" => array(
                                    "question" => "TCPA Statement",
                                    "answer" => $TCPAText,
                                ),
                            );

                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $residential = ($property_type == "Residential" ? "Yes" : "No");

                            switch ($project_nature) {
                                case "Install roof on new construction":
                                    $project_nature_data = "Install new roof";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "Replace existing roof";
                                    break;
                                default:
                                    $project_nature_data = "Repair existing roof";
                            }
                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roofType = "asphalt";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofType = "wood";
                                    break;
                                case "Metal Roofing":
                                    $roofType = "metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofType = "slate";
                                    break;
                                default:
                                    $roofType = "asphalt";
                            }

                            $Lead_data_array['campaign_id'] = "111";
                            $Lead_data_array['questions'] = array(
                                "question_1" => array(
                                    "question" => "Roofing Service",
                                    "answer" => $project_nature_data,
                                ),
                                "question_2" => array(
                                    "question" => "Homeowner",
                                    "answer" => $residential,
                                ),
                                "question_3" => array(
                                    "question" => "Roofing Material",
                                    "answer" => $roofType,
                                ),
                            );

                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['response']['status']) && $result2['response']['status'] != "400") {
                        if ($result2['response']['message'] == "OK" && $result2['response']['status'] == "200") {
                            return 1;
                        }
                    }
                    break;
                case 1237:
                    //Tampa Bay Solar 1237

                    $url_api = "https://tampabaysolar.myfreshworks.com/crm/sales/api/contacts";
                    $httpheader = array(
                        "Authorization: Token wjKSvY3bxXf2xqrKsdJIQw",
                        "content-type: application/json"
                    );

                    $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                    $utility_provider = trim($crm_details['data']['utility_provider']);
                    $roof_shade = trim($crm_details['data']['roof_shade']);

                    $Lead_data_array = array(
                        "contact" => array(
                            "first_name" => $first_name,
                            "last_name" => $last_name,
                            "address" => $street,
                            "city" => $city,
                            "state" => $statename_code,
                            "zipcode" => $zip,
                            "emails" => $email,
                            "mobile_number" => $number1,
                            "custom_field" => array(
                                "cf_utility_provider" => $utility_provider,
                                "cf_average_electric_bill" => $monthly_electric_bill,
                                "cf_additional_details" => "Roof Shade: " . $roof_shade,
                                "cf_lead_sale_type" => "New Lead",
                                "cf_lead_industry" => "Solar",
                                "cf_lead_price" => $Lead_Cost,
                            ),
                            "campaign_id" => $leadsCustomerCampaign_id,
                            "lead_source_id" => $google_ts,
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2["contact"])) {
                            return 1;
                        }
                    }
                    return 0;
                case 1245:
                    //Sanrgy 1245

                    $url_api = "https://rest.gohighlevel.com/v1/contacts/";
                    $httpheader = array(
                        "Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbl9pZCI6IkJTRTdFaTFSM1Vrd0FHNXNXdklmIiwiY29tcGFueV9pZCI6IkI1ZkRGM0g3RmUwOVFCVlN3VFpoIiwidmVyc2lvbiI6MSwiaWF0IjoxNjc2NDgwNDI1ODQ1LCJzdWIiOiJQNXJROUJraWU0T0xWTUdBSTdlSSJ9.9f2Ia6cbbRfitVWQkCcz7L0ZUQg68t-O07gTzPB_hT4",
                        "content-type: application/json"
                    );
                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "name" => $first_name . " " . $last_name,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postalCode" => $zip,
                        "email" => $email,
                        "phone" => $number1,
                        "companyName" => "Allied digital media",
                        "country" => "US",
                        "sales_rep" => "Jessica Fristoe",
                        "source_name" => "AlliedLead",
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if (!empty($result2["contact"])) {
                            return 1;
                        }
                    }
                    return 0;
                case 1267:
                    //Centauri Systems 12676
                    //go high level
                    $url_api_post = "https://rest.gohighlevel.com/v1/contacts/";
                    $gohighlevelkey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJsb2NhdGlvbl9pZCI6InI2R3pxRDdyRm04THZNMHJSR2RDIiwiY29tcGFueV9pZCI6IlRUbWwwSXpBMWxGY2Q2cW9VNzdhIiwidmVyc2lvbiI6MSwiaWF0IjoxNzAwMTY0MjA0Njc5LCJzdWIiOiJ1c2VyX2lkIn0.gqrPdVJzVn_93FS_TRNPsHKH6cZLxjIwR_3Wp6hu7NM";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        "Authorization: Bearer $gohighlevelkey"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "name" => "$first_name $last_name",
                        "email" => $email,
                        "phone" => "+1$number1",
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postalCode" => $zip,
                        "website" => $OriginalURL2,
                        "tags" => array("Allied Digital")
                    );

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 1273:
                    //Markytek 1273

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://api.leadprosper.io/post";
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data_array = array(
                        "lp_ping_id" => $TransactionId,
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "email" => $email,
                        "phone" => $number1,
                        "address" => $street,
                        "jornaya_leadid" => $LeadId,
                        "trustedform_cert_url" => $trusted_form,
                        "zip_code" => $zip,
                        "state" => $statename_code,
                        "ip_address" => $IPAddress,
                        "user_agent" => $UserAgent,
                        "landing_page_url" => $OriginalURL2,
                        "city" => $city,
                        "lp_subid1" => $google_ts,
                        "TCPA" => "Yes",
                        "tcpa_language" => $TCPAText,
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);

                            switch ($number_of_windows) {
                                case "1":
                                    $wndw_number = 1;
                                    break;
                                case "2":
                                    $wndw_number = 2;
                                    break;
                                case "3-5":
                                    $wndw_number = 5;
                                    break;
                                case "6-9":
                                    $wndw_number = 8;
                                    break;
                                default:
                                    $wndw_number = 10;
                            }
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");
                            $project_nature_data = ($project_nature == "Repair" ? "repair" : "new");

                            $Lead_data_array['lp_campaign_id'] = "19758";
                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $Lead_data_array['lp_supplier_id'] = "47887";
                                $Lead_data_array['lp_key'] = "z2dlc3p7xiw3wl";
                            } else {
                                $Lead_data_array['lp_supplier_id'] = "48537";
                                $Lead_data_array['lp_key'] = "qq0jh5rw2fgw17";
                            }
                            $Lead_data_array['number_of_windows'] = $wndw_number;
                            $Lead_data_array['homeowner'] = $homeowner;
                            $Lead_data_array['service_type'] = $project_nature_data;
                            $Lead_data_array['property_type'] = "residential";

                            break;
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == "Rented" ? "No" : "Yes");
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "Full Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "Partial";
                                    break;
                                default:
                                    $roof_shade_data = "Partial";
                            }

                            $Lead_data_array['lp_campaign_id'] = "19754";
                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $Lead_data_array['lp_supplier_id'] = "47885";
                                $Lead_data_array['lp_key'] = "0enof1qrmtozor";
                            } else {
                                $Lead_data_array['lp_supplier_id'] = "48535";
                                $Lead_data_array['lp_key'] = "w3z7beyk3i0edp";
                            }
                            $Lead_data_array['electric_provider'] = $utility_provider;
                            $Lead_data_array['homeowner'] = $homeowner;
                            $Lead_data_array['shade'] = $roof_shade_data;
                            $Lead_data_array['electric_bill_monthly'] = $average_bill;
                            break;
                        case 6:
                            //Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $residential = ($property_type == "Residential" ? "residential" : "commercial");

                            switch ($project_nature) {
                                case "Install roof on new construction":
                                    $project_nature_data = "new";
                                    break;
                                case "Completely replace roof":
                                    $project_nature_data = "replace";
                                    break;
                                default:
                                    $project_nature_data = "repair";
                            }

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Asphalt Shingle';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Asphalt Shingle';
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Asphalt Shingle';
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install-Wood Shake/Comp.';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Wood Shake';
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Wood Shake/Comp.';
                                    }
                                    break;
                                case  "Metal Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Metal';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Metal';
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Metal';
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Natural Slate';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Natural Slate';
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Natural Slate';
                                    }
                                    break;
                                case "Tile Roofing":
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $task_id = 'Roof Install - Tile';
                                            break;
                                        case "Completely replace roof":
                                            $task_id = 'Roof Replace - Tile';
                                            break;
                                        default:
                                            $task_id = 'Roof Repair - Tile';
                                    }
                                    break;
                                default:
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $roofing_material = "Other";
                                            break;
                                        case "Completely replace roof":
                                            $roofing_material = "Other";
                                            break;
                                        default:
                                            $roofing_material = "Other";
                                    }
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $Timeframe = "immediate";
                                    break;
                                case "Within 6 months":
                                    $Timeframe = "Over 2 weeks";
                                    break;
                                default:
                                    $Timeframe = "1-2_week";
                            }

                            $Lead_data_array['lp_campaign_id'] = "19756";
                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $Lead_data_array['lp_supplier_id'] = "47886";
                                $Lead_data_array['lp_key'] = "gg2ptdvepa5e5x";
                            } else {
                                $Lead_data_array['lp_supplier_id'] = "48536";
                                $Lead_data_array['lp_key'] = "vzevcgy35hkvw2";
                            }
                            $Lead_data_array['homeowner'] = "Yes";
                            $Lead_data_array['service_type'] = $project_nature_data;
                            $Lead_data_array['time_frame'] = $Timeframe;
                            $Lead_data_array['property_type'] = $residential;
                            $Lead_data_array['task_id'] = $task_id;

                            break;
                        case 9:
                            //Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            switch ($bathroom_type_name) {
                                case "Cabinets / Vanity":
                                    $bathroom_type_name_data = "Bathroom Remodeling - Cabinets Vanity";
                                    break;
                                case "Flooring":
                                    $bathroom_type_name_data = "Bathroom Remodeling - Flooring";
                                    break;
                                case "Shower / Bath":
                                    $bathroom_type_name_data = "Bathroom Remodeling - Shower Bath";
                                    break;
                                case "Sinks":
                                    $bathroom_type_name_data = "Bathroom Remodeling - Sinks";
                                    break;
                                case "Toilet":
                                    $bathroom_type_name_data = "Bathroom Remodeling - Toilet";
                                    break;
                                default:
                                    $bathroom_type_name_data = "Bathroom - Other";
                            }

                            switch ($start_time) {
                                case 'Immediately':
                                    $start_time_data = "immediately";
                                    break;
                                case 'Within 6 months':
                                    $start_time_data = "1_3_months";
                                    break;
                                default:
                                    $start_time_data = "3_plus_months";
                            }

                            $Lead_data_array['lp_campaign_id'] = "20024";
                            if (strpos("-" . strtolower($campaign_name), 'affiliate') == true) {
                                $Lead_data_array['lp_supplier_id'] = "47888";
                                $Lead_data_array['lp_key'] = "7jodb3rqztdldg";
                            } else {
                                $Lead_data_array['lp_supplier_id'] = "48538";
                                $Lead_data_array['lp_key'] = "oj50bkp5vb7r2m";
                            }
                            $Lead_data_array['project_type'] = $bathroom_type_name_data;
                            $Lead_data_array['homeowner'] = $homeowner;
                            $Lead_data_array['property_type'] = "Single Family Home";
                            $Lead_data_array['trustedform_cert_url'] = $trusted_form;
                            $Lead_data_array['tcpa_text'] = $TCPAText;
                            $Lead_data_array['tcpa_optin'] = "Yes";

                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['lp_action'] = "test";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "ACCEPTED") {
                            return 1;
                        }
                    }
                    break;
                case 1281:
                    // 1281	Vista Home Improvement
                    $url_api = "https://app.channelautomation.com/api/iwh/f679c637c6a1427c5d544dad74f1e74e";

                    $httpheader = array(
                        "Content-Type: application/json",
                        "Accept: application/json"
                    );

                    $service_name = ucfirst($crm_details['service_campaign_name']);

                    $Lead_data_array = array(
                        "leadData" => array(
                            "firstName" => $first_name,
                            "lastName" => $last_name,
                            "email" => "$email",
                            "phone" => $number1,
                            "address" => $street,
                            "city" => $city,
                            "state" => $statename_code,
                            "tcpaCompliance" => array(
                                "isCompliant" => $tcpa_compliant4,
                                "consentTimestamp" => date('Y-m-d H:i:s'),
                                "consentMethod" => "online form"
                            ),
                            "additionalInfo" => array(
                                "vertical" => $service_name,
                            ),
                        ),
                        "optInStatus" => array(
                            "canEmail" => true,
                            "canSMS" => true,
                            "canCall" => true
                        ),
                        "privacyPolicyAgreement" => array(
                            "hasAgreed" => true,
                            "agreementTimestamp" => date('Y-m-d H:i:s')
                        ),
                        "sender" => "Allied Digital Media"
                    );

                    switch ($lead_type_service_id) {
                        case 6:
                            // Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $residential = ($property_type == "Residential" ? "Yes" : "No");

                            $Lead_data_array['leadData']['additionalInfo']['RoofType'] = $roof_type;
                            $Lead_data_array['leadData']['additionalInfo']['ProjectNature'] = $project_nature;
                            $Lead_data_array['leadData']['additionalInfo']['StartTime'] = $start_time;
                            $Lead_data_array['leadData']['additionalInfo']['ResidentialProperty'] = $residential;
                            break;
                        case 9:
                            // Bathroom
                            $bathroom_type_name = trim($crm_details['data']['services']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            $Lead_data_array['leadData']['additionalInfo']['ServiceType'] = $bathroom_type_name;
                            $Lead_data_array['leadData']['additionalInfo']['PropertyOwner'] = $ownership;
                            $Lead_data_array['leadData']['additionalInfo']['StartTime'] = $start_time;
                            break;
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if ($result2["status"] == "ok") {
                            return 1;
                        }
                    }
                    break;
                case 1291:
                    //Energy Pal 1291

                    if (!empty($data_msg['ping_post_data']['TransactionId'])) {
                        $TransactionId = $data_msg['ping_post_data']['TransactionId'];
                    } else {
                        return 0;
                    }

                    $url_api = "https://api.energypal.com/api/v1/leads/post";
                    $httpheader = array(
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    $Lead_data_array = array(
                        "cid" => "xjx02mz0kok8sia1",
                        "ping_id" => $TransactionId,
                        "universal_leadid" => $LeadId,
                        "ip_address" => $IPAddress,
                        "tcpa_text" => $TCPAText,
                        "first_name" => $first_name,
                        "last_name" => $last_name,
                        "phone" => $number1,
                        "email" => $email,
                        "address" => array(
                            "street" => $street,
                            "city" => $city,
                            "state" => $statename_code,
                            "zip" => $zip,
                            "country" => "US",
                        )
                    );

                    switch ($lead_type_service_id) {
                        case 2:
                            //Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == "Rented" ? "No" : "Yes");
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = 50;
                                    break;
                                case '$51 - $100':
                                    $average_bill = 100;
                                    break;
                                case '$101 - $150':
                                    $average_bill = 150;
                                    break;
                                case '$151 - $200':
                                    $average_bill = 200;
                                    break;
                                case '$201 - $300':
                                    $average_bill = 300;
                                    break;
                                case '$301 - $400':
                                    $average_bill = 400;
                                    break;
                                case '$401 - $500':
                                    $average_bill = 500;
                                    break;
                                default:
                                    $average_bill = 600;
                            }

                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Unsure";
                            }

                            $Lead_data_array['ownership'] = $homeowner;
                            $Lead_data_array['electric_bill'] = $average_bill;
                            $Lead_data_array['electric_utility'] = $utility_provider;
                            $Lead_data_array['roof_shade'] = $roof_shade_data;
                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['test'] = true;
                        $Lead_data_array['zip'] = "90001";
                        $Lead_data_array['state'] = "CA";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'])) {
                        if ($result2['status'] == "accepted") {
                            return 1;
                        }
                    }
                    break;
                case 1300:
                    //1300 iRadius Group
                    $url_api_post = "https://prodhimprove.iradiusleads.com/post.aspx";

                    $httpheader = array(
                        "content-type: text/xml"
                    );

                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                    $Lead_data_post = '<Request>
                            <Vendor>';

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_post .= '<IsTest>1</IsTest>';
                    } else {
                        $Lead_data_post .= '<IsTest>0</IsTest>';
                    }

                    $Lead_data_post .= '<VendorId>10117</VendorId>
                                       <SubVendorId>' . $lead_source_text . '</SubVendorId>';

                    switch ($lead_type_service_id) {
                        case 2:
                            // Solar
                            $Lead_data_post .= '<LeadTypeId>19</LeadTypeId>';
                            break;
                        default:
                            $Lead_data_post .= '<LeadTypeId>20</LeadTypeId>';
                    }

                    $Lead_data_post .= '
                        <IPAddress>' . $IPAddress . '</IPAddress>
                        <UniqueId>' . $leadsCustomerCampaign_id . '</UniqueId>
                        <LeadId>' . $TransactionId . '</LeadId>
                        <LeadMetaData>
                            <ULeadId>' . $LeadId . '</ULeadId>
                            <ULeadIdTCPA>True</ULeadIdTCPA>
                            <NonLeadIdTCPA>False</NonLeadIdTCPA>
                            <ClientUserAgent>' . $UserAgent . '</ClientUserAgent>
                            <TCPAInfo>
                                <LeadCreationDate>' . date("Y-m-d\TH:i:s", time()) . '</LeadCreationDate>
                                <ConsentInfo ConsentType="Active" ConsumerConsented="True">' . $TCPAText . '</ConsentInfo>
                                <LeadIdTCPADisclosure>True</LeadIdTCPADisclosure>
                                <xxTrustedFormCertUrl>' . $trusted_form . '</xxTrustedFormCertUrl>
                                <LandingPageUrl>' . $OriginalURL2 . '</LandingPageUrl>
                            </TCPAInfo>
                        </LeadMetaData>
                    </Vendor>
                    <Contact>
                        <City>' . $city . '</City>
                        <State>' . $statename_code . '</State>
                        <ZIPCode>' . $zip . '</ZIPCode>
                        <FirstName>' . $first_name . '</FirstName>
                        <LastName>' . $last_name . '</LastName>
                        <Address>' . $street . '</Address>
                        <EmailAddress>' . $email . '</EmailAddress>
                        <HomePhoneNumber>' . $number1 . '</HomePhoneNumber>
                        <WorkPhoneNumber>' . $number1 . '</WorkPhoneNumber>
                        <WhenToContact>Anytime</WhenToContact>';

                    switch ($lead_type_service_id) {
                        case 1:
                            //windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $start_time_data = ($start_time == "Immediately" ? "Ready Now" : "1 to 3 Months");
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $Lead_data_post .= '</Contact>
                                <HomeImprove>
                                     <TimeFrame>' . $start_time_data . '</TimeFrame>
                                     <ProjectType>Windows</ProjectType>
                                     <ResidenceType>' . $homeowner . '</ResidenceType>
                                </HomeImprove>';
                            break;
                        case 2:
                            // Solar
                            $url_api_post = "https://prodsolar.iradiusleads.com/post.aspx";

                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $homeowner = ($property_type == "Rented" ? "No" : "Yes");
                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                    $average_bill = "$0-50";
                                    break;
                                case '$51 - $100':
                                    $average_bill = "$51-100";
                                    break;
                                case '$101 - $150':
                                    $average_bill = "$101-150";
                                    break;
                                case '$151 - $200':
                                    $average_bill = "$151-200";
                                    break;
                                case '$201 - $300':
                                    $average_bill = "$201-300";
                                    break;
                                case '$301 - $400':
                                    $average_bill = "$301-400";
                                    break;
                                case '$401 - $500':
                                    $average_bill = "$401-500";
                                    break;
                                default:
                                    $average_bill = "$501-600";
                            }
                            switch ($roof_shade) {
                                case "Full Sun":
                                    $roof_shade_data = "No Shade";
                                    break;
                                case "Mostly Shaded":
                                    $roof_shade_data = "A Lot Of Shade";
                                    break;
                                case "Partial Sun":
                                    $roof_shade_data = "A Little Shade";
                                    break;
                                default:
                                    $roof_shade_data = "Unknown";
                            }

                            $Lead_data_post .= '
                                <DOB>1990-05-15</DOB>
                            </Contact>
                            <Solar>
                                <RoofShade>' . $roof_shade_data . '</RoofShade>
                                <MonthlyBill>' . $average_bill . '</MonthlyBill>
                                <HomeOwner>' . $homeowner . '</HomeOwner>
                                <TimeFrame>Timing is Flexible</TimeFrame>
                                <CurrentProvider>Unsure/Not Listed</CurrentProvider>
                                <CreditScore>Good</CreditScore>
                                <RoofType>Unsure/Other</RoofType>
                                <PropertyType>Single Family</PropertyType>
                            </Solar>';
                            break;
                        case 6:
                            //Roofing
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $start_time_data = ($start_time == "Immediately" ? "Ready Now" : "1 to 3 Months");
                            $residential = ($property_type == "Residential" ? "Own" : "Rent");

                            $Lead_data_post .= '</Contact>
                                <HomeImprove>
                                     <TimeFrame>' . $start_time_data . '</TimeFrame>
                                     <ProjectType>Roofing</ProjectType>
                                     <ResidenceType>' . $residential . '</ResidenceType>
                                </HomeImprove>';
                            break;
                        case 7:
                            // Home Siding
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $start_time_data = ($start_time == "Immediately" ? "Ready Now" : "1 to 3 Months");
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $Lead_data_post .= '</Contact>
                                <HomeImprove>
                                     <TimeFrame>' . $start_time_data . '</TimeFrame>
                                     <ProjectType>Siding</ProjectType>
                                     <ResidenceType>' . $homeowner . '</ResidenceType>
                                </HomeImprove>';
                            break;
                        case 8:
                            // Kitchen
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $start_time_data = ($start_time == "Immediately" ? "Ready Now" : "1 to 3 Months");
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $Lead_data_post .= '</Contact>
                                <HomeImprove>
                                     <TimeFrame>' . $start_time_data . '</TimeFrame>
                                     <ProjectType>Kitchen Remodeling</ProjectType>
                                     <ResidenceType>' . $homeowner . '</ResidenceType>
                                </HomeImprove>';
                            break;
                        case 9:
                            // Bathroom
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);

                            $start_time_data = ($start_time == "Immediately" ? "Ready Now" : "1 to 3 Months");
                            $homeowner = ($ownership == "Yes" ? "Own" : "Rent");

                            $Lead_data_post .= '</Contact>
                                <HomeImprove>
                                     <TimeFrame>' . $start_time_data . '</TimeFrame>
                                     <ProjectType>Bathroom Remodeling</ProjectType>
                                     <ResidenceType>' . $homeowner . '</ResidenceType>
                                </HomeImprove>';
                            break;
                    }

                    $Lead_data_post .= '</Request>';

                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                    try {
                        libxml_use_internal_errors(true);
                        $result2 = simplexml_load_string($result);
                        $result3 = json_encode($result2);
                        $result4 = json_decode($result3, TRUE);

                        if (!empty($result4)) {
                            if (!empty($result4['Status'])) {
                                if ($result4['Status'] == "Accepted") {
                                    return 1;
                                }
                            }
                        }
                    } catch (Exception $e) {

                    }
                    break;
                case 1308:
                    //1308 Premier Home Pros
                    $url_api = "https://lms.outboundani.com/capture/allgqQ2mKrFVAJ0TAXdS2";

                    $httpheader = array();

                    $Lead_data_array = array(
                        "Vendor" => "AlliedDigital",
                        "firstname" => $first_name,
                        "lastname" => $last_name,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zip" => $zip,
                        "phone1" => $number1,
                        "email" => $email,
                        "vendor_source" => $lead_source_text,
                        "vendor_subsource" => $google_ts,
                        "sroid" => $leadsCustomerCampaign_id,
                        "lead_fee" => $Lead_Cost
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, http_build_query($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if ($result2["message"] == "ok") {
                            return 1;
                        }
                    }
                    return 0;
                    break;
                case 1296:
                    // 1296	Blue Fire Leads
                    $url_api = "https://affiliate.bluefireleads.com/api/v2/leads/post";

                    $httpheader = array(
                        "content-type: application/json",
                        "user-agent: $UserAgent"
                    );

                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                    $VendorId = "c5f62ee1-0911-4bf3-8fda-e44ebd81a97f";

                    $Lead_data_array = array(
                        "VendorId" => $VendorId,
                        "Zip" => $zip,
                        "LeadTokenId" => $LeadId,
                        "TrustCert" => $trusted_form,
                        "Tcpa" => $TCPAText,
                        "IpAddress" => $IPAddress,
                        "CreatedDate" => gmdate("Y-m-d\TH:i:s\Z"),
                        "Source" => $lead_source_text,
                        "PingId" => $TransactionId,
                        "PhoneNumber" => $number1,
                        "FirstName" => $first_name,
                        "LastName" => $last_name,
                        "Email" => $email,
                        "RequestUrl" => $OriginalURL2,
                        "Address" => $street,
                        "City" => $city,
                        "State" => $statename_code
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            // Windows
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($project_nature) {
                                case "Install":
                                case "Replace":
                                    $proNature = "Replace";
                                    break;
                                default:
                                    $proNature = "Repair";
                            }

                            $Lead_data_array['Industry'] = "windows_category";
                            $Lead_data_array['WorkType'] = $proNature;
                            $Lead_data_array['WindowCount'] = $number_of_windows;
                            break;
                        case 6:
                            // Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            switch ($project_nature) {
                                case "Install roof on new construction":
                                case "Completely replace roof":
                                    $project_nature_data = "Replace";
                                    break;
                                default:
                                    $project_nature_data = "Repair";
                            }
                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $roofType = "Asphalt";
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $roofType = "Wood";
                                    break;
                                case "Metal Roofing":
                                    $roofType = "Metal";
                                    break;
                                case "Natural Slate Roofing":
                                    $roofType = "Slate";
                                    break;
                                default:
                                    $roofType = "Asphalt";
                            }

                            $Lead_data_array['Industry'] = "roofing_category";
                            $Lead_data_array['WorkType'] = $project_nature_data;
                            $Lead_data_array['Material'] = $roofType;
                            break;
                        case 9:
                            // Bathroom

                            $Lead_data_array['Industry'] = "bath_category";
                            $Lead_data_array['WorkType'] = "Replace";
                            break;
                        case 7:
                            $typeOfSiding = trim($crm_details['data']['type_of_siding']);
                            $sidingMapping = [
                                "Vinyl Siding" => "Vinyl",
                                "Composite wood Siding" => "Wood",
                                "Aluminum Siding" => "Metal"
                            ];
                            $Lead_data_array['Industry'] = "siding_category";
                            $Lead_data_array['Material'] = $sidingMapping["$typeOfSiding"];
                            break;
                    }

                    if (config('app.env', 'local') == "local" || !empty($data_msg['is_test'])) {
                        //Test Mode
                        $Lead_data_array['Test'] = "true";
                    }

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['data'])) {
                        if ($result2['data']['status'] == "Accepted") {
                            return 1;
                        }
                    }
                    break;
                case 1302:
                    // 1302	Morson
                    $url_api = "https://api.wiserleads.com/services/post";

                    $httpheader = array(
                        "content-type: application/json",
                        "Accept: application/json"
                    );

                    $campaignToken = "86f0148e41f1ed522a932c8821be3b7bd08f661a";
                    $campaignCode = "allieddigitalmedia";
                    $TransactionId = $data_msg['ping_post_data']['TransactionId'];

                    $Lead_data_array = array(
                        "campaign" => $campaignCode,
                        "campaign_token" => $campaignToken,
                        "lead_token" => $TransactionId,
                        "firstname" => $first_name,
                        "lastname" => $last_name,
                        "street_address" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "zipcode" => $zip,
                        "phone" => $number1,
                        "email" => $email,
                        "ip_address" => $IPAddress,
                        "tcpa_consent" => $tcpa_compliant2,
                        "tcpa_consent_language" => $TCPAText,
                        "certification_type" => "TrustedForm",
                        "certification_token" => $trusted_form
                    );

                    switch ($lead_type_service_id) {
                        case 1:
                            // Windows
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);

                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            switch ($number_of_windows) {
                                case '1':
                                    switch ($project_nature) {
                                        case "Repair":
                                            $project_type = "Repair";
                                            break;
                                        default:
                                            $project_type = "Install";
                                    }
                                    $number_windows = "1";
                                    break;
                                case '2':
                                    switch ($project_nature) {
                                        case "Repair":
                                            $project_type = "Repair";
                                            break;
                                        default:
                                            $project_type = "Install";
                                    }
                                    $number_windows = "2";
                                    break;
                                case "3-5":
                                    switch ($project_nature) {
                                        case "Repair":
                                            $project_type = "Repair";
                                            break;
                                        default:
                                            $project_type = "Install";
                                    }
                                    $number_windows = "3-5";
                                    break;
                                case "6-9":
                                default:
                                    switch ($project_nature) {
                                        case "Repair":
                                            $project_type = "Repair";
                                            break;
                                        default:
                                            $project_type = "Install";
                                    }
                                    $number_windows = "6-9";
                                    break;
                            }

                            $Lead_data_array['ownhome'] = $homeowner;
                            $Lead_data_array['service_code'] = "WINDOWS";
                            $Lead_data_array['NumberOfWindows'] = $number_windows;
                            $Lead_data_array['WindowsProjectScope'] = $project_type;
                            $Lead_data_array['WindowMaterial'] = "Vinyl";
                            break;
                        case 2:
                            // Solar
                            $monthly_electric_bill = trim($crm_details['data']['monthly_electric_bill']);
                            $utility_provider = trim($crm_details['data']['utility_provider']);
                            $roof_shade = trim($crm_details['data']['roof_shade']);
                            $property_type = trim($crm_details['data']['property_type']);
                            $power_solution = trim($crm_details['data']['power_solution']);

                            $homeowner = ($property_type == "Rented" ? "No" : "Yes");

                            switch ($monthly_electric_bill) {
                                case '$0 - $50':
                                case '$51 - $100':
                                    $average_bill = "less_than_100";
                                    break;
                                case '$101 - $150':
                                case '$151 - $200':
                                    $average_bill = "from_100_to_200";
                                    break;
                                case '$201 - $300':
                                    $average_bill = "from_200_to_300";
                                    break;
                                default:
                                    $average_bill = "more_than_300";
                            }

                            $Lead_data_array['ownhome'] = $homeowner;
                            $Lead_data_array['service_code'] = "SOLAR";
                            $Lead_data_array['monthly_bill'] = $average_bill;
                            $Lead_data_array['description'] = "Requested Solar Solution: $power_solution, Utility Provider: $utility_provider, Roof Shade: $roof_shade";
                            $Lead_data_array['house_size'] = "";
                            break;
                        case 4:
                            // Flooring
                            $Type_OfFlooring = trim($crm_details['data']['flooring_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $ownership = trim($crm_details['data']['homeOwn']);

                            switch ($Type_OfFlooring) {
                                case "Vinyl Linoleum Flooring":
                                    $serviceCode = "FLOORING_VINYL_LINOLEUM";
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $project_type = " Install";
                                            break;
                                        default:
                                            $project_type = "Repair";
                                    }
                                    break;
                                case "Tile Flooring":
                                    $serviceCode = "FLOORING_TILE";
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $project_type = "Install";
                                            break;
                                        default:
                                            $project_type = "Repair";
                                    }
                                    break;
                                case "Hardwood Flooring":
                                    $serviceCode = "FLOORING_HARDWOOD";
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $project_type = "Install";
                                            break;
                                        case "Refinish Existing Flooring":
                                            $project_type = "Refinishing";
                                            break;
                                        default:
                                            $project_type = "Repair";
                                    }
                                    $Lead_data_array['MaterialPurchase'] = "No";
                                    break;
                                case "Carpet":
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $project_type = "Install";
                                            $serviceCode = "CARPET";
                                            break;
                                        default:
                                            $serviceCode = "CARPET_REPAIR";
                                            $project_type = "Repair";
                                    }
                                    break;
                                default:
                                    $serviceCode = "FLOORING_LAMINATE";
                                    switch ($project_nature) {
                                        case "Install New Flooring":
                                            $project_type = "Install";
                                            break;
                                        default:
                                            $project_type = "Repair";
                                    }
                                    $Lead_data_array['MaterialPurchase'] = "No";
                            }

                            $homeowner = ($ownership == 'Yes' ? "Yes" : "No");


                            $Lead_data_array['ownhome'] = $homeowner;
                            $Lead_data_array['service_code'] = $serviceCode;
                            $Lead_data_array['CommercialLocation'] = "Home";
                            $Lead_data_array['FlooringProjectScope'] = $project_type;
                            break;
                        case 6:
                            // Roofing
                            $roof_type = trim($crm_details['data']['roof_type']);
                            $project_nature = trim($crm_details['data']['project_nature']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $property_type = trim($crm_details['data']['property_type']);

                            $residential = ($property_type == "Residential" ? "Yes" : "No");

                            switch ($roof_type) {
                                case "Asphalt Roofing":
                                    $serviceCode = "ROOFING_ASPHALT";
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                        case "Completely replace roof":
                                            $project_nature_data = "Completely replace roof";
                                            break;
                                        default:
                                            $project_nature_data = "Repair existing roof";
                                    }
                                    break;
                                case "Wood Shake/Composite Roofing":
                                    $serviceCode = "ROOFING_COMPOSITE";
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $project_nature_data = "Install roof on new construction";
                                            break;
                                        case "Completely replace roof":
                                            $project_nature_data = "Completely replace roof";
                                            break;
                                        default:
                                            $project_nature_data = "Repair existing roof";
                                    }
                                    break;
                                case "Metal Roofing":
                                    $serviceCode = "ROOFING_METAL";
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $project_nature_data = "Install new roof";
                                            break;
                                        case "Completely replace roof":
                                            $project_nature_data = "Replace existing roof";
                                            break;
                                        default:
                                            $project_nature_data = "Repair existing roof";
                                    }
                                    break;
                                case "Natural Slate Roofing":
                                    $serviceCode = "ROOFING_NATURAL_SLATE";
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $project_nature_data = "Install roof on new construction";
                                            break;
                                        case "Completely replace roof":
                                            $project_nature_data = "Completely replace roof";
                                            break;
                                        default:
                                            $project_nature_data = "Repair existing roof";
                                    }
                                    break;
                                default:
                                    $serviceCode = "ROOFING_TILE";
                                    switch ($project_nature) {
                                        case "Install roof on new construction":
                                            $project_nature_data = "Install roof on new construction";
                                            break;
                                        case "Completely replace roof":
                                            $project_nature_data = "Completely replace roof";
                                            break;
                                        default:
                                            $project_nature_data = "Repair existing roof";
                                    }
                            }

                            $Lead_data_array['ownhome'] = $residential;
                            $Lead_data_array['service_code'] = $serviceCode;
                            $Lead_data_array['RoofingPlan'] = $project_nature_data;
                            break;
                        case 9:
                            // Bathroom
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $homeowner = ($ownership == "Yes" ? "Yes" : "No");

                            $Lead_data_array['ownhome'] = $homeowner;
                            $Lead_data_array['service_code'] = "BATH_REMODEL";
                            $Lead_data_array['OptIn1'] = "No";
                            break;
                    }

                    $Lead_data_array['status'] = "Planning & Budgeting";
                    $Lead_data_array['timeframe'] = "Timing is Flexible";

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($Lead_data_array)), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2)) {
                        if ($result2['success'] == "true") {
                            return 1;
                        }
                    }
                    break;
                case 636:
                    //The Lead Giant
                    if ($crm_details['campaign_Type'] == 6) {
                        $url_api = "https://display.ringba.com/enrich/";
                        $fields = array(
                            "callerid" => $number1,
                            "first_name" => $first_name,
                            "last_name" => $last_name,
                            "zip" => $zip,
                            "email" => $email,
                            "Jornaya" => $LeadId,
                            "Trusted_Form_Token_Data" => $trusted_form,
                            "address_1" => $street,
                            "city" => $city,
                        );

                        $httpheader = array(
                            "cache-control: no-cache",
                            "Accept: application/json",
                            "content-type: application/json"
                        );

                        $query_fields = collect($fields)->map(function ($value, $field) {
                            return "{$field}={$value}";
                        })->implode('&');

                        switch ($lead_type_service_id) {
                            case 1:
                                $url_api .= '2368771586476999768?';
                                $url_api .= $query_fields;
                                break;
                            case 9:
                                $url_api .= '2368580709657871492?';
                                $url_api .= $query_fields;
                                break;
                        }

                        $url_api = str_replace(' ', '%20', $url_api);

                        $response = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                        $parsed_response = json_decode($response, true);

                        if (!empty($parsed_response) && $parsed_response['status'] == 'ok') {
                            return 1;
                        }
                    }
                    break;
                case 1320:
                    //JKR Windows integration
                    //go high level
                    $url_api_post = "https://rest.gohighlevel.com/v1/contacts/";
                    $gohighlevelkey = "d3e1e811-3da9-44a9-9b0d-3868756aaa77";
                    $httpheader = array(
                        'Accept: application/json',
                        'Content-Type: application/json',
                        "Authorization: Bearer $gohighlevelkey"
                    );
                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "name" => "$first_name $last_name",
                        "email" => $email,
                        "phone" => "+1$number1",
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postalCode" => $zip,
                        "website" => $OriginalURL2,
                        "country" => "US",
                        "tags" => array("Allied Digital")
                    );
                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    return 1;
                    break;
                case 1323:
                    //Hatch API ======================================================
                    //Payless Kitchens and Baths-Kitchens
                    $url_api = "https://api.usehatchapp.com/v1/contacts";
                    $httpheader = array(
                        'Authorization: Bearer ff4e2e4a-97dc-4f50-b890-079344013052',
                        'Content-Type: application/json',
                        "Accept: application/json"
                    );

                    $Lead_data_array = array(
                        "firstName" => $first_name,
                        "lastName" => $last_name,
                        "email" => $email,
                        "phoneNumber" => $number1,
                        "source" => "custom:allied-digital",
                        "id" => $leadsCustomerCampaign_id,
                        "details" => array(
                            "address" => $street,
                            "city" => $city,
                            "zip" => $zip,
                            "zipcode" => $zip,
                            "state" => $statename_code
                        )
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['data']['id'])) {
                        return 1;
                    }
                    break;
                case 1327:
                    //Five Star Bath Solutions of Minneapolis - Bathroom
                    $url_api_post = "https://serviceminder.io/service/contact/addupdate/b0dd2592b3ff4fa69ff81a6737db669c";
                    $httpheader = array(
                        'Content-Type: application/x-www-form-urlencoded',
                        "Accept: application/json"
                    );

                    $Lead_data_post = "FirstName=$first_name&LastName=$last_name&Name=$first_name.$last_name&Email=$email&Address1=$street&City=$city&Phone1=$number1&Phone1Type=Home&PostalCode=$zip";
                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                    $result2 = json_decode($result, true);
                    if (!empty($result2) && isset($result2['Message']) && $result2['Message'] == "Contact added") {
                        return 1;
                    }
                    break;
                case 1295:
                    //Creative Construction USA - Windows
                    $url_api = "https://alivo-api-production.azurewebsites.net/integration/custom/lead/create/";
                    $httpheader = array(
                        'Content-Type: application/json',
                        "Accept: application/json"
                    );

                    $Lead_data_array = array(
                        "integration_id" => "92b683945b2a42c0b7070f203c1dc992",
                        "audience_full_name" => $first_name . $last_name,
                        "audience_first_name" => $first_name,
                        "audience_last_name" => $last_name,
                        "audience_phone" => $number1,
                        "audience_email" => $email,
                        "audience_company" => "Allied Digital Media",
                        "audience_website" => $OriginalURL2,
                        "audience_phone_opt_in" => "$tcpa_compliant4",
                        "audience_email_opt_in" => "$tcpa_compliant4",
                        "audience_pipeline_stage" => "NEW"
                    );

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                    $result2 = json_decode($result, true);
                    if (!empty($result2['status'] === "success")) {
                        return 1;
                    }
                    break;
                case 1331:
                    //Five Star Franchising
                    $url_api_post = "https://serviceminder.io/service/contact/addupdate/37186e2aca004b438be1e4e7e76a0967";
                    $httpheader = array(
                        'Content-Type: application/x-www-form-urlencoded',
                        "Accept: application/json"
                    );
                    $Lead_data_array = array(
                        "FirstName" => $first_name,
                        "LastName" => $last_name,
                        "Name" => $first_name . $last_name,
                        "Email" => $email,
                        "Address1" => $street,
                        "City" => $city,
                        "Phone1" => $number1,
                        "Phone1Type" => "Home",
                        "PostalCode" => $zip,
                        "Notes" => ""
                    );
                    $Lead_data_post = "FirstName=$first_name&LastName=$last_name&Name=$first_name.$last_name&Email=$email&Address1=$street&City=$city&Phone1=$number1&Phone1Type=Home&PostalCode=$zip";
                    $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, $Lead_data_post, "POST", 1, $crm_details['campaign_id']);

                    $result2 = json_decode($result, true);
                    if (!empty($result2) && isset($result2['Message']) && $result2['Message'] == "Contact added") {
                        return 1;
                    }
                    break;
                case 1328:
                    //Floor Coverings International
                    switch ($crm_details['service_id']) {
                        case 4:
                            $url = "https://api.inspirenet.cloud/lms/v1/lead/0a316820-234a-4eea-b183-9c42bc42b8c8";

                            $project_nature = explode(' ', $crm_details['data']['project_nature'])[0]; // Repair / Install / Refinish
                            $service_type = "{$project_nature} {$crm_details['data']['flooring_type']}";

                            $fields = array(
                                "lead_id" => $LeadId,
                                "first_name" => $first_name,
                                "last_name" => $last_name,
                                "trusted_form" => $trusted_form,
                                "phone" => $number1,
                                "email" => $email,
                                "address" => $street,
                                "cost" => $Lead_Cost,
                                "service_type" => $service_type,
                                "campaign_name" => $campaign_name,
                                "zip_code" => $zip,
                                "city" => $city,
                                "state" => $statename_code
                            );

                            if (config('app.env', 'local') == 'local') {
                                $fields['zip_code'] = 11111;
                            }

                            $headers = array(
                                "Accept: application/json",
                                "content-type: application/json"
                            );

                            $response = $crm_api_file->api_send_data($url, $headers, $leadsCustomerCampaign_id, json_encode($fields), "POST", 1, $crm_details['campaign_id']);

                            $parsedResponse = json_decode($response, true);

                            if (!empty($parsedResponse) && $parsedResponse['success'] == true) {
                                return 1;
                            }

                            break;
                    }
                case 375:
                    // 375	Blue ink digital
                    switch ($crm_details['service_id']) {
                        case 24:
                            $VehicleYear = trim($crm_details['data']['VehicleYear']);
                            $VehicleMake = trim($crm_details['data']['VehicleMake']);
                            $car_model = trim($crm_details['data']['car_model']);
                            $more_than_one_vehicle = trim($crm_details['data']['more_than_one_vehicle']);
                            $driversNum = trim($crm_details['data']['driversNum']);
                            $birthday = trim($crm_details['data']['birthday']);
                            $genders = trim($crm_details['data']['genders']);
                            $married = trim($crm_details['data']['married']);
                            $license = trim($crm_details['data']['license']);
                            $InsuranceCarrier = trim($crm_details['data']['InsuranceCarrier']);
                            $driver_experience = trim($crm_details['data']['driver_experience']);
                            $number_of_tickets = trim($crm_details['data']['number_of_tickets']);
                            $DUI_charges = trim($crm_details['data']['DUI_charges']);
                            $SR_22_need = trim($crm_details['data']['SR_22_need']);
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $submodel = trim($crm_details['data']['submodel']);
                            $coverage_type = trim($crm_details['data']['coverage_type']);
                            $license_status = trim($crm_details['data']['license_status']);
                            $license_state = trim($crm_details['data']['license_state']);
                            $ticket_date = trim($crm_details['data']['ticket_date']);
                            $violation_date = trim($crm_details['data']['violation_date']);
                            $accident_date = trim($crm_details['data']['accident_date']);
                            $claim_date = trim($crm_details['data']['claim_date']);
                            $expiration_date = trim($crm_details['data']['expiration_date']);
                            $date = date('Y-m-d H:i:s');
                            $genders = trim($crm_details['data']['genders']);

                            $body = [
                                "auth_code" => $data_msg['ping_post_data']['TransactionId'],
                                "meta" =>
                                    [
                                        "originally_created" => $date,
                                        "source_id" => $lead_source_text,
                                        "user_agent" => $UserAgent,
                                        "landing_page_url" => $OriginalURL2,
                                        "tcpa_compliant" => $tcpa_compliant,
                                        "tcpa_consent_text" => $TCPAText
                                    ],
                                "contact" =>
                                    [
                                        "zip_code" => $zip,
                                        "ip_address" => $IPAddress,
                                        "first_name" => $first_name,
                                        "last_name" => $last_name,
                                        "email" => $email,
                                        "phone" => $number1,
                                        "address" => $street,
                                        "city" => $city,
                                        "state" => $statename_code
                                    ],
                                "data" =>
                                    [
                                        "drivers" =>
                                            [
                                                [
                                                    "birth_date" => $birthday,
                                                    "relationship" => "Self",
                                                    "gender" => $genders[0] ?? 'M',
                                                    "license_status" => $license_status,
                                                    "license_state" => $license_state,
                                                    "tickets" =>
                                                        [
                                                            [
                                                                "ticket_date" =>date("y-m-d", strtotime($ticket_date))
                                                            ]
                                                        ],
                                                    "major_violations" =>
                                                        [
                                                            [
                                                                "violation_date" => date("y-m-d", strtotime($violation_date))
                                                            ]
                                                        ],
                                                    "accidents" =>
                                                        [
                                                            [
                                                                "accident_date" => date("y-m-d", strtotime($accident_date))
                                                            ]
                                                        ],
                                                    "claims" =>
                                                        [
                                                            [
                                                                "claim_date" => date("y-m-d", strtotime($claim_date))
                                                            ]
                                                        ]
                                                ]
                                            ],
                                        "vehicles" =>
                                            [
                                                [
                                                    "year" => $VehicleYear,
                                                    "make" => $VehicleMake,
                                                    "model" => $car_model,
                                                    "submodel" => $submodel
                                                ]
                                            ],
                                        "requested_policy" =>
                                            [
                                                "coverage_type" => $coverage_type
                                            ],
                                        "current_policy" =>
                                            [
                                                "insurance_company" => $InsuranceCarrier,
                                                "expiration_date" => date("y-m-d", strtotime($expiration_date)),
                                                "coverage_type" => $coverage_type
                                            ]
                                    ]
                            ];

                            $httpheader = array(
                                "cache-control: no-cache",
                                "Accept: application/json",
                                "content-type: application/json",
                                "Authorization: Token ed2c54c758aa7d591af8b6f9a107063dde0070d5"
                            );
                            $url = "https://api.gateway.blueinkanalytics.com/v2/auto_insurance/post";

                            $response = $crm_api_file->api_send_data($url, $httpheader, $leadsCustomerCampaign_id, stripslashes(json_encode($body)), "POST", 1, $crm_details['campaign_id']);
                            $result2 = json_decode($response, true);
                            if (!empty($result2)) {
                                if (!empty($result2['status'])) {
                                    if ($result2['status'] == "success") {
                                        $TransactionId = $result2['confirmation_id'];
                                        $Payout = $result2['price'];
                                        $multi_type = 0;
                                        $Result = 1;
                                        return 1;
                                    }
                                }
                            }
                    }

                    break;
                case 1343:
                    //LEND HOME IMPROVEMENT
                    $url_api = "https://lendhi.leadperfection.com/batch/leadformgeneric.asp";
                    $passWordLP = '#1!askj0Rtn%';
                    $UserID = "AlliedDigitalMedia";
                    $dialed_tollfree = "0000000095";
                    $subid = "21_7_1_1_0_C23076";

                    $httpheader = array(
                        "Content-Type: application/x-www-form-urlencoded",
                    );
                    switch ($crm_details['service_id']) {
                        case 1:
                            $prog = "Window";
                            break;
                        case 9:
                            $prog = "Bathroom";
                            break;
                    }

                    $url_api .= "?FinanceProduct=$prog&FirstName=$first_name&LastName=$last_name&Address=$street&City=$city&State=$statename_code&Zip=$zip&Phone=$number1&Email=$email&dialed_tollfree=$dialed_tollfree&UserID=$UserID&Password=$passWordLP&subid=$subid";
                    $url_api = str_replace(" ", "%20", $url_api);

                    $result = $crm_api_file->api_send_data($url_api, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);
                    if (strpos("-" . strtolower($result), 'ok') == true) {
                        return 1;
                    }
                    break;
                case 667:
                    //WinTek USA
                    switch ($lead_type_service_id) {
                        case 1:
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $trusted_form_link = substr($data_msg['trusted_form'], strrpos($data_msg['trusted_form'], '/') + 1);

                            $url_api_post = "https://app.leadconduit.com/flows/65e9e6bc8438994533611203/sources/65e22c36458d897f96bfa96b/submit";
                            $httpheader = array(
                                'Accept: application/json',
                                'Content-Type: application/json',
                            );

                            $Lead_data_array = array(
                                "first_name" => $first_name,
                                "last_name" => $last_name,
                                "phone_1" => $number1,
                                "email" => $email,
                                "address_1" => $street,
                                "city" => $city,
                                "state" => $statename_code,
                                "postal_code" => $zip,
                                "source_timestamp" => date('Y-m-d H:i:s'),
                                "phonetype_wntk" => "Mobile",
                                "product" => "Windows",
                               // "submission_agent_wntk" => substr($UserAgent, 0, 255),
                                "submission_date_wntk" => date('Y-m-d H:i:s'),
                              //  "referral_url" => $OriginalURL2,
                                "service" =>$project_nature,
                               // "vendor_name" => "Allied Digital media",
                                "campaign_id" => $campaign_name,
                                "price" => $Lead_Cost,
                               // "interested_in_wntk" => "Windows",
                               // "order_purchase_date_wntk" => date('Y-m-d H:i:s'),
                               // "provider_database_wntk" => "Allied DIgital Media - Exclusive",
                                "homeowner_wntk" => $ownership,
                                "project_time_frame_wntk" => $start_time,
                                "trustedform_cert_url" => $trusted_form,
                               // "Optin_ID" => $trusted_form_link,
                                "quantity_wntk" => $number_of_windows,
                            );
                            $result = $crm_api_file->api_send_data($url_api_post, $httpheader, $leadsCustomerCampaign_id, json_encode($Lead_data_array), "POST", 1, $crm_details['campaign_id']);
                            $result2 = json_decode($result, true);
                            if (!empty($result2)) {
                                if (!empty($result2['outcome'])) {
                                    if ($result2['outcome'] == "success") {
                                        $TransactionId = $result2['lead']['id'];
                                        $Payout = $result2['price'];
                                        $multi_type = 0;
                                        $Result = 1;
                                        return 1;
                                    }
                                }
                            }

                            break;
                    }
                    break;
                case 1346:
                    $url = "http://bdmleadmanagement.valid1.net/Leads.aspx?";

                    $body = [
                        "first_name" => "$first_name",
                        "last_name" => $last_name,
                        "address1" => $street,
                        "city" => $city,
                        "state" => $statename_code,
                        "postal_code" => $zip,
                        "email" => $email,
                        "phone_primary" => $number1,
                        "EBRDate" => date("m/d/Y G:i:s"),
                        "ip" => $IPAddress,
                        "cert" => $trusted_form,
                        "alid" => "2381",
                        "source" => "Allied Digital"
                    ];

                    $httpheader = array(
                        "cache-control: no-cache",
                        "Accept: application/json",
                        "content-type: application/json"
                    );

                    if (config('app.env', 'local') == "local") {
                        $body['BDMLeadType'] = 'test';
                        $body['postal_code'] = '87017';
                        $body['state'] = 'NM';
                    } else {
                        $body['BDMLeadType'] = 'live';
                    }

                    switch ($lead_type_service_id) {
                        case 1:
                            $ownership = trim($crm_details['data']['homeOwn']);
                            $start_time = trim($crm_details['data']['start_time']);
                            $number_of_windows = trim($crm_details['data']['number_of_window']);
                            $project_nature = trim($crm_details['data']['project_nature']);

                            $windows_product = array(
                                "Install" => [
                                    '1' => '1-Install',
                                    '2' => '2-Install',
                                    '3-5' => '3-5-Install',
                                    '6-9' => '6-9-Install',
                                    '10+' => "Windows - New Windows - 10+"
                                ],

                                "Replace" => [
                                    '1' => '1-Replace',
                                    '2' => '2-Replace',
                                    '3-5' => '3-5-Replace',
                                    '6-9' => '6-9-Replace',
                                    '10+' => "replace windows - number of windows 10"
                                ],

                                "Repair" => [
                                    '1' => '1-Repair',
                                    '2' => '2-Repair',
                                    '3-5' => '6-9-Repair',
                                    '6-9' => '6-9-Repair',
                                    '10+' => "6-9-Repair"
                                ]
                            );

                            $body["taskName"] = $windows_product["$project_nature"]["$number_of_windows"];
                            $body['oid'] = "10129";

                            $url .= http_build_query($body);

                            $response = $crm_api_file->api_send_data($url, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);

                            if (str_contains(strtolower($response), 'success -')) {
                                return 1;
                            } else {
                                return 0;
                            }
                            break;
                        case 7:
                            $type_of_siding = trim($crm_details['data']['type_of_siding']);

                            $sidingType = [
                                "Vinyl Siding" => "Vinyl Siding - Install or Completely Replace",
                                "Brickface Siding" => "Siding Install",
                                "Composite wood Siding" => "Siding Install",
                                "Aluminum Siding" => "Siding Install",
                                "Stoneface Siding" => "Siding Install",
                                "Fiber Cement Siding" => "Siding Install",
                            ];

                            $body["taskName"] = $sidingType["$type_of_siding"];
                            $body['oid'] = "10126";
                            $url .= http_build_query($body);

                            $response = $crm_api_file->api_send_data($url, $httpheader, $leadsCustomerCampaign_id, "", "POST", 1, $crm_details['campaign_id']);

                            if (str_contains(strtolower($response), 'success -')) {
                                return 1;
                            } else {
                                return 0;
                            }

                            break;
                    }
                    break;

            }
            return 0;
        } catch (Exception $e) {

        }
    }
}
